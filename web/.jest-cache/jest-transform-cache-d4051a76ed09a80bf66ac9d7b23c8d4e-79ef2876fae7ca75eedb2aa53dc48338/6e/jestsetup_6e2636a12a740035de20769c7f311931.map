{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/jest.setup.js"],"sourcesContent":["import '@testing-library/jest-dom';\n\n// Set up test environment variables\nprocess.env.NEXT_PUBLIC_SUPABASE_URL = 'https://test.supabase.co';\nprocess.env.NEXT_PUBLIC_SUPABASE_ANON_KEY = 'test-anon-key';\nprocess.env.SUPABASE_SERVICE_ROLE_KEY = 'test-service-role-key';\nprocess.env.NEXTAUTH_SECRET = 'test-secret';\nprocess.env.NEXTAUTH_URL = 'http://localhost:3000';\n\n// Mock crypto API for DPoP tests\nObject.defineProperty(global, 'crypto', {\n  value: {\n    subtle: {\n      generateKey: jest.fn().mockResolvedValue({\n        publicKey: { type: 'public', algorithm: { name: 'ECDSA' } },\n        privateKey: { type: 'private', algorithm: { name: 'ECDSA' } }\n      }),\n      exportKey: jest.fn().mockResolvedValue(new ArrayBuffer(32)),\n      importKey: jest.fn().mockResolvedValue({ type: 'public', algorithm: { name: 'ECDSA' } }),\n      sign: jest.fn().mockResolvedValue(new ArrayBuffer(64)),\n      verify: jest.fn().mockResolvedValue(true)\n    },\n    getRandomValues: jest.fn().mockImplementation((array) => {\n      for (let i = 0; i < array.length; i++) {\n        array[i] = Math.floor(Math.random() * 256);\n      }\n      return array;\n    })\n  }\n});\n\n// Mock Supabase client\njest.mock('@supabase/supabase-js', () => ({\n  createClient: jest.fn(() => ({\n    auth: {\n      getUser: jest.fn().mockResolvedValue({ data: { user: null }, error: null }),\n      getSession: jest.fn().mockResolvedValue({ data: { session: null }, error: null }),\n      signInWithPassword: jest.fn().mockResolvedValue({ data: { user: null }, error: null }),\n      signUp: jest.fn().mockResolvedValue({ data: { user: null }, error: null }),\n      signOut: jest.fn().mockResolvedValue({ error: null }),\n      onAuthStateChange: jest.fn().mockReturnValue({ data: { subscription: { unsubscribe: jest.fn() } } })\n    },\n    from: jest.fn(() => ({\n      select: jest.fn().mockReturnThis(),\n      insert: jest.fn().mockReturnThis(),\n      update: jest.fn().mockReturnThis(),\n      delete: jest.fn().mockReturnThis(),\n      eq: jest.fn().mockReturnThis(),\n      single: jest.fn().mockResolvedValue({ data: null, error: null }),\n      then: jest.fn().mockResolvedValue({ data: [], error: null })\n    })),\n    rpc: jest.fn().mockResolvedValue({ data: null, error: null })\n  }))\n}));\n\n// Mock auth service\njest.mock('@/lib/auth', () => ({\n  getAuthService: jest.fn(() => ({\n    isAuthenticated: jest.fn().mockReturnValue(false),\n    getStoredUser: jest.fn().mockReturnValue(null),\n    getCurrentUser: jest.fn().mockResolvedValue(null),\n    login: jest.fn().mockResolvedValue({ user: null }),\n    register: jest.fn().mockResolvedValue({ user: null }),\n    logout: jest.fn().mockResolvedValue(),\n    refreshUser: jest.fn().mockResolvedValue(null),\n  }))\n}));\n\n// Mock Next.js router\njest.mock('next/router', () => ({\n  useRouter() {\n    return {\n      route: '/',\n      pathname: '/',\n      query: {},\n      asPath: '/',\n      push: jest.fn(),\n      pop: jest.fn(),\n      reload: jest.fn(),\n      back: jest.fn(),\n      prefetch: jest.fn().mockResolvedValue(undefined),\n      beforePopState: jest.fn(),\n      events: {\n        on: jest.fn(),\n        off: jest.fn(),\n        emit: jest.fn(),\n      },\n      isFallback: false,\n    };\n  },\n}));\n\n// Mock Next.js image component\njest.mock('next/image', () => ({\n  __esModule: true,\n  default: function MockImage(props) {\n    return require('react').createElement('img', props);\n  },\n}));\n\n// Mock Next.js server components\njest.mock('next/server', () => ({\n  NextRequest: class MockNextRequest {\n    constructor(url = 'http://localhost:3000') {\n      this.url = url;\n      this.headers = new Map();\n      this.method = 'GET';\n    }\n  },\n  NextResponse: {\n    json: jest.fn((data) => ({ json: () => data })),\n    redirect: jest.fn((url) => ({ url })),\n    next: jest.fn(() => ({ next: true }))\n  }\n}));\n\n// Mock window.matchMedia\nObject.defineProperty(window, 'matchMedia', {\n  writable: true,\n  value: jest.fn().mockImplementation(query => ({\n    matches: false,\n    media: query,\n    onchange: null,\n    addListener: jest.fn(),\n    removeListener: jest.fn(),\n    addEventListener: jest.fn(),\n    removeEventListener: jest.fn(),\n    dispatchEvent: jest.fn(),\n  })),\n});\n\n// Mock ResizeObserver\nglobal.ResizeObserver = jest.fn().mockImplementation(() => ({\n  observe: jest.fn(),\n  unobserve: jest.fn(),\n  disconnect: jest.fn(),\n}));\n\n// Mock IntersectionObserver\nglobal.IntersectionObserver = jest.fn().mockImplementation(() => ({\n  observe: jest.fn(),\n  unobserve: jest.fn(),\n  disconnect: jest.fn(),\n}));\n\n// Mock performance API\nObject.defineProperty(window, 'performance', {\n  value: {\n    now: jest.fn(() => Date.now()),\n    mark: jest.fn(),\n    measure: jest.fn(),\n    getEntriesByType: jest.fn(() => []),\n    memory: {\n      usedJSHeapSize: 1000000,\n      totalJSHeapSize: 2000000,\n      jsHeapSizeLimit: 4000000\n    }\n  }\n});\n\n// Mock navigator\nObject.defineProperty(window, 'navigator', {\n  value: {\n    ...window.navigator,\n    connection: {\n      effectiveType: '4g',\n      downlink: 10,\n      rtt: 50\n    },\n    standalone: false,\n    userAgent: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36'\n  }\n});\n\n// Suppress console warnings in tests\nconst originalWarn = console.warn;\nconst originalError = console.error;\n\nbeforeAll(() => {\n  console.warn = (...args) => {\n    if (\n      typeof args[0] === 'string' &&\n      (args[0].includes('Warning: ReactDOM.render is deprecated') ||\n       args[0].includes('Warning: An update to') ||\n       args[0].includes('Warning: componentWillReceiveProps'))\n    ) {\n      return;\n    }\n    originalWarn.call(console, ...args);\n  };\n\n  console.error = (...args) => {\n    if (\n      typeof args[0] === 'string' &&\n      (args[0].includes('Failed to load devices') ||\n       args[0].includes('Warning: An update to'))\n    ) {\n      return;\n    }\n    originalError.call(console, ...args);\n  };\n});\n\nafterAll(() => {\n  console.warn = originalWarn;\n  console.error = originalError;\n});\n"],"names":["jest","mock","createClient","fn","auth","getUser","mockResolvedValue","data","user","error","getSession","session","signInWithPassword","signUp","signOut","onAuthStateChange","mockReturnValue","subscription","unsubscribe","from","select","mockReturnThis","insert","update","delete","eq","single","then","rpc","getAuthService","isAuthenticated","getStoredUser","getCurrentUser","login","register","logout","refreshUser","useRouter","route","pathname","query","asPath","push","pop","reload","back","prefetch","undefined","beforePopState","events","on","off","emit","isFallback","__esModule","default","MockImage","props","require","createElement","NextRequest","MockNextRequest","constructor","url","headers","Map","method","NextResponse","json","redirect","next","process","env","NEXT_PUBLIC_SUPABASE_URL","NEXT_PUBLIC_SUPABASE_ANON_KEY","SUPABASE_SERVICE_ROLE_KEY","NEXTAUTH_SECRET","NEXTAUTH_URL","Object","defineProperty","global","value","subtle","generateKey","publicKey","type","algorithm","name","privateKey","exportKey","ArrayBuffer","importKey","sign","verify","getRandomValues","mockImplementation","array","i","length","Math","floor","random","window","writable","matches","media","onchange","addListener","removeListener","addEventListener","removeEventListener","dispatchEvent","ResizeObserver","observe","unobserve","disconnect","IntersectionObserver","now","Date","mark","measure","getEntriesByType","memory","usedJSHeapSize","totalJSHeapSize","jsHeapSizeLimit","navigator","connection","effectiveType","downlink","rtt","standalone","userAgent","originalWarn","console","warn","originalError","beforeAll","args","includes","call","afterAll"],"mappings":"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"}