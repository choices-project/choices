3c4085c1db1b5938c7babb8ccfd0d77c
/**
 * Approval Voting Strategy
 * 
 * Implements approval voting where voters can approve (vote for) multiple options.
 * Results show approval scores for each option, with the highest scoring option winning.
 * 
 * Created: September 15, 2025
 * Updated: September 15, 2025
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "ApprovalStrategy", {
    enumerable: true,
    get: function() {
        return ApprovalStrategy;
    }
});
const _logger = require("../../utils/logger");
class ApprovalStrategy {
    getVotingMethod() {
        return "approval";
    }
    async validateVote(request, poll) {
        await Promise.resolve(); // Satisfy require-await rule
        try {
            const voteData = request.voteData;
            // Validate approvals array exists and is not empty
            if (!voteData.approvals || !Array.isArray(voteData.approvals)) {
                return {
                    valid: false,
                    isValid: false,
                    error: "Approval votes must be an array",
                    errors: [
                        "Approval votes must be an array"
                    ],
                    requiresAuthentication: false,
                    requiresTokens: false
                };
            }
            // Validate approvals array is not empty
            if (voteData.approvals.length === 0) {
                return {
                    valid: false,
                    isValid: false,
                    error: "At least one approval is required",
                    errors: [
                        "At least one approval is required"
                    ],
                    requiresAuthentication: false,
                    requiresTokens: false
                };
            }
            // Validate all approvals are valid integers
            for (const approval of voteData.approvals){
                if (typeof approval !== "number" || !Number.isInteger(approval)) {
                    return {
                        valid: false,
                        isValid: false,
                        error: "Approval votes must be integers",
                        errors: [
                            "Approval votes must be integers"
                        ],
                        requiresAuthentication: false,
                        requiresTokens: false
                    };
                }
                if (approval < 0 || approval >= poll.options.length) {
                    return {
                        valid: false,
                        isValid: false,
                        error: "Invalid option selected",
                        errors: [
                            "Invalid option selected"
                        ],
                        requiresAuthentication: false,
                        requiresTokens: false
                    };
                }
            }
            // Check for duplicate approvals
            const uniqueApprovals = new Set(voteData.approvals);
            if (uniqueApprovals.size !== voteData.approvals.length) {
                return {
                    valid: false,
                    isValid: false,
                    error: "Duplicate approvals are not allowed",
                    errors: [
                        "Duplicate approvals are not allowed"
                    ],
                    requiresAuthentication: false,
                    requiresTokens: false
                };
            }
            // Check maximum approvals limit
            const maxApprovals = poll.votingConfig?.maxChoices || poll.options.length;
            if (voteData.approvals.length > maxApprovals) {
                return {
                    valid: false,
                    isValid: false,
                    error: `Maximum ${maxApprovals} approvals allowed`,
                    errors: [
                        `Maximum ${maxApprovals} approvals allowed`
                    ],
                    requiresAuthentication: false,
                    requiresTokens: false
                };
            }
            (0, _logger.devLog)("Approval vote validated successfully", {
                pollId: request.pollId,
                approvals: voteData.approvals,
                userId: request.userId
            });
            return {
                valid: true,
                isValid: true,
                requiresAuthentication: false,
                requiresTokens: false
            };
        } catch (error) {
            (0, _logger.devLog)("Approval vote validation error:", {
                error: error instanceof Error ? error.message : String(error)
            });
            return {
                valid: false,
                isValid: false,
                error: "Approval vote validation failed",
                errors: [
                    "Approval vote validation failed"
                ],
                requiresAuthentication: false,
                requiresTokens: false
            };
        }
    }
    async processVote(request, poll) {
        await Promise.resolve(); // Satisfy require-await rule
        try {
            const voteData = request.voteData;
            // Create vote data for storage
            const voteRecord = {
                id: `vote_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
                pollId: request.pollId,
                userId: request.userId,
                approvals: voteData.approvals,
                privacyLevel: "standard",
                auditReceipt: `audit_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
                timestamp: new Date(),
                ipAddress: request.ipAddress,
                userAgent: request.userAgent
            };
            (0, _logger.devLog)("Approval vote processed successfully", {
                pollId: request.pollId,
                userId: request.userId,
                approvals: voteData.approvals,
                voteId: voteRecord.id
            });
            return {
                success: true,
                voteId: voteRecord.id,
                message: "Vote recorded successfully",
                pollId: request.pollId
            };
        } catch (error) {
            (0, _logger.devLog)("Approval vote processing error:", {
                error: error instanceof Error ? error.message : String(error)
            });
            return {
                success: false,
                error: "Failed to process approval vote",
                message: "Failed to process approval vote",
                pollId: request.pollId
            };
        }
    }
    async calculateResults(poll, votes) {
        await Promise.resolve(); // Satisfy require-await rule
        try {
            const startTime = Date.now();
            // Initialize tracking objects
            const approvalScores = {};
            const optionVotes = {};
            const approvalPercentages = {};
            const optionPercentages = {};
            // Initialize all options with zero scores
            poll.options.forEach((option)=>{
                approvalScores[option.id] = 0;
                optionVotes[option.id] = 0;
                approvalPercentages[option.id] = 0;
                optionPercentages[option.id] = 0;
            });
            // Process each vote
            votes.forEach((vote)=>{
                if (vote.voteData?.approvals) {
                    vote.voteData.approvals.forEach((approval)=>{
                        const option = poll.options[approval];
                        if (option?.id) {
                            approvalScores[option.id] = (approvalScores[option.id] || 0) + 1;
                            optionVotes[option.id] = (optionVotes[option.id] || 0) + 1;
                        }
                    });
                }
            });
            const totalVotes = votes.length;
            // Calculate percentages
            if (totalVotes > 0) {
                Object.keys(approvalScores).forEach((optionId)=>{
                    const approvalScore = approvalScores[optionId];
                    const optionVote = optionVotes[optionId];
                    if (approvalScore !== undefined) {
                        approvalPercentages[optionId] = approvalScore / totalVotes * 100;
                    }
                    if (optionVote !== undefined) {
                        optionPercentages[optionId] = optionVote / totalVotes * 100;
                    }
                });
            }
            // Find winner (highest approval score)
            let winner;
            let winnerVotes = 0;
            let winnerPercentage = 0;
            if (totalVotes > 0) {
                Object.entries(approvalScores).forEach(([optionId, score])=>{
                    if (score > winnerVotes) {
                        winner = optionId;
                        winnerVotes = score;
                        winnerPercentage = approvalPercentages[optionId] || 0;
                    }
                });
            }
            const results = {
                winner,
                winnerVotes,
                winnerPercentage,
                optionVotes,
                optionPercentages,
                abstentions: 0,
                abstentionPercentage: 0
            };
            (0, _logger.devLog)("Approval results calculated", {
                pollId: poll.id,
                totalVotes,
                winner,
                winnerVotes,
                winnerPercentage,
                calculationTime: Date.now() - startTime
            });
            return {
                pollId: poll.id,
                votingMethod: poll.votingMethod,
                totalVotes,
                participationRate: totalVotes / 100,
                results,
                calculatedAt: new Date().toISOString(),
                metadata: {
                    calculationTime: Date.now() - startTime,
                    method: "approval"
                }
            };
        } catch (error) {
            (0, _logger.devLog)("Approval results calculation error:", {
                error: error instanceof Error ? error.message : String(error)
            });
            // Return empty results on error
            return {
                pollId: poll.id,
                votingMethod: poll.votingMethod,
                totalVotes: 0,
                participationRate: 0,
                results: {
                    winner: undefined,
                    winnerVotes: 0,
                    winnerPercentage: 0,
                    optionVotes: {},
                    optionPercentages: {},
                    abstentions: 0,
                    abstentionPercentage: 0
                },
                calculatedAt: new Date().toISOString(),
                metadata: {
                    calculationTime: 0,
                    error: error instanceof Error ? error.message : "Unknown error"
                }
            };
        }
    }
    getConfiguration() {
        return {
            method: "approval",
            description: "Voters can approve multiple options",
            allowsMultipleSelections: true,
            requiresRanking: false,
            maxSelections: "unlimited"
        };
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hbGF1Z2hpbmdraXRzdW5lL3NyYy9DaG9pY2VzL3dlYi9saWIvdm90ZS9zdHJhdGVnaWVzL2FwcHJvdmFsLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQXBwcm92YWwgVm90aW5nIFN0cmF0ZWd5XG4gKiBcbiAqIEltcGxlbWVudHMgYXBwcm92YWwgdm90aW5nIHdoZXJlIHZvdGVycyBjYW4gYXBwcm92ZSAodm90ZSBmb3IpIG11bHRpcGxlIG9wdGlvbnMuXG4gKiBSZXN1bHRzIHNob3cgYXBwcm92YWwgc2NvcmVzIGZvciBlYWNoIG9wdGlvbiwgd2l0aCB0aGUgaGlnaGVzdCBzY29yaW5nIG9wdGlvbiB3aW5uaW5nLlxuICogXG4gKiBDcmVhdGVkOiBTZXB0ZW1iZXIgMTUsIDIwMjVcbiAqIFVwZGF0ZWQ6IFNlcHRlbWJlciAxNSwgMjAyNVxuICovXG5cbmltcG9ydCB7IGRldkxvZyB9IGZyb20gJ0AvbGliL3V0aWxzL2xvZ2dlcic7XG5cbmltcG9ydCB0eXBlIHsgXG4gIFZvdGluZ1N0cmF0ZWd5LCBcbiAgVm90ZVJlcXVlc3QsIFxuICBWb3RlUmVzcG9uc2UsIFxuICBWb3RlVmFsaWRhdGlvbiwgXG4gIFBvbGxEYXRhLCBcbiAgVm90ZURhdGEsIFxuICBSZXN1bHRzRGF0YSxcbiAgVm90aW5nTWV0aG9kLFxuICBQb2xsUmVzdWx0c1xufSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBBcHByb3ZhbFN0cmF0ZWd5IGltcGxlbWVudHMgVm90aW5nU3RyYXRlZ3kge1xuICBcbiAgZ2V0Vm90aW5nTWV0aG9kKCk6IFZvdGluZ01ldGhvZCB7XG4gICAgcmV0dXJuICdhcHByb3ZhbCc7XG4gIH1cblxuICBhc3luYyB2YWxpZGF0ZVZvdGUocmVxdWVzdDogVm90ZVJlcXVlc3QsIHBvbGw6IFBvbGxEYXRhKTogUHJvbWlzZTxWb3RlVmFsaWRhdGlvbj4ge1xuICAgIGF3YWl0IFByb21pc2UucmVzb2x2ZSgpOyAvLyBTYXRpc2Z5IHJlcXVpcmUtYXdhaXQgcnVsZVxuICAgIHRyeSB7XG4gICAgICBjb25zdCB2b3RlRGF0YSA9IHJlcXVlc3Qudm90ZURhdGE7XG5cbiAgICAgIC8vIFZhbGlkYXRlIGFwcHJvdmFscyBhcnJheSBleGlzdHMgYW5kIGlzIG5vdCBlbXB0eVxuICAgICAgaWYgKCF2b3RlRGF0YS5hcHByb3ZhbHMgfHwgIUFycmF5LmlzQXJyYXkodm90ZURhdGEuYXBwcm92YWxzKSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjogJ0FwcHJvdmFsIHZvdGVzIG11c3QgYmUgYW4gYXJyYXknLFxuICAgICAgICAgIGVycm9yczogWydBcHByb3ZhbCB2b3RlcyBtdXN0IGJlIGFuIGFycmF5J10sXG4gICAgICAgICAgcmVxdWlyZXNBdXRoZW50aWNhdGlvbjogZmFsc2UsXG4gICAgICAgICAgcmVxdWlyZXNUb2tlbnM6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8vIFZhbGlkYXRlIGFwcHJvdmFscyBhcnJheSBpcyBub3QgZW1wdHlcbiAgICAgIGlmICh2b3RlRGF0YS5hcHByb3ZhbHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgIGlzVmFsaWQ6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiAnQXQgbGVhc3Qgb25lIGFwcHJvdmFsIGlzIHJlcXVpcmVkJyxcbiAgICAgICAgICBlcnJvcnM6IFsnQXQgbGVhc3Qgb25lIGFwcHJvdmFsIGlzIHJlcXVpcmVkJ10sXG4gICAgICAgICAgcmVxdWlyZXNBdXRoZW50aWNhdGlvbjogZmFsc2UsXG4gICAgICAgICAgcmVxdWlyZXNUb2tlbnM6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8vIFZhbGlkYXRlIGFsbCBhcHByb3ZhbHMgYXJlIHZhbGlkIGludGVnZXJzXG4gICAgICBmb3IgKGNvbnN0IGFwcHJvdmFsIG9mIHZvdGVEYXRhLmFwcHJvdmFscykge1xuICAgICAgICBpZiAodHlwZW9mIGFwcHJvdmFsICE9PSAnbnVtYmVyJyB8fCAhTnVtYmVyLmlzSW50ZWdlcihhcHByb3ZhbCkpIHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgaXNWYWxpZDogZmFsc2UsXG4gICAgICAgICAgICBlcnJvcjogJ0FwcHJvdmFsIHZvdGVzIG11c3QgYmUgaW50ZWdlcnMnLFxuICAgICAgICAgICAgZXJyb3JzOiBbJ0FwcHJvdmFsIHZvdGVzIG11c3QgYmUgaW50ZWdlcnMnXSxcbiAgICAgICAgICAgIHJlcXVpcmVzQXV0aGVudGljYXRpb246IGZhbHNlLFxuICAgICAgICAgICAgcmVxdWlyZXNUb2tlbnM6IGZhbHNlXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChhcHByb3ZhbCA8IDAgfHwgYXBwcm92YWwgPj0gcG9sbC5vcHRpb25zLmxlbmd0aCkge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgIGVycm9yOiAnSW52YWxpZCBvcHRpb24gc2VsZWN0ZWQnLFxuICAgICAgICAgICAgZXJyb3JzOiBbJ0ludmFsaWQgb3B0aW9uIHNlbGVjdGVkJ10sXG4gICAgICAgICAgICByZXF1aXJlc0F1dGhlbnRpY2F0aW9uOiBmYWxzZSxcbiAgICAgICAgICAgIHJlcXVpcmVzVG9rZW5zOiBmYWxzZVxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgZm9yIGR1cGxpY2F0ZSBhcHByb3ZhbHNcbiAgICAgIGNvbnN0IHVuaXF1ZUFwcHJvdmFscyA9IG5ldyBTZXQodm90ZURhdGEuYXBwcm92YWxzKTtcbiAgICAgIGlmICh1bmlxdWVBcHByb3ZhbHMuc2l6ZSAhPT0gdm90ZURhdGEuYXBwcm92YWxzLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjogJ0R1cGxpY2F0ZSBhcHByb3ZhbHMgYXJlIG5vdCBhbGxvd2VkJyxcbiAgICAgICAgICBlcnJvcnM6IFsnRHVwbGljYXRlIGFwcHJvdmFscyBhcmUgbm90IGFsbG93ZWQnXSxcbiAgICAgICAgICByZXF1aXJlc0F1dGhlbnRpY2F0aW9uOiBmYWxzZSxcbiAgICAgICAgICByZXF1aXJlc1Rva2VuczogZmFsc2VcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgbWF4aW11bSBhcHByb3ZhbHMgbGltaXRcbiAgICAgIGNvbnN0IG1heEFwcHJvdmFscyA9IHBvbGwudm90aW5nQ29uZmlnPy5tYXhDaG9pY2VzIHx8IHBvbGwub3B0aW9ucy5sZW5ndGg7XG4gICAgICBpZiAodm90ZURhdGEuYXBwcm92YWxzLmxlbmd0aCA+IG1heEFwcHJvdmFscykge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjogYE1heGltdW0gJHttYXhBcHByb3ZhbHN9IGFwcHJvdmFscyBhbGxvd2VkYCxcbiAgICAgICAgICBlcnJvcnM6IFtgTWF4aW11bSAke21heEFwcHJvdmFsc30gYXBwcm92YWxzIGFsbG93ZWRgXSxcbiAgICAgICAgICByZXF1aXJlc0F1dGhlbnRpY2F0aW9uOiBmYWxzZSxcbiAgICAgICAgICByZXF1aXJlc1Rva2VuczogZmFsc2VcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgZGV2TG9nKCdBcHByb3ZhbCB2b3RlIHZhbGlkYXRlZCBzdWNjZXNzZnVsbHknLCB7XG4gICAgICAgIHBvbGxJZDogcmVxdWVzdC5wb2xsSWQsXG4gICAgICAgIGFwcHJvdmFsczogdm90ZURhdGEuYXBwcm92YWxzLFxuICAgICAgICB1c2VySWQ6IHJlcXVlc3QudXNlcklkXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsaWQ6IHRydWUsXG4gICAgICAgIGlzVmFsaWQ6IHRydWUsXG4gICAgICAgIHJlcXVpcmVzQXV0aGVudGljYXRpb246IGZhbHNlLFxuICAgICAgICByZXF1aXJlc1Rva2VuczogZmFsc2VcbiAgICAgIH07XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgZGV2TG9nKCdBcHByb3ZhbCB2b3RlIHZhbGlkYXRpb24gZXJyb3I6JywgeyBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpIH0pO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6ICdBcHByb3ZhbCB2b3RlIHZhbGlkYXRpb24gZmFpbGVkJyxcbiAgICAgICAgZXJyb3JzOiBbJ0FwcHJvdmFsIHZvdGUgdmFsaWRhdGlvbiBmYWlsZWQnXSxcbiAgICAgICAgcmVxdWlyZXNBdXRoZW50aWNhdGlvbjogZmFsc2UsXG4gICAgICAgIHJlcXVpcmVzVG9rZW5zOiBmYWxzZVxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBwcm9jZXNzVm90ZShyZXF1ZXN0OiBWb3RlUmVxdWVzdCwgcG9sbDogUG9sbERhdGEpOiBQcm9taXNlPFZvdGVSZXNwb25zZT4ge1xuICAgIGF3YWl0IFByb21pc2UucmVzb2x2ZSgpOyAvLyBTYXRpc2Z5IHJlcXVpcmUtYXdhaXQgcnVsZVxuICAgIHRyeSB7XG4gICAgICBjb25zdCB2b3RlRGF0YSA9IHJlcXVlc3Qudm90ZURhdGE7XG4gICAgICBcbiAgICAgIC8vIENyZWF0ZSB2b3RlIGRhdGEgZm9yIHN0b3JhZ2VcbiAgICAgIGNvbnN0IHZvdGVSZWNvcmQ6IFZvdGVEYXRhID0ge1xuICAgICAgICBpZDogYHZvdGVfJHtEYXRlLm5vdygpfV8ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KX1gLFxuICAgICAgICBwb2xsSWQ6IHJlcXVlc3QucG9sbElkLFxuICAgICAgICB1c2VySWQ6IHJlcXVlc3QudXNlcklkLFxuICAgICAgICBhcHByb3ZhbHM6IHZvdGVEYXRhLmFwcHJvdmFscyxcbiAgICAgICAgcHJpdmFjeUxldmVsOiAnc3RhbmRhcmQnLFxuICAgICAgICBhdWRpdFJlY2VpcHQ6IGBhdWRpdF8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWAsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgaXBBZGRyZXNzOiByZXF1ZXN0LmlwQWRkcmVzcyxcbiAgICAgICAgdXNlckFnZW50OiByZXF1ZXN0LnVzZXJBZ2VudFxuICAgICAgfTtcblxuICAgICAgZGV2TG9nKCdBcHByb3ZhbCB2b3RlIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHknLCB7XG4gICAgICAgIHBvbGxJZDogcmVxdWVzdC5wb2xsSWQsXG4gICAgICAgIHVzZXJJZDogcmVxdWVzdC51c2VySWQsXG4gICAgICAgIGFwcHJvdmFsczogdm90ZURhdGEuYXBwcm92YWxzLFxuICAgICAgICB2b3RlSWQ6IHZvdGVSZWNvcmQuaWRcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICB2b3RlSWQ6IHZvdGVSZWNvcmQuaWQsXG4gICAgICAgIG1lc3NhZ2U6ICdWb3RlIHJlY29yZGVkIHN1Y2Nlc3NmdWxseScsXG4gICAgICAgIHBvbGxJZDogcmVxdWVzdC5wb2xsSWRcbiAgICAgIH07XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgZGV2TG9nKCdBcHByb3ZhbCB2b3RlIHByb2Nlc3NpbmcgZXJyb3I6JywgeyBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpIH0pO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiAnRmFpbGVkIHRvIHByb2Nlc3MgYXBwcm92YWwgdm90ZScsXG4gICAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gcHJvY2VzcyBhcHByb3ZhbCB2b3RlJyxcbiAgICAgICAgcG9sbElkOiByZXF1ZXN0LnBvbGxJZFxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBjYWxjdWxhdGVSZXN1bHRzKHBvbGw6IFBvbGxEYXRhLCB2b3RlczogVm90ZURhdGFbXSk6IFByb21pc2U8UmVzdWx0c0RhdGE+IHtcbiAgICBhd2FpdCBQcm9taXNlLnJlc29sdmUoKTsgLy8gU2F0aXNmeSByZXF1aXJlLWF3YWl0IHJ1bGVcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgIFxuICAgICAgLy8gSW5pdGlhbGl6ZSB0cmFja2luZyBvYmplY3RzXG4gICAgICBjb25zdCBhcHByb3ZhbFNjb3JlczogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xuICAgICAgY29uc3Qgb3B0aW9uVm90ZXM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcbiAgICAgIGNvbnN0IGFwcHJvdmFsUGVyY2VudGFnZXM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcbiAgICAgIGNvbnN0IG9wdGlvblBlcmNlbnRhZ2VzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XG5cbiAgICAgIC8vIEluaXRpYWxpemUgYWxsIG9wdGlvbnMgd2l0aCB6ZXJvIHNjb3Jlc1xuICAgICAgcG9sbC5vcHRpb25zLmZvckVhY2gob3B0aW9uID0+IHtcbiAgICAgICAgYXBwcm92YWxTY29yZXNbb3B0aW9uLmlkXSA9IDA7XG4gICAgICAgIG9wdGlvblZvdGVzW29wdGlvbi5pZF0gPSAwO1xuICAgICAgICBhcHByb3ZhbFBlcmNlbnRhZ2VzW29wdGlvbi5pZF0gPSAwO1xuICAgICAgICBvcHRpb25QZXJjZW50YWdlc1tvcHRpb24uaWRdID0gMDtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBQcm9jZXNzIGVhY2ggdm90ZVxuICAgICAgdm90ZXMuZm9yRWFjaCh2b3RlID0+IHtcbiAgICAgICAgaWYgKHZvdGUudm90ZURhdGE/LmFwcHJvdmFscykge1xuICAgICAgICAgIHZvdGUudm90ZURhdGEuYXBwcm92YWxzLmZvckVhY2goYXBwcm92YWwgPT4ge1xuICAgICAgICAgICAgY29uc3Qgb3B0aW9uID0gcG9sbC5vcHRpb25zW2FwcHJvdmFsXTtcbiAgICAgICAgICAgIGlmIChvcHRpb24/LmlkKSB7XG4gICAgICAgICAgICAgIGFwcHJvdmFsU2NvcmVzW29wdGlvbi5pZF0gPSAoYXBwcm92YWxTY29yZXNbb3B0aW9uLmlkXSB8fCAwKSArIDE7XG4gICAgICAgICAgICAgIG9wdGlvblZvdGVzW29wdGlvbi5pZF0gPSAob3B0aW9uVm90ZXNbb3B0aW9uLmlkXSB8fCAwKSArIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB0b3RhbFZvdGVzID0gdm90ZXMubGVuZ3RoO1xuXG4gICAgICAvLyBDYWxjdWxhdGUgcGVyY2VudGFnZXNcbiAgICAgIGlmICh0b3RhbFZvdGVzID4gMCkge1xuICAgICAgICBPYmplY3Qua2V5cyhhcHByb3ZhbFNjb3JlcykuZm9yRWFjaChvcHRpb25JZCA9PiB7XG4gICAgICAgICAgY29uc3QgYXBwcm92YWxTY29yZSA9IGFwcHJvdmFsU2NvcmVzW29wdGlvbklkXTtcbiAgICAgICAgICBjb25zdCBvcHRpb25Wb3RlID0gb3B0aW9uVm90ZXNbb3B0aW9uSWRdO1xuICAgICAgICAgIGlmIChhcHByb3ZhbFNjb3JlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGFwcHJvdmFsUGVyY2VudGFnZXNbb3B0aW9uSWRdID0gKGFwcHJvdmFsU2NvcmUgLyB0b3RhbFZvdGVzKSAqIDEwMDtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9wdGlvblZvdGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgb3B0aW9uUGVyY2VudGFnZXNbb3B0aW9uSWRdID0gKG9wdGlvblZvdGUgLyB0b3RhbFZvdGVzKSAqIDEwMDtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBGaW5kIHdpbm5lciAoaGlnaGVzdCBhcHByb3ZhbCBzY29yZSlcbiAgICAgIGxldCB3aW5uZXI6IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgICAgIGxldCB3aW5uZXJWb3RlcyA9IDA7XG4gICAgICBsZXQgd2lubmVyUGVyY2VudGFnZSA9IDA7XG5cbiAgICAgIGlmICh0b3RhbFZvdGVzID4gMCkge1xuICAgICAgICBPYmplY3QuZW50cmllcyhhcHByb3ZhbFNjb3JlcykuZm9yRWFjaCgoW29wdGlvbklkLCBzY29yZV0pID0+IHtcbiAgICAgICAgICBpZiAoc2NvcmUgPiB3aW5uZXJWb3Rlcykge1xuICAgICAgICAgICAgd2lubmVyID0gb3B0aW9uSWQ7XG4gICAgICAgICAgICB3aW5uZXJWb3RlcyA9IHNjb3JlO1xuICAgICAgICAgICAgd2lubmVyUGVyY2VudGFnZSA9IGFwcHJvdmFsUGVyY2VudGFnZXNbb3B0aW9uSWRdIHx8IDA7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVzdWx0czogUG9sbFJlc3VsdHMgPSB7XG4gICAgICAgIHdpbm5lcixcbiAgICAgICAgd2lubmVyVm90ZXMsXG4gICAgICAgIHdpbm5lclBlcmNlbnRhZ2UsXG4gICAgICAgIG9wdGlvblZvdGVzLFxuICAgICAgICBvcHRpb25QZXJjZW50YWdlcyxcbiAgICAgICAgYWJzdGVudGlvbnM6IDAsXG4gICAgICAgIGFic3RlbnRpb25QZXJjZW50YWdlOiAwXG4gICAgICB9O1xuXG4gICAgICBkZXZMb2coJ0FwcHJvdmFsIHJlc3VsdHMgY2FsY3VsYXRlZCcsIHtcbiAgICAgICAgcG9sbElkOiBwb2xsLmlkLFxuICAgICAgICB0b3RhbFZvdGVzLFxuICAgICAgICB3aW5uZXIsXG4gICAgICAgIHdpbm5lclZvdGVzLFxuICAgICAgICB3aW5uZXJQZXJjZW50YWdlLFxuICAgICAgICBjYWxjdWxhdGlvblRpbWU6IERhdGUubm93KCkgLSBzdGFydFRpbWVcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBwb2xsSWQ6IHBvbGwuaWQsXG4gICAgICAgIHZvdGluZ01ldGhvZDogcG9sbC52b3RpbmdNZXRob2QsXG4gICAgICAgIHRvdGFsVm90ZXMsXG4gICAgICAgIHBhcnRpY2lwYXRpb25SYXRlOiB0b3RhbFZvdGVzIC8gMTAwLCAvLyBNb2NrIHBhcnRpY2lwYXRpb24gcmF0ZVxuICAgICAgICByZXN1bHRzLFxuICAgICAgICBjYWxjdWxhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICBjYWxjdWxhdGlvblRpbWU6IERhdGUubm93KCkgLSBzdGFydFRpbWUsXG4gICAgICAgICAgbWV0aG9kOiAnYXBwcm92YWwnXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgZGV2TG9nKCdBcHByb3ZhbCByZXN1bHRzIGNhbGN1bGF0aW9uIGVycm9yOicsIHsgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKSB9KTtcbiAgICAgIFxuICAgICAgLy8gUmV0dXJuIGVtcHR5IHJlc3VsdHMgb24gZXJyb3JcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHBvbGxJZDogcG9sbC5pZCxcbiAgICAgICAgdm90aW5nTWV0aG9kOiBwb2xsLnZvdGluZ01ldGhvZCxcbiAgICAgICAgdG90YWxWb3RlczogMCxcbiAgICAgICAgcGFydGljaXBhdGlvblJhdGU6IDAsXG4gICAgICAgIHJlc3VsdHM6IHtcbiAgICAgICAgICB3aW5uZXI6IHVuZGVmaW5lZCxcbiAgICAgICAgICB3aW5uZXJWb3RlczogMCxcbiAgICAgICAgICB3aW5uZXJQZXJjZW50YWdlOiAwLFxuICAgICAgICAgIG9wdGlvblZvdGVzOiB7fSxcbiAgICAgICAgICBvcHRpb25QZXJjZW50YWdlczoge30sXG4gICAgICAgICAgYWJzdGVudGlvbnM6IDAsXG4gICAgICAgICAgYWJzdGVudGlvblBlcmNlbnRhZ2U6IDBcbiAgICAgICAgfSxcbiAgICAgICAgY2FsY3VsYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgY2FsY3VsYXRpb25UaW1lOiAwLFxuICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIGdldENvbmZpZ3VyYXRpb24oKTogUmVjb3JkPHN0cmluZywgdW5rbm93bj4ge1xuICAgIHJldHVybiB7XG4gICAgICBtZXRob2Q6ICdhcHByb3ZhbCcsXG4gICAgICBkZXNjcmlwdGlvbjogJ1ZvdGVycyBjYW4gYXBwcm92ZSBtdWx0aXBsZSBvcHRpb25zJyxcbiAgICAgIGFsbG93c011bHRpcGxlU2VsZWN0aW9uczogdHJ1ZSxcbiAgICAgIHJlcXVpcmVzUmFua2luZzogZmFsc2UsXG4gICAgICBtYXhTZWxlY3Rpb25zOiAndW5saW1pdGVkJ1xuICAgIH07XG4gIH1cbn0iXSwibmFtZXMiOlsiQXBwcm92YWxTdHJhdGVneSIsImdldFZvdGluZ01ldGhvZCIsInZhbGlkYXRlVm90ZSIsInJlcXVlc3QiLCJwb2xsIiwiUHJvbWlzZSIsInJlc29sdmUiLCJ2b3RlRGF0YSIsImFwcHJvdmFscyIsIkFycmF5IiwiaXNBcnJheSIsInZhbGlkIiwiaXNWYWxpZCIsImVycm9yIiwiZXJyb3JzIiwicmVxdWlyZXNBdXRoZW50aWNhdGlvbiIsInJlcXVpcmVzVG9rZW5zIiwibGVuZ3RoIiwiYXBwcm92YWwiLCJOdW1iZXIiLCJpc0ludGVnZXIiLCJvcHRpb25zIiwidW5pcXVlQXBwcm92YWxzIiwiU2V0Iiwic2l6ZSIsIm1heEFwcHJvdmFscyIsInZvdGluZ0NvbmZpZyIsIm1heENob2ljZXMiLCJkZXZMb2ciLCJwb2xsSWQiLCJ1c2VySWQiLCJFcnJvciIsIm1lc3NhZ2UiLCJTdHJpbmciLCJwcm9jZXNzVm90ZSIsInZvdGVSZWNvcmQiLCJpZCIsIkRhdGUiLCJub3ciLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHIiLCJwcml2YWN5TGV2ZWwiLCJhdWRpdFJlY2VpcHQiLCJ0aW1lc3RhbXAiLCJpcEFkZHJlc3MiLCJ1c2VyQWdlbnQiLCJ2b3RlSWQiLCJzdWNjZXNzIiwiY2FsY3VsYXRlUmVzdWx0cyIsInZvdGVzIiwic3RhcnRUaW1lIiwiYXBwcm92YWxTY29yZXMiLCJvcHRpb25Wb3RlcyIsImFwcHJvdmFsUGVyY2VudGFnZXMiLCJvcHRpb25QZXJjZW50YWdlcyIsImZvckVhY2giLCJvcHRpb24iLCJ2b3RlIiwidG90YWxWb3RlcyIsIk9iamVjdCIsImtleXMiLCJvcHRpb25JZCIsImFwcHJvdmFsU2NvcmUiLCJvcHRpb25Wb3RlIiwidW5kZWZpbmVkIiwid2lubmVyIiwid2lubmVyVm90ZXMiLCJ3aW5uZXJQZXJjZW50YWdlIiwiZW50cmllcyIsInNjb3JlIiwicmVzdWx0cyIsImFic3RlbnRpb25zIiwiYWJzdGVudGlvblBlcmNlbnRhZ2UiLCJjYWxjdWxhdGlvblRpbWUiLCJ2b3RpbmdNZXRob2QiLCJwYXJ0aWNpcGF0aW9uUmF0ZSIsImNhbGN1bGF0ZWRBdCIsInRvSVNPU3RyaW5nIiwibWV0YWRhdGEiLCJtZXRob2QiLCJnZXRDb25maWd1cmF0aW9uIiwiZGVzY3JpcHRpb24iLCJhbGxvd3NNdWx0aXBsZVNlbGVj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