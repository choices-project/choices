{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/lib/stores/profileStore.ts"],"sourcesContent":["/**\n * Profile Store - Zustand Implementation\n * \n * Comprehensive profile state management with Zustand integration\n * Handles profile data, preferences, settings, and real-time updates\n * \n * Created: December 19, 2024\n * Status: âœ… INTEGRATED\n */\n\nimport { create } from 'zustand';\nimport { devtools } from 'zustand/middleware';\nimport { persist } from 'zustand/middleware';\nimport { immer } from 'zustand/middleware/immer';\n\nimport type { \n  ProfileUser, \n  UserProfile, \n  ProfileUpdateData, \n  ProfilePreferences, \n  PrivacySettings,\n  ProfileValidationResult,\n  AvatarUploadResult,\n  ProfileExportData\n} from '@/features/profile/types';\nimport { logger } from '@/lib/utils/logger';\n\nimport type { BaseStore } from './types';\n\n\n// Local type definition\ninterface ProfileCompleteness {\n  isComplete: boolean;\n  percentage: number;\n  missingFields: string[];\n}\n\n// Profile store state interface\ntype ProfileStore = {\n  // Profile data\n  profile: ProfileUser | null;\n  userProfile: UserProfile | null;\n  \n  // Profile state\n  isProfileLoaded: boolean;\n  isProfileComplete: boolean;\n  profileCompleteness: number;\n  missingFields: string[];\n  \n  // Loading states\n  isProfileLoading: boolean;\n  isUpdating: boolean;\n  isUploadingAvatar: boolean;\n  isExporting: boolean;\n  \n  // Validation state\n  validationErrors: Record<string, string[]>;\n  validationWarnings: Record<string, string[]>;\n  \n  // Profile preferences and settings\n  preferences: ProfilePreferences | null;\n  privacySettings: PrivacySettings | null;\n  \n  // Profile actions\n  setProfile: (profile: ProfileUser | null) => void;\n  setUserProfile: (userProfile: UserProfile | null) => void;\n  updateProfile: (updates: ProfileUpdateData) => Promise<boolean>;\n  updatePreferences: (preferences: Partial<ProfilePreferences>) => Promise<boolean>;\n  updatePrivacySettings: (settings: Partial<PrivacySettings>) => Promise<boolean>;\n  \n  // Avatar actions\n  updateAvatar: (file: File) => Promise<AvatarUploadResult>;\n  removeAvatar: () => Promise<boolean>;\n  \n  // Profile management\n  loadProfile: () => Promise<void>;\n  refreshProfile: () => Promise<void>;\n  exportProfile: () => Promise<ProfileExportData | null>;\n  deleteProfile: () => Promise<boolean>;\n  \n  // Validation\n  validateProfile: (data: ProfileUpdateData) => ProfileValidationResult;\n  setValidationErrors: (errors: Record<string, string[]>) => void;\n  setValidationWarnings: (warnings: Record<string, string[]>) => void;\n  clearValidation: () => void;\n  \n  // Loading states\n  setProfileLoading: (loading: boolean) => void;\n  setUpdating: (updating: boolean) => void;\n  setUploadingAvatar: (uploading: boolean) => void;\n  setExporting: (exporting: boolean) => void;\n  \n  // Profile completeness\n  updateProfileCompleteness: () => void;\n  getProfileCompleteness: () => ProfileCompleteness;\n  \n  // Profile display helpers\n  getDisplayName: () => string;\n  getInitials: () => string;\n  getTrustTierDisplay: () => string;\n  isAdmin: () => boolean;\n  \n  // Reset and cleanup\n  resetProfile: () => void;\n  clearProfile: () => void;\n} & BaseStore\n\n// Create profile store with middleware\nexport const useProfileStore = create<ProfileStore>()(\n  devtools(\n    persist(\n      immer((set, get) => ({\n        // Initial state\n        profile: null,\n        userProfile: null,\n        isProfileLoaded: false,\n        isProfileComplete: false,\n        profileCompleteness: 0,\n        missingFields: [],\n        isLoading: false,\n        isProfileLoading: false,\n        isUpdating: false,\n        isUploadingAvatar: false,\n        isExporting: false,\n        error: null,\n        validationErrors: {},\n        validationWarnings: {},\n        preferences: null,\n        privacySettings: null,\n        \n        // Base store actions\n        setLoading: (loading) => set((state) => {\n          state.isLoading = loading;\n        }),\n        \n        setError: (error) => set((state) => {\n          state.error = error;\n        }),\n        \n        clearError: () => set((state) => {\n          state.error = null;\n        }),\n        \n        // Profile data actions\n        setProfile: (profile) => set((state) => {\n          state.profile = profile;\n          state.isProfileLoaded = !!profile;\n          if (profile) {\n            state.updateProfileCompleteness();\n          }\n        }),\n        \n        setUserProfile: (userProfile) => set((state) => {\n          state.userProfile = userProfile;\n          if (userProfile) {\n            state.preferences = userProfile.preferences as ProfilePreferences || null;\n            state.privacySettings = userProfile.privacy_settings as PrivacySettings || null;\n            state.updateProfileCompleteness();\n          }\n        }),\n        \n        // Profile update action\n        updateProfile: async (updates) => {\n          set((state) => {\n            state.isUpdating = true;\n            state.error = null;\n          });\n          \n          try {\n            // Import profile service dynamically to avoid circular dependencies\n            const { updateProfile: updateProfileService } = await import('@/features/profile/lib/profile-service');\n            const result = await updateProfileService(updates);\n            \n            if (result.success && result.data) {\n              set((state) => {\n                state.profile = result.data as ProfileUser;\n                state.isUpdating = false;\n                state.updateProfileCompleteness();\n              });\n              return true;\n            } else {\n              set((state) => {\n                state.error = result.error || 'Failed to update profile';\n                state.isUpdating = false;\n              });\n              return false;\n            }\n          } catch (error) {\n            set((state) => {\n              state.error = error instanceof Error ? error.message : 'Failed to update profile';\n              state.isUpdating = false;\n            });\n            return false;\n          }\n        },\n        \n        // Preferences update\n        updatePreferences: async (preferences) => {\n          set((state) => {\n            state.isUpdating = true;\n            state.error = null;\n          });\n          \n          try {\n            const { updateProfile } = await import('@/features/profile/lib/profile-service');\n            const result = await updateProfile({ preferences });\n            \n            if (result.success) {\n              set((state) => {\n                if (state.preferences) {\n                  state.preferences = { ...state.preferences, ...preferences };\n                } else {\n                  state.preferences = preferences;\n                }\n                state.isUpdating = false;\n              });\n              return true;\n            } else {\n              set((state) => {\n                state.error = result.error || 'Failed to update preferences';\n                state.isUpdating = false;\n              });\n              return false;\n            }\n          } catch (error) {\n            set((state) => {\n              state.error = error instanceof Error ? error.message : 'Failed to update preferences';\n              state.isUpdating = false;\n            });\n            return false;\n          }\n        },\n        \n        // Privacy settings update\n        updatePrivacySettings: async (settings) => {\n          set((state) => {\n            state.isUpdating = true;\n            state.error = null;\n          });\n          \n          try {\n            const { updateProfile } = await import('@/features/profile/lib/profile-service');\n            const result = await updateProfile({ privacy_settings: settings as PrivacySettings });\n            \n            if (result.success) {\n              set((state) => {\n                if (state.privacySettings) {\n                  state.privacySettings = { ...state.privacySettings, ...settings };\n                } else {\n                  state.privacySettings = settings as PrivacySettings;\n                }\n                state.isUpdating = false;\n              });\n              return true;\n            } else {\n              set((state) => {\n                state.error = result.error || 'Failed to update privacy settings';\n                state.isUpdating = false;\n              });\n              return false;\n            }\n          } catch (error) {\n            set((state) => {\n              state.error = error instanceof Error ? error.message : 'Failed to update privacy settings';\n              state.isUpdating = false;\n            });\n            return false;\n          }\n        },\n        \n        // Avatar actions\n        updateAvatar: async (file) => {\n          set((state) => {\n            state.isUploadingAvatar = true;\n            state.error = null;\n          });\n          \n          try {\n            const { updateProfileAvatar } = await import('@/features/profile/lib/profile-service');\n            const result = await updateProfileAvatar(file);\n            \n            set((state) => {\n              state.isUploadingAvatar = false;\n            });\n            \n            if (result.success && result.avatar_url) {\n              set((state) => {\n                if (state.profile) {\n                  state.profile.avatar_url = result.avatar_url;\n                }\n                if (state.userProfile) {\n                  state.userProfile.avatar_url = result.avatar_url;\n                }\n              });\n            }\n            \n            return result;\n          } catch (error) {\n            set((state) => {\n              state.error = error instanceof Error ? error.message : 'Failed to update avatar';\n              state.isUploadingAvatar = false;\n            });\n            return {\n              success: false,\n              error: error instanceof Error ? error.message : 'Failed to update avatar'\n            };\n          }\n        },\n        \n        removeAvatar: async () => {\n          set((state) => {\n            state.isUpdating = true;\n            state.error = null;\n          });\n          \n          try {\n            const { updateProfile } = await import('@/features/profile/lib/profile-service');\n            const currentState = get();\n            const result = await updateProfile({ display_name: currentState.profile?.display_name } as ProfileUpdateData);\n            \n            if (result.success) {\n              set((state) => {\n                if (state.profile) {\n                  state.profile.avatar_url = undefined;\n                }\n                if (state.userProfile) {\n                  state.userProfile.avatar_url = undefined;\n                }\n                state.isUpdating = false;\n              });\n              return true;\n            } else {\n              set((state) => {\n                state.error = result.error || 'Failed to remove avatar';\n                state.isUpdating = false;\n              });\n              return false;\n            }\n          } catch (error) {\n            set((state) => {\n              state.error = error instanceof Error ? error.message : 'Failed to remove avatar';\n              state.isUpdating = false;\n            });\n            return false;\n          }\n        },\n        \n        // Profile management\n        loadProfile: async () => {\n          set((state) => {\n            state.isProfileLoading = true;\n            state.error = null;\n          });\n          \n          try {\n            const { getCurrentProfile } = await import('@/features/profile/lib/profile-service');\n            const result = await getCurrentProfile();\n            \n            if (result.success && result.data) {\n              set((state) => {\n                state.profile = result.data as ProfileUser;\n                state.isProfileLoaded = true;\n                state.isProfileLoading = false;\n                state.updateProfileCompleteness();\n              });\n            } else {\n              set((state) => {\n                state.error = result.error || 'Failed to load profile';\n                state.isProfileLoading = false;\n              });\n            }\n          } catch (error) {\n            set((state) => {\n              state.error = error instanceof Error ? error.message : 'Failed to load profile';\n              state.isProfileLoading = false;\n            });\n          }\n        },\n        \n        refreshProfile: async () => {\n          await get().loadProfile();\n        },\n        \n        exportProfile: async () => {\n          set((state) => {\n            state.isExporting = true;\n            state.error = null;\n          });\n          \n          try {\n            const { exportUserData } = await import('@/features/profile/lib/profile-service');\n            const result = await exportUserData();\n            \n            set((state) => {\n              state.isExporting = false;\n            });\n            \n            return result;\n          } catch (error) {\n            set((state) => {\n              state.error = error instanceof Error ? error.message : 'Failed to export profile';\n              state.isExporting = false;\n            });\n            return null;\n          }\n        },\n        \n        deleteProfile: async () => {\n          set((state) => {\n            state.isUpdating = true;\n            state.error = null;\n          });\n          \n          try {\n            const { deleteProfile } = await import('@/features/profile/lib/profile-service');\n            const result = await deleteProfile();\n            \n            if (result.success) {\n              set((state) => {\n                state.profile = null;\n                state.userProfile = null;\n                state.isProfileLoaded = false;\n                state.isProfileComplete = false;\n                state.profileCompleteness = 0;\n                state.missingFields = [];\n                state.isUpdating = false;\n              });\n              return true;\n            } else {\n              set((state) => {\n                state.error = result.error || 'Failed to delete profile';\n                state.isUpdating = false;\n              });\n              return false;\n            }\n          } catch (error) {\n            set((state) => {\n              state.error = error instanceof Error ? error.message : 'Failed to delete profile';\n              state.isUpdating = false;\n            });\n            return false;\n          }\n        },\n        \n        // Validation\n        validateProfile: (data) => {\n          // Basic validation logic\n          const errors: string[] = [];\n          const warnings: string[] = [];\n          \n          if (data.display_name && data.display_name.length < 2) {\n            errors.push('Display name must be at least 2 characters');\n          }\n          \n          if (data.bio && data.bio.length > 500) {\n            warnings.push('Bio is quite long, consider shortening it');\n          }\n          \n          return {\n            isValid: errors.length === 0,\n            errors,\n            warnings\n          };\n        },\n        \n        setValidationErrors: (errors) => set((state) => {\n          state.validationErrors = errors;\n        }),\n        \n        setValidationWarnings: (warnings) => set((state) => {\n          state.validationWarnings = warnings;\n        }),\n        \n        clearValidation: () => set((state) => {\n          state.validationErrors = {};\n          state.validationWarnings = {};\n        }),\n        \n        // Loading states\n        setProfileLoading: (loading) => set((state) => {\n          state.isProfileLoading = loading;\n        }),\n        \n        setUpdating: (updating) => set((state) => {\n          state.isUpdating = updating;\n        }),\n        \n        setUploadingAvatar: (uploading) => set((state) => {\n          state.isUploadingAvatar = uploading;\n        }),\n        \n        setExporting: (exporting) => set((state) => {\n          state.isExporting = exporting;\n        }),\n        \n        // Profile completeness\n        updateProfileCompleteness: () => {\n          const state = get();\n          const profile = state.profile || state.userProfile;\n          \n          if (!profile) {\n            set((state) => {\n              state.isProfileComplete = false;\n              state.profileCompleteness = 0;\n              state.missingFields = [];\n            });\n            return;\n          }\n          \n          const requiredFields = ['display_name', 'username', 'email'];\n          const missingFields: string[] = [];\n          \n          requiredFields.forEach(field => {\n            if (!profile[field as keyof typeof profile] || \n                (typeof profile[field as keyof typeof profile] === 'string' && \n                 (profile[field as keyof typeof profile] as string).trim().length === 0)) {\n              missingFields.push(field.replace('_', ' '));\n            }\n          });\n          \n          const isComplete = missingFields.length === 0;\n          const percentage = Math.round(((requiredFields.length - missingFields.length) / requiredFields.length) * 100);\n          \n          set((state) => {\n            state.isProfileComplete = isComplete;\n            state.profileCompleteness = percentage;\n            state.missingFields = missingFields;\n          });\n        },\n        \n        getProfileCompleteness: () => {\n          const state = get();\n          return {\n            isComplete: state.isProfileComplete,\n            percentage: state.profileCompleteness,\n            missingFields: state.missingFields\n          };\n        },\n        \n        // Profile display helpers\n        getDisplayName: () => {\n          const state = get();\n          const profile = state.profile || state.userProfile;\n          if (!profile) return 'User';\n          return profile.display_name || profile.username || profile.email?.split('@')[0] || 'User';\n        },\n        \n        getInitials: () => {\n          const state = get();\n          const displayName = state.getDisplayName();\n          return displayName\n            .split(' ')\n            .map(word => word.charAt(0))\n            .join('')\n            .toUpperCase()\n            .slice(0, 2);\n        },\n        \n        getTrustTierDisplay: () => {\n          const state = get();\n          const profile = state.profile || state.userProfile;\n          if (!profile) return 'Unknown';\n          \n          const tierNames: Record<string, string> = {\n            'T0': 'New User',\n            'T1': 'Verified User',\n            'T2': 'Trusted User',\n            'T3': 'VIP User',\n          };\n          return tierNames[profile.trust_tier] || 'Unknown';\n        },\n        \n        isAdmin: () => {\n          const state = get();\n          const profile = state.profile || state.userProfile;\n          return profile?.is_admin || false;\n        },\n        \n        // Reset and cleanup\n        resetProfile: () => set((state) => {\n          state.profile = null;\n          state.userProfile = null;\n          state.isProfileLoaded = false;\n          state.isProfileComplete = false;\n          state.profileCompleteness = 0;\n          state.missingFields = [];\n          state.preferences = null;\n          state.privacySettings = null;\n          state.validationErrors = {};\n          state.validationWarnings = {};\n        }),\n        \n        clearProfile: () => {\n          get().resetProfile();\n        }\n      })),\n      {\n        name: 'profile-store',\n        partialize: (state) => ({\n          profile: state.profile,\n          userProfile: state.userProfile,\n          preferences: state.preferences,\n          privacySettings: state.privacySettings,\n          isProfileLoaded: state.isProfileLoaded,\n          isProfileComplete: state.isProfileComplete,\n          profileCompleteness: state.profileCompleteness\n        })\n      }\n    ),\n    {\n      name: 'profile-store'\n    }\n  )\n);\n\n// Profile store selectors for common use cases\nexport const profileSelectors = {\n  // Basic profile data\n  profile: (state: ProfileStore) => state.profile,\n  userProfile: (state: ProfileStore) => state.userProfile,\n  \n  // Profile state\n  isProfileLoaded: (state: ProfileStore) => state.isProfileLoaded,\n  isProfileComplete: (state: ProfileStore) => state.isProfileComplete,\n  profileCompleteness: (state: ProfileStore) => state.profileCompleteness,\n  missingFields: (state: ProfileStore) => state.missingFields,\n  \n  // Loading states\n  isLoading: (state: ProfileStore) => state.isProfileLoading || state.isUpdating,\n  isUpdating: (state: ProfileStore) => state.isUpdating,\n  isUploadingAvatar: (state: ProfileStore) => state.isUploadingAvatar,\n  isExporting: (state: ProfileStore) => state.isExporting,\n  \n  // Error states\n  hasError: (state: ProfileStore) => !!state.error,\n  error: (state: ProfileStore) => state.error,\n  \n  // Profile display\n  displayName: (state: ProfileStore) => state.getDisplayName(),\n  initials: (state: ProfileStore) => state.getInitials(),\n  trustTierDisplay: (state: ProfileStore) => state.getTrustTierDisplay(),\n  isAdmin: (state: ProfileStore) => state.isAdmin(),\n  \n  // Preferences and settings\n  preferences: (state: ProfileStore) => state.preferences,\n  privacySettings: (state: ProfileStore) => state.privacySettings,\n  \n  // Validation\n  validationErrors: (state: ProfileStore) => state.validationErrors,\n  validationWarnings: (state: ProfileStore) => state.validationWarnings,\n  hasValidationErrors: (state: ProfileStore) => Object.keys(state.validationErrors).length > 0,\n  hasValidationWarnings: (state: ProfileStore) => Object.keys(state.validationWarnings).length > 0\n};\n\n// Profile store hooks for common patterns\nexport const useProfile = () => useProfileStore((state) => ({\n  profile: state.profile,\n  userProfile: state.userProfile,\n  isProfileLoaded: state.isProfileLoaded,\n  isProfileComplete: state.isProfileComplete,\n  profileCompleteness: state.profileCompleteness,\n  missingFields: state.missingFields\n}));\n\nexport const useProfileLoading = () => useProfileStore((state) => ({\n  isLoading: state.isProfileLoading,\n  isUpdating: state.isUpdating,\n  isUploadingAvatar: state.isUploadingAvatar,\n  isExporting: state.isExporting\n}));\n\nexport const useProfileError = () => useProfileStore((state) => ({\n  error: state.error,\n  hasError: !!state.error\n}));\n\nexport const useProfileDisplay = () => useProfileStore((state) => ({\n  displayName: state.getDisplayName(),\n  initials: state.getInitials(),\n  trustTierDisplay: state.getTrustTierDisplay(),\n  isAdmin: state.isAdmin()\n}));\n\nexport const useProfileValidation = () => useProfileStore((state) => ({\n  validationErrors: state.validationErrors,\n  validationWarnings: state.validationWarnings,\n  hasValidationErrors: Object.keys(state.validationErrors).length > 0,\n  hasValidationWarnings: Object.keys(state.validationWarnings).length > 0\n}));\n\nexport const useProfileActions = () => useProfileStore((state) => ({\n  updateProfile: state.updateProfile,\n  updatePreferences: state.updatePreferences,\n  updatePrivacySettings: state.updatePrivacySettings,\n  updateAvatar: state.updateAvatar,\n  removeAvatar: state.removeAvatar,\n  loadProfile: state.loadProfile,\n  refreshProfile: state.refreshProfile,\n  exportProfile: state.exportProfile,\n  deleteProfile: state.deleteProfile,\n  validateProfile: state.validateProfile,\n  setValidationErrors: state.setValidationErrors,\n  clearValidation: state.clearValidation\n}));\n\nexport const useProfileStats = () => useProfileStore((state) => ({\n  isProfileLoaded: state.isProfileLoaded,\n  isProfileComplete: state.isProfileComplete,\n  profileCompleteness: state.profileCompleteness,\n  missingFields: state.missingFields,\n  hasPreferences: !!state.preferences,\n  hasPrivacySettings: !!state.privacySettings\n}));\n\n// Profile store utilities\nexport const profileStoreUtils = {\n  // Initialize profile store\n  initialize: () => {\n    logger.info('Profile store initialized');\n  },\n  \n  // Reset profile store\n  reset: () => {\n    useProfileStore.getState().resetProfile();\n    logger.info('Profile store reset');\n  },\n  \n  // Get profile completeness\n  getCompleteness: () => {\n    return useProfileStore.getState().getProfileCompleteness();\n  },\n  \n  // Validate profile data\n  validate: (data: ProfileUpdateData) => {\n    return useProfileStore.getState().validateProfile(data);\n  },\n  \n  // Get profile display info\n  getDisplayInfo: () => {\n    const state = useProfileStore.getState();\n    return {\n      displayName: state.getDisplayName(),\n      initials: state.getInitials(),\n      trustTier: state.getTrustTierDisplay(),\n      isAdmin: state.isAdmin()\n    };\n  }\n};\n\n// Profile store subscriptions\nexport const profileStoreSubscriptions = {\n  // Subscribe to profile changes\n  onProfileChange: (callback: (profile: ProfileUser | null) => void) => {\n    return useProfileStore.subscribe(\n      (state, prevState) => {\n        if (state.profile !== prevState.profile) {\n          callback(state.profile);\n        }\n      }\n    );\n  },\n  \n  // Subscribe to profile completeness changes\n  onCompletenessChange: (callback: (completeness: ProfileCompleteness) => void) => {\n    return useProfileStore.subscribe(\n      (state, prevState) => {\n        const current = state.getProfileCompleteness();\n        const previous = prevState.getProfileCompleteness();\n        if (current !== previous) {\n          callback(current);\n        }\n      }\n    );\n  },\n  \n  // Subscribe to loading state changes\n  onLoadingChange: (callback: (isLoading: boolean) => void) => {\n    return useProfileStore.subscribe(\n      (state, prevState) => {\n        const current = state.isProfileLoading || state.isUpdating;\n        const previous = prevState.isProfileLoading || prevState.isUpdating;\n        if (current !== previous) {\n          callback(current);\n        }\n      }\n    );\n  }\n};\n\n// Profile store debugging\nexport const profileStoreDebug = {\n  // Log current state\n  logState: () => {\n    const state = useProfileStore.getState();\n    logger.debug('Profile Store State', {\n      profile: state.profile,\n      isProfileLoaded: state.isProfileLoaded,\n      isProfileComplete: state.isProfileComplete,\n      profileCompleteness: state.profileCompleteness,\n      isLoading: state.isProfileLoading,\n      isUpdating: state.isUpdating,\n      error: state.error\n    });\n  },\n  \n  // Reset store\n  reset: () => {\n    profileStoreUtils.reset();\n  },\n  \n  // Clear all data\n  clearAll: () => {\n    useProfileStore.getState().clearProfile();\n    logger.info('Profile store cleared');\n  }\n};\n"],"names":["profileSelectors","profileStoreDebug","profileStoreSubscriptions","profileStoreUtils","useProfile","useProfileActions","useProfileDisplay","useProfileError","useProfileLoading","useProfileStats","useProfileStore","useProfileValidation","create","devtools","persist","immer","set","get","profile","userProfile","isProfileLoaded","isProfileComplete","profileCompleteness","missingFields","isLoading","isProfileLoading","isUpdating","isUploadingAvatar","isExporting","error","validationErrors","validationWarnings","preferences","privacySettings","setLoading","loading","state","setError","clearError","setProfile","updateProfileCompleteness","setUserProfile","privacy_settings","updateProfile","updates","updateProfileService","result","success","data","Error","message","updatePreferences","updatePrivacySettings","settings","updateAvatar","file","updateProfileAvatar","avatar_url","removeAvatar","currentState","display_name","undefined","loadProfile","getCurrentProfile","refreshProfile","exportProfile","exportUserData","deleteProfile","validateProfile","errors","warnings","length","push","bio","isValid","setValidationErrors","setValidationWarnings","clearValidation","setProfileLoading","setUpdating","updating","setUploadingAvatar","uploading","setExporting","exporting","requiredFields","forEach","field","trim","replace","isComplete","percentage","Math","round","getProfileCompleteness","getDisplayName","username","email","split","getInitials","displayName","map","word","charAt","join","toUpperCase","slice","getTrustTierDisplay","tierNames","trust_tier","isAdmin","is_admin","resetProfile","clearProfile","name","partialize","hasError","initials","trustTierDisplay","hasValidationErrors","Object","keys","hasValidationWarnings","hasPreferences","hasPrivacySettings","initialize","logger","info","reset","getState","getCompleteness","validate","getDisplayInfo","trustTier","onProfileChange","callback","subscribe","prevState","onCompletenessChange","current","previous","onLoadingChange","logState","debug","clearAll"],"mappings":"AAAA;;;;;;;;CAQC;;;;;;;;;;;IAgmBYA,gBAAgB;eAAhBA;;IA8KAC,iBAAiB;eAAjBA;;IAxCAC,yBAAyB;eAAzBA;;IAnCAC,iBAAiB;eAAjBA;;IA5DAC,UAAU;eAAVA;;IAmCAC,iBAAiB;eAAjBA;;IAdAC,iBAAiB;eAAjBA;;IALAC,eAAe;eAAfA;;IAPAC,iBAAiB;eAAjBA;;IAyCAC,eAAe;eAAfA;;IArlBAC,eAAe;eAAfA;;IA+jBAC,oBAAoB;eAApBA;;;yBAjqBU;4BACE;uBAEH;wBAYC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmFhB,MAAMD,kBAAkBE,IAAAA,eAAM,IACnCC,IAAAA,oBAAQ,EACNC,IAAAA,mBAAO,EACLC,IAAAA,YAAK,EAAC,CAACC,KAAKC,MAAS,CAAA;QACnB,gBAAgB;QAChBC,SAAS;QACTC,aAAa;QACbC,iBAAiB;QACjBC,mBAAmB;QACnBC,qBAAqB;QACrBC,eAAe,EAAE;QACjBC,WAAW;QACXC,kBAAkB;QAClBC,YAAY;QACZC,mBAAmB;QACnBC,aAAa;QACbC,OAAO;QACPC,kBAAkB,CAAC;QACnBC,oBAAoB,CAAC;QACrBC,aAAa;QACbC,iBAAiB;QAEjB,qBAAqB;QACrBC,YAAY,CAACC,UAAYnB,IAAI,CAACoB;gBAC5BA,MAAMZ,SAAS,GAAGW;YACpB;QAEAE,UAAU,CAACR,QAAUb,IAAI,CAACoB;gBACxBA,MAAMP,KAAK,GAAGA;YAChB;QAEAS,YAAY,IAAMtB,IAAI,CAACoB;gBACrBA,MAAMP,KAAK,GAAG;YAChB;QAEA,uBAAuB;QACvBU,YAAY,CAACrB,UAAYF,IAAI,CAACoB;gBAC5BA,MAAMlB,OAAO,GAAGA;gBAChBkB,MAAMhB,eAAe,GAAG,CAAC,CAACF;gBAC1B,IAAIA,SAAS;oBACXkB,MAAMI,yBAAyB;gBACjC;YACF;QAEAC,gBAAgB,CAACtB,cAAgBH,IAAI,CAACoB;gBACpCA,MAAMjB,WAAW,GAAGA;gBACpB,IAAIA,aAAa;oBACfiB,MAAMJ,WAAW,GAAGb,YAAYa,WAAW,IAA0B;oBACrEI,MAAMH,eAAe,GAAGd,YAAYuB,gBAAgB,IAAuB;oBAC3EN,MAAMI,yBAAyB;gBACjC;YACF;QAEA,wBAAwB;QACxBG,eAAe,OAAOC;YACpB5B,IAAI,CAACoB;gBACHA,MAAMV,UAAU,GAAG;gBACnBU,MAAMP,KAAK,GAAG;YAChB;YAEA,IAAI;gBACF,oEAAoE;gBACpE,MAAM,EAAEc,eAAeE,oBAAoB,EAAE,GAAG,MAAM,mEAAA,QAAO;gBAC7D,MAAMC,SAAS,MAAMD,qBAAqBD;gBAE1C,IAAIE,OAAOC,OAAO,IAAID,OAAOE,IAAI,EAAE;oBACjChC,IAAI,CAACoB;wBACHA,MAAMlB,OAAO,GAAG4B,OAAOE,IAAI;wBAC3BZ,MAAMV,UAAU,GAAG;wBACnBU,MAAMI,yBAAyB;oBACjC;oBACA,OAAO;gBACT,OAAO;oBACLxB,IAAI,CAACoB;wBACHA,MAAMP,KAAK,GAAGiB,OAAOjB,KAAK,IAAI;wBAC9BO,MAAMV,UAAU,GAAG;oBACrB;oBACA,OAAO;gBACT;YACF,EAAE,OAAOG,OAAO;gBACdb,IAAI,CAACoB;oBACHA,MAAMP,KAAK,GAAGA,iBAAiBoB,QAAQpB,MAAMqB,OAAO,GAAG;oBACvDd,MAAMV,UAAU,GAAG;gBACrB;gBACA,OAAO;YACT;QACF;QAEA,qBAAqB;QACrByB,mBAAmB,OAAOnB;YACxBhB,IAAI,CAACoB;gBACHA,MAAMV,UAAU,GAAG;gBACnBU,MAAMP,KAAK,GAAG;YAChB;YAEA,IAAI;gBACF,MAAM,EAAEc,aAAa,EAAE,GAAG,MAAM,mEAAA,QAAO;gBACvC,MAAMG,SAAS,MAAMH,cAAc;oBAAEX;gBAAY;gBAEjD,IAAIc,OAAOC,OAAO,EAAE;oBAClB/B,IAAI,CAACoB;wBACH,IAAIA,MAAMJ,WAAW,EAAE;4BACrBI,MAAMJ,WAAW,GAAG;gCAAE,GAAGI,MAAMJ,WAAW;gCAAE,GAAGA,WAAW;4BAAC;wBAC7D,OAAO;4BACLI,MAAMJ,WAAW,GAAGA;wBACtB;wBACAI,MAAMV,UAAU,GAAG;oBACrB;oBACA,OAAO;gBACT,OAAO;oBACLV,IAAI,CAACoB;wBACHA,MAAMP,KAAK,GAAGiB,OAAOjB,KAAK,IAAI;wBAC9BO,MAAMV,UAAU,GAAG;oBACrB;oBACA,OAAO;gBACT;YACF,EAAE,OAAOG,OAAO;gBACdb,IAAI,CAACoB;oBACHA,MAAMP,KAAK,GAAGA,iBAAiBoB,QAAQpB,MAAMqB,OAAO,GAAG;oBACvDd,MAAMV,UAAU,GAAG;gBACrB;gBACA,OAAO;YACT;QACF;QAEA,0BAA0B;QAC1B0B,uBAAuB,OAAOC;YAC5BrC,IAAI,CAACoB;gBACHA,MAAMV,UAAU,GAAG;gBACnBU,MAAMP,KAAK,GAAG;YAChB;YAEA,IAAI;gBACF,MAAM,EAAEc,aAAa,EAAE,GAAG,MAAM,mEAAA,QAAO;gBACvC,MAAMG,SAAS,MAAMH,cAAc;oBAAED,kBAAkBW;gBAA4B;gBAEnF,IAAIP,OAAOC,OAAO,EAAE;oBAClB/B,IAAI,CAACoB;wBACH,IAAIA,MAAMH,eAAe,EAAE;4BACzBG,MAAMH,eAAe,GAAG;gCAAE,GAAGG,MAAMH,eAAe;gCAAE,GAAGoB,QAAQ;4BAAC;wBAClE,OAAO;4BACLjB,MAAMH,eAAe,GAAGoB;wBAC1B;wBACAjB,MAAMV,UAAU,GAAG;oBACrB;oBACA,OAAO;gBACT,OAAO;oBACLV,IAAI,CAACoB;wBACHA,MAAMP,KAAK,GAAGiB,OAAOjB,KAAK,IAAI;wBAC9BO,MAAMV,UAAU,GAAG;oBACrB;oBACA,OAAO;gBACT;YACF,EAAE,OAAOG,OAAO;gBACdb,IAAI,CAACoB;oBACHA,MAAMP,KAAK,GAAGA,iBAAiBoB,QAAQpB,MAAMqB,OAAO,GAAG;oBACvDd,MAAMV,UAAU,GAAG;gBACrB;gBACA,OAAO;YACT;QACF;QAEA,iBAAiB;QACjB4B,cAAc,OAAOC;YACnBvC,IAAI,CAACoB;gBACHA,MAAMT,iBAAiB,GAAG;gBAC1BS,MAAMP,KAAK,GAAG;YAChB;YAEA,IAAI;gBACF,MAAM,EAAE2B,mBAAmB,EAAE,GAAG,MAAM,mEAAA,QAAO;gBAC7C,MAAMV,SAAS,MAAMU,oBAAoBD;gBAEzCvC,IAAI,CAACoB;oBACHA,MAAMT,iBAAiB,GAAG;gBAC5B;gBAEA,IAAImB,OAAOC,OAAO,IAAID,OAAOW,UAAU,EAAE;oBACvCzC,IAAI,CAACoB;wBACH,IAAIA,MAAMlB,OAAO,EAAE;4BACjBkB,MAAMlB,OAAO,CAACuC,UAAU,GAAGX,OAAOW,UAAU;wBAC9C;wBACA,IAAIrB,MAAMjB,WAAW,EAAE;4BACrBiB,MAAMjB,WAAW,CAACsC,UAAU,GAAGX,OAAOW,UAAU;wBAClD;oBACF;gBACF;gBAEA,OAAOX;YACT,EAAE,OAAOjB,OAAO;gBACdb,IAAI,CAACoB;oBACHA,MAAMP,KAAK,GAAGA,iBAAiBoB,QAAQpB,MAAMqB,OAAO,GAAG;oBACvDd,MAAMT,iBAAiB,GAAG;gBAC5B;gBACA,OAAO;oBACLoB,SAAS;oBACTlB,OAAOA,iBAAiBoB,QAAQpB,MAAMqB,OAAO,GAAG;gBAClD;YACF;QACF;QAEAQ,cAAc;YACZ1C,IAAI,CAACoB;gBACHA,MAAMV,UAAU,GAAG;gBACnBU,MAAMP,KAAK,GAAG;YAChB;YAEA,IAAI;gBACF,MAAM,EAAEc,aAAa,EAAE,GAAG,MAAM,mEAAA,QAAO;gBACvC,MAAMgB,eAAe1C;gBACrB,MAAM6B,SAAS,MAAMH,cAAc;oBAAEiB,cAAcD,aAAazC,OAAO,EAAE0C;gBAAa;gBAEtF,IAAId,OAAOC,OAAO,EAAE;oBAClB/B,IAAI,CAACoB;wBACH,IAAIA,MAAMlB,OAAO,EAAE;4BACjBkB,MAAMlB,OAAO,CAACuC,UAAU,GAAGI;wBAC7B;wBACA,IAAIzB,MAAMjB,WAAW,EAAE;4BACrBiB,MAAMjB,WAAW,CAACsC,UAAU,GAAGI;wBACjC;wBACAzB,MAAMV,UAAU,GAAG;oBACrB;oBACA,OAAO;gBACT,OAAO;oBACLV,IAAI,CAACoB;wBACHA,MAAMP,KAAK,GAAGiB,OAAOjB,KAAK,IAAI;wBAC9BO,MAAMV,UAAU,GAAG;oBACrB;oBACA,OAAO;gBACT;YACF,EAAE,OAAOG,OAAO;gBACdb,IAAI,CAACoB;oBACHA,MAAMP,KAAK,GAAGA,iBAAiBoB,QAAQpB,MAAMqB,OAAO,GAAG;oBACvDd,MAAMV,UAAU,GAAG;gBACrB;gBACA,OAAO;YACT;QACF;QAEA,qBAAqB;QACrBoC,aAAa;YACX9C,IAAI,CAACoB;gBACHA,MAAMX,gBAAgB,GAAG;gBACzBW,MAAMP,KAAK,GAAG;YAChB;YAEA,IAAI;gBACF,MAAM,EAAEkC,iBAAiB,EAAE,GAAG,MAAM,mEAAA,QAAO;gBAC3C,MAAMjB,SAAS,MAAMiB;gBAErB,IAAIjB,OAAOC,OAAO,IAAID,OAAOE,IAAI,EAAE;oBACjChC,IAAI,CAACoB;wBACHA,MAAMlB,OAAO,GAAG4B,OAAOE,IAAI;wBAC3BZ,MAAMhB,eAAe,GAAG;wBACxBgB,MAAMX,gBAAgB,GAAG;wBACzBW,MAAMI,yBAAyB;oBACjC;gBACF,OAAO;oBACLxB,IAAI,CAACoB;wBACHA,MAAMP,KAAK,GAAGiB,OAAOjB,KAAK,IAAI;wBAC9BO,MAAMX,gBAAgB,GAAG;oBAC3B;gBACF;YACF,EAAE,OAAOI,OAAO;gBACdb,IAAI,CAACoB;oBACHA,MAAMP,KAAK,GAAGA,iBAAiBoB,QAAQpB,MAAMqB,OAAO,GAAG;oBACvDd,MAAMX,gBAAgB,GAAG;gBAC3B;YACF;QACF;QAEAuC,gBAAgB;YACd,MAAM/C,MAAM6C,WAAW;QACzB;QAEAG,eAAe;YACbjD,IAAI,CAACoB;gBACHA,MAAMR,WAAW,GAAG;gBACpBQ,MAAMP,KAAK,GAAG;YAChB;YAEA,IAAI;gBACF,MAAM,EAAEqC,cAAc,EAAE,GAAG,MAAM,mEAAA,QAAO;gBACxC,MAAMpB,SAAS,MAAMoB;gBAErBlD,IAAI,CAACoB;oBACHA,MAAMR,WAAW,GAAG;gBACtB;gBAEA,OAAOkB;YACT,EAAE,OAAOjB,OAAO;gBACdb,IAAI,CAACoB;oBACHA,MAAMP,KAAK,GAAGA,iBAAiBoB,QAAQpB,MAAMqB,OAAO,GAAG;oBACvDd,MAAMR,WAAW,GAAG;gBACtB;gBACA,OAAO;YACT;QACF;QAEAuC,eAAe;YACbnD,IAAI,CAACoB;gBACHA,MAAMV,UAAU,GAAG;gBACnBU,MAAMP,KAAK,GAAG;YAChB;YAEA,IAAI;gBACF,MAAM,EAAEsC,aAAa,EAAE,GAAG,MAAM,mEAAA,QAAO;gBACvC,MAAMrB,SAAS,MAAMqB;gBAErB,IAAIrB,OAAOC,OAAO,EAAE;oBAClB/B,IAAI,CAACoB;wBACHA,MAAMlB,OAAO,GAAG;wBAChBkB,MAAMjB,WAAW,GAAG;wBACpBiB,MAAMhB,eAAe,GAAG;wBACxBgB,MAAMf,iBAAiB,GAAG;wBAC1Be,MAAMd,mBAAmB,GAAG;wBAC5Bc,MAAMb,aAAa,GAAG,EAAE;wBACxBa,MAAMV,UAAU,GAAG;oBACrB;oBACA,OAAO;gBACT,OAAO;oBACLV,IAAI,CAACoB;wBACHA,MAAMP,KAAK,GAAGiB,OAAOjB,KAAK,IAAI;wBAC9BO,MAAMV,UAAU,GAAG;oBACrB;oBACA,OAAO;gBACT;YACF,EAAE,OAAOG,OAAO;gBACdb,IAAI,CAACoB;oBACHA,MAAMP,KAAK,GAAGA,iBAAiBoB,QAAQpB,MAAMqB,OAAO,GAAG;oBACvDd,MAAMV,UAAU,GAAG;gBACrB;gBACA,OAAO;YACT;QACF;QAEA,aAAa;QACb0C,iBAAiB,CAACpB;YAChB,yBAAyB;YACzB,MAAMqB,SAAmB,EAAE;YAC3B,MAAMC,WAAqB,EAAE;YAE7B,IAAItB,KAAKY,YAAY,IAAIZ,KAAKY,YAAY,CAACW,MAAM,GAAG,GAAG;gBACrDF,OAAOG,IAAI,CAAC;YACd;YAEA,IAAIxB,KAAKyB,GAAG,IAAIzB,KAAKyB,GAAG,CAACF,MAAM,GAAG,KAAK;gBACrCD,SAASE,IAAI,CAAC;YAChB;YAEA,OAAO;gBACLE,SAASL,OAAOE,MAAM,KAAK;gBAC3BF;gBACAC;YACF;QACF;QAEAK,qBAAqB,CAACN,SAAWrD,IAAI,CAACoB;gBACpCA,MAAMN,gBAAgB,GAAGuC;YAC3B;QAEAO,uBAAuB,CAACN,WAAatD,IAAI,CAACoB;gBACxCA,MAAML,kBAAkB,GAAGuC;YAC7B;QAEAO,iBAAiB,IAAM7D,IAAI,CAACoB;gBAC1BA,MAAMN,gBAAgB,GAAG,CAAC;gBAC1BM,MAAML,kBAAkB,GAAG,CAAC;YAC9B;QAEA,iBAAiB;QACjB+C,mBAAmB,CAAC3C,UAAYnB,IAAI,CAACoB;gBACnCA,MAAMX,gBAAgB,GAAGU;YAC3B;QAEA4C,aAAa,CAACC,WAAahE,IAAI,CAACoB;gBAC9BA,MAAMV,UAAU,GAAGsD;YACrB;QAEAC,oBAAoB,CAACC,YAAclE,IAAI,CAACoB;gBACtCA,MAAMT,iBAAiB,GAAGuD;YAC5B;QAEAC,cAAc,CAACC,YAAcpE,IAAI,CAACoB;gBAChCA,MAAMR,WAAW,GAAGwD;YACtB;QAEA,uBAAuB;QACvB5C,2BAA2B;YACzB,MAAMJ,QAAQnB;YACd,MAAMC,UAAUkB,MAAMlB,OAAO,IAAIkB,MAAMjB,WAAW;YAElD,IAAI,CAACD,SAAS;gBACZF,IAAI,CAACoB;oBACHA,MAAMf,iBAAiB,GAAG;oBAC1Be,MAAMd,mBAAmB,GAAG;oBAC5Bc,MAAMb,aAAa,GAAG,EAAE;gBAC1B;gBACA;YACF;YAEA,MAAM8D,iBAAiB;gBAAC;gBAAgB;gBAAY;aAAQ;YAC5D,MAAM9D,gBAA0B,EAAE;YAElC8D,eAAeC,OAAO,CAACC,CAAAA;gBACrB,IAAI,CAACrE,OAAO,CAACqE,MAA8B,IACtC,OAAOrE,OAAO,CAACqE,MAA8B,KAAK,YAClD,AAACrE,OAAO,CAACqE,MAA8B,CAAYC,IAAI,GAAGjB,MAAM,KAAK,GAAI;oBAC5EhD,cAAciD,IAAI,CAACe,MAAME,OAAO,CAAC,KAAK;gBACxC;YACF;YAEA,MAAMC,aAAanE,cAAcgD,MAAM,KAAK;YAC5C,MAAMoB,aAAaC,KAAKC,KAAK,CAAC,AAAER,CAAAA,eAAed,MAAM,GAAGhD,cAAcgD,MAAM,AAAD,IAAKc,eAAed,MAAM,GAAI;YAEzGvD,IAAI,CAACoB;gBACHA,MAAMf,iBAAiB,GAAGqE;gBAC1BtD,MAAMd,mBAAmB,GAAGqE;gBAC5BvD,MAAMb,aAAa,GAAGA;YACxB;QACF;QAEAuE,wBAAwB;YACtB,MAAM1D,QAAQnB;YACd,OAAO;gBACLyE,YAAYtD,MAAMf,iBAAiB;gBACnCsE,YAAYvD,MAAMd,mBAAmB;gBACrCC,eAAea,MAAMb,aAAa;YACpC;QACF;QAEA,0BAA0B;QAC1BwE,gBAAgB;YACd,MAAM3D,QAAQnB;YACd,MAAMC,UAAUkB,MAAMlB,OAAO,IAAIkB,MAAMjB,WAAW;YAClD,IAAI,CAACD,SAAS,OAAO;YACrB,OAAOA,QAAQ0C,YAAY,IAAI1C,QAAQ8E,QAAQ,IAAI9E,QAAQ+E,KAAK,EAAEC,MAAM,IAAI,CAAC,EAAE,IAAI;QACrF;QAEAC,aAAa;YACX,MAAM/D,QAAQnB;YACd,MAAMmF,cAAchE,MAAM2D,cAAc;YACxC,OAAOK,YACJF,KAAK,CAAC,KACNG,GAAG,CAACC,CAAAA,OAAQA,KAAKC,MAAM,CAAC,IACxBC,IAAI,CAAC,IACLC,WAAW,GACXC,KAAK,CAAC,GAAG;QACd;QAEAC,qBAAqB;YACnB,MAAMvE,QAAQnB;YACd,MAAMC,UAAUkB,MAAMlB,OAAO,IAAIkB,MAAMjB,WAAW;YAClD,IAAI,CAACD,SAAS,OAAO;YAErB,MAAM0F,YAAoC;gBACxC,MAAM;gBACN,MAAM;gBACN,MAAM;gBACN,MAAM;YACR;YACA,OAAOA,SAAS,CAAC1F,QAAQ2F,UAAU,CAAC,IAAI;QAC1C;QAEAC,SAAS;YACP,MAAM1E,QAAQnB;YACd,MAAMC,UAAUkB,MAAMlB,OAAO,IAAIkB,MAAMjB,WAAW;YAClD,OAAOD,SAAS6F,YAAY;QAC9B;QAEA,oBAAoB;QACpBC,cAAc,IAAMhG,IAAI,CAACoB;gBACvBA,MAAMlB,OAAO,GAAG;gBAChBkB,MAAMjB,WAAW,GAAG;gBACpBiB,MAAMhB,eAAe,GAAG;gBACxBgB,MAAMf,iBAAiB,GAAG;gBAC1Be,MAAMd,mBAAmB,GAAG;gBAC5Bc,MAAMb,aAAa,GAAG,EAAE;gBACxBa,MAAMJ,WAAW,GAAG;gBACpBI,MAAMH,eAAe,GAAG;gBACxBG,MAAMN,gBAAgB,GAAG,CAAC;gBAC1BM,MAAML,kBAAkB,GAAG,CAAC;YAC9B;QAEAkF,cAAc;YACZhG,MAAM+F,YAAY;QACpB;IACF,CAAA,IACA;IACEE,MAAM;IACNC,YAAY,CAAC/E,QAAW,CAAA;YACtBlB,SAASkB,MAAMlB,OAAO;YACtBC,aAAaiB,MAAMjB,WAAW;YAC9Ba,aAAaI,MAAMJ,WAAW;YAC9BC,iBAAiBG,MAAMH,eAAe;YACtCb,iBAAiBgB,MAAMhB,eAAe;YACtCC,mBAAmBe,MAAMf,iBAAiB;YAC1CC,qBAAqBc,MAAMd,mBAAmB;QAChD,CAAA;AACF,IAEF;IACE4F,MAAM;AACR;AAKG,MAAMlH,mBAAmB;IAC9B,qBAAqB;IACrBkB,SAAS,CAACkB,QAAwBA,MAAMlB,OAAO;IAC/CC,aAAa,CAACiB,QAAwBA,MAAMjB,WAAW;IAEvD,gBAAgB;IAChBC,iBAAiB,CAACgB,QAAwBA,MAAMhB,eAAe;IAC/DC,mBAAmB,CAACe,QAAwBA,MAAMf,iBAAiB;IACnEC,qBAAqB,CAACc,QAAwBA,MAAMd,mBAAmB;IACvEC,eAAe,CAACa,QAAwBA,MAAMb,aAAa;IAE3D,iBAAiB;IACjBC,WAAW,CAACY,QAAwBA,MAAMX,gBAAgB,IAAIW,MAAMV,UAAU;IAC9EA,YAAY,CAACU,QAAwBA,MAAMV,UAAU;IACrDC,mBAAmB,CAACS,QAAwBA,MAAMT,iBAAiB;IACnEC,aAAa,CAACQ,QAAwBA,MAAMR,WAAW;IAEvD,eAAe;IACfwF,UAAU,CAAChF,QAAwB,CAAC,CAACA,MAAMP,KAAK;IAChDA,OAAO,CAACO,QAAwBA,MAAMP,KAAK;IAE3C,kBAAkB;IAClBuE,aAAa,CAAChE,QAAwBA,MAAM2D,cAAc;IAC1DsB,UAAU,CAACjF,QAAwBA,MAAM+D,WAAW;IACpDmB,kBAAkB,CAAClF,QAAwBA,MAAMuE,mBAAmB;IACpEG,SAAS,CAAC1E,QAAwBA,MAAM0E,OAAO;IAE/C,2BAA2B;IAC3B9E,aAAa,CAACI,QAAwBA,MAAMJ,WAAW;IACvDC,iBAAiB,CAACG,QAAwBA,MAAMH,eAAe;IAE/D,aAAa;IACbH,kBAAkB,CAACM,QAAwBA,MAAMN,gBAAgB;IACjEC,oBAAoB,CAACK,QAAwBA,MAAML,kBAAkB;IACrEwF,qBAAqB,CAACnF,QAAwBoF,OAAOC,IAAI,CAACrF,MAAMN,gBAAgB,EAAEyC,MAAM,GAAG;IAC3FmD,uBAAuB,CAACtF,QAAwBoF,OAAOC,IAAI,CAACrF,MAAML,kBAAkB,EAAEwC,MAAM,GAAG;AACjG;AAGO,MAAMnE,aAAa,IAAMM,gBAAgB,CAAC0B,QAAW,CAAA;YAC1DlB,SAASkB,MAAMlB,OAAO;YACtBC,aAAaiB,MAAMjB,WAAW;YAC9BC,iBAAiBgB,MAAMhB,eAAe;YACtCC,mBAAmBe,MAAMf,iBAAiB;YAC1CC,qBAAqBc,MAAMd,mBAAmB;YAC9CC,eAAea,MAAMb,aAAa;QACpC,CAAA;AAEO,MAAMf,oBAAoB,IAAME,gBAAgB,CAAC0B,QAAW,CAAA;YACjEZ,WAAWY,MAAMX,gBAAgB;YACjCC,YAAYU,MAAMV,UAAU;YAC5BC,mBAAmBS,MAAMT,iBAAiB;YAC1CC,aAAaQ,MAAMR,WAAW;QAChC,CAAA;AAEO,MAAMrB,kBAAkB,IAAMG,gBAAgB,CAAC0B,QAAW,CAAA;YAC/DP,OAAOO,MAAMP,KAAK;YAClBuF,UAAU,CAAC,CAAChF,MAAMP,KAAK;QACzB,CAAA;AAEO,MAAMvB,oBAAoB,IAAMI,gBAAgB,CAAC0B,QAAW,CAAA;YACjEgE,aAAahE,MAAM2D,cAAc;YACjCsB,UAAUjF,MAAM+D,WAAW;YAC3BmB,kBAAkBlF,MAAMuE,mBAAmB;YAC3CG,SAAS1E,MAAM0E,OAAO;QACxB,CAAA;AAEO,MAAMnG,uBAAuB,IAAMD,gBAAgB,CAAC0B,QAAW,CAAA;YACpEN,kBAAkBM,MAAMN,gBAAgB;YACxCC,oBAAoBK,MAAML,kBAAkB;YAC5CwF,qBAAqBC,OAAOC,IAAI,CAACrF,MAAMN,gBAAgB,EAAEyC,MAAM,GAAG;YAClEmD,uBAAuBF,OAAOC,IAAI,CAACrF,MAAML,kBAAkB,EAAEwC,MAAM,GAAG;QACxE,CAAA;AAEO,MAAMlE,oBAAoB,IAAMK,gBAAgB,CAAC0B,QAAW,CAAA;YACjEO,eAAeP,MAAMO,aAAa;YAClCQ,mBAAmBf,MAAMe,iBAAiB;YAC1CC,uBAAuBhB,MAAMgB,qBAAqB;YAClDE,cAAclB,MAAMkB,YAAY;YAChCI,cAActB,MAAMsB,YAAY;YAChCI,aAAa1B,MAAM0B,WAAW;YAC9BE,gBAAgB5B,MAAM4B,cAAc;YACpCC,eAAe7B,MAAM6B,aAAa;YAClCE,eAAe/B,MAAM+B,aAAa;YAClCC,iBAAiBhC,MAAMgC,eAAe;YACtCO,qBAAqBvC,MAAMuC,mBAAmB;YAC9CE,iBAAiBzC,MAAMyC,eAAe;QACxC,CAAA;AAEO,MAAMpE,kBAAkB,IAAMC,gBAAgB,CAAC0B,QAAW,CAAA;YAC/DhB,iBAAiBgB,MAAMhB,eAAe;YACtCC,mBAAmBe,MAAMf,iBAAiB;YAC1CC,qBAAqBc,MAAMd,mBAAmB;YAC9CC,eAAea,MAAMb,aAAa;YAClCoG,gBAAgB,CAAC,CAACvF,MAAMJ,WAAW;YACnC4F,oBAAoB,CAAC,CAACxF,MAAMH,eAAe;QAC7C,CAAA;AAGO,MAAM9B,oBAAoB;IAC/B,2BAA2B;IAC3B0H,YAAY;QACVC,cAAM,CAACC,IAAI,CAAC;IACd;IAEA,sBAAsB;IACtBC,OAAO;QACLtH,gBAAgBuH,QAAQ,GAAGjB,YAAY;QACvCc,cAAM,CAACC,IAAI,CAAC;IACd;IAEA,2BAA2B;IAC3BG,iBAAiB;QACf,OAAOxH,gBAAgBuH,QAAQ,GAAGnC,sBAAsB;IAC1D;IAEA,wBAAwB;IACxBqC,UAAU,CAACnF;QACT,OAAOtC,gBAAgBuH,QAAQ,GAAG7D,eAAe,CAACpB;IACpD;IAEA,2BAA2B;IAC3BoF,gBAAgB;QACd,MAAMhG,QAAQ1B,gBAAgBuH,QAAQ;QACtC,OAAO;YACL7B,aAAahE,MAAM2D,cAAc;YACjCsB,UAAUjF,MAAM+D,WAAW;YAC3BkC,WAAWjG,MAAMuE,mBAAmB;YACpCG,SAAS1E,MAAM0E,OAAO;QACxB;IACF;AACF;AAGO,MAAM5G,4BAA4B;IACvC,+BAA+B;IAC/BoI,iBAAiB,CAACC;QAChB,OAAO7H,gBAAgB8H,SAAS,CAC9B,CAACpG,OAAOqG;YACN,IAAIrG,MAAMlB,OAAO,KAAKuH,UAAUvH,OAAO,EAAE;gBACvCqH,SAASnG,MAAMlB,OAAO;YACxB;QACF;IAEJ;IAEA,4CAA4C;IAC5CwH,sBAAsB,CAACH;QACrB,OAAO7H,gBAAgB8H,SAAS,CAC9B,CAACpG,OAAOqG;YACN,MAAME,UAAUvG,MAAM0D,sBAAsB;YAC5C,MAAM8C,WAAWH,UAAU3C,sBAAsB;YACjD,IAAI6C,YAAYC,UAAU;gBACxBL,SAASI;YACX;QACF;IAEJ;IAEA,qCAAqC;IACrCE,iBAAiB,CAACN;QAChB,OAAO7H,gBAAgB8H,SAAS,CAC9B,CAACpG,OAAOqG;YACN,MAAME,UAAUvG,MAAMX,gBAAgB,IAAIW,MAAMV,UAAU;YAC1D,MAAMkH,WAAWH,UAAUhH,gBAAgB,IAAIgH,UAAU/G,UAAU;YACnE,IAAIiH,YAAYC,UAAU;gBACxBL,SAASI;YACX;QACF;IAEJ;AACF;AAGO,MAAM1I,oBAAoB;IAC/B,oBAAoB;IACpB6I,UAAU;QACR,MAAM1G,QAAQ1B,gBAAgBuH,QAAQ;QACtCH,cAAM,CAACiB,KAAK,CAAC,uBAAuB;YAClC7H,SAASkB,MAAMlB,OAAO;YACtBE,iBAAiBgB,MAAMhB,eAAe;YACtCC,mBAAmBe,MAAMf,iBAAiB;YAC1CC,qBAAqBc,MAAMd,mBAAmB;YAC9CE,WAAWY,MAAMX,gBAAgB;YACjCC,YAAYU,MAAMV,UAAU;YAC5BG,OAAOO,MAAMP,KAAK;QACpB;IACF;IAEA,cAAc;IACdmG,OAAO;QACL7H,kBAAkB6H,KAAK;IACzB;IAEA,iBAAiB;IACjBgB,UAAU;QACRtI,gBAAgBuH,QAAQ,GAAGhB,YAAY;QACvCa,cAAM,CAACC,IAAI,CAAC;IACd;AACF"}