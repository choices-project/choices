{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/jest.setup.js"],"sourcesContent":["// Jest setup file\nimport '@testing-library/jest-dom'\nimport React from 'react'\n\n// Polyfill for TextEncoder/TextDecoder\nimport { TextEncoder, TextDecoder } from 'util'\nglobal.TextEncoder = TextEncoder\nglobal.TextDecoder = TextDecoder\n\n// Polyfill fetch for Jest - simple mock implementation\nglobal.fetch = jest.fn(() =>\n  Promise.resolve({\n    ok: true,\n    status: 200,\n    json: () => Promise.resolve({}),\n    text: () => Promise.resolve(''),\n    headers: new Map()\n  })\n)\n\n// Polyfill for Web API Request/Response (compatible with NextRequest)\nif (!global.Request) {\n  global.Request = class Request {\n    constructor(url, options = {}) {\n      this._url = url\n      this._method = options.method || 'GET'\n      this._headers = new Map()\n      this._body = options.body\n      if (options.headers) {\n        Object.entries(options.headers).forEach(([key, value]) => {\n          this._headers.set(key, value)\n        })\n      }\n    }\n    \n    get url() { return this._url }\n    get method() { return this._method }\n    get headers() { return this._headers }\n    get body() { return this._body }\n    \n    async json() {\n      return JSON.parse(this._body || '{}')\n    }\n    \n    async text() {\n      return this._body || ''\n    }\n  }\n}\n\nif (!global.Response) {\n  global.Response = class Response {\n    constructor(body, options = {}) {\n      this._body = body\n      this._status = options.status || 200\n      this._statusText = options.statusText || 'OK'\n      this._headers = new Map()\n      if (options.headers) {\n        Object.entries(options.headers).forEach(([key, value]) => {\n          this._headers.set(key, value)\n        })\n      }\n    }\n    \n    get status() { return this._status }\n    get statusText() { return this._statusText }\n    get headers() { return this._headers }\n    get body() { return this._body }\n    \n    async json() {\n      return JSON.parse(this._body || '{}')\n    }\n    \n    async text() {\n      return this._body || ''\n    }\n    \n    // Add static methods for NextResponse compatibility\n    static json(data, options = {}) {\n      return new Response(JSON.stringify(data), {\n        ...options,\n        headers: {\n          'Content-Type': 'application/json',\n          ...options.headers,\n        },\n      })\n    }\n    \n    static text(data, options = {}) {\n      return new Response(data, {\n        ...options,\n        headers: {\n          'Content-Type': 'text/plain',\n          ...options.headers,\n        },\n      })\n    }\n  }\n}\n\nglobal.Headers = class Headers {\n  constructor(init = {}) {\n    this.map = new Map()\n    if (init) {\n      Object.entries(init).forEach(([key, value]) => {\n        this.map.set(key, value)\n      })\n    }\n  }\n  \n  get(name) {\n    return this.map.get(name)\n  }\n  \n  set(name, value) {\n    this.map.set(name, value)\n  }\n  \n  has(name) {\n    return this.map.has(name)\n  }\n}\n\n// Make React available globally for test files\nglobal.React = React\n\n// Mock Next.js router\njest.mock('next/navigation', () => ({\n  useRouter: () => ({\n    push: jest.fn(),\n    replace: jest.fn(),\n    prefetch: jest.fn(),\n    back: jest.fn(),\n    forward: jest.fn(),\n    refresh: jest.fn(),\n  }),\n  useSearchParams: () => ({\n    get: jest.fn(),\n  }),\n  usePathname: () => '/',\n}))\n\n// Mock Next.js headers\njest.mock('next/headers', () => ({\n  headers: () => ({\n    get: jest.fn(),\n  }),\n  cookies: () => ({\n    get: jest.fn(),\n    set: jest.fn(),\n    delete: jest.fn(),\n  }),\n}))\n\n// Mock environment variables\nprocess.env.NEXT_PUBLIC_SUPABASE_URL = 'http://localhost:54321'\nprocess.env.NEXT_PUBLIC_SUPABASE_ANON_KEY = 'test-anon-key'\nprocess.env.SUPABASE_SERVICE_ROLE_KEY = 'test-service-role-key'\n\n// Mock browser APIs that are missing in Jest\nglobal.Notification = class Notification {\n  constructor(title, options = {}) {\n    this.title = title\n    this.options = options\n  }\n  static requestPermission = jest.fn().mockResolvedValue('granted')\n  static permission = 'granted'\n}\n\nglobal.localStorage = {\n  getItem: jest.fn(),\n  setItem: jest.fn(),\n  removeItem: jest.fn(),\n  clear: jest.fn(),\n  length: 0,\n  key: jest.fn(),\n}\n\nglobal.sessionStorage = {\n  getItem: jest.fn(),\n  setItem: jest.fn(),\n  removeItem: jest.fn(),\n  clear: jest.fn(),\n  length: 0,\n  key: jest.fn(),\n}\n\n// Mock navigator.onLine\nObject.defineProperty(global.navigator, 'onLine', {\n  writable: true,\n  value: true,\n})\n\n// Mock window.matchMedia\nObject.defineProperty(window, 'matchMedia', {\n  writable: true,\n  value: jest.fn().mockImplementation(query => ({\n    matches: false,\n    media: query,\n    onchange: null,\n    addListener: jest.fn(), // deprecated\n    removeListener: jest.fn(), // deprecated\n    addEventListener: jest.fn(),\n    removeEventListener: jest.fn(),\n    dispatchEvent: jest.fn(),\n  })),\n})\n\n// Mock IntersectionObserver\nglobal.IntersectionObserver = class IntersectionObserver {\n  constructor() {}\n  disconnect() {}\n  observe() {}\n  unobserve() {}\n}\n\n// Mock ResizeObserver\nglobal.ResizeObserver = class ResizeObserver {\n  constructor() {}\n  disconnect() {}\n  observe() {}\n  unobserve() {}\n}\n\n// Note: Store mocks should be done per-test, not globally\n// This allows for more precise testing and better isolation\n\n// Mock React Router - only mock what's necessary\njest.mock('react-router-dom', () => ({\n  ...jest.requireActual('react-router-dom'),\n  useNavigate: () => jest.fn(),\n  useLocation: () => ({ pathname: '/', search: '', hash: '', state: null }),\n  useParams: () => ({}),\n  // Keep actual Link and NavLink for better testing\n}))\n\n// Mock Supabase client - should be done per-test for better control\n// This is a basic mock that can be overridden in individual tests\njest.mock('@/utils/supabase/client', () => ({\n  createClient: jest.fn(() => ({\n    auth: {\n      getUser: jest.fn().mockResolvedValue({ data: { user: null }, error: null }),\n      signIn: jest.fn().mockResolvedValue({ data: { user: null }, error: null }),\n      signOut: jest.fn().mockResolvedValue({ error: null }),\n      onAuthStateChange: jest.fn().mockReturnValue({ data: { subscription: null } }),\n    },\n    from: jest.fn(() => ({\n      select: jest.fn().mockReturnThis(),\n      insert: jest.fn().mockReturnThis(),\n      update: jest.fn().mockReturnThis(),\n      delete: jest.fn().mockReturnThis(),\n      eq: jest.fn().mockReturnThis(),\n      single: jest.fn().mockResolvedValue({ data: null, error: null }),\n      then: jest.fn().mockResolvedValue({ data: [], error: null }),\n    })),\n  })),\n}))\n\n// Mock NextResponse for API routes\nglobal.NextResponse = {\n  json: (data, options = {}) => {\n    return new Response(JSON.stringify(data), {\n      ...options,\n      headers: {\n        'Content-Type': 'application/json',\n        ...options.headers,\n      },\n    })\n  },\n  text: (data, options = {}) => {\n    return new Response(data, {\n      ...options,\n      headers: {\n        'Content-Type': 'text/plain',\n        ...options.headers,\n      },\n    })\n  },\n}\n\n// Mock Next.js components - minimal mocks that preserve functionality\njest.mock('next/image', () => ({\n  __esModule: true,\n  default: (props) => {\n    // Preserve src, alt, and other important props for testing\n    const { src, alt, ...restProps } = props\n    return <img src={src} alt={alt} {...restProps} />\n  },\n}))\n\njest.mock('next/link', () => ({\n  __esModule: true,\n  default: ({ children, href, ...props }) => (\n    <a href={href} {...props}>{children}</a>\n  ),\n}))"],"names":["jest","mock","useRouter","push","fn","replace","prefetch","back","forward","refresh","useSearchParams","get","usePathname","headers","cookies","set","delete","requireActual","useNavigate","useLocation","pathname","search","hash","state","useParams","createClient","auth","getUser","mockResolvedValue","data","user","error","signIn","signOut","onAuthStateChange","mockReturnValue","subscription","from","select","mockReturnThis","insert","update","eq","single","then","__esModule","default","props","src","alt","restProps","img","children","href","a","global","TextEncoder","TextDecoder","fetch","Promise","resolve","ok","status","json","text","Map","Request","constructor","url","options","_url","_method","method","_headers","_body","body","Object","entries","forEach","key","value","JSON","parse","Response","_status","_statusText","statusText","stringify","Headers","init","map","name","has","React","process","env","NEXT_PUBLIC_SUPABASE_URL","NEXT_PUBLIC_SUPABASE_ANON_KEY","SUPABASE_SERVICE_ROLE_KEY","Notification","title","requestPermission","permission","localStorage","getItem","setItem","removeItem","clear","length","sessionStorage","defineProperty","navigator","writable","window","mockImplementation","query","matches","media","onchange","addListener","removeListener","addEventListener","removeEventListener","dispatchEvent","IntersectionObserver","disconnect","observe","unobserve","ResizeObserver","NextResponse"],"mappings":"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"}