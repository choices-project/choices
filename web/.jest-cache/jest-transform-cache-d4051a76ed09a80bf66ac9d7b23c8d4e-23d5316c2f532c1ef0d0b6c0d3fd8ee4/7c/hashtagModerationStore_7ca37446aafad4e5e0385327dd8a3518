e17e874f1b22a8c2c6c359a4484f7d3b
/**
 * Hashtag Moderation Store - Zustand Implementation
 * 
 * Manages hashtag moderation state including flagging interface,
 * moderation queue, and form state management.
 * 
 * Created: January 15, 2025
 * Status: âœ… ACTIVE
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    moderationStoreUtils: function() {
        return moderationStoreUtils;
    },
    useHashtagModerationStore: function() {
        return useHashtagModerationStore;
    },
    useModerationActions: function() {
        return useModerationActions;
    },
    useModerationDebug: function() {
        return useModerationDebug;
    },
    useModerationError: function() {
        return useModerationError;
    },
    useModerationForm: function() {
        return useModerationForm;
    },
    useModerationLoading: function() {
        return useModerationLoading;
    },
    useModerationModal: function() {
        return useModerationModal;
    },
    useModerationQueue: function() {
        return useModerationQueue;
    },
    useModerationStats: function() {
        return useModerationStats;
    },
    useModerationSubscription: function() {
        return useModerationSubscription;
    },
    usePendingFlags: function() {
        return usePendingFlags;
    },
    useSelectedModeration: function() {
        return useSelectedModeration;
    }
});
const _zustand = require("zustand");
const _middleware = require("zustand/middleware");
const _immer = require("zustand/middleware/immer");
const _logger = require("../utils/logger");
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {
        __proto__: null
    };
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
const useHashtagModerationStore = (0, _zustand.create)()((0, _middleware.devtools)((0, _middleware.persist)((0, _immer.immer)((set, _get)=>({
        // Initial state
        isOpen: false,
        flagType: "inappropriate",
        reason: "",
        isSubmitting: false,
        error: null,
        moderationQueue: [],
        selectedModeration: null,
        isLoading: false,
        // Base store actions
        setLoading: (loading)=>set((state)=>{
                state.isLoading = loading;
            }),
        setError: (error)=>set((state)=>{
                state.error = error;
            }),
        clearError: ()=>set((state)=>{
                state.error = null;
            }),
        // Modal actions
        setIsOpen: (open)=>set((state)=>{
                state.isOpen = open;
                // Reset form when opening
                if (open) {
                    state.flagType = "inappropriate";
                    state.reason = "";
                    state.error = null;
                }
            }),
        // Form actions
        setFlagType: (type)=>set((state)=>{
                state.flagType = type;
            }),
        setReason: (reason)=>set((state)=>{
                state.reason = reason;
            }),
        resetForm: ()=>set((state)=>{
                state.flagType = "inappropriate";
                state.reason = "";
                state.isSubmitting = false;
                state.error = null;
            }),
        // Submission actions
        setIsSubmitting: (submitting)=>set((state)=>{
                state.isSubmitting = submitting;
            }),
        // Moderation actions
        setModerationQueue: (queue)=>set((state)=>{
                state.moderationQueue = queue;
            }),
        setSelectedModeration: (moderation)=>set((state)=>{
                state.selectedModeration = moderation;
            }),
        addModeration: (moderation)=>set((state)=>{
                state.moderationQueue.unshift(moderation);
            }),
        updateModeration: (id, updates)=>set((state)=>{
                const index = state.moderationQueue.findIndex((m)=>m.id === id);
                if (index !== -1) {
                    const existing = state.moderationQueue[index];
                    if (existing) {
                        state.moderationQueue[index] = {
                            ...existing,
                            ...updates,
                            updatedAt: new Date().toISOString()
                        };
                    }
                }
            }),
        removeModeration: (id)=>set((state)=>{
                state.moderationQueue = state.moderationQueue.filter((m)=>m.id !== id);
            }),
        // Flag actions
        submitFlag: async (hashtagId)=>{
            const state = _get();
            if (!state.reason.trim()) {
                set((state)=>{
                    state.error = "Please provide a reason for flagging";
                });
                return;
            }
            set((state)=>{
                state.isSubmitting = true;
                state.error = null;
            });
            try {
                // Get user ID from user store
                const { useUserStore } = await Promise.resolve().then(()=>/*#__PURE__*/ _interop_require_wildcard(require("./userStore")));
                const userStore = useUserStore.getState();
                const userId = userStore.user?.id || "anonymous";
                const flag = {
                    id: crypto.randomUUID(),
                    hashtagId,
                    flagType: state.flagType,
                    reason: state.reason,
                    userId,
                    timestamp: new Date().toISOString(),
                    status: "pending"
                };
                // Submit flag to API
                const response = await fetch("/api/hashtags?action=flag", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(flag)
                });
                if (!response.ok) {
                    throw new Error(`Failed to submit flag: ${response.statusText}`);
                }
                // Reset form after successful submission
                set((state)=>{
                    state.isSubmitting = false;
                    state.isOpen = false;
                    state.flagType = "inappropriate";
                    state.reason = "";
                });
                _logger.logger.info("Flag submitted", {
                    flag
                });
            } catch (error) {
                set((state)=>{
                    state.isSubmitting = false;
                    state.error = error instanceof Error ? error.message : "Failed to submit flag";
                });
            }
        },
        approveFlag: async (flagId)=>{
            set((state)=>{
                state.isLoading = true;
            });
            try {
                // Approve flag via API
                const response = await fetch(`/api/hashtags?action=approve&flagId=${flagId}`, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    }
                });
                if (!response.ok) {
                    throw new Error(`Failed to approve flag: ${response.statusText}`);
                }
                set((state)=>{
                    const flagIndex = state.moderationQueue.findIndex((m)=>m.flags?.some((f)=>f.id === flagId));
                    if (flagIndex !== -1) {
                        const moderation = state.moderationQueue[flagIndex];
                        if (moderation) {
                            const flag = moderation.flags?.find((f)=>f.id === flagId);
                            if (flag) {
                                flag.status = "approved";
                            }
                        }
                    }
                    state.isLoading = false;
                });
            // Flag approved successfully
            } catch (error) {
                set((state)=>{
                    state.isLoading = false;
                    state.error = error instanceof Error ? error.message : "Failed to approve flag";
                });
            }
        },
        rejectFlag: async (flagId)=>{
            set((state)=>{
                state.isLoading = true;
            });
            try {
                // Reject flag via API
                const response = await fetch(`/api/hashtags?action=reject&flagId=${flagId}`, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    }
                });
                if (!response.ok) {
                    throw new Error(`Failed to reject flag: ${response.statusText}`);
                }
                set((state)=>{
                    const flagIndex = state.moderationQueue.findIndex((m)=>m.flags?.some((f)=>f.id === flagId));
                    if (flagIndex !== -1) {
                        const moderation = state.moderationQueue[flagIndex];
                        if (moderation) {
                            const flag = moderation.flags?.find((f)=>f.id === flagId);
                            if (flag) {
                                flag.status = "rejected";
                            }
                        }
                    }
                    state.isLoading = false;
                });
            // Flag rejected successfully
            } catch (error) {
                set((state)=>{
                    state.isLoading = false;
                    state.error = error instanceof Error ? error.message : "Failed to reject flag";
                });
            }
        },
        // Queue management actions
        loadModerationQueue: async ()=>{
            set((state)=>{
                state.isLoading = true;
            });
            try {
                // Load moderation queue from API
                const response = await fetch("/api/hashtags?action=moderation-queue", {
                    method: "GET",
                    headers: {
                        "Content-Type": "application/json"
                    }
                });
                if (!response.ok) {
                    throw new Error(`Failed to load moderation queue: ${response.statusText}`);
                }
                const moderationQueue = await response.json();
                set((state)=>{
                    state.moderationQueue = moderationQueue;
                    state.isLoading = false;
                });
            } catch (error) {
                set((state)=>{
                    state.isLoading = false;
                    state.error = error instanceof Error ? error.message : "Failed to load moderation queue";
                });
            }
        },
        refreshQueue: async ()=>{
            const { loadModerationQueue } = _get();
            await loadModerationQueue();
        }
    })), {
    name: "hashtag-moderation-store",
    partialize: (state)=>({
            flagType: state.flagType,
            reason: state.reason
        })
}), {
    name: "hashtag-moderation-store"
}));
const useModerationModal = ()=>useHashtagModerationStore((state)=>state.isOpen);
const useModerationForm = ()=>useHashtagModerationStore((state)=>({
            flagType: state.flagType,
            reason: state.reason,
            isSubmitting: state.isSubmitting,
            error: state.error
        }));
const useModerationQueue = ()=>useHashtagModerationStore((state)=>state.moderationQueue);
const useSelectedModeration = ()=>useHashtagModerationStore((state)=>state.selectedModeration);
const useModerationLoading = ()=>useHashtagModerationStore((state)=>state.isLoading);
const useModerationError = ()=>useHashtagModerationStore((state)=>state.error);
const useModerationActions = ()=>useHashtagModerationStore((state)=>({
            setIsOpen: state.setIsOpen,
            setFlagType: state.setFlagType,
            setReason: state.setReason,
            resetForm: state.resetForm,
            setIsSubmitting: state.setIsSubmitting,
            setError: state.setError,
            setModerationQueue: state.setModerationQueue,
            setSelectedModeration: state.setSelectedModeration,
            addModeration: state.addModeration,
            updateModeration: state.updateModeration,
            removeModeration: state.removeModeration,
            submitFlag: state.submitFlag,
            approveFlag: state.approveFlag,
            rejectFlag: state.rejectFlag,
            loadModerationQueue: state.loadModerationQueue,
            refreshQueue: state.refreshQueue
        }));
const useModerationStats = ()=>useHashtagModerationStore((state)=>{
        const queue = state.moderationQueue;
        return {
            total: queue.length,
            pending: queue.filter((m)=>m.status === "pending").length,
            approved: queue.filter((m)=>m.status === "approved").length,
            rejected: queue.filter((m)=>m.status === "rejected").length,
            underReview: queue.filter((m)=>m.status === "under_review").length
        };
    });
const usePendingFlags = ()=>useHashtagModerationStore((state)=>state.moderationQueue.flatMap((m)=>m.flags.filter((f)=>f.status === "pending")));
const moderationStoreUtils = {
    getFlagTypeLabel: (type)=>{
        const labels = {
            inappropriate: "Inappropriate Content",
            spam: "Spam",
            misleading: "Misleading",
            harassment: "Harassment",
            other: "Other"
        };
        return labels[type];
    },
    getStatusColor: (status)=>{
        const colors = {
            pending: "yellow",
            approved: "green",
            rejected: "red",
            under_review: "blue"
        };
        return colors[status];
    },
    canSubmitFlag: (reason)=>{
        return reason.trim().length > 0;
    }
};
const useModerationSubscription = ()=>{
    const store = useHashtagModerationStore();
    return {
        subscribe: (callback)=>{
            return useHashtagModerationStore.subscribe(callback);
        },
        getState: ()=>store
    };
};
const useModerationDebug = ()=>{
    const state = useHashtagModerationStore();
    return {
        state,
        actions: useModerationActions(),
        stats: useModerationStats()
    };
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hbGF1Z2hpbmdraXRzdW5lL3NyYy9DaG9pY2VzL3dlYi9saWIvc3RvcmVzL2hhc2h0YWdNb2RlcmF0aW9uU3RvcmUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBIYXNodGFnIE1vZGVyYXRpb24gU3RvcmUgLSBadXN0YW5kIEltcGxlbWVudGF0aW9uXG4gKiBcbiAqIE1hbmFnZXMgaGFzaHRhZyBtb2RlcmF0aW9uIHN0YXRlIGluY2x1ZGluZyBmbGFnZ2luZyBpbnRlcmZhY2UsXG4gKiBtb2RlcmF0aW9uIHF1ZXVlLCBhbmQgZm9ybSBzdGF0ZSBtYW5hZ2VtZW50LlxuICogXG4gKiBDcmVhdGVkOiBKYW51YXJ5IDE1LCAyMDI1XG4gKiBTdGF0dXM6IOKchSBBQ1RJVkVcbiAqL1xuXG5pbXBvcnQgeyBjcmVhdGUgfSBmcm9tICd6dXN0YW5kJztcbmltcG9ydCB7IGRldnRvb2xzIH0gZnJvbSAnenVzdGFuZC9taWRkbGV3YXJlJztcbmltcG9ydCB7IHBlcnNpc3QgfSBmcm9tICd6dXN0YW5kL21pZGRsZXdhcmUnO1xuaW1wb3J0IHsgaW1tZXIgfSBmcm9tICd6dXN0YW5kL21pZGRsZXdhcmUvaW1tZXInO1xuXG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICdAL2xpYi91dGlscy9sb2dnZXInO1xuXG5pbXBvcnQgdHlwZSB7IEJhc2VTdG9yZSB9IGZyb20gJy4vdHlwZXMnO1xuXG4vLyBIYXNodGFnIG1vZGVyYXRpb24gdHlwZXNcbmV4cG9ydCB0eXBlIEhhc2h0YWdGbGFnVHlwZSA9ICdpbmFwcHJvcHJpYXRlJyB8ICdzcGFtJyB8ICdtaXNsZWFkaW5nJyB8ICdoYXJhc3NtZW50JyB8ICdvdGhlcic7XG5cbmV4cG9ydCB0eXBlIEhhc2h0YWdNb2RlcmF0aW9uU3RhdHVzID0gJ3BlbmRpbmcnIHwgJ2FwcHJvdmVkJyB8ICdyZWplY3RlZCcgfCAndW5kZXJfcmV2aWV3JztcblxuZXhwb3J0IGludGVyZmFjZSBIYXNodGFnRmxhZyB7XG4gIGlkOiBzdHJpbmc7XG4gIGhhc2h0YWdJZDogc3RyaW5nO1xuICBmbGFnVHlwZTogSGFzaHRhZ0ZsYWdUeXBlO1xuICByZWFzb246IHN0cmluZztcbiAgdXNlcklkOiBzdHJpbmc7XG4gIHRpbWVzdGFtcDogc3RyaW5nO1xuICBzdGF0dXM6IEhhc2h0YWdNb2RlcmF0aW9uU3RhdHVzO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEhhc2h0YWdNb2RlcmF0aW9uIHtcbiAgaWQ6IHN0cmluZztcbiAgaGFzaHRhZ0lkOiBzdHJpbmc7XG4gIHN0YXR1czogSGFzaHRhZ01vZGVyYXRpb25TdGF0dXM7XG4gIGZsYWdzOiBIYXNodGFnRmxhZ1tdO1xuICBtb2RlcmF0b3JJZD86IHN0cmluZztcbiAgbW9kZXJhdG9yTm90ZXM/OiBzdHJpbmc7XG4gIGNyZWF0ZWRBdDogc3RyaW5nO1xuICB1cGRhdGVkQXQ6IHN0cmluZztcbn1cblxuLy8gU3RvcmUgc3RhdGUgaW50ZXJmYWNlXG50eXBlIEhhc2h0YWdNb2RlcmF0aW9uU3RvcmUgPSB7XG4gIC8vIE1vZGFsIHN0YXRlXG4gIGlzT3BlbjogYm9vbGVhbjtcbiAgXG4gIC8vIEZvcm0gc3RhdGVcbiAgZmxhZ1R5cGU6IEhhc2h0YWdGbGFnVHlwZTtcbiAgcmVhc29uOiBzdHJpbmc7XG4gIFxuICAvLyBTdWJtaXNzaW9uIHN0YXRlXG4gIGlzU3VibWl0dGluZzogYm9vbGVhbjtcbiAgZXJyb3I6IHN0cmluZyB8IG51bGw7XG4gIFxuICAvLyBNb2RlcmF0aW9uIHF1ZXVlXG4gIG1vZGVyYXRpb25RdWV1ZTogSGFzaHRhZ01vZGVyYXRpb25bXTtcbiAgc2VsZWN0ZWRNb2RlcmF0aW9uOiBIYXNodGFnTW9kZXJhdGlvbiB8IG51bGw7XG4gIFxuICAvLyBBY3Rpb25zIC0gTW9kYWxcbiAgc2V0SXNPcGVuOiAob3BlbjogYm9vbGVhbikgPT4gdm9pZDtcbiAgXG4gIC8vIEFjdGlvbnMgLSBGb3JtXG4gIHNldEZsYWdUeXBlOiAodHlwZTogSGFzaHRhZ0ZsYWdUeXBlKSA9PiB2b2lkO1xuICBzZXRSZWFzb246IChyZWFzb246IHN0cmluZykgPT4gdm9pZDtcbiAgcmVzZXRGb3JtOiAoKSA9PiB2b2lkO1xuICBcbiAgLy8gQWN0aW9ucyAtIFN1Ym1pc3Npb25cbiAgc2V0SXNTdWJtaXR0aW5nOiAoc3VibWl0dGluZzogYm9vbGVhbikgPT4gdm9pZDtcbiAgc2V0RXJyb3I6IChlcnJvcjogc3RyaW5nIHwgbnVsbCkgPT4gdm9pZDtcbiAgXG4gIC8vIEFjdGlvbnMgLSBNb2RlcmF0aW9uXG4gIHNldE1vZGVyYXRpb25RdWV1ZTogKHF1ZXVlOiBIYXNodGFnTW9kZXJhdGlvbltdKSA9PiB2b2lkO1xuICBzZXRTZWxlY3RlZE1vZGVyYXRpb246IChtb2RlcmF0aW9uOiBIYXNodGFnTW9kZXJhdGlvbiB8IG51bGwpID0+IHZvaWQ7XG4gIGFkZE1vZGVyYXRpb246IChtb2RlcmF0aW9uOiBIYXNodGFnTW9kZXJhdGlvbikgPT4gdm9pZDtcbiAgdXBkYXRlTW9kZXJhdGlvbjogKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IFBhcnRpYWw8SGFzaHRhZ01vZGVyYXRpb24+KSA9PiB2b2lkO1xuICByZW1vdmVNb2RlcmF0aW9uOiAoaWQ6IHN0cmluZykgPT4gdm9pZDtcbiAgXG4gIC8vIEFjdGlvbnMgLSBGbGFnc1xuICBzdWJtaXRGbGFnOiAoaGFzaHRhZ0lkOiBzdHJpbmcpID0+IFByb21pc2U8dm9pZD47XG4gIGFwcHJvdmVGbGFnOiAoZmxhZ0lkOiBzdHJpbmcpID0+IFByb21pc2U8dm9pZD47XG4gIHJlamVjdEZsYWc6IChmbGFnSWQ6IHN0cmluZykgPT4gUHJvbWlzZTx2b2lkPjtcbiAgXG4gIC8vIEFjdGlvbnMgLSBRdWV1ZSBtYW5hZ2VtZW50XG4gIGxvYWRNb2RlcmF0aW9uUXVldWU6ICgpID0+IFByb21pc2U8dm9pZD47XG4gIHJlZnJlc2hRdWV1ZTogKCkgPT4gUHJvbWlzZTx2b2lkPjtcbn0gJiBCYXNlU3RvcmU7XG5cbi8vIENyZWF0ZSBoYXNodGFnIG1vZGVyYXRpb24gc3RvcmUgd2l0aCBtaWRkbGV3YXJlXG5leHBvcnQgY29uc3QgdXNlSGFzaHRhZ01vZGVyYXRpb25TdG9yZSA9IGNyZWF0ZTxIYXNodGFnTW9kZXJhdGlvblN0b3JlPigpKFxuICBkZXZ0b29scyhcbiAgICBwZXJzaXN0KFxuICAgICAgaW1tZXIoKHNldCwgX2dldCkgPT4gKHtcbiAgICAgICAgLy8gSW5pdGlhbCBzdGF0ZVxuICAgICAgICBpc09wZW46IGZhbHNlLFxuICAgICAgICBmbGFnVHlwZTogJ2luYXBwcm9wcmlhdGUnLFxuICAgICAgICByZWFzb246ICcnLFxuICAgICAgICBpc1N1Ym1pdHRpbmc6IGZhbHNlLFxuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgbW9kZXJhdGlvblF1ZXVlOiBbXSxcbiAgICAgICAgc2VsZWN0ZWRNb2RlcmF0aW9uOiBudWxsLFxuICAgICAgICBpc0xvYWRpbmc6IGZhbHNlLFxuICAgICAgICBcbiAgICAgICAgLy8gQmFzZSBzdG9yZSBhY3Rpb25zXG4gICAgICAgIHNldExvYWRpbmc6IChsb2FkaW5nKSA9PiBzZXQoKHN0YXRlKSA9PiB7XG4gICAgICAgICAgc3RhdGUuaXNMb2FkaW5nID0gbG9hZGluZztcbiAgICAgICAgfSksXG4gICAgICAgIFxuICAgICAgICBzZXRFcnJvcjogKGVycm9yKSA9PiBzZXQoKHN0YXRlKSA9PiB7XG4gICAgICAgICAgc3RhdGUuZXJyb3IgPSBlcnJvcjtcbiAgICAgICAgfSksXG4gICAgICAgIFxuICAgICAgICBjbGVhckVycm9yOiAoKSA9PiBzZXQoKHN0YXRlKSA9PiB7XG4gICAgICAgICAgc3RhdGUuZXJyb3IgPSBudWxsO1xuICAgICAgICB9KSxcbiAgICAgICAgXG4gICAgICAgIC8vIE1vZGFsIGFjdGlvbnNcbiAgICAgICAgc2V0SXNPcGVuOiAob3BlbikgPT4gc2V0KChzdGF0ZSkgPT4ge1xuICAgICAgICAgIHN0YXRlLmlzT3BlbiA9IG9wZW47XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gUmVzZXQgZm9ybSB3aGVuIG9wZW5pbmdcbiAgICAgICAgICBpZiAob3Blbikge1xuICAgICAgICAgICAgc3RhdGUuZmxhZ1R5cGUgPSAnaW5hcHByb3ByaWF0ZSc7XG4gICAgICAgICAgICBzdGF0ZS5yZWFzb24gPSAnJztcbiAgICAgICAgICAgIHN0YXRlLmVycm9yID0gbnVsbDtcbiAgICAgICAgICB9XG4gICAgICAgIH0pLFxuICAgICAgICBcbiAgICAgICAgLy8gRm9ybSBhY3Rpb25zXG4gICAgICAgIHNldEZsYWdUeXBlOiAodHlwZSkgPT4gc2V0KChzdGF0ZSkgPT4ge1xuICAgICAgICAgIHN0YXRlLmZsYWdUeXBlID0gdHlwZTtcbiAgICAgICAgfSksXG4gICAgICAgIFxuICAgICAgICBzZXRSZWFzb246IChyZWFzb24pID0+IHNldCgoc3RhdGUpID0+IHtcbiAgICAgICAgICBzdGF0ZS5yZWFzb24gPSByZWFzb247XG4gICAgICAgIH0pLFxuICAgICAgICBcbiAgICAgICAgcmVzZXRGb3JtOiAoKSA9PiBzZXQoKHN0YXRlKSA9PiB7XG4gICAgICAgICAgc3RhdGUuZmxhZ1R5cGUgPSAnaW5hcHByb3ByaWF0ZSc7XG4gICAgICAgICAgc3RhdGUucmVhc29uID0gJyc7XG4gICAgICAgICAgc3RhdGUuaXNTdWJtaXR0aW5nID0gZmFsc2U7XG4gICAgICAgICAgc3RhdGUuZXJyb3IgPSBudWxsO1xuICAgICAgICB9KSxcbiAgICAgICAgXG4gICAgICAgIC8vIFN1Ym1pc3Npb24gYWN0aW9uc1xuICAgICAgICBzZXRJc1N1Ym1pdHRpbmc6IChzdWJtaXR0aW5nKSA9PiBzZXQoKHN0YXRlKSA9PiB7XG4gICAgICAgICAgc3RhdGUuaXNTdWJtaXR0aW5nID0gc3VibWl0dGluZztcbiAgICAgICAgfSksXG4gICAgICAgIFxuICAgICAgICAvLyBNb2RlcmF0aW9uIGFjdGlvbnNcbiAgICAgICAgc2V0TW9kZXJhdGlvblF1ZXVlOiAocXVldWUpID0+IHNldCgoc3RhdGUpID0+IHtcbiAgICAgICAgICBzdGF0ZS5tb2RlcmF0aW9uUXVldWUgPSBxdWV1ZTtcbiAgICAgICAgfSksXG4gICAgICAgIFxuICAgICAgICBzZXRTZWxlY3RlZE1vZGVyYXRpb246IChtb2RlcmF0aW9uKSA9PiBzZXQoKHN0YXRlKSA9PiB7XG4gICAgICAgICAgc3RhdGUuc2VsZWN0ZWRNb2RlcmF0aW9uID0gbW9kZXJhdGlvbjtcbiAgICAgICAgfSksXG4gICAgICAgIFxuICAgICAgICBhZGRNb2RlcmF0aW9uOiAobW9kZXJhdGlvbikgPT4gc2V0KChzdGF0ZSkgPT4ge1xuICAgICAgICAgIHN0YXRlLm1vZGVyYXRpb25RdWV1ZS51bnNoaWZ0KG1vZGVyYXRpb24pO1xuICAgICAgICB9KSxcbiAgICAgICAgXG4gICAgICAgIHVwZGF0ZU1vZGVyYXRpb246IChpZCwgdXBkYXRlcykgPT4gc2V0KChzdGF0ZSkgPT4ge1xuICAgICAgICAgIGNvbnN0IGluZGV4ID0gc3RhdGUubW9kZXJhdGlvblF1ZXVlLmZpbmRJbmRleChtID0+IG0uaWQgPT09IGlkKTtcbiAgICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICBjb25zdCBleGlzdGluZyA9IHN0YXRlLm1vZGVyYXRpb25RdWV1ZVtpbmRleF07XG4gICAgICAgICAgICBpZiAoZXhpc3RpbmcpIHtcbiAgICAgICAgICAgICAgc3RhdGUubW9kZXJhdGlvblF1ZXVlW2luZGV4XSA9IHtcbiAgICAgICAgICAgICAgICAuLi5leGlzdGluZyxcbiAgICAgICAgICAgICAgICAuLi51cGRhdGVzLFxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSksXG4gICAgICAgIFxuICAgICAgICByZW1vdmVNb2RlcmF0aW9uOiAoaWQpID0+IHNldCgoc3RhdGUpID0+IHtcbiAgICAgICAgICBzdGF0ZS5tb2RlcmF0aW9uUXVldWUgPSBzdGF0ZS5tb2RlcmF0aW9uUXVldWUuZmlsdGVyKG0gPT4gbS5pZCAhPT0gaWQpO1xuICAgICAgICB9KSxcbiAgICAgICAgXG4gICAgICAgIC8vIEZsYWcgYWN0aW9uc1xuICAgICAgICBzdWJtaXRGbGFnOiBhc3luYyAoaGFzaHRhZ0lkKSA9PiB7XG4gICAgICAgICAgY29uc3Qgc3RhdGUgPSBfZ2V0KCk7XG4gICAgICAgICAgaWYgKCFzdGF0ZS5yZWFzb24udHJpbSgpKSB7XG4gICAgICAgICAgICBzZXQoKHN0YXRlKSA9PiB7XG4gICAgICAgICAgICAgIHN0YXRlLmVycm9yID0gJ1BsZWFzZSBwcm92aWRlIGEgcmVhc29uIGZvciBmbGFnZ2luZyc7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgXG4gICAgICAgICAgc2V0KChzdGF0ZSkgPT4ge1xuICAgICAgICAgICAgc3RhdGUuaXNTdWJtaXR0aW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIHN0YXRlLmVycm9yID0gbnVsbDtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR2V0IHVzZXIgSUQgZnJvbSB1c2VyIHN0b3JlXG4gICAgICAgICAgICBjb25zdCB7IHVzZVVzZXJTdG9yZSB9ID0gYXdhaXQgaW1wb3J0KCdAL2xpYi9zdG9yZXMvdXNlclN0b3JlJyk7XG4gICAgICAgICAgICBjb25zdCB1c2VyU3RvcmUgPSB1c2VVc2VyU3RvcmUuZ2V0U3RhdGUoKTtcbiAgICAgICAgICAgIGNvbnN0IHVzZXJJZCA9IHVzZXJTdG9yZS51c2VyPy5pZCB8fCAnYW5vbnltb3VzJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgZmxhZzogSGFzaHRhZ0ZsYWcgPSB7XG4gICAgICAgICAgICAgIGlkOiBjcnlwdG8ucmFuZG9tVVVJRCgpLFxuICAgICAgICAgICAgICBoYXNodGFnSWQsXG4gICAgICAgICAgICAgIGZsYWdUeXBlOiBzdGF0ZS5mbGFnVHlwZSxcbiAgICAgICAgICAgICAgcmVhc29uOiBzdGF0ZS5yZWFzb24sXG4gICAgICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICAgIHN0YXR1czogJ3BlbmRpbmcnLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU3VibWl0IGZsYWcgdG8gQVBJXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCcvYXBpL2hhc2h0YWdzP2FjdGlvbj1mbGFnJywge1xuICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGZsYWcpLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gc3VibWl0IGZsYWc6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gUmVzZXQgZm9ybSBhZnRlciBzdWNjZXNzZnVsIHN1Ym1pc3Npb25cbiAgICAgICAgICAgIHNldCgoc3RhdGUpID0+IHtcbiAgICAgICAgICAgICAgc3RhdGUuaXNTdWJtaXR0aW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgIHN0YXRlLmlzT3BlbiA9IGZhbHNlO1xuICAgICAgICAgICAgICBzdGF0ZS5mbGFnVHlwZSA9ICdpbmFwcHJvcHJpYXRlJztcbiAgICAgICAgICAgICAgc3RhdGUucmVhc29uID0gJyc7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbG9nZ2VyLmluZm8oJ0ZsYWcgc3VibWl0dGVkJywgeyBmbGFnIH0pO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBzZXQoKHN0YXRlKSA9PiB7XG4gICAgICAgICAgICAgIHN0YXRlLmlzU3VibWl0dGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICBzdGF0ZS5lcnJvciA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBzdWJtaXQgZmxhZyc7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBhcHByb3ZlRmxhZzogYXN5bmMgKGZsYWdJZCkgPT4ge1xuICAgICAgICAgIHNldCgoc3RhdGUpID0+IHtcbiAgICAgICAgICAgIHN0YXRlLmlzTG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEFwcHJvdmUgZmxhZyB2aWEgQVBJXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAvYXBpL2hhc2h0YWdzP2FjdGlvbj1hcHByb3ZlJmZsYWdJZD0ke2ZsYWdJZH1gLCB7XG4gICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGFwcHJvdmUgZmxhZzogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBzZXQoKHN0YXRlKSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IGZsYWdJbmRleCA9IHN0YXRlLm1vZGVyYXRpb25RdWV1ZS5maW5kSW5kZXgobSA9PiBcbiAgICAgICAgICAgICAgICBtLmZsYWdzPy5zb21lKGYgPT4gZi5pZCA9PT0gZmxhZ0lkKVxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICBpZiAoZmxhZ0luZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1vZGVyYXRpb24gPSBzdGF0ZS5tb2RlcmF0aW9uUXVldWVbZmxhZ0luZGV4XTtcbiAgICAgICAgICAgICAgICBpZiAobW9kZXJhdGlvbikge1xuICAgICAgICAgICAgICAgICAgY29uc3QgZmxhZyA9IG1vZGVyYXRpb24uZmxhZ3M/LmZpbmQoZiA9PiBmLmlkID09PSBmbGFnSWQpO1xuICAgICAgICAgICAgICAgICAgaWYgKGZsYWcpIHtcbiAgICAgICAgICAgICAgICAgICAgZmxhZy5zdGF0dXMgPSAnYXBwcm92ZWQnO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBzdGF0ZS5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBGbGFnIGFwcHJvdmVkIHN1Y2Nlc3NmdWxseVxuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBzZXQoKHN0YXRlKSA9PiB7XG4gICAgICAgICAgICAgIHN0YXRlLmlzTG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICBzdGF0ZS5lcnJvciA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBhcHByb3ZlIGZsYWcnO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgcmVqZWN0RmxhZzogYXN5bmMgKGZsYWdJZCkgPT4ge1xuICAgICAgICAgIHNldCgoc3RhdGUpID0+IHtcbiAgICAgICAgICAgIHN0YXRlLmlzTG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFJlamVjdCBmbGFnIHZpYSBBUElcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYC9hcGkvaGFzaHRhZ3M/YWN0aW9uPXJlamVjdCZmbGFnSWQ9JHtmbGFnSWR9YCwge1xuICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byByZWplY3QgZmxhZzogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBzZXQoKHN0YXRlKSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IGZsYWdJbmRleCA9IHN0YXRlLm1vZGVyYXRpb25RdWV1ZS5maW5kSW5kZXgobSA9PiBcbiAgICAgICAgICAgICAgICBtLmZsYWdzPy5zb21lKGYgPT4gZi5pZCA9PT0gZmxhZ0lkKVxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICBpZiAoZmxhZ0luZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1vZGVyYXRpb24gPSBzdGF0ZS5tb2RlcmF0aW9uUXVldWVbZmxhZ0luZGV4XTtcbiAgICAgICAgICAgICAgICBpZiAobW9kZXJhdGlvbikge1xuICAgICAgICAgICAgICAgICAgY29uc3QgZmxhZyA9IG1vZGVyYXRpb24uZmxhZ3M/LmZpbmQoZiA9PiBmLmlkID09PSBmbGFnSWQpO1xuICAgICAgICAgICAgICAgICAgaWYgKGZsYWcpIHtcbiAgICAgICAgICAgICAgICAgICAgZmxhZy5zdGF0dXMgPSAncmVqZWN0ZWQnO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBzdGF0ZS5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBGbGFnIHJlamVjdGVkIHN1Y2Nlc3NmdWxseVxuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBzZXQoKHN0YXRlKSA9PiB7XG4gICAgICAgICAgICAgIHN0YXRlLmlzTG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICBzdGF0ZS5lcnJvciA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byByZWplY3QgZmxhZyc7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICAvLyBRdWV1ZSBtYW5hZ2VtZW50IGFjdGlvbnNcbiAgICAgICAgbG9hZE1vZGVyYXRpb25RdWV1ZTogYXN5bmMgKCkgPT4ge1xuICAgICAgICAgIHNldCgoc3RhdGUpID0+IHtcbiAgICAgICAgICAgIHN0YXRlLmlzTG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIExvYWQgbW9kZXJhdGlvbiBxdWV1ZSBmcm9tIEFQSVxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnL2FwaS9oYXNodGFncz9hY3Rpb249bW9kZXJhdGlvbi1xdWV1ZScsIHtcbiAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBsb2FkIG1vZGVyYXRpb24gcXVldWU6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgbW9kZXJhdGlvblF1ZXVlID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBzZXQoKHN0YXRlKSA9PiB7XG4gICAgICAgICAgICAgIHN0YXRlLm1vZGVyYXRpb25RdWV1ZSA9IG1vZGVyYXRpb25RdWV1ZTtcbiAgICAgICAgICAgICAgc3RhdGUuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgc2V0KChzdGF0ZSkgPT4ge1xuICAgICAgICAgICAgICBzdGF0ZS5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgc3RhdGUuZXJyb3IgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdGYWlsZWQgdG8gbG9hZCBtb2RlcmF0aW9uIHF1ZXVlJztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIHJlZnJlc2hRdWV1ZTogYXN5bmMgKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHsgbG9hZE1vZGVyYXRpb25RdWV1ZSB9ID0gX2dldCgpO1xuICAgICAgICAgIGF3YWl0IGxvYWRNb2RlcmF0aW9uUXVldWUoKTtcbiAgICAgICAgfSxcbiAgICAgIH0pKSxcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ2hhc2h0YWctbW9kZXJhdGlvbi1zdG9yZScsXG4gICAgICAgIHBhcnRpYWxpemU6IChzdGF0ZSkgPT4gKHtcbiAgICAgICAgICBmbGFnVHlwZTogc3RhdGUuZmxhZ1R5cGUsXG4gICAgICAgICAgcmVhc29uOiBzdGF0ZS5yZWFzb24sXG4gICAgICAgIH0pLFxuICAgICAgfVxuICAgICksXG4gICAgeyBuYW1lOiAnaGFzaHRhZy1tb2RlcmF0aW9uLXN0b3JlJyB9XG4gIClcbik7XG5cbi8vIFN0b3JlIHNlbGVjdG9ycyBmb3Igb3B0aW1pemVkIHJlLXJlbmRlcnNcbmV4cG9ydCBjb25zdCB1c2VNb2RlcmF0aW9uTW9kYWwgPSAoKSA9PiB1c2VIYXNodGFnTW9kZXJhdGlvblN0b3JlKHN0YXRlID0+IHN0YXRlLmlzT3Blbik7XG5leHBvcnQgY29uc3QgdXNlTW9kZXJhdGlvbkZvcm0gPSAoKSA9PiB1c2VIYXNodGFnTW9kZXJhdGlvblN0b3JlKFxuICBzdGF0ZSA9PiAoe1xuICAgIGZsYWdUeXBlOiBzdGF0ZS5mbGFnVHlwZSxcbiAgICByZWFzb246IHN0YXRlLnJlYXNvbixcbiAgICBpc1N1Ym1pdHRpbmc6IHN0YXRlLmlzU3VibWl0dGluZyxcbiAgICBlcnJvcjogc3RhdGUuZXJyb3IsXG4gIH0pXG4pO1xuXG5leHBvcnQgY29uc3QgdXNlTW9kZXJhdGlvblF1ZXVlID0gKCkgPT4gdXNlSGFzaHRhZ01vZGVyYXRpb25TdG9yZShzdGF0ZSA9PiBzdGF0ZS5tb2RlcmF0aW9uUXVldWUpO1xuZXhwb3J0IGNvbnN0IHVzZVNlbGVjdGVkTW9kZXJhdGlvbiA9ICgpID0+IHVzZUhhc2h0YWdNb2RlcmF0aW9uU3RvcmUoc3RhdGUgPT4gc3RhdGUuc2VsZWN0ZWRNb2RlcmF0aW9uKTtcbmV4cG9ydCBjb25zdCB1c2VNb2RlcmF0aW9uTG9hZGluZyA9ICgpID0+IHVzZUhhc2h0YWdNb2RlcmF0aW9uU3RvcmUoc3RhdGUgPT4gc3RhdGUuaXNMb2FkaW5nKTtcbmV4cG9ydCBjb25zdCB1c2VNb2RlcmF0aW9uRXJyb3IgPSAoKSA9PiB1c2VIYXNodGFnTW9kZXJhdGlvblN0b3JlKHN0YXRlID0+IHN0YXRlLmVycm9yKTtcblxuLy8gQWN0aW9uIHNlbGVjdG9yc1xuZXhwb3J0IGNvbnN0IHVzZU1vZGVyYXRpb25BY3Rpb25zID0gKCkgPT4gdXNlSGFzaHRhZ01vZGVyYXRpb25TdG9yZShzdGF0ZSA9PiAoe1xuICBzZXRJc09wZW46IHN0YXRlLnNldElzT3BlbixcbiAgc2V0RmxhZ1R5cGU6IHN0YXRlLnNldEZsYWdUeXBlLFxuICBzZXRSZWFzb246IHN0YXRlLnNldFJlYXNvbixcbiAgcmVzZXRGb3JtOiBzdGF0ZS5yZXNldEZvcm0sXG4gIHNldElzU3VibWl0dGluZzogc3RhdGUuc2V0SXNTdWJtaXR0aW5nLFxuICBzZXRFcnJvcjogc3RhdGUuc2V0RXJyb3IsXG4gIHNldE1vZGVyYXRpb25RdWV1ZTogc3RhdGUuc2V0TW9kZXJhdGlvblF1ZXVlLFxuICBzZXRTZWxlY3RlZE1vZGVyYXRpb246IHN0YXRlLnNldFNlbGVjdGVkTW9kZXJhdGlvbixcbiAgYWRkTW9kZXJhdGlvbjogc3RhdGUuYWRkTW9kZXJhdGlvbixcbiAgdXBkYXRlTW9kZXJhdGlvbjogc3RhdGUudXBkYXRlTW9kZXJhdGlvbixcbiAgcmVtb3ZlTW9kZXJhdGlvbjogc3RhdGUucmVtb3ZlTW9kZXJhdGlvbixcbiAgc3VibWl0RmxhZzogc3RhdGUuc3VibWl0RmxhZyxcbiAgYXBwcm92ZUZsYWc6IHN0YXRlLmFwcHJvdmVGbGFnLFxuICByZWplY3RGbGFnOiBzdGF0ZS5yZWplY3RGbGFnLFxuICBsb2FkTW9kZXJhdGlvblF1ZXVlOiBzdGF0ZS5sb2FkTW9kZXJhdGlvblF1ZXVlLFxuICByZWZyZXNoUXVldWU6IHN0YXRlLnJlZnJlc2hRdWV1ZSxcbn0pKTtcblxuLy8gQ29tcHV0ZWQgc2VsZWN0b3JzXG5leHBvcnQgY29uc3QgdXNlTW9kZXJhdGlvblN0YXRzID0gKCkgPT4gdXNlSGFzaHRhZ01vZGVyYXRpb25TdG9yZShzdGF0ZSA9PiB7XG4gIGNvbnN0IHF1ZXVlID0gc3RhdGUubW9kZXJhdGlvblF1ZXVlO1xuICByZXR1cm4ge1xuICAgIHRvdGFsOiBxdWV1ZS5sZW5ndGgsXG4gICAgcGVuZGluZzogcXVldWUuZmlsdGVyKG0gPT4gbS5zdGF0dXMgPT09ICdwZW5kaW5nJykubGVuZ3RoLFxuICAgIGFwcHJvdmVkOiBxdWV1ZS5maWx0ZXIobSA9PiBtLnN0YXR1cyA9PT0gJ2FwcHJvdmVkJykubGVuZ3RoLFxuICAgIHJlamVjdGVkOiBxdWV1ZS5maWx0ZXIobSA9PiBtLnN0YXR1cyA9PT0gJ3JlamVjdGVkJykubGVuZ3RoLFxuICAgIHVuZGVyUmV2aWV3OiBxdWV1ZS5maWx0ZXIobSA9PiBtLnN0YXR1cyA9PT0gJ3VuZGVyX3JldmlldycpLmxlbmd0aCxcbiAgfTtcbn0pO1xuXG5leHBvcnQgY29uc3QgdXNlUGVuZGluZ0ZsYWdzID0gKCkgPT4gdXNlSGFzaHRhZ01vZGVyYXRpb25TdG9yZShzdGF0ZSA9PiBcbiAgc3RhdGUubW9kZXJhdGlvblF1ZXVlLmZsYXRNYXAobSA9PiBtLmZsYWdzLmZpbHRlcihmID0+IGYuc3RhdHVzID09PSAncGVuZGluZycpKVxuKTtcblxuLy8gU3RvcmUgdXRpbGl0aWVzXG5leHBvcnQgY29uc3QgbW9kZXJhdGlvblN0b3JlVXRpbHMgPSB7XG4gIGdldEZsYWdUeXBlTGFiZWw6ICh0eXBlOiBIYXNodGFnRmxhZ1R5cGUpOiBzdHJpbmcgPT4ge1xuICAgIGNvbnN0IGxhYmVscyA9IHtcbiAgICAgIGluYXBwcm9wcmlhdGU6ICdJbmFwcHJvcHJpYXRlIENvbnRlbnQnLFxuICAgICAgc3BhbTogJ1NwYW0nLFxuICAgICAgbWlzbGVhZGluZzogJ01pc2xlYWRpbmcnLFxuICAgICAgaGFyYXNzbWVudDogJ0hhcmFzc21lbnQnLFxuICAgICAgb3RoZXI6ICdPdGhlcicsXG4gICAgfTtcbiAgICByZXR1cm4gbGFiZWxzW3R5cGVdO1xuICB9LFxuICBcbiAgZ2V0U3RhdHVzQ29sb3I6IChzdGF0dXM6IEhhc2h0YWdNb2RlcmF0aW9uU3RhdHVzKTogc3RyaW5nID0+IHtcbiAgICBjb25zdCBjb2xvcnMgPSB7XG4gICAgICBwZW5kaW5nOiAneWVsbG93JyxcbiAgICAgIGFwcHJvdmVkOiAnZ3JlZW4nLFxuICAgICAgcmVqZWN0ZWQ6ICdyZWQnLFxuICAgICAgdW5kZXJfcmV2aWV3OiAnYmx1ZScsXG4gICAgfTtcbiAgICByZXR1cm4gY29sb3JzW3N0YXR1c107XG4gIH0sXG4gIFxuICBjYW5TdWJtaXRGbGFnOiAocmVhc29uOiBzdHJpbmcpOiBib29sZWFuID0+IHtcbiAgICByZXR1cm4gcmVhc29uLnRyaW0oKS5sZW5ndGggPiAwO1xuICB9LFxufTtcblxuLy8gU3RvcmUgc3Vic2NyaXB0aW9uc1xuZXhwb3J0IGNvbnN0IHVzZU1vZGVyYXRpb25TdWJzY3JpcHRpb24gPSAoKSA9PiB7XG4gIGNvbnN0IHN0b3JlID0gdXNlSGFzaHRhZ01vZGVyYXRpb25TdG9yZSgpO1xuICBcbiAgcmV0dXJuIHtcbiAgICBzdWJzY3JpYmU6IChjYWxsYmFjazogKHN0YXRlOiBIYXNodGFnTW9kZXJhdGlvblN0b3JlKSA9PiB2b2lkKSA9PiB7XG4gICAgICByZXR1cm4gdXNlSGFzaHRhZ01vZGVyYXRpb25TdG9yZS5zdWJzY3JpYmUoY2FsbGJhY2spO1xuICAgIH0sXG4gICAgZ2V0U3RhdGU6ICgpID0+IHN0b3JlLFxuICB9O1xufTtcblxuLy8gU3RvcmUgZGVidWdnaW5nXG5leHBvcnQgY29uc3QgdXNlTW9kZXJhdGlvbkRlYnVnID0gKCkgPT4ge1xuICBjb25zdCBzdGF0ZSA9IHVzZUhhc2h0YWdNb2RlcmF0aW9uU3RvcmUoKTtcbiAgXG4gIHJldHVybiB7XG4gICAgc3RhdGUsXG4gICAgYWN0aW9uczogdXNlTW9kZXJhdGlvbkFjdGlvbnMoKSxcbiAgICBzdGF0czogdXNlTW9kZXJhdGlvblN0YXRzKCksXG4gIH07XG59O1xuIl0sIm5hbWVzIjpbIm1vZGVyYXRpb25TdG9yZVV0aWxzIiwidXNlSGFzaHRhZ01vZGVyYXRpb25TdG9yZSIsInVzZU1vZGVyYXRpb25BY3Rpb25zIiwidXNlTW9kZXJhdGlvbkRlYnVnIiwidXNlTW9kZXJhdGlvbkVycm9yIiwidXNlTW9kZXJhdGlvbkZvcm0iLCJ1c2VNb2RlcmF0aW9uTG9hZGluZyIsInVzZU1vZGVyYXRpb25Nb2RhbCIsInVzZU1vZGVyYXRpb25RdWV1ZSIsInVzZU1vZGVyYXRpb25TdGF0cyIsInVzZU1vZGVyYXRpb25TdWJzY3JpcHRpb24iLCJ1c2VQZW5kaW5nRmxhZ3MiLCJ1c2VTZWxlY3RlZE1vZGVyYXRpb24iLCJjcmVhdGUiLCJkZXZ0b29scyIsInBlcnNpc3QiLCJpbW1lciIsInNldCIsIl9nZXQiLCJpc09wZW4iLCJmbGFnVHlwZSIsInJlYXNvbiIsImlzU3VibWl0dGluZyIsImVycm9yIiwibW9kZXJhdGlvblF1ZXVlIiwic2VsZWN0ZWRNb2RlcmF0aW9uIiwiaXNMb2FkaW5nIiwic2V0TG9hZGluZyIsImxvYWRpbmciLCJzdGF0ZSIsInNldEVycm9yIiwiY2xlYXJFcnJvciIsInNldElzT3BlbiIsIm9wZW4iLCJzZXRGbGFnVHlwZSIsInR5cGUiLCJzZXRSZWFzb24iLCJyZXNldEZvcm0iLCJzZXRJc1N1Ym1pdHRpbmciLCJzdWJtaXR0aW5nIiwic2V0TW9kZXJhdGlvblF1ZXVlIiwicXVldWUiLCJzZXRTZWxlY3RlZE1vZGVyYXRpb24iLCJtb2RlcmF0aW9uIiwiYWRkTW9kZXJhdGlvbiIsInVuc2hpZnQiLCJ1cGRhdGVNb2RlcmF0aW9uIiwiaWQiLCJ1cGRhdGVzIiwiaW5kZXgiLCJmaW5kSW5kZXgiLCJtIiwiZXhpc3RpbmciLCJ1cGRhdGVkQXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJyZW1vdmVNb2RlcmF0aW9uIiwiZmlsdGVyIiwic3VibWl0RmxhZyIsImhhc2h0YWdJZCIsInRyaW0iLCJ1c2VVc2VyU3RvcmUiLCJ1c2VyU3RvcmUiLCJnZXRTdGF0ZSIsInVzZXJJZCIsInVzZXIiLCJmbGFnIiwiY3J5cHRvIiwicmFuZG9tVVVJRCIsInRpbWVzdGFtcCIsInN0YXR1cyIsInJlc3BvbnNlIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJvayIsIkVycm9yIiwic3RhdHVzVGV4dCIsImxvZ2dlciIsImluZm8iLCJtZXNzYWdlIiwiYXBwcm92ZUZsYWciLCJmbGFnSWQiLCJmbGFnSW5kZXgiLCJmbGFncyIsInNvbWUiLCJmIiwiZmluZCIsInJlamVjdEZsYWciLCJsb2FkTW9kZXJhdGlvblF1ZXVlIiwianNvbiIsInJlZnJlc2hRdWV1ZSIsIm5hbWUiLCJwYXJ0aWFsaXplIiwidG90YWwiLCJsZW5ndGgiLCJwZW5kaW5nIiwiYXBwcm92ZWQiLCJyZWplY3RlZCIsInVuZGVyUmV2aWV3IiwiZmxhdE1hcCIsImdldEZsYWdUeXBlTGFiZWwiLCJsYWJlbHMiLCJpbmFwcHJvcHJpYXRlIiwic3BhbSIsIm1pc2xlYWRpbmciLCJoYXJhc3NtZW50Iiwib3RoZXIiLCJnZXRTdGF0dXNDb2xvciIsImNvbG9ycyIsInVuZGVyX3JldmlldyIsImNhblN1Ym1pdEZsYWciLCJzdG9yZSIsInN1YnNjcmliZSIsImNhbGxiYWNrIiwiYWN0aW9ucyIsInN0YXRzIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Q0FRQzs7Ozs7Ozs7Ozs7SUF5YVlBLG9CQUFvQjtlQUFwQkE7O0lBclZBQyx5QkFBeUI7ZUFBekJBOztJQWlUQUMsb0JBQW9CO2VBQXBCQTs7SUE0RUFDLGtCQUFrQjtlQUFsQkE7O0lBL0VBQyxrQkFBa0I7ZUFBbEJBOztJQVpBQyxpQkFBaUI7ZUFBakJBOztJQVdBQyxvQkFBb0I7ZUFBcEJBOztJQVpBQyxrQkFBa0I7ZUFBbEJBOztJQVVBQyxrQkFBa0I7ZUFBbEJBOztJQTBCQUMsa0JBQWtCO2VBQWxCQTs7SUE0Q0FDLHlCQUF5QjtlQUF6QkE7O0lBakNBQyxlQUFlO2VBQWZBOztJQXBDQUMscUJBQXFCO2VBQXJCQTs7O3lCQTlYVTs0QkFDRTt1QkFFSDt3QkFFQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBNkVoQixNQUFNWCw0QkFBNEJZLElBQUFBLGVBQU0sSUFDN0NDLElBQUFBLG9CQUFRLEVBQ05DLElBQUFBLG1CQUFPLEVBQ0xDLElBQUFBLFlBQUssRUFBQyxDQUFDQyxLQUFLQyxPQUFVLENBQUE7UUFDcEIsZ0JBQWdCO1FBQ2hCQyxRQUFRO1FBQ1JDLFVBQVU7UUFDVkMsUUFBUTtRQUNSQyxjQUFjO1FBQ2RDLE9BQU87UUFDUEMsaUJBQWlCLEVBQUU7UUFDbkJDLG9CQUFvQjtRQUNwQkMsV0FBVztRQUVYLHFCQUFxQjtRQUNyQkMsWUFBWSxDQUFDQyxVQUFZWCxJQUFJLENBQUNZO2dCQUM1QkEsTUFBTUgsU0FBUyxHQUFHRTtZQUNwQjtRQUVBRSxVQUFVLENBQUNQLFFBQVVOLElBQUksQ0FBQ1k7Z0JBQ3hCQSxNQUFNTixLQUFLLEdBQUdBO1lBQ2hCO1FBRUFRLFlBQVksSUFBTWQsSUFBSSxDQUFDWTtnQkFDckJBLE1BQU1OLEtBQUssR0FBRztZQUNoQjtRQUVBLGdCQUFnQjtRQUNoQlMsV0FBVyxDQUFDQyxPQUFTaEIsSUFBSSxDQUFDWTtnQkFDeEJBLE1BQU1WLE1BQU0sR0FBR2M7Z0JBRWYsMEJBQTBCO2dCQUMxQixJQUFJQSxNQUFNO29CQUNSSixNQUFNVCxRQUFRLEdBQUc7b0JBQ2pCUyxNQUFNUixNQUFNLEdBQUc7b0JBQ2ZRLE1BQU1OLEtBQUssR0FBRztnQkFDaEI7WUFDRjtRQUVBLGVBQWU7UUFDZlcsYUFBYSxDQUFDQyxPQUFTbEIsSUFBSSxDQUFDWTtnQkFDMUJBLE1BQU1ULFFBQVEsR0FBR2U7WUFDbkI7UUFFQUMsV0FBVyxDQUFDZixTQUFXSixJQUFJLENBQUNZO2dCQUMxQkEsTUFBTVIsTUFBTSxHQUFHQTtZQUNqQjtRQUVBZ0IsV0FBVyxJQUFNcEIsSUFBSSxDQUFDWTtnQkFDcEJBLE1BQU1ULFFBQVEsR0FBRztnQkFDakJTLE1BQU1SLE1BQU0sR0FBRztnQkFDZlEsTUFBTVAsWUFBWSxHQUFHO2dCQUNyQk8sTUFBTU4sS0FBSyxHQUFHO1lBQ2hCO1FBRUEscUJBQXFCO1FBQ3JCZSxpQkFBaUIsQ0FBQ0MsYUFBZXRCLElBQUksQ0FBQ1k7Z0JBQ3BDQSxNQUFNUCxZQUFZLEdBQUdpQjtZQUN2QjtRQUVBLHFCQUFxQjtRQUNyQkMsb0JBQW9CLENBQUNDLFFBQVV4QixJQUFJLENBQUNZO2dCQUNsQ0EsTUFBTUwsZUFBZSxHQUFHaUI7WUFDMUI7UUFFQUMsdUJBQXVCLENBQUNDLGFBQWUxQixJQUFJLENBQUNZO2dCQUMxQ0EsTUFBTUosa0JBQWtCLEdBQUdrQjtZQUM3QjtRQUVBQyxlQUFlLENBQUNELGFBQWUxQixJQUFJLENBQUNZO2dCQUNsQ0EsTUFBTUwsZUFBZSxDQUFDcUIsT0FBTyxDQUFDRjtZQUNoQztRQUVBRyxrQkFBa0IsQ0FBQ0MsSUFBSUMsVUFBWS9CLElBQUksQ0FBQ1k7Z0JBQ3RDLE1BQU1vQixRQUFRcEIsTUFBTUwsZUFBZSxDQUFDMEIsU0FBUyxDQUFDQyxDQUFBQSxJQUFLQSxFQUFFSixFQUFFLEtBQUtBO2dCQUM1RCxJQUFJRSxVQUFVLENBQUMsR0FBRztvQkFDaEIsTUFBTUcsV0FBV3ZCLE1BQU1MLGVBQWUsQ0FBQ3lCLE1BQU07b0JBQzdDLElBQUlHLFVBQVU7d0JBQ1p2QixNQUFNTCxlQUFlLENBQUN5QixNQUFNLEdBQUc7NEJBQzdCLEdBQUdHLFFBQVE7NEJBQ1gsR0FBR0osT0FBTzs0QkFDVkssV0FBVyxJQUFJQyxPQUFPQyxXQUFXO3dCQUNuQztvQkFDRjtnQkFDRjtZQUNGO1FBRUFDLGtCQUFrQixDQUFDVCxLQUFPOUIsSUFBSSxDQUFDWTtnQkFDN0JBLE1BQU1MLGVBQWUsR0FBR0ssTUFBTUwsZUFBZSxDQUFDaUMsTUFBTSxDQUFDTixDQUFBQSxJQUFLQSxFQUFFSixFQUFFLEtBQUtBO1lBQ3JFO1FBRUEsZUFBZTtRQUNmVyxZQUFZLE9BQU9DO1lBQ2pCLE1BQU05QixRQUFRWDtZQUNkLElBQUksQ0FBQ1csTUFBTVIsTUFBTSxDQUFDdUMsSUFBSSxJQUFJO2dCQUN4QjNDLElBQUksQ0FBQ1k7b0JBQ0hBLE1BQU1OLEtBQUssR0FBRztnQkFDaEI7Z0JBQ0E7WUFDRjtZQUVBTixJQUFJLENBQUNZO2dCQUNIQSxNQUFNUCxZQUFZLEdBQUc7Z0JBQ3JCTyxNQUFNTixLQUFLLEdBQUc7WUFDaEI7WUFFQSxJQUFJO2dCQUNGLDhCQUE4QjtnQkFDOUIsTUFBTSxFQUFFc0MsWUFBWSxFQUFFLEdBQUcsTUFBTSxtRUFBQSxRQUFPO2dCQUN0QyxNQUFNQyxZQUFZRCxhQUFhRSxRQUFRO2dCQUN2QyxNQUFNQyxTQUFTRixVQUFVRyxJQUFJLEVBQUVsQixNQUFNO2dCQUVyQyxNQUFNbUIsT0FBb0I7b0JBQ3hCbkIsSUFBSW9CLE9BQU9DLFVBQVU7b0JBQ3JCVDtvQkFDQXZDLFVBQVVTLE1BQU1ULFFBQVE7b0JBQ3hCQyxRQUFRUSxNQUFNUixNQUFNO29CQUNwQjJDO29CQUNBSyxXQUFXLElBQUlmLE9BQU9DLFdBQVc7b0JBQ2pDZSxRQUFRO2dCQUNWO2dCQUVBLHFCQUFxQjtnQkFDckIsTUFBTUMsV0FBVyxNQUFNQyxNQUFNLDZCQUE2QjtvQkFDeERDLFFBQVE7b0JBQ1JDLFNBQVM7d0JBQ1AsZ0JBQWdCO29CQUNsQjtvQkFDQUMsTUFBTUMsS0FBS0MsU0FBUyxDQUFDWDtnQkFDdkI7Z0JBRUEsSUFBSSxDQUFDSyxTQUFTTyxFQUFFLEVBQUU7b0JBQ2hCLE1BQU0sSUFBSUMsTUFBTSxDQUFDLHVCQUF1QixFQUFFUixTQUFTUyxVQUFVLENBQUMsQ0FBQztnQkFDakU7Z0JBRUEseUNBQXlDO2dCQUN6Qy9ELElBQUksQ0FBQ1k7b0JBQ0hBLE1BQU1QLFlBQVksR0FBRztvQkFDckJPLE1BQU1WLE1BQU0sR0FBRztvQkFDZlUsTUFBTVQsUUFBUSxHQUFHO29CQUNqQlMsTUFBTVIsTUFBTSxHQUFHO2dCQUNqQjtnQkFFQTRELGNBQU0sQ0FBQ0MsSUFBSSxDQUFDLGtCQUFrQjtvQkFBRWhCO2dCQUFLO1lBQ3ZDLEVBQUUsT0FBTzNDLE9BQU87Z0JBQ2ROLElBQUksQ0FBQ1k7b0JBQ0hBLE1BQU1QLFlBQVksR0FBRztvQkFDckJPLE1BQU1OLEtBQUssR0FBR0EsaUJBQWlCd0QsUUFBUXhELE1BQU00RCxPQUFPLEdBQUc7Z0JBQ3pEO1lBQ0Y7UUFDRjtRQUVBQyxhQUFhLE9BQU9DO1lBQ2xCcEUsSUFBSSxDQUFDWTtnQkFDSEEsTUFBTUgsU0FBUyxHQUFHO1lBQ3BCO1lBRUEsSUFBSTtnQkFDRix1QkFBdUI7Z0JBQ3ZCLE1BQU02QyxXQUFXLE1BQU1DLE1BQU0sQ0FBQyxvQ0FBb0MsRUFBRWEsT0FBTyxDQUFDLEVBQUU7b0JBQzVFWixRQUFRO29CQUNSQyxTQUFTO3dCQUNQLGdCQUFnQjtvQkFDbEI7Z0JBQ0Y7Z0JBRUEsSUFBSSxDQUFDSCxTQUFTTyxFQUFFLEVBQUU7b0JBQ2hCLE1BQU0sSUFBSUMsTUFBTSxDQUFDLHdCQUF3QixFQUFFUixTQUFTUyxVQUFVLENBQUMsQ0FBQztnQkFDbEU7Z0JBRUEvRCxJQUFJLENBQUNZO29CQUNILE1BQU15RCxZQUFZekQsTUFBTUwsZUFBZSxDQUFDMEIsU0FBUyxDQUFDQyxDQUFBQSxJQUNoREEsRUFBRW9DLEtBQUssRUFBRUMsS0FBS0MsQ0FBQUEsSUFBS0EsRUFBRTFDLEVBQUUsS0FBS3NDO29CQUU5QixJQUFJQyxjQUFjLENBQUMsR0FBRzt3QkFDcEIsTUFBTTNDLGFBQWFkLE1BQU1MLGVBQWUsQ0FBQzhELFVBQVU7d0JBQ25ELElBQUkzQyxZQUFZOzRCQUNkLE1BQU11QixPQUFPdkIsV0FBVzRDLEtBQUssRUFBRUcsS0FBS0QsQ0FBQUEsSUFBS0EsRUFBRTFDLEVBQUUsS0FBS3NDOzRCQUNsRCxJQUFJbkIsTUFBTTtnQ0FDUkEsS0FBS0ksTUFBTSxHQUFHOzRCQUNoQjt3QkFDRjtvQkFDRjtvQkFDQXpDLE1BQU1ILFNBQVMsR0FBRztnQkFDcEI7WUFFQSw2QkFBNkI7WUFDL0IsRUFBRSxPQUFPSCxPQUFPO2dCQUNkTixJQUFJLENBQUNZO29CQUNIQSxNQUFNSCxTQUFTLEdBQUc7b0JBQ2xCRyxNQUFNTixLQUFLLEdBQUdBLGlCQUFpQndELFFBQVF4RCxNQUFNNEQsT0FBTyxHQUFHO2dCQUN6RDtZQUNGO1FBQ0Y7UUFFQVEsWUFBWSxPQUFPTjtZQUNqQnBFLElBQUksQ0FBQ1k7Z0JBQ0hBLE1BQU1ILFNBQVMsR0FBRztZQUNwQjtZQUVBLElBQUk7Z0JBQ0Ysc0JBQXNCO2dCQUN0QixNQUFNNkMsV0FBVyxNQUFNQyxNQUFNLENBQUMsbUNBQW1DLEVBQUVhLE9BQU8sQ0FBQyxFQUFFO29CQUMzRVosUUFBUTtvQkFDUkMsU0FBUzt3QkFDUCxnQkFBZ0I7b0JBQ2xCO2dCQUNGO2dCQUVBLElBQUksQ0FBQ0gsU0FBU08sRUFBRSxFQUFFO29CQUNoQixNQUFNLElBQUlDLE1BQU0sQ0FBQyx1QkFBdUIsRUFBRVIsU0FBU1MsVUFBVSxDQUFDLENBQUM7Z0JBQ2pFO2dCQUVBL0QsSUFBSSxDQUFDWTtvQkFDSCxNQUFNeUQsWUFBWXpELE1BQU1MLGVBQWUsQ0FBQzBCLFNBQVMsQ0FBQ0MsQ0FBQUEsSUFDaERBLEVBQUVvQyxLQUFLLEVBQUVDLEtBQUtDLENBQUFBLElBQUtBLEVBQUUxQyxFQUFFLEtBQUtzQztvQkFFOUIsSUFBSUMsY0FBYyxDQUFDLEdBQUc7d0JBQ3BCLE1BQU0zQyxhQUFhZCxNQUFNTCxlQUFlLENBQUM4RCxVQUFVO3dCQUNuRCxJQUFJM0MsWUFBWTs0QkFDZCxNQUFNdUIsT0FBT3ZCLFdBQVc0QyxLQUFLLEVBQUVHLEtBQUtELENBQUFBLElBQUtBLEVBQUUxQyxFQUFFLEtBQUtzQzs0QkFDbEQsSUFBSW5CLE1BQU07Z0NBQ1JBLEtBQUtJLE1BQU0sR0FBRzs0QkFDaEI7d0JBQ0Y7b0JBQ0Y7b0JBQ0F6QyxNQUFNSCxTQUFTLEdBQUc7Z0JBQ3BCO1lBRUEsNkJBQTZCO1lBQy9CLEVBQUUsT0FBT0gsT0FBTztnQkFDZE4sSUFBSSxDQUFDWTtvQkFDSEEsTUFBTUgsU0FBUyxHQUFHO29CQUNsQkcsTUFBTU4sS0FBSyxHQUFHQSxpQkFBaUJ3RCxRQUFReEQsTUFBTTRELE9BQU8sR0FBRztnQkFDekQ7WUFDRjtRQUNGO1FBRUEsMkJBQTJCO1FBQzNCUyxxQkFBcUI7WUFDbkIzRSxJQUFJLENBQUNZO2dCQUNIQSxNQUFNSCxTQUFTLEdBQUc7WUFDcEI7WUFFQSxJQUFJO2dCQUNGLGlDQUFpQztnQkFDakMsTUFBTTZDLFdBQVcsTUFBTUMsTUFBTSx5Q0FBeUM7b0JBQ3BFQyxRQUFRO29CQUNSQyxTQUFTO3dCQUNQLGdCQUFnQjtvQkFDbEI7Z0JBQ0Y7Z0JBRUEsSUFBSSxDQUFDSCxTQUFTTyxFQUFFLEVBQUU7b0JBQ2hCLE1BQU0sSUFBSUMsTUFBTSxDQUFDLGlDQUFpQyxFQUFFUixTQUFTUyxVQUFVLENBQUMsQ0FBQztnQkFDM0U7Z0JBRUEsTUFBTXhELGtCQUFrQixNQUFNK0MsU0FBU3NCLElBQUk7Z0JBRTNDNUUsSUFBSSxDQUFDWTtvQkFDSEEsTUFBTUwsZUFBZSxHQUFHQTtvQkFDeEJLLE1BQU1ILFNBQVMsR0FBRztnQkFDcEI7WUFDRixFQUFFLE9BQU9ILE9BQU87Z0JBQ2ROLElBQUksQ0FBQ1k7b0JBQ0hBLE1BQU1ILFNBQVMsR0FBRztvQkFDbEJHLE1BQU1OLEtBQUssR0FBR0EsaUJBQWlCd0QsUUFBUXhELE1BQU00RCxPQUFPLEdBQUc7Z0JBQ3pEO1lBQ0Y7UUFDRjtRQUVBVyxjQUFjO1lBQ1osTUFBTSxFQUFFRixtQkFBbUIsRUFBRSxHQUFHMUU7WUFDaEMsTUFBTTBFO1FBQ1I7SUFDRixDQUFBLElBQ0E7SUFDRUcsTUFBTTtJQUNOQyxZQUFZLENBQUNuRSxRQUFXLENBQUE7WUFDdEJULFVBQVVTLE1BQU1ULFFBQVE7WUFDeEJDLFFBQVFRLE1BQU1SLE1BQU07UUFDdEIsQ0FBQTtBQUNGLElBRUY7SUFBRTBFLE1BQU07QUFBMkI7QUFLaEMsTUFBTXhGLHFCQUFxQixJQUFNTiwwQkFBMEI0QixDQUFBQSxRQUFTQSxNQUFNVixNQUFNO0FBQ2hGLE1BQU1kLG9CQUFvQixJQUFNSiwwQkFDckM0QixDQUFBQSxRQUFVLENBQUE7WUFDUlQsVUFBVVMsTUFBTVQsUUFBUTtZQUN4QkMsUUFBUVEsTUFBTVIsTUFBTTtZQUNwQkMsY0FBY08sTUFBTVAsWUFBWTtZQUNoQ0MsT0FBT00sTUFBTU4sS0FBSztRQUNwQixDQUFBO0FBR0ssTUFBTWYscUJBQXFCLElBQU1QLDBCQUEwQjRCLENBQUFBLFFBQVNBLE1BQU1MLGVBQWU7QUFDekYsTUFBTVosd0JBQXdCLElBQU1YLDBCQUEwQjRCLENBQUFBLFFBQVNBLE1BQU1KLGtCQUFrQjtBQUMvRixNQUFNbkIsdUJBQXVCLElBQU1MLDBCQUEwQjRCLENBQUFBLFFBQVNBLE1BQU1ILFNBQVM7QUFDckYsTUFBTXRCLHFCQUFxQixJQUFNSCwwQkFBMEI0QixDQUFBQSxRQUFTQSxNQUFNTixLQUFLO0FBRy9FLE1BQU1yQix1QkFBdUIsSUFBTUQsMEJBQTBCNEIsQ0FBQUEsUUFBVSxDQUFBO1lBQzVFRyxXQUFXSCxNQUFNRyxTQUFTO1lBQzFCRSxhQUFhTCxNQUFNSyxXQUFXO1lBQzlCRSxXQUFXUCxNQUFNTyxTQUFTO1lBQzFCQyxXQUFXUixNQUFNUSxTQUFTO1lBQzFCQyxpQkFBaUJULE1BQU1TLGVBQWU7WUFDdENSLFVBQVVELE1BQU1DLFFBQVE7WUFDeEJVLG9CQUFvQlgsTUFBTVcsa0JBQWtCO1lBQzVDRSx1QkFBdUJiLE1BQU1hLHFCQUFxQjtZQUNsREUsZUFBZWYsTUFBTWUsYUFBYTtZQUNsQ0Usa0JBQWtCakIsTUFBTWlCLGdCQUFnQjtZQUN4Q1Usa0JBQWtCM0IsTUFBTTJCLGdCQUFnQjtZQUN4Q0UsWUFBWTdCLE1BQU02QixVQUFVO1lBQzVCMEIsYUFBYXZELE1BQU11RCxXQUFXO1lBQzlCTyxZQUFZOUQsTUFBTThELFVBQVU7WUFDNUJDLHFCQUFxQi9ELE1BQU0rRCxtQkFBbUI7WUFDOUNFLGNBQWNqRSxNQUFNaUUsWUFBWTtRQUNsQyxDQUFBO0FBR08sTUFBTXJGLHFCQUFxQixJQUFNUiwwQkFBMEI0QixDQUFBQTtRQUNoRSxNQUFNWSxRQUFRWixNQUFNTCxlQUFlO1FBQ25DLE9BQU87WUFDTHlFLE9BQU94RCxNQUFNeUQsTUFBTTtZQUNuQkMsU0FBUzFELE1BQU1nQixNQUFNLENBQUNOLENBQUFBLElBQUtBLEVBQUVtQixNQUFNLEtBQUssV0FBVzRCLE1BQU07WUFDekRFLFVBQVUzRCxNQUFNZ0IsTUFBTSxDQUFDTixDQUFBQSxJQUFLQSxFQUFFbUIsTUFBTSxLQUFLLFlBQVk0QixNQUFNO1lBQzNERyxVQUFVNUQsTUFBTWdCLE1BQU0sQ0FBQ04sQ0FBQUEsSUFBS0EsRUFBRW1CLE1BQU0sS0FBSyxZQUFZNEIsTUFBTTtZQUMzREksYUFBYTdELE1BQU1nQixNQUFNLENBQUNOLENBQUFBLElBQUtBLEVBQUVtQixNQUFNLEtBQUssZ0JBQWdCNEIsTUFBTTtRQUNwRTtJQUNGO0FBRU8sTUFBTXZGLGtCQUFrQixJQUFNViwwQkFBMEI0QixDQUFBQSxRQUM3REEsTUFBTUwsZUFBZSxDQUFDK0UsT0FBTyxDQUFDcEQsQ0FBQUEsSUFBS0EsRUFBRW9DLEtBQUssQ0FBQzlCLE1BQU0sQ0FBQ2dDLENBQUFBLElBQUtBLEVBQUVuQixNQUFNLEtBQUs7QUFJL0QsTUFBTXRFLHVCQUF1QjtJQUNsQ3dHLGtCQUFrQixDQUFDckU7UUFDakIsTUFBTXNFLFNBQVM7WUFDYkMsZUFBZTtZQUNmQyxNQUFNO1lBQ05DLFlBQVk7WUFDWkMsWUFBWTtZQUNaQyxPQUFPO1FBQ1Q7UUFDQSxPQUFPTCxNQUFNLENBQUN0RSxLQUFLO0lBQ3JCO0lBRUE0RSxnQkFBZ0IsQ0FBQ3pDO1FBQ2YsTUFBTTBDLFNBQVM7WUFDYmIsU0FBUztZQUNUQyxVQUFVO1lBQ1ZDLFVBQVU7WUFDVlksY0FBYztRQUNoQjtRQUNBLE9BQU9ELE1BQU0sQ0FBQzFDLE9BQU87SUFDdkI7SUFFQTRDLGVBQWUsQ0FBQzdGO1FBQ2QsT0FBT0EsT0FBT3VDLElBQUksR0FBR3NDLE1BQU0sR0FBRztJQUNoQztBQUNGO0FBR08sTUFBTXhGLDRCQUE0QjtJQUN2QyxNQUFNeUcsUUFBUWxIO0lBRWQsT0FBTztRQUNMbUgsV0FBVyxDQUFDQztZQUNWLE9BQU9wSCwwQkFBMEJtSCxTQUFTLENBQUNDO1FBQzdDO1FBQ0F0RCxVQUFVLElBQU1vRDtJQUNsQjtBQUNGO0FBR08sTUFBTWhILHFCQUFxQjtJQUNoQyxNQUFNMEIsUUFBUTVCO0lBRWQsT0FBTztRQUNMNEI7UUFDQXlGLFNBQVNwSDtRQUNUcUgsT0FBTzlHO0lBQ1Q7QUFDRiJ9