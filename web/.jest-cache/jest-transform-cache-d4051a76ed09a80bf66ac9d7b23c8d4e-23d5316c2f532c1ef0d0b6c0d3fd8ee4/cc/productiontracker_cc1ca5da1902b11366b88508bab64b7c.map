{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/tests/jest/unit/performance/production-tracker.ts"],"sourcesContent":["/**\n * Production Performance Tracker\n * \n * Provides real-world performance tracking, user experience metrics,\n * regression detection, and advanced analytics for production environments.\n */\n\nexport interface ProductionMetrics {\n  sessionId: string;\n  userId?: string;\n  timestamp: Date;\n  userAgent: string;\n  deviceType: 'mobile' | 'tablet' | 'desktop';\n  connectionType: 'slow-2g' | '2g' | '3g' | '4g' | 'wifi' | 'ethernet';\n  viewport: { width: number; height: number };\n  performance: {\n    renderTime: number;\n    memoryUsage: number;\n    networkLatency: number;\n    apiResponseTime: number;\n    userInteractionTime: number;\n    pageLoadTime: number;\n    timeToInteractive: number;\n    firstContentfulPaint: number;\n    largestContentfulPaint: number;\n    cumulativeLayoutShift: number;\n  };\n  userExperience: {\n    satisfaction: number; // 1-5 scale\n    frustration: number; // 1-5 scale\n    taskCompletion: boolean;\n    errorRate: number;\n    bounceRate: boolean;\n    sessionDuration: number;\n  };\n  businessMetrics: {\n    conversionRate: number;\n    engagementScore: number;\n    retentionRate: number;\n    revenueImpact: number;\n  };\n}\n\nexport interface PerformanceRegression {\n  id: string;\n  componentName: string;\n  metric: string;\n  baselineValue: number;\n  currentValue: number;\n  changePercentage: number;\n  severity: 'low' | 'medium' | 'high' | 'critical';\n  detectedAt: Date;\n  resolvedAt?: Date;\n  impact: {\n    userExperience: number;\n    businessMetrics: number;\n    technicalDebt: number;\n  };\n}\n\nexport interface UserExperienceInsights {\n  overallScore: number;\n  topIssues: string[];\n  improvementOpportunities: string[];\n  userSegments: {\n    highPerformers: string[];\n    strugglingUsers: string[];\n    atRiskUsers: string[];\n  };\n  recommendations: string[];\n  predictedImpact: number;\n}\n\nexport interface ProductionAnalytics {\n  performanceTrends: {\n    period: string;\n    averageRenderTime: number;\n    averageMemoryUsage: number;\n    averageUserSatisfaction: number;\n    trend: 'improving' | 'stable' | 'declining';\n  }[];\n  userExperienceMetrics: {\n    satisfactionDistribution: { score: number; percentage: number }[];\n    taskCompletionRate: number;\n    errorRate: number;\n    bounceRate: number;\n  };\n  businessImpact: {\n    conversionImpact: number;\n    revenueImpact: number;\n    userRetentionImpact: number;\n  };\n  technicalHealth: {\n    performanceScore: number;\n    stabilityScore: number;\n    scalabilityScore: number;\n    maintainabilityScore: number;\n  };\n}\n\nexport class ProductionTracker {\n  private metrics: ProductionMetrics[] = [];\n  private regressions: PerformanceRegression[] = [];\n  private baselineMetrics: Map<string, number> = new Map();\n  private isTracking: boolean = false;\n  private sessionId: string = '';\n\n  /**\n   * Start production tracking session\n   */\n  startTracking(sessionId: string, userId?: string): void {\n    this.sessionId = sessionId;\n    this.isTracking = true;\n    \n    console.log(`üè≠ Starting production tracking for session: ${sessionId}`);\n    if (userId) {\n      console.log(`üë§ User ID: ${userId}`);\n    }\n  }\n\n  /**\n   * Stop production tracking\n   */\n  stopTracking(): void {\n    this.isTracking = false;\n    console.log(`üè≠ Production tracking stopped for session: ${this.sessionId}`);\n  }\n\n  /**\n   * Record production performance metrics\n   */\n  recordProductionMetrics(metrics: Omit<ProductionMetrics, 'sessionId' | 'timestamp'>): void {\n    if (!this.isTracking) {\n      console.warn('‚ö†Ô∏è Production tracking not started. Call startTracking() first.');\n      return;\n    }\n\n    const fullMetrics: ProductionMetrics = {\n      ...metrics,\n      sessionId: this.sessionId,\n      timestamp: new Date(),\n    };\n\n    this.metrics.push(fullMetrics);\n    \n    // Check for performance regressions\n    this.checkForRegressions(fullMetrics);\n    \n    // Update baseline metrics\n    this.updateBaselineMetrics(fullMetrics);\n    \n    console.log(`üìä Production metrics recorded:`);\n    console.log(`- Render Time: ${fullMetrics.performance.renderTime.toFixed(2)}ms`);\n    console.log(`- Memory Usage: ${fullMetrics.performance.memoryUsage.toFixed(2)}MB`);\n    console.log(`- User Satisfaction: ${fullMetrics.userExperience.satisfaction}/5`);\n    console.log(`- Task Completion: ${fullMetrics.userExperience.taskCompletion ? 'Yes' : 'No'}`);\n  }\n\n  /**\n   * Check for performance regressions\n   */\n  private checkForRegressions(metrics: ProductionMetrics): void {\n    const performanceKeys = Object.keys(metrics.performance) as Array<keyof typeof metrics.performance>;\n    \n    performanceKeys.forEach(key => {\n      const currentValue = metrics.performance[key];\n      const baselineKey = `${metrics.deviceType}_${key}`;\n      const baselineValue = this.baselineMetrics.get(baselineKey);\n      \n      if (baselineValue !== undefined) {\n        const changePercentage = ((currentValue - baselineValue) / baselineValue) * 100;\n        \n        // Define regression thresholds\n        const thresholds = {\n          renderTime: 20, // 20% increase\n          memoryUsage: 30, // 30% increase\n          networkLatency: 25, // 25% increase\n          apiResponseTime: 30, // 30% increase\n          userInteractionTime: 15, // 15% increase\n          pageLoadTime: 25, // 25% increase\n          timeToInteractive: 20, // 20% increase\n          firstContentfulPaint: 15, // 15% increase\n          largestContentfulPaint: 20, // 20% increase\n          cumulativeLayoutShift: 50, // 50% increase\n        };\n        \n        const threshold = thresholds[key] || 20;\n        \n        if (changePercentage > threshold) {\n          const severity = this.calculateRegressionSeverity(changePercentage, key);\n          \n          const regression: PerformanceRegression = {\n            id: `regression_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n            componentName: 'Production Performance',\n            metric: key,\n            baselineValue,\n            currentValue,\n            changePercentage,\n            severity,\n            detectedAt: new Date(),\n            impact: {\n              userExperience: this.calculateUserExperienceImpact(changePercentage, key),\n              businessMetrics: this.calculateBusinessImpact(changePercentage, key),\n              technicalDebt: this.calculateTechnicalDebtImpact(changePercentage, key),\n            },\n          };\n          \n          this.regressions.push(regression);\n          \n          console.log(`üö® Performance regression detected:`);\n          console.log(`- Metric: ${key}`);\n          console.log(`- Change: +${changePercentage.toFixed(2)}%`);\n          console.log(`- Severity: ${severity.toUpperCase()}`);\n        }\n      }\n    });\n  }\n\n  /**\n   * Calculate regression severity\n   */\n  private calculateRegressionSeverity(changePercentage: number, metric: string): 'low' | 'medium' | 'high' | 'critical' {\n    if (changePercentage > 100) return 'critical';\n    if (changePercentage > 50) return 'high';\n    if (changePercentage > 25) return 'medium';\n    return 'low';\n  }\n\n  /**\n   * Calculate user experience impact\n   */\n  private calculateUserExperienceImpact(changePercentage: number, metric: string): number {\n    const impactFactors = {\n      renderTime: 0.8,\n      memoryUsage: 0.6,\n      networkLatency: 0.7,\n      apiResponseTime: 0.9,\n      userInteractionTime: 0.95,\n      pageLoadTime: 0.85,\n      timeToInteractive: 0.9,\n      firstContentfulPaint: 0.8,\n      largestContentfulPaint: 0.7,\n      cumulativeLayoutShift: 0.6,\n    };\n    \n    const factor = impactFactors[metric as keyof typeof impactFactors] || 0.5;\n    return Math.min(100, changePercentage * factor);\n  }\n\n  /**\n   * Calculate business impact\n   */\n  private calculateBusinessImpact(changePercentage: number, metric: string): number {\n    const businessFactors = {\n      renderTime: 0.3,\n      memoryUsage: 0.2,\n      networkLatency: 0.4,\n      apiResponseTime: 0.6,\n      userInteractionTime: 0.7,\n      pageLoadTime: 0.5,\n      timeToInteractive: 0.6,\n      firstContentfulPaint: 0.4,\n      largestContentfulPaint: 0.3,\n      cumulativeLayoutShift: 0.2,\n    };\n    \n    const factor = businessFactors[metric as keyof typeof businessFactors] || 0.3;\n    return Math.min(100, changePercentage * factor);\n  }\n\n  /**\n   * Calculate technical debt impact\n   */\n  private calculateTechnicalDebtImpact(changePercentage: number, metric: string): number {\n    const debtFactors = {\n      renderTime: 0.4,\n      memoryUsage: 0.8,\n      networkLatency: 0.3,\n      apiResponseTime: 0.5,\n      userInteractionTime: 0.3,\n      pageLoadTime: 0.4,\n      timeToInteractive: 0.3,\n      firstContentfulPaint: 0.2,\n      largestContentfulPaint: 0.2,\n      cumulativeLayoutShift: 0.1,\n    };\n    \n    const factor = debtFactors[metric as keyof typeof debtFactors] || 0.4;\n    return Math.min(100, changePercentage * factor);\n  }\n\n  /**\n   * Update baseline metrics\n   */\n  private updateBaselineMetrics(metrics: ProductionMetrics): void {\n    const performanceKeys = Object.keys(metrics.performance) as Array<keyof typeof metrics.performance>;\n    \n    performanceKeys.forEach(key => {\n      const baselineKey = `${metrics.deviceType}_${key}`;\n      const currentValue = metrics.performance[key];\n      const existingBaseline = this.baselineMetrics.get(baselineKey);\n      \n      if (existingBaseline === undefined) {\n        // Set initial baseline\n        this.baselineMetrics.set(baselineKey, currentValue);\n      } else {\n        // Update baseline with exponential moving average\n        const alpha = 0.1; // Learning rate\n        const newBaseline = (alpha * currentValue) + ((1 - alpha) * existingBaseline);\n        this.baselineMetrics.set(baselineKey, newBaseline);\n      }\n    });\n  }\n\n  /**\n   * Generate user experience insights\n   */\n  generateUserExperienceInsights(): UserExperienceInsights {\n    if (this.metrics.length === 0) {\n      return {\n        overallScore: 0,\n        topIssues: ['No data available'],\n        improvementOpportunities: [],\n        userSegments: {\n          highPerformers: [],\n          strugglingUsers: [],\n          atRiskUsers: [],\n        },\n        recommendations: ['Start collecting user experience data'],\n        predictedImpact: 0,\n      };\n    }\n\n    const satisfactionScores = this.metrics.map(m => m.userExperience.satisfaction);\n    const averageSatisfaction = satisfactionScores.reduce((sum, score) => sum + score, 0) / satisfactionScores.length;\n    \n    const taskCompletionRate = this.metrics.filter(m => m.userExperience.taskCompletion).length / this.metrics.length;\n    const errorRate = this.metrics.reduce((sum, m) => sum + m.userExperience.errorRate, 0) / this.metrics.length;\n    \n    // Calculate overall score\n    const overallScore = (averageSatisfaction * 20) + (taskCompletionRate * 30) + ((1 - errorRate) * 50);\n    \n    // Identify top issues\n    const topIssues: string[] = [];\n    if (averageSatisfaction < 3) topIssues.push('Low user satisfaction');\n    if (taskCompletionRate < 0.7) topIssues.push('Poor task completion rate');\n    if (errorRate > 0.1) topIssues.push('High error rate');\n    \n    // Identify improvement opportunities\n    const improvementOpportunities: string[] = [];\n    if (averageSatisfaction < 4) improvementOpportunities.push('Improve user satisfaction');\n    if (taskCompletionRate < 0.8) improvementOpportunities.push('Enhance task completion');\n    if (errorRate > 0.05) improvementOpportunities.push('Reduce error rate');\n    \n    // Segment users\n    const highPerformers = this.metrics.filter(m => \n      m.userExperience.satisfaction >= 4 && \n      m.userExperience.taskCompletion && \n      m.userExperience.errorRate < 0.05\n    ).map(m => m.sessionId);\n    \n    const strugglingUsers = this.metrics.filter(m => \n      m.userExperience.satisfaction < 3 || \n      !m.userExperience.taskCompletion || \n      m.userExperience.errorRate > 0.1\n    ).map(m => m.sessionId);\n    \n    const atRiskUsers = this.metrics.filter(m => \n      m.userExperience.satisfaction < 4 && \n      m.userExperience.satisfaction >= 3\n    ).map(m => m.sessionId);\n    \n    // Generate recommendations\n    const recommendations: string[] = [];\n    if (averageSatisfaction < 4) {\n      recommendations.push('Focus on user experience improvements');\n    }\n    if (taskCompletionRate < 0.8) {\n      recommendations.push('Simplify user workflows');\n    }\n    if (errorRate > 0.05) {\n      recommendations.push('Improve error handling and user guidance');\n    }\n    \n    const predictedImpact = Math.max(0, 100 - overallScore);\n    \n    return {\n      overallScore,\n      topIssues,\n      improvementOpportunities,\n      userSegments: {\n        highPerformers,\n        strugglingUsers,\n        atRiskUsers,\n      },\n      recommendations,\n      predictedImpact,\n    };\n  }\n\n  /**\n   * Generate production analytics\n   */\n  generateProductionAnalytics(): ProductionAnalytics {\n    if (this.metrics.length === 0) {\n      return {\n        performanceTrends: [],\n        userExperienceMetrics: {\n          satisfactionDistribution: [],\n          taskCompletionRate: 0,\n          errorRate: 0,\n          bounceRate: 0,\n        },\n        businessImpact: {\n          conversionImpact: 0,\n          revenueImpact: 0,\n          userRetentionImpact: 0,\n        },\n        technicalHealth: {\n          performanceScore: 0,\n          stabilityScore: 0,\n          scalabilityScore: 0,\n          maintainabilityScore: 0,\n        },\n      };\n    }\n\n    // Calculate performance trends\n    const performanceTrends = this.calculatePerformanceTrends();\n    \n    // Calculate user experience metrics\n    const userExperienceMetrics = this.calculateUserExperienceMetrics();\n    \n    // Calculate business impact\n    const businessImpact = this.calculateBusinessImpact();\n    \n    // Calculate technical health\n    const technicalHealth = this.calculateTechnicalHealth();\n    \n    return {\n      performanceTrends,\n      userExperienceMetrics,\n      businessImpact,\n      technicalHealth,\n    };\n  }\n\n  /**\n   * Calculate performance trends\n   */\n  private calculatePerformanceTrends(): ProductionAnalytics['performanceTrends'] {\n    // Group metrics by time periods (simplified for demo)\n    const periods = ['Week 1', 'Week 2', 'Week 3', 'Week 4'];\n    \n    return periods.map(period => {\n      const periodMetrics = this.metrics.slice(0, Math.floor(this.metrics.length / 4));\n      const averageRenderTime = periodMetrics.reduce((sum, m) => sum + m.performance.renderTime, 0) / periodMetrics.length;\n      const averageMemoryUsage = periodMetrics.reduce((sum, m) => sum + m.performance.memoryUsage, 0) / periodMetrics.length;\n      const averageUserSatisfaction = periodMetrics.reduce((sum, m) => sum + m.userExperience.satisfaction, 0) / periodMetrics.length;\n      \n      return {\n        period,\n        averageRenderTime,\n        averageMemoryUsage,\n        averageUserSatisfaction,\n        trend: 'stable' as const,\n      };\n    });\n  }\n\n  /**\n   * Calculate user experience metrics\n   */\n  private calculateUserExperienceMetrics(): ProductionAnalytics['userExperienceMetrics'] {\n    const satisfactionScores = this.metrics.map(m => m.userExperience.satisfaction);\n    const satisfactionDistribution = [1, 2, 3, 4, 5].map(score => ({\n      score,\n      percentage: (satisfactionScores.filter(s => s === score).length / satisfactionScores.length) * 100,\n    }));\n    \n    const taskCompletionRate = this.metrics.filter(m => m.userExperience.taskCompletion).length / this.metrics.length;\n    const errorRate = this.metrics.reduce((sum, m) => sum + m.userExperience.errorRate, 0) / this.metrics.length;\n    const bounceRate = this.metrics.filter(m => m.userExperience.bounceRate).length / this.metrics.length;\n    \n    return {\n      satisfactionDistribution,\n      taskCompletionRate,\n      errorRate,\n      bounceRate,\n    };\n  }\n\n  /**\n   * Calculate business impact\n   */\n  private calculateBusinessImpact(): ProductionAnalytics['businessImpact'] {\n    const averageSatisfaction = this.metrics.reduce((sum, m) => sum + m.userExperience.satisfaction, 0) / this.metrics.length;\n    const taskCompletionRate = this.metrics.filter(m => m.userExperience.taskCompletion).length / this.metrics.length;\n    const averageRevenueImpact = this.metrics.reduce((sum, m) => sum + m.businessMetrics.revenueImpact, 0) / this.metrics.length;\n    \n    return {\n      conversionImpact: (averageSatisfaction - 3) * 10, // Simplified calculation\n      revenueImpact: averageRevenueImpact,\n      userRetentionImpact: taskCompletionRate * 20,\n    };\n  }\n\n  /**\n   * Calculate technical health\n   */\n  private calculateTechnicalHealth(): ProductionAnalytics['technicalHealth'] {\n    const averageRenderTime = this.metrics.reduce((sum, m) => sum + m.performance.renderTime, 0) / this.metrics.length;\n    const averageMemoryUsage = this.metrics.reduce((sum, m) => sum + m.performance.memoryUsage, 0) / this.metrics.length;\n    const errorRate = this.metrics.reduce((sum, m) => sum + m.userExperience.errorRate, 0) / this.metrics.length;\n    \n    const performanceScore = Math.max(0, 100 - (averageRenderTime / 10));\n    const stabilityScore = Math.max(0, 100 - (errorRate * 1000));\n    const scalabilityScore = Math.max(0, 100 - (averageMemoryUsage * 5));\n    const maintainabilityScore = 85; // Simplified calculation\n    \n    return {\n      performanceScore,\n      stabilityScore,\n      scalabilityScore,\n      maintainabilityScore,\n    };\n  }\n\n  /**\n   * Get active regressions\n   */\n  getActiveRegressions(): PerformanceRegression[] {\n    return this.regressions.filter(r => !r.resolvedAt);\n  }\n\n  /**\n   * Resolve regression\n   */\n  resolveRegression(regressionId: string): void {\n    const regression = this.regressions.find(r => r.id === regressionId);\n    if (regression) {\n      regression.resolvedAt = new Date();\n      console.log(`‚úÖ Regression resolved: ${regressionId}`);\n    }\n  }\n\n  /**\n   * Get production metrics for a specific session\n   */\n  getSessionMetrics(sessionId: string): ProductionMetrics[] {\n    return this.metrics.filter(m => m.sessionId === sessionId);\n  }\n\n  /**\n   * Clear all production data\n   */\n  clear(): void {\n    this.metrics = [];\n    this.regressions = [];\n    this.baselineMetrics.clear();\n    this.isTracking = false;\n    this.sessionId = '';\n  }\n\n  /**\n   * Export production data\n   */\n  exportProductionData(): string {\n    return JSON.stringify({\n      metrics: this.metrics,\n      regressions: this.regressions,\n      baselineMetrics: Object.fromEntries(this.baselineMetrics),\n      insights: this.generateUserExperienceInsights(),\n      analytics: this.generateProductionAnalytics(),\n    }, null, 2);\n  }\n}\n\n// Global production tracker instance\nexport const productionTracker = new ProductionTracker();\n"],"names":["ProductionTracker","productionTracker","startTracking","sessionId","userId","isTracking","console","log","stopTracking","recordProductionMetrics","metrics","warn","fullMetrics","timestamp","Date","push","checkForRegressions","updateBaselineMetrics","performance","renderTime","toFixed","memoryUsage","userExperience","satisfaction","taskCompletion","performanceKeys","Object","keys","forEach","key","currentValue","baselineKey","deviceType","baselineValue","baselineMetrics","get","undefined","changePercentage","thresholds","networkLatency","apiResponseTime","userInteractionTime","pageLoadTime","timeToInteractive","firstContentfulPaint","largestContentfulPaint","cumulativeLayoutShift","threshold","severity","calculateRegressionSeverity","regression","id","now","Math","random","toString","substr","componentName","metric","detectedAt","impact","calculateUserExperienceImpact","businessMetrics","calculateBusinessImpact","technicalDebt","calculateTechnicalDebtImpact","regressions","toUpperCase","impactFactors","factor","min","businessFactors","debtFactors","existingBaseline","set","alpha","newBaseline","generateUserExperienceInsights","length","overallScore","topIssues","improvementOpportunities","userSegments","highPerformers","strugglingUsers","atRiskUsers","recommendations","predictedImpact","satisfactionScores","map","m","averageSatisfaction","reduce","sum","score","taskCompletionRate","filter","errorRate","max","generateProductionAnalytics","performanceTrends","userExperienceMetrics","satisfactionDistribution","bounceRate","businessImpact","conversionImpact","revenueImpact","userRetentionImpact","technicalHealth","performanceScore","stabilityScore","scalabilityScore","maintainabilityScore","calculatePerformanceTrends","calculateUserExperienceMetrics","calculateTechnicalHealth","periods","period","periodMetrics","slice","floor","averageRenderTime","averageMemoryUsage","averageUserSatisfaction","trend","percentage","s","averageRevenueImpact","getActiveRegressions","r","resolvedAt","resolveRegression","regressionId","find","getSessionMetrics","clear","exportProductionData","JSON","stringify","fromEntries","insights","analytics","Map"],"mappings":"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"}