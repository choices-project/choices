{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/lib/stores/userStore.ts"],"sourcesContent":["/**\n * User Store - Zustand Implementation\n * \n * Centralized user state management including authentication, profile,\n * preferences, and settings. Consolidates AuthContext and user-related state.\n * \n * Created: October 10, 2025\n * Status: âœ… ACTIVE\n */\n\nimport type { User, Session } from '@supabase/supabase-js';\nimport { create } from 'zustand';\nimport { devtools } from 'zustand/middleware';\nimport { persist } from 'zustand/middleware';\nimport { immer } from 'zustand/middleware/immer';\n\nimport { withOptional } from '@/lib/utils/objects';\n\nimport type { UserProfile, BaseStore } from './types';\n\n// Profile editing types\nexport interface ProfileUpdateData {\n  displayname: string;\n  bio: string;\n  username: string;\n  primaryconcerns: string[];\n  communityfocus: string[];\n  participationstyle: 'observer' | 'participant' | 'leader' | 'organizer';\n  privacysettings: {\n    profile_visibility: 'public' | 'private' | 'friends';\n    show_email: boolean;\n    show_activity: boolean;\n    allow_messages: boolean;\n    share_demographics: boolean;\n    allow_analytics: boolean;\n  };\n}\n\nexport interface Representative {\n  id: string;\n  name: string;\n  title: string;\n  party: string;\n  district: string;\n  state: string;\n  phone?: string;\n  email?: string;\n  website?: string;\n  photo?: string;\n  socialMedia?: {\n    twitter?: string;\n    facebook?: string;\n    instagram?: string;\n  };\n}\n\n// User store state interface\ntype UserStore = {\n  // Authentication state\n  user: User | null;\n  session: Session | null;\n  isAuthenticated: boolean;\n  \n  // User profile data\n  profile: UserProfile | null;\n  \n  // Profile editing state\n  profileEditData: ProfileUpdateData | null;\n  isProfileEditing: boolean;\n  profileEditErrors: Record<string, string>;\n  \n  // Address and representatives\n  currentAddress: string;\n  currentState: string;\n  representatives: Representative[];\n  showAddressForm: boolean;\n  newAddress: string;\n  addressLoading: boolean;\n  savedSuccessfully: boolean;\n  \n  // Avatar editing\n  avatarFile: File | null;\n  avatarPreview: string | null;\n  isUploadingAvatar: boolean;\n  \n  // Biometric state\n  biometric: {\n    isSupported: boolean | null;\n    isAvailable: boolean | null;\n    hasCredentials: boolean | null;\n    isRegistering: boolean;\n    error: string | null;\n    success: boolean;\n  };\n  \n  // Loading states\n  isProfileLoading: boolean;\n  isUpdating: boolean;\n  \n  // Actions - Authentication\n  setUser: (user: User | null) => void;\n  setSession: (session: Session | null) => void;\n  setAuthenticated: (authenticated: boolean) => void;\n  signOut: () => void;\n  clearUser: () => void;\n  \n  // Actions - Profile Editing\n  setProfileEditData: (data: ProfileUpdateData) => void;\n  updateProfileEditData: (updates: Partial<ProfileUpdateData>) => void;\n  updateProfileField: (field: keyof ProfileUpdateData, value: any) => void;\n  updateArrayField: (field: 'primaryconcerns' | 'communityfocus', value: string) => void;\n  updatePrivacySetting: (setting: keyof ProfileUpdateData['privacysettings'], value: any) => void;\n  setProfileEditing: (editing: boolean) => void;\n  setProfileEditError: (field: string, error: string) => void;\n  clearProfileEditError: (field: string) => void;\n  clearAllProfileEditErrors: () => void;\n  \n  // Actions - Address and Representatives\n  setCurrentAddress: (address: string) => void;\n  setCurrentState: (state: string) => void;\n  setRepresentatives: (representatives: Representative[]) => void;\n  addRepresentative: (representative: Representative) => void;\n  removeRepresentative: (id: string) => void;\n  setShowAddressForm: (show: boolean) => void;\n  setNewAddress: (address: string) => void;\n  setAddressLoading: (loading: boolean) => void;\n  setSavedSuccessfully: (saved: boolean) => void;\n  lookupAddress: (address: string) => Promise<Representative[]>;\n  handleAddressUpdate: (address: string) => Promise<void>;\n  \n  // Actions - Avatar\n  setAvatarFile: (file: File | null) => void;\n  setAvatarPreview: (preview: string | null) => void;\n  setUploadingAvatar: (uploading: boolean) => void;\n  clearAvatar: () => void;\n  \n  // Actions - Profile\n  setProfile: (profile: UserProfile | null) => void;\n  updateProfile: (updates: Partial<UserProfile>) => void;\n  updatePreferences: (preferences: Partial<UserProfile['preferences']>) => void;\n  updateSettings: (settings: Partial<UserProfile['settings']>) => void;\n  updateMetadata: (metadata: Partial<UserProfile['metadata']>) => void;\n  \n  // Actions - Biometric\n  setBiometricSupported: (supported: boolean) => void;\n  setBiometricAvailable: (available: boolean) => void;\n  setBiometricCredentials: (hasCredentials: boolean) => void;\n  setBiometricRegistering: (registering: boolean) => void;\n  setBiometricError: (error: string | null) => void;\n  setBiometricSuccess: (success: boolean) => void;\n  resetBiometric: () => void;\n  \n  // Actions - Loading states\n  setProfileLoading: (loading: boolean) => void;\n  setUpdating: (updating: boolean) => void;\n  \n  // Actions - Error handling\n  setUserError: (error: string | null) => void;\n  clearUserError: () => void;\n} & BaseStore\n\n// Create user store with middleware\nexport const useUserStore = create<UserStore>()(\n  devtools(\n    persist(\n      immer((set, _get) => ({\n      // Initial state\n      user: null,\n      session: null,\n      isAuthenticated: false,\n      profile: null,\n      \n      // Profile editing state\n      profileEditData: null,\n      isProfileEditing: false,\n      profileEditErrors: {},\n      \n      // Address and representatives\n      currentAddress: '',\n      currentState: '',\n      representatives: [],\n      showAddressForm: false,\n      newAddress: '',\n      addressLoading: false,\n      savedSuccessfully: false,\n      \n      // Avatar editing\n      avatarFile: null,\n      avatarPreview: null,\n      isUploadingAvatar: false,\n      \n      biometric: {\n        isSupported: null,\n        isAvailable: null,\n        hasCredentials: null,\n        isRegistering: false,\n        error: null,\n        success: false,\n      },\n      isLoading: false,\n      isProfileLoading: false,\n      isUpdating: false,\n      error: null,\n      \n      // Base store actions\n      setLoading: (loading) => set((state) => {\n        state.isLoading = loading;\n      }),\n      \n      setError: (error) => set((state) => {\n        state.error = error;\n      }),\n      \n      clearError: () => set((state) => {\n        state.error = null;\n      }),\n      \n      // Authentication actions\n      setUser: (user) => set((state) => {\n        // Only update if the user is actually different\n        if (state.user !== user) {\n          state.user = user;\n          state.isAuthenticated = !!user;\n          \n          // Log authentication state change\n          if (user) {\n          } else {\n          }\n        }\n      }),\n      \n      setSession: (session) => set((state) => {\n        state.session = session;\n        \n        // Only update user and authentication state if they're different\n        // This prevents infinite loops when the same session is set multiple times\n        const newUser = session?.user || null;\n        const newAuthenticated = !!newUser;\n        \n        if (state.user !== newUser) {\n          state.user = newUser;\n        }\n        if (state.isAuthenticated !== newAuthenticated) {\n          state.isAuthenticated = newAuthenticated;\n        }\n      }),\n      \n      setAuthenticated: (authenticated) => set((state) => {\n        // Only update if the authentication state is actually different\n        if (state.isAuthenticated !== authenticated) {\n          state.isAuthenticated = authenticated;\n          \n          if (!authenticated) {\n            state.user = null;\n            state.session = null;\n            state.profile = null;\n          }\n        }\n      }),\n      \n      signOut: () => set((state) => {\n        state.user = null;\n        state.session = null;\n        state.profile = null;\n        state.isAuthenticated = false;\n        state.error = null;\n        \n      }),\n      \n      clearUser: () => set((state) => {\n        state.user = null;\n        state.session = null;\n        state.profile = null;\n        state.isAuthenticated = false;\n        state.error = null;\n        state.isLoading = false;\n        state.isProfileLoading = false;\n        state.isUpdating = false;\n      }),\n      \n      // Profile actions\n      setProfile: (profile) => set((state) => {\n        state.profile = profile;\n        \n        if (profile) {\n        }\n      }),\n      \n      updateProfile: (updates) => set((state) => {\n        if (state.profile) {\n          state.profile = { ...state.profile, ...updates };\n          state.profile.metadata.updatedAt = new Date().toISOString();\n        }\n      }),\n      \n      updatePreferences: (preferences) => set((state) => {\n        if (state.profile) {\n          state.profile.preferences = { ...state.profile.preferences, ...preferences };\n          state.profile.metadata.updatedAt = new Date().toISOString();\n        }\n      }),\n      \n      updateSettings: (settings) => set((state) => {\n        if (state.profile) {\n          state.profile.settings = { ...state.profile.settings, ...settings };\n          state.profile.metadata.updatedAt = new Date().toISOString();\n        }\n      }),\n      \n      updateMetadata: (metadata) => set((state) => {\n        if (state.profile) {\n          state.profile.metadata = { ...state.profile.metadata, ...metadata };\n        }\n      }),\n      \n      // Loading state actions\n      setProfileLoading: (loading) => set((state) => {\n        state.isProfileLoading = loading;\n      }),\n      \n      setUpdating: (updating) => set((state) => {\n        state.isUpdating = updating;\n      }),\n      \n      // Biometric actions\n      setBiometricSupported: (supported) => set((state) => {\n        state.biometric.isSupported = supported;\n      }),\n      \n      setBiometricAvailable: (available) => set((state) => {\n        state.biometric.isAvailable = available;\n      }),\n      \n      setBiometricCredentials: (hasCredentials) => set((state) => {\n        state.biometric.hasCredentials = hasCredentials;\n      }),\n      \n      setBiometricRegistering: (registering) => set((state) => {\n        state.biometric.isRegistering = registering;\n      }),\n      \n      setBiometricError: (error) => set((state) => {\n        state.biometric.error = error;\n      }),\n      \n      setBiometricSuccess: (success) => set((state) => {\n        state.biometric.success = success;\n      }),\n      \n      resetBiometric: () => set((state) => {\n        state.biometric = {\n          isSupported: null,\n          isAvailable: null,\n          hasCredentials: null,\n          isRegistering: false,\n          error: null,\n          success: false,\n        };\n      }),\n      \n      // Profile editing actions\n      setProfileEditData: (data) => set((state) => {\n        state.profileEditData = data;\n      }),\n      \n      updateProfileEditData: (updates) => set((state) => {\n        if (state.profileEditData) {\n          state.profileEditData = { ...state.profileEditData, ...updates };\n        }\n      }),\n      \n      updateProfileField: (field, value) => set((state) => {\n        if (state.profileEditData) {\n          state.profileEditData[field] = value;\n        }\n      }),\n      \n      updateArrayField: (field, value) => set((state) => {\n        if (state.profileEditData) {\n          const currentArray = state.profileEditData[field] || [];\n          const newArray = currentArray.includes(value)\n            ? currentArray.filter(item => item !== value)\n            : [...currentArray, value];\n          state.profileEditData[field] = newArray;\n        }\n      }),\n      \n      updatePrivacySetting: (setting, value) => set((state) => {\n        if (state.profileEditData) {\n          (state.profileEditData.privacysettings as any)[setting] = value;\n        }\n      }),\n      \n      setProfileEditing: (editing) => set((state) => {\n        state.isProfileEditing = editing;\n      }),\n      \n      setProfileEditError: (field, error) => set((state) => {\n        state.profileEditErrors[field] = error;\n      }),\n      \n      clearProfileEditError: (field) => set((state) => {\n        delete state.profileEditErrors[field];\n      }),\n      \n      clearAllProfileEditErrors: () => set((state) => {\n        state.profileEditErrors = {};\n      }),\n      \n      // Address and representatives actions\n      setCurrentAddress: (address) => set((state) => {\n        state.currentAddress = address;\n      }),\n      \n      setCurrentState: (stateValue) => set((state) => {\n        state.currentState = stateValue;\n      }),\n      \n      setRepresentatives: (representatives) => set((state) => {\n        state.representatives = representatives;\n      }),\n      \n      addRepresentative: (representative) => set((state) => {\n        const existingIndex = state.representatives.findIndex(rep => rep.id === representative.id);\n        if (existingIndex === -1) {\n          state.representatives.push(representative);\n        }\n      }),\n      \n      removeRepresentative: (id) => set((state) => {\n        state.representatives = state.representatives.filter(rep => rep.id !== id);\n      }),\n      \n      setShowAddressForm: (show) => set((state) => {\n        state.showAddressForm = show;\n      }),\n      \n      setNewAddress: (address) => set((state) => {\n        state.newAddress = address;\n      }),\n      \n      setAddressLoading: (loading) => set((state) => {\n        state.addressLoading = loading;\n      }),\n      \n      setSavedSuccessfully: (saved) => set((state) => {\n        state.savedSuccessfully = saved;\n      }),\n      \n      lookupAddress: async (address) => {\n        try {\n          const response = await fetch(`/api/civics/by-address?address=${encodeURIComponent(address)}`);\n          if (!response.ok) {\n            throw new Error('Address lookup failed');\n          }\n          const result = await response.json();\n          return result.data || [];\n        } catch (error) {\n          console.error('Address lookup failed:', error);\n          throw error;\n        }\n      },\n      \n      handleAddressUpdate: async (address) => {\n        const currentState = _get();\n        set((state) => {\n          state.addressLoading = true;\n        });\n        \n        try {\n          const representatives = await currentState.lookupAddress(address);\n          \n          set((state) => {\n            state.currentAddress = address;\n            state.representatives = representatives;\n            state.showAddressForm = false;\n            state.newAddress = '';\n            state.savedSuccessfully = true;\n            state.addressLoading = false;\n          });\n          \n          // Clear success message after 3 seconds\n          setTimeout(() => {\n            set((state) => {\n              state.savedSuccessfully = false;\n            });\n          }, 3000);\n          \n        } catch (error) {\n          console.error('Address update failed:', error);\n          set((state) => {\n            state.addressLoading = false;\n            state.savedSuccessfully = false;\n          });\n          throw error;\n        }\n      },\n      \n      // Avatar actions\n      setAvatarFile: (file) => set((state) => {\n        state.avatarFile = file;\n      }),\n      \n      setAvatarPreview: (preview) => set((state) => {\n        state.avatarPreview = preview;\n      }),\n      \n      setUploadingAvatar: (uploading) => set((state) => {\n        state.isUploadingAvatar = uploading;\n      }),\n      \n      clearAvatar: () => set((state) => {\n        state.avatarFile = null;\n        state.avatarPreview = null;\n      }),\n      \n      // Error handling actions\n      setUserError: (error) => set((state) => {\n        state.error = error;\n        \n        if (error) {\n          console.error('User store error:', error);\n        }\n      }),\n      \n      clearUserError: () => set((state) => {\n        state.error = null;\n      }),\n    })),\n    {\n      name: 'user-store',\n      partialize: (state) => ({\n        profile: state.profile,\n        isAuthenticated: state.isAuthenticated,\n      }),\n    }\n  ),\n  { name: 'user-store' }\n));\n\n// Store selectors for optimized re-renders\nexport const useUser = () => useUserStore(state => state.user);\nexport const useSession = () => useUserStore(state => state.session);\nexport const useIsAuthenticated = () => useUserStore(state => state.isAuthenticated);\nexport const useUserProfile = () => useUserStore(state => state.profile);\nexport const useUserPreferences = () => useUserStore(state => state.profile?.preferences);\nexport const useUserSettings = () => useUserStore(state => state.profile?.settings);\nexport const useUserLoading = () => useUserStore(state => state.isLoading);\nexport const useUserError = () => useUserStore(state => state.error);\n\n// Biometric selectors\nexport const useBiometric = () => useUserStore(state => state.biometric);\nexport const useBiometricSupported = () => useUserStore(state => state.biometric.isSupported);\nexport const useBiometricAvailable = () => useUserStore(state => state.biometric.isAvailable);\nexport const useBiometricCredentials = () => useUserStore(state => state.biometric.hasCredentials);\nexport const useBiometricRegistering = () => useUserStore(state => state.biometric.isRegistering);\nexport const useBiometricError = () => useUserStore(state => state.biometric.error);\nexport const useBiometricSuccess = () => useUserStore(state => state.biometric.success);\n\n// Action selectors\nexport const useUserActions = () => useUserStore(state => ({\n  setUser: state.setUser,\n  setSession: state.setSession,\n  setAuthenticated: state.setAuthenticated,\n  signOut: state.signOut,\n  clearUser: state.clearUser,\n  setProfile: state.setProfile,\n  updateProfile: state.updateProfile,\n  updatePreferences: state.updatePreferences,\n  updateSettings: state.updateSettings,\n  updateMetadata: state.updateMetadata,\n  setProfileLoading: state.setProfileLoading,\n  setUpdating: state.setUpdating,\n  setUserError: state.setUserError,\n  clearUserError: state.clearUserError,\n  setBiometricSupported: state.setBiometricSupported,\n  setBiometricAvailable: state.setBiometricAvailable,\n  setBiometricCredentials: state.setBiometricCredentials,\n  setBiometricRegistering: state.setBiometricRegistering,\n  setBiometricError: state.setBiometricError,\n  setBiometricSuccess: state.setBiometricSuccess,\n  resetBiometric: state.resetBiometric,\n  // Profile editing actions\n  setProfileEditData: state.setProfileEditData,\n  updateProfileEditData: state.updateProfileEditData,\n  updateProfileField: state.updateProfileField,\n  updateArrayField: state.updateArrayField,\n  updatePrivacySetting: state.updatePrivacySetting,\n  setProfileEditing: state.setProfileEditing,\n  setProfileEditError: state.setProfileEditError,\n  clearProfileEditError: state.clearProfileEditError,\n  clearAllProfileEditErrors: state.clearAllProfileEditErrors,\n  // Address and representatives actions\n  setCurrentAddress: state.setCurrentAddress,\n  setCurrentState: state.setCurrentState,\n  setRepresentatives: state.setRepresentatives,\n  addRepresentative: state.addRepresentative,\n  removeRepresentative: state.removeRepresentative,\n  setShowAddressForm: state.setShowAddressForm,\n  setNewAddress: state.setNewAddress,\n  setAddressLoading: state.setAddressLoading,\n  setSavedSuccessfully: state.setSavedSuccessfully,\n  lookupAddress: state.lookupAddress,\n  handleAddressUpdate: state.handleAddressUpdate,\n  // Avatar actions\n  setAvatarFile: state.setAvatarFile,\n  setAvatarPreview: state.setAvatarPreview,\n  setUploadingAvatar: state.setUploadingAvatar,\n  clearAvatar: state.clearAvatar,\n}));\n\n// Computed selectors\nexport const useUserDisplayName = () => useUserStore(state => {\n  if (state.profile?.username) return state.profile.username;\n  if (state.user?.user_metadata?.full_name) return state.user.user_metadata.full_name;\n  if (state.user?.email) return state.user.email.split('@')[0];\n  return 'User';\n});\n\nexport const useUserAvatar = () => useUserStore(state => {\n  if (state.profile?.avatar) return state.profile.avatar;\n  if (state.user?.user_metadata?.avatar_url) return state.user.user_metadata.avatar_url;\n  return null;\n});\n\nexport const useUserTheme = () => useUserStore(state => {\n  return state.profile?.preferences?.theme || 'system';\n});\n\nexport const useUserNotifications = () => useUserStore(state => {\n  return state.profile?.preferences?.notifications ?? true;\n});\n\n// Profile editing selectors\nexport const useUserProfileEditData = () => useUserStore(state => state.profileEditData);\nexport const useUserIsProfileEditing = () => useUserStore(state => state.isProfileEditing);\nexport const useUserProfileEditErrors = () => useUserStore(state => state.profileEditErrors);\n\n// Address and representatives selectors\nexport const useUserCurrentAddress = () => useUserStore(state => state.currentAddress);\nexport const useUserCurrentState = () => useUserStore(state => state.currentState);\nexport const useUserRepresentatives = () => useUserStore(state => state.representatives);\nexport const useUserShowAddressForm = () => useUserStore(state => state.showAddressForm);\nexport const useUserNewAddress = () => useUserStore(state => state.newAddress);\nexport const useUserAddressLoading = () => useUserStore(state => state.addressLoading);\nexport const useUserSavedSuccessfully = () => useUserStore(state => state.savedSuccessfully);\n\n// Avatar selectors\nexport const useUserAvatarFile = () => useUserStore(state => state.avatarFile);\nexport const useUserAvatarPreview = () => useUserStore(state => state.avatarPreview);\nexport const useUserIsUploadingAvatar = () => useUserStore(state => state.isUploadingAvatar);\n\n// Store utilities\nexport const userStoreUtils = {\n  /**\n   * Check if user has specific preference\n   */\n  hasPreference: (preference: keyof UserProfile['preferences']) => {\n    const state = useUserStore.getState();\n    return state.profile?.preferences?.[preference] ?? false;\n  },\n  \n  /**\n   * Check if user has specific setting\n   */\n  hasSetting: (setting: keyof UserProfile['settings']) => {\n    const state = useUserStore.getState();\n    return state.profile?.settings?.[setting] ?? false;\n  },\n  \n  /**\n   * Get user's full profile with computed fields\n   */\n  getFullProfile: () => {\n    const state = useUserStore.getState();\n    if (!state.profile || !state.user) return null;\n    \n    return {\n      ...state.profile,\n      email: state.user.email,\n      id: state.user.id,\n      createdAt: state.user.created_at,\n      lastSignIn: state.user.last_sign_in_at,\n    };\n  },\n  \n  /**\n   * Check if user is admin\n   */\n  isAdmin: () => {\n    const state = useUserStore.getState();\n    return state.user?.user_metadata?.role === 'admin';\n  },\n  \n  /**\n   * Get user's display information\n   */\n  getDisplayInfo: () => {\n    const state = useUserStore.getState();\n    return {\n      name: state.profile?.username || state.user?.email?.split('@')[0] || 'User',\n      avatar: state.profile?.avatar || state.user?.user_metadata?.avatar_url,\n      email: state.user?.email,\n      theme: state.profile?.preferences?.theme || 'system',\n      notifications: state.profile?.preferences?.notifications ?? true,\n    };\n  }\n};\n\n// Store subscriptions for external integrations\nexport const userStoreSubscriptions = {\n  /**\n   * Subscribe to authentication changes\n   */\n  onAuthChange: (callback: (isAuthenticated: boolean, user: User | null) => void) => {\n    return useUserStore.subscribe(\n      (state, prevState) => {\n        const { isAuthenticated, user } = state;\n        const { isAuthenticated: prevIsAuthenticated, user: prevUser } = prevState;\n        if (isAuthenticated !== prevIsAuthenticated || user !== prevUser) {\n          callback(isAuthenticated, user);\n        }\n      }\n    );\n  },\n  \n  /**\n   * Subscribe to profile changes\n   */\n  onProfileChange: (callback: (profile: UserProfile | null) => void) => {\n    return useUserStore.subscribe(\n      (state, prevState) => {\n        const { profile } = state;\n        const { profile: prevProfile } = prevState;\n        if (profile !== prevProfile) {\n          callback(profile);\n        }\n      }\n    );\n  },\n  \n  /**\n   * Subscribe to preference changes\n   */\n  onPreferenceChange: (callback: (preferences: UserProfile['preferences']) => void) => {\n    return useUserStore.subscribe(\n      (state, prevState) => {\n        const preferences = state.profile?.preferences;\n        const prevPreferences = prevState.profile?.preferences;\n        if (preferences !== prevPreferences && preferences) {\n          callback(preferences);\n        }\n      }\n    );\n  }\n};\n\n// Store debugging utilities\nexport const userStoreDebug = {\n  /**\n   * Log current user state\n   */\n  logState: () => {\n    const state = useUserStore.getState();\n    // State logging removed for production\n  },\n  \n  /**\n   * Log user profile details\n   */\n  logProfile: () => {\n    const state = useUserStore.getState();\n    if (state.profile) {\n      // Profile logging removed for production\n    }\n  },\n  \n  /**\n   * Reset store to initial state\n   */\n  reset: () => {\n    useUserStore.getState().clearUser();\n  }\n};\n"],"names":["useBiometric","useBiometricAvailable","useBiometricCredentials","useBiometricError","useBiometricRegistering","useBiometricSuccess","useBiometricSupported","useIsAuthenticated","useSession","useUser","useUserActions","useUserAddressLoading","useUserAvatar","useUserAvatarFile","useUserAvatarPreview","useUserCurrentAddress","useUserCurrentState","useUserDisplayName","useUserError","useUserIsProfileEditing","useUserIsUploadingAvatar","useUserLoading","useUserNewAddress","useUserNotifications","useUserPreferences","useUserProfile","useUserProfileEditData","useUserProfileEditErrors","useUserRepresentatives","useUserSavedSuccessfully","useUserSettings","useUserShowAddressForm","useUserStore","useUserTheme","userStoreDebug","userStoreSubscriptions","userStoreUtils","create","devtools","persist","immer","set","_get","user","session","isAuthenticated","profile","profileEditData","isProfileEditing","profileEditErrors","currentAddress","currentState","representatives","showAddressForm","newAddress","addressLoading","savedSuccessfully","avatarFile","avatarPreview","isUploadingAvatar","biometric","isSupported","isAvailable","hasCredentials","isRegistering","error","success","isLoading","isProfileLoading","isUpdating","setLoading","loading","state","setError","clearError","setUser","setSession","newUser","newAuthenticated","setAuthenticated","authenticated","signOut","clearUser","setProfile","updateProfile","updates","metadata","updatedAt","Date","toISOString","updatePreferences","preferences","updateSettings","settings","updateMetadata","setProfileLoading","setUpdating","updating","setBiometricSupported","supported","setBiometricAvailable","available","setBiometricCredentials","setBiometricRegistering","registering","setBiometricError","setBiometricSuccess","resetBiometric","setProfileEditData","data","updateProfileEditData","updateProfileField","field","value","updateArrayField","currentArray","newArray","includes","filter","item","updatePrivacySetting","setting","privacysettings","setProfileEditing","editing","setProfileEditError","clearProfileEditError","clearAllProfileEditErrors","setCurrentAddress","address","setCurrentState","stateValue","setRepresentatives","addRepresentative","representative","existingIndex","findIndex","rep","id","push","removeRepresentative","setShowAddressForm","show","setNewAddress","setAddressLoading","setSavedSuccessfully","saved","lookupAddress","response","fetch","encodeURIComponent","ok","Error","result","json","console","handleAddressUpdate","setTimeout","setAvatarFile","file","setAvatarPreview","preview","setUploadingAvatar","uploading","clearAvatar","setUserError","clearUserError","name","partialize","username","user_metadata","full_name","email","split","avatar","avatar_url","theme","notifications","hasPreference","preference","getState","hasSetting","getFullProfile","createdAt","created_at","lastSignIn","last_sign_in_at","isAdmin","role","getDisplayInfo","onAuthChange","callback","subscribe","prevState","prevIsAuthenticated","prevUser","onProfileChange","prevProfile","onPreferenceChange","prevPreferences","logState","logProfile","reset"],"mappings":"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"}