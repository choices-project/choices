{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/features/onboarding/components/BalancedOnboardingFlow.tsx"],"sourcesContent":["// Balanced Onboarding Flow\n// 5 essential steps: Welcome, Privacy, Demographics, Auth, Complete\n// Created: October 2, 2025\n\n'use client';\n\nimport { useRouter } from 'next/navigation';\nimport React, { useState, useEffect } from 'react';\n\nimport { FeatureWrapper } from '@/components/shared/FeatureWrapper';\nimport { PasskeyRegister } from '@/features/auth/components/PasskeyRegister';\nimport type { UserDemographics, PrivacyPreferences, OnboardingData } from '@/features/onboarding/types';\nimport { useUser, useUserLoading } from '@/lib/stores';\nimport { \n  useOnboardingStep,\n  useOnboardingData,\n  useOnboardingActions,\n  useOnboardingLoading,\n  useOnboardingError\n} from '@/lib/stores';\nimport { withOptional } from '@/lib/utils/objects';\nimport { getSupabaseBrowserClient } from '@/utils/supabase/client';\nimport { T } from '@/lib/testing/testIds';\n\n\n// Step 1: Welcome & Value Proposition (30 seconds)\nconst WelcomeStep: React.FC<{\n  onNext: () => void;\n  onSkip: () => void;\n}> = ({ onNext, onSkip }) => {\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center\">\n      <div className=\"max-w-2xl mx-auto text-center p-8\">\n        <div className=\"mb-8\">\n          <h1 className=\"text-5xl font-bold text-gray-900 mb-6\">\n            Welcome to Choices\n          </h1>\n          <p className=\"text-xl text-gray-600 mb-8\">\n            Make informed decisions with transparent, data-driven insights\n          </p>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\n          <div className=\"bg-white rounded-lg p-6 shadow-sm\">\n            <div className=\"text-4xl mb-4\">üó≥Ô∏è</div>\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">Vote on Issues</h3>\n            <p className=\"text-gray-600 text-sm\">Participate in polls on topics that matter to you</p>\n          </div>\n          <div className=\"bg-white rounded-lg p-6 shadow-sm\">\n            <div className=\"text-4xl mb-4\">üèõÔ∏è</div>\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">Track Representatives</h3>\n            <p className=\"text-gray-600 text-sm\">See how your elected officials vote and fundraise</p>\n          </div>\n          <div className=\"bg-white rounded-lg p-6 shadow-sm\">\n            <div className=\"text-4xl mb-4\">üìä</div>\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">Campaign Finance</h3>\n            <p className=\"text-gray-600 text-sm\">Understand who funds political campaigns</p>\n          </div>\n        </div>\n\n        <div className=\"bg-blue-50 rounded-lg p-4 mb-8\">\n          <p className=\"text-blue-800 font-medium\">\n            ‚è±Ô∏è This will take about 3 minutes to get you started\n          </p>\n        </div>\n\n        <div className=\"space-y-4\">\n          <button\n            onClick={onNext}\n            data-testid={T.welcomeNext}\n            className=\"w-full bg-blue-600 text-white py-4 px-8 rounded-lg font-semibold text-lg hover:bg-blue-700 transition-colors\"\n          >\n            Get Started\n          </button>\n          <button\n            onClick={onSkip}\n            className=\"w-full text-gray-500 hover:text-gray-700 transition-colors\"\n          >\n            I&apos;m a returning user\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// Step 2: Data Safety & Privacy Philosophy (45 seconds)\nconst PrivacyStep: React.FC<{\n  onNext: () => void;\n  onBack: () => void;\n  privacy: PrivacyPreferences;\n  setPrivacy: (privacy: PrivacyPreferences) => void;\n}> = ({ onNext, onBack, privacy, setPrivacy }) => {\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center\">\n      <div className=\"max-w-2xl mx-auto p-8\">\n        <div className=\"text-center mb-8\">\n          <h2 className=\"text-4xl font-bold text-gray-900 mb-4\">\n            Your Privacy Matters\n          </h2>\n          <p className=\"text-xl text-gray-600\">\n            We believe in transparency and data protection\n          </p>\n        </div>\n\n        <div className=\"space-y-6 mb-8\">\n          <div className=\"bg-white rounded-lg p-6 shadow-sm\">\n            <div className=\"flex items-start space-x-4\">\n              <div className=\"text-3xl\">üîí</div>\n              <div>\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">Location Data</h3>\n                <p className=\"text-gray-600\">\n                  We only need your state/district to find your representatives. \n                  We never store your exact address.\n                </p>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"bg-white rounded-lg p-6 shadow-sm\">\n            <div className=\"flex items-start space-x-4\">\n              <div className=\"text-3xl\">üìä</div>\n              <div>\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">Demographics</h3>\n                <p className=\"text-gray-600\">\n                  Age and education help us show you relevant polls and \n                  match you with similar voters.\n                </p>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"bg-white rounded-lg p-6 shadow-sm\">\n            <div className=\"flex items-start space-x-4\">\n              <div className=\"text-3xl\">üõ°Ô∏è</div>\n              <div>\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">Data Protection</h3>\n                <p className=\"text-gray-600\">\n                  All data is encrypted, anonymized, and never sold. \n                  You can delete your data anytime.\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"bg-gray-50 rounded-lg p-6 mb-8\">\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Your Privacy Controls</h3>\n          <div className=\"space-y-4\">\n            <label className=\"flex items-center space-x-3\">\n              <input\n                type=\"checkbox\"\n                checked={privacy.location_sharing === 'quantized'}\n                onChange={(e) => setPrivacy(withOptional(privacy, {\n                  location_sharing: e.target.checked ? 'quantized' : 'disabled'\n                }))}\n                className=\"w-5 h-5 text-blue-600 rounded\"\n              />\n              <span className=\"text-gray-700\">\n                Allow location sharing (quantized to state level)\n              </span>\n            </label>\n            <label className=\"flex items-center space-x-3\">\n              <input\n                type=\"checkbox\"\n                checked={privacy.demographic_sharing === 'enabled'}\n                onChange={(e) => setPrivacy(withOptional(privacy, {\n                  demographic_sharing: e.target.checked ? 'enabled' : 'disabled'\n                }))}\n                className=\"w-5 h-5 text-blue-600 rounded\"\n              />\n              <span className=\"text-gray-700\">\n                Share demographics for better experience\n              </span>\n            </label>\n            <label className=\"flex items-center space-x-3\">\n              <input\n                type=\"checkbox\"\n                checked={privacy.analytics_sharing === 'enabled'}\n                onChange={(e) => setPrivacy(withOptional(privacy, {\n                  analytics_sharing: e.target.checked ? 'enabled' : 'limited'\n                }))}\n                className=\"w-5 h-5 text-blue-600 rounded\"\n              />\n              <span className=\"text-gray-700\">\n                Share analytics to improve the platform\n              </span>\n            </label>\n          </div>\n        </div>\n\n        <div className=\"flex justify-between\">\n          <button\n            onClick={onBack}\n            className=\"text-gray-500 hover:text-gray-700 transition-colors\"\n          >\n            ‚Üê Back\n          </button>\n          <button\n            onClick={onNext}\n            data-testid={T.privacyNext}\n            className=\"bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-blue-700 transition-colors\"\n          >\n            Continue\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// Step 3: Location & Demographics (60 seconds)\nconst DemographicsStep: React.FC<{\n  onNext: () => void;\n  onBack: () => void;\n  onSkip: () => void;\n  demographics: UserDemographics;\n  setDemographics: (demographics: UserDemographics) => void;\n}> = ({ onNext, onBack, onSkip, demographics, setDemographics }) => {\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center\">\n      <div className=\"max-w-2xl mx-auto p-8\">\n        <div className=\"text-center mb-8\">\n          <h2 className=\"text-4xl font-bold text-gray-900 mb-4\">\n            Help Us Personalize Your Experience\n          </h2>\n          <p className=\"text-xl text-gray-600\">\n            This information helps us show you relevant content\n          </p>\n        </div>\n\n        <div className=\"space-y-8\">\n          {/* Location Section */}\n          <div className=\"bg-white rounded-lg p-6 shadow-sm\">\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center\">\n              <span className=\"text-2xl mr-3\">üìç</span>\n              Location\n            </h3>\n            <p className=\"text-gray-600 mb-4\">\n              We need this to find your representatives\n            </p>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  State\n                </label>\n                <select\n                  value={demographics?.location?.state || ''}\n                  onChange={(e) => setDemographics(withOptional(demographics, {\n                    location: withOptional(demographics?.location || {}, { state: e.target.value })\n                  }))}\n                  className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                >\n                  <option value=\"\">Select your state</option>\n                  <option value=\"AL\">Alabama</option>\n                  <option value=\"AK\">Alaska</option>\n                  <option value=\"AZ\">Arizona</option>\n                  <option value=\"AR\">Arkansas</option>\n                  <option value=\"CA\">California</option>\n                  <option value=\"CO\">Colorado</option>\n                  <option value=\"CT\">Connecticut</option>\n                  <option value=\"DE\">Delaware</option>\n                  <option value=\"FL\">Florida</option>\n                  <option value=\"GA\">Georgia</option>\n                  <option value=\"HI\">Hawaii</option>\n                  <option value=\"ID\">Idaho</option>\n                  <option value=\"IL\">Illinois</option>\n                  <option value=\"IN\">Indiana</option>\n                  <option value=\"IA\">Iowa</option>\n                  <option value=\"KS\">Kansas</option>\n                  <option value=\"KY\">Kentucky</option>\n                  <option value=\"LA\">Louisiana</option>\n                  <option value=\"ME\">Maine</option>\n                  <option value=\"MD\">Maryland</option>\n                  <option value=\"MA\">Massachusetts</option>\n                  <option value=\"MI\">Michigan</option>\n                  <option value=\"MN\">Minnesota</option>\n                  <option value=\"MS\">Mississippi</option>\n                  <option value=\"MO\">Missouri</option>\n                  <option value=\"MT\">Montana</option>\n                  <option value=\"NE\">Nebraska</option>\n                  <option value=\"NV\">Nevada</option>\n                  <option value=\"NH\">New Hampshire</option>\n                  <option value=\"NJ\">New Jersey</option>\n                  <option value=\"NM\">New Mexico</option>\n                  <option value=\"NY\">New York</option>\n                  <option value=\"NC\">North Carolina</option>\n                  <option value=\"ND\">North Dakota</option>\n                  <option value=\"OH\">Ohio</option>\n                  <option value=\"OK\">Oklahoma</option>\n                  <option value=\"OR\">Oregon</option>\n                  <option value=\"PA\">Pennsylvania</option>\n                  <option value=\"RI\">Rhode Island</option>\n                  <option value=\"SC\">South Carolina</option>\n                  <option value=\"SD\">South Dakota</option>\n                  <option value=\"TN\">Tennessee</option>\n                  <option value=\"TX\">Texas</option>\n                  <option value=\"UT\">Utah</option>\n                  <option value=\"VT\">Vermont</option>\n                  <option value=\"VA\">Virginia</option>\n                  <option value=\"WA\">Washington</option>\n                  <option value=\"WV\">West Virginia</option>\n                  <option value=\"WI\">Wisconsin</option>\n                  <option value=\"WY\">Wyoming</option>\n                </select>\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  District (Optional)\n                </label>\n                <input\n                  type=\"text\"\n                  value={demographics?.location?.district || ''}\n                  onChange={(e) => setDemographics(withOptional(demographics, {\n                    location: withOptional(demographics?.location || {}, { district: e.target.value })\n                  }))}\n                  placeholder=\"Enter your congressional district\"\n                  className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                />\n              </div>\n            </div>\n            <p className=\"text-sm text-gray-500 mt-2\">\n              We only store your state and district, not your exact address\n            </p>\n          </div>\n\n          {/* Demographics Section */}\n          <div className=\"bg-white rounded-lg p-6 shadow-sm\">\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center\">\n              <span className=\"text-2xl mr-3\">üë§</span>\n              Demographics\n            </h3>\n            <p className=\"text-gray-600 mb-4\">\n              This helps us show you relevant polls and match you with similar voters\n            </p>\n            \n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Age Range\n                </label>\n                <select\n                  value={demographics?.age_range || ''}\n                  onChange={(e) => setDemographics(withOptional(demographics, {\n                    age_range: e.target.value as UserDemographics['age_range']\n                  }))}\n                  className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                >\n                  <option value=\"\">Select age range</option>\n                  <option value=\"18-24\">18-24</option>\n                  <option value=\"25-34\">25-34</option>\n                  <option value=\"35-44\">35-44</option>\n                  <option value=\"45-54\">45-54</option>\n                  <option value=\"55-64\">55-64</option>\n                  <option value=\"65+\">65+</option>\n                </select>\n              </div>\n              \n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Education Level\n                </label>\n                <select\n                  value={demographics?.education || ''}\n                  onChange={(e) => setDemographics(withOptional(demographics, {\n                    education: e.target.value as UserDemographics['education']\n                  }))}\n                  className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                >\n                  <option value=\"\">Select education</option>\n                  <option value=\"high_school\">High School</option>\n                  <option value=\"some_college\">Some College</option>\n                  <option value=\"bachelor\">Bachelor&apos;s Degree</option>\n                  <option value=\"graduate\">Graduate Degree</option>\n                </select>\n              </div>\n              \n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Political Engagement\n                </label>\n                <select\n                  value={demographics?.political_engagement || ''}\n                  onChange={(e) => setDemographics(withOptional(demographics, {\n                    political_engagement: e.target.value as UserDemographics['political_engagement']\n                  }))}\n                  className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                >\n                  <option value=\"\">Select engagement</option>\n                  <option value=\"casual\">Casual (vote occasionally)</option>\n                  <option value=\"moderate\">Moderate (follow politics)</option>\n                  <option value=\"very_engaged\">Very Engaged (very active)</option>\n                </select>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"flex justify-between items-center mt-8\">\n          <button\n            onClick={onBack}\n            className=\"text-gray-500 hover:text-gray-700 transition-colors\"\n          >\n            ‚Üê Back\n          </button>\n          \n          <div className=\"flex space-x-4\">\n            <button\n              onClick={onSkip}\n              className=\"text-gray-500 hover:text-gray-700 transition-colors\"\n            >\n              Skip for now\n            </button>\n            <button\n              onClick={onNext}\n              data-testid={T.profileNext}\n              className=\"bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-blue-700 transition-colors\"\n            >\n              Continue\n            </button>\n          </div>\n        </div>\n        \n        <p className=\"text-sm text-gray-500 text-center mt-4\">\n          You can always add this information later\n        </p>\n      </div>\n    </div>\n  );\n};\n\n// Step 4: Authentication Setup (45 seconds)\nconst AuthStep: React.FC<{\n  onNext: () => void;\n  onBack: () => void;\n  onSkip: () => void;\n  error?: string | null;\n  isLoading?: boolean;\n}> = ({ onNext, onBack, onSkip, error, isLoading }) => {\n  const [authMethod, setAuthMethod] = useState<'email' | 'passkey' | 'google' | null>(null);\n  const [success, setSuccess] = useState(false);\n\n  const handleAuthMethodSelect = (method: 'email' | 'passkey' | 'google') => {\n    setAuthMethod(method);\n    // Error is managed by the store\n    setSuccess(false);\n  };\n\n  const handlePasskeySuccess = () => {\n    setSuccess(true);\n    setTimeout(() => {\n      onNext();\n    }, 1000);\n  };\n\n  const handlePasskeyError = (error: string) => {\n    // Error is managed by the store\n    console.error('Passkey error:', error);\n  };\n\n  const handleEmailAuth = async () => {\n    try {\n      // Redirect to registration page for email auth\n      const { safeNavigate } = await import('@/lib/utils/ssr-safe');\n      safeNavigate('/register');\n    } catch {\n      console.error('Failed to redirect to registration');\n    }\n  };\n\n  const handleGoogleAuth = async () => {\n    try {\n      // Redirect to Google OAuth\n      const { safeNavigate } = await import('@/lib/utils/ssr-safe');\n      safeNavigate('/auth/google');\n    } catch {\n      console.error('Failed to redirect to Google authentication');\n    }\n  };\n\n  // If user has selected a method, show the appropriate interface\n  if (authMethod === 'passkey') {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center\">\n        <div className=\"max-w-2xl mx-auto p-8\">\n          <div className=\"text-center mb-8\">\n            <h2 className=\"text-4xl font-bold text-gray-900 mb-4\">\n              Set Up Your Passkey\n            </h2>\n            <p className=\"text-xl text-gray-600\">\n              Create a secure, passwordless way to sign in\n            </p>\n          </div>\n\n          <div className=\"bg-white rounded-lg p-6 shadow-sm mb-8\">\n            <div className=\"text-center mb-6\">\n              <div className=\"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n                <span className=\"text-3xl\">üîê</span>\n              </div>\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">Why Passkeys?</h3>\n              <ul className=\"text-gray-600 space-y-2 text-left\">\n                <li>‚Ä¢ Use your fingerprint, face, or device PIN</li>\n                <li>‚Ä¢ No passwords to remember or type</li>\n                <li>‚Ä¢ Works across all your devices</li>\n                <li>‚Ä¢ Maximum security with privacy</li>\n              </ul>\n            </div>\n\n            <FeatureWrapper feature=\"WEBAUTHN\">\n              <div data-testid={T.onboardingPasskeySetup}>\n                <PasskeyRegister\n                  onSuccess={handlePasskeySuccess}\n                  onError={handlePasskeyError}\n                  className=\"w-full\"\n                />\n              </div>\n            </FeatureWrapper>\n\n            {error && (\n              <div className=\"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg\">\n                <div className=\"flex items-center gap-2 text-red-800\">\n                  <span className=\"text-sm\">{error}</span>\n                </div>\n              </div>\n            )}\n\n            {success && (\n              <div className=\"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg\">\n                <div className=\"flex items-center gap-2 text-green-800\">\n                  <span className=\"text-sm\">‚úÖ Passkey created successfully!</span>\n                </div>\n              </div>\n            )}\n          </div>\n\n          <div className=\"flex justify-between items-center\">\n            <button\n              onClick={() => setAuthMethod(null)}\n              className=\"text-gray-500 hover:text-gray-700 transition-colors\"\n            >\n              ‚Üê Back to options\n            </button>\n            \n            <div className=\"flex space-x-4\">\n              <button\n                onClick={onSkip}\n                className=\"text-gray-500 hover:text-gray-700 transition-colors\"\n              >\n                Skip for now\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Main authentication method selection\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center\">\n      <div className=\"max-w-2xl mx-auto p-8\">\n        <div className=\"text-center mb-8\">\n          <h2 className=\"text-4xl font-bold text-gray-900 mb-4\">\n            Create Your Account\n          </h2>\n          <p className=\"text-xl text-gray-600\">\n            Choose how you&apos;d like to sign in\n          </p>\n        </div>\n\n        <div className=\"space-y-4 mb-8\">\n          <FeatureWrapper feature=\"WEBAUTHN\">\n            <button\n              onClick={() => handleAuthMethodSelect('passkey')}\n              disabled={isLoading}\n              data-testid={T.authPasskeyOption}\n              className=\"w-full flex items-center space-x-4 p-6 border border-gray-200 rounded-lg hover:border-blue-300 hover:bg-blue-50 transition-colors disabled:opacity-50\"\n            >\n              <span className=\"text-3xl\">üîê</span>\n              <div className=\"text-left\">\n                <div className=\"text-lg font-semibold\">Passkey (Recommended)</div>\n                <div className=\"text-gray-500\">Passwordless and secure</div>\n              </div>\n            </button>\n          </FeatureWrapper>\n\n          <button\n            onClick={handleEmailAuth}\n            disabled={isLoading}\n            data-testid={T.authEmailOption}\n            className=\"w-full flex items-center space-x-4 p-6 border border-gray-200 rounded-lg hover:border-blue-300 hover:bg-blue-50 transition-colors disabled:opacity-50\"\n          >\n            <span className=\"text-3xl\">üìß</span>\n            <div className=\"text-left\">\n              <div className=\"text-lg font-semibold\">Email & Password</div>\n              <div className=\"text-gray-500\">Simple and secure</div>\n            </div>\n          </button>\n\n          <button\n            onClick={handleGoogleAuth}\n            disabled={isLoading}\n            data-testid={T.authGoogleOption}\n            className=\"w-full flex items-center space-x-4 p-6 border border-gray-200 rounded-lg hover:border-blue-300 hover:bg-blue-50 transition-colors disabled:opacity-50\"\n          >\n            <span className=\"text-3xl\">üì±</span>\n            <div className=\"text-left\">\n              <div className=\"text-lg font-semibold\">Continue with Google</div>\n              <div className=\"text-gray-500\">Quick and easy</div>\n            </div>\n          </button>\n        </div>\n\n        <div className=\"bg-gray-50 rounded-lg p-6 mb-8\">\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">Why do we need authentication?</h3>\n          <ul className=\"text-gray-600 space-y-2\">\n            <li>‚Ä¢ Save your preferences and voting history</li>\n            <li>‚Ä¢ Show you personalized content</li>\n            <li>‚Ä¢ Keep your data secure and private</li>\n          </ul>\n        </div>\n\n        <div className=\"flex justify-between items-center\">\n          <button\n            onClick={onBack}\n            className=\"text-gray-500 hover:text-gray-700 transition-colors\"\n          >\n            ‚Üê Back\n          </button>\n          \n          <div className=\"flex space-x-4\">\n            <button\n              onClick={onSkip}\n              className=\"text-gray-500 hover:text-gray-700 transition-colors\"\n            >\n              Continue without account\n            </button>\n          </div>\n        </div>\n        \n        <p className=\"text-sm text-gray-500 text-center mt-4\">\n          You can start without an account, but with limited features\n        </p>\n      </div>\n    </div>\n  );\n};\n\n// Step 5: Profile Setup (Optional - can be skipped)\nconst ProfileStep: React.FC<{\n  onNext: () => void;\n  onBack: () => void;\n  onSkip: () => void;\n  profile: OnboardingData['profile'];\n  onUpdate: (updates: Partial<OnboardingData['profile']>) => void;\n}> = ({ onNext, onBack, onSkip, profile, onUpdate }) => {\n  const [displayName, setDisplayName] = useState(profile?.display_name || '');\n  const [bio, setBio] = useState(profile?.bio || '');\n  const [primaryConcerns] = useState<string[]>(profile?.primary_concerns || []);\n  const [communityFocus] = useState<string[]>(profile?.community_focus || []);\n  const [participationStyle, setParticipationStyle] = useState<'observer' | 'contributor' | 'leader'>(profile?.participation_style || 'observer');\n\n  const handleNext = () => {\n    onUpdate({\n      display_name: displayName,\n      bio,\n      primary_concerns: primaryConcerns,\n      community_focus: communityFocus,\n      participation_style: participationStyle\n    });\n    onNext();\n  };\n\n  const handleSkip = () => {\n    onSkip();\n  };\n\n  return (\n    <div className=\"max-w-2xl mx-auto\">\n      <div className=\"text-center mb-8\">\n        <h2 className=\"text-3xl font-bold text-gray-900 mb-4\">Complete Your Profile</h2>\n        <p className=\"text-lg text-gray-600\">\n          Help us personalize your experience (optional)\n        </p>\n      </div>\n\n      <div className=\"space-y-6\">\n        {/* Display Name */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Display Name\n          </label>\n          <input\n            type=\"text\"\n            value={displayName}\n            onChange={(e) => setDisplayName(e.target.value)}\n            placeholder=\"Enter your display name\"\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          />\n        </div>\n\n        {/* Bio */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Bio (Optional)\n          </label>\n          <textarea\n            value={bio}\n            onChange={(e) => setBio(e.target.value)}\n            placeholder=\"Share a brief description about yourself (optional)\"\n            rows={3}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          />\n        </div>\n\n        {/* Participation Style */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            How do you prefer to participate?\n          </label>\n          <div className=\"space-y-2\">\n            {[\n              { value: 'observer', label: 'Observer', desc: 'I prefer to read and learn' },\n              { value: 'contributor', label: 'Contributor', desc: 'I like to share my thoughts' },\n              { value: 'leader', label: 'Leader', desc: 'I want to drive discussions' }\n            ].map((option) => (\n              <label key={option.value} className=\"flex items-center space-x-3 p-3 border rounded-md cursor-pointer hover:bg-gray-50\">\n                <input\n                  type=\"radio\"\n                  name=\"participation\"\n                  value={option.value}\n                  checked={participationStyle === option.value}\n                  onChange={(e) => setParticipationStyle(e.target.value as any)}\n                  className=\"h-4 w-4 text-blue-600\"\n                />\n                <div>\n                  <div className=\"font-medium\">{option.label}</div>\n                  <div className=\"text-sm text-gray-500\">{option.desc}</div>\n                </div>\n              </label>\n            ))}\n          </div>\n        </div>\n      </div>\n\n      <div className=\"flex justify-between mt-8\">\n        <button\n          onClick={onBack}\n          className=\"px-4 py-2 text-gray-600 hover:text-gray-800\"\n        >\n          ‚Üê Back\n        </button>\n        <div className=\"space-x-3\">\n          <button\n            onClick={handleSkip}\n            className=\"px-4 py-2 text-gray-600 hover:text-gray-800\"\n          >\n            Skip for now\n          </button>\n          <button\n            onClick={handleNext}\n            className=\"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700\"\n          >\n            Complete Profile\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// Step 6: Complete & First Experience (30 seconds)\nconst CompleteStep: React.FC<{\n  onFinish: () => void;\n  demographics: UserDemographics;\n}> = ({ onFinish, demographics }) => {\n  const router = useRouter();\n\n  const handleFindRepresentatives = () => {\n    onFinish();\n    router.push('/civics');\n  };\n\n  const handleBrowsePolls = () => {\n    onFinish();\n    router.push('/polls');\n  };\n\n  const handleExploreFeatures = () => {\n    onFinish();\n    router.push('/dashboard');\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center\">\n      <div className=\"max-w-2xl mx-auto text-center p-8\">\n        <div className=\"mb-8\">\n          <div className=\"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6\">\n            <span className=\"text-4xl\">üéâ</span>\n          </div>\n          <h2 className=\"text-4xl font-bold text-gray-900 mb-4\">\n            You&apos;re All Set!\n          </h2>\n          <p className=\"text-xl text-gray-600\">\n            Let&apos;s find your representatives and explore what&apos;s available\n          </p>\n        </div>\n\n        <div className=\"bg-white rounded-lg p-6 shadow-sm mb-8\">\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Your Personalized Dashboard</h3>\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n            <div className=\"text-center p-4 bg-blue-50 rounded-lg\">\n              <div className=\"text-2xl mb-2\">üèõÔ∏è</div>\n              <h4 className=\"font-semibold text-gray-900\">Your Representatives</h4>\n              <p className=\"text-sm text-gray-600\">\n                Based on your location: {demographics?.location?.state || 'Not specified'}\n              </p>\n            </div>\n            <div className=\"text-center p-4 bg-green-50 rounded-lg\">\n              <div className=\"text-2xl mb-2\">üó≥Ô∏è</div>\n              <h4 className=\"font-semibold text-gray-900\">Relevant Polls</h4>\n              <p className=\"text-sm text-gray-600\">\n                Polls matching your interests\n              </p>\n            </div>\n            <div className=\"text-center p-4 bg-purple-50 rounded-lg\">\n              <div className=\"text-2xl mb-2\">üìä</div>\n              <h4 className=\"font-semibold text-gray-900\">Campaign Finance</h4>\n              <p className=\"text-sm text-gray-600\">\n                See who funds campaigns\n              </p>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"space-y-4 mb-8\">\n          <button\n            onClick={handleFindRepresentatives}\n            data-testid={T.completeOnboarding}\n            className=\"w-full bg-blue-600 text-white py-4 px-8 rounded-lg font-semibold text-lg hover:bg-blue-700 transition-colors\"\n          >\n            Find My Representatives\n          </button>\n          <button\n            onClick={handleBrowsePolls}\n            className=\"w-full bg-green-600 text-white py-4 px-8 rounded-lg font-semibold text-lg hover:bg-green-700 transition-colors\"\n          >\n            Browse Current Polls\n          </button>\n          <button\n            onClick={handleExploreFeatures}\n            className=\"w-full bg-purple-600 text-white py-4 px-8 rounded-lg font-semibold text-lg hover:bg-purple-700 transition-colors\"\n          >\n            Explore All Features\n          </button>\n        </div>\n\n        <div className=\"bg-gray-50 rounded-lg p-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">What&apos;s Next?</h3>\n          <ul className=\"text-left text-gray-600 space-y-2\">\n            <li>‚Ä¢ Vote on polls that interest you</li>\n            <li>‚Ä¢ Track how your representatives vote</li>\n            <li>‚Ä¢ See campaign finance data</li>\n            <li>‚Ä¢ Get notified about important issues</li>\n          </ul>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n/**\n * Balanced Onboarding Flow Component\n * \n * A comprehensive onboarding flow that guides users through 6 essential steps:\n * 1. Welcome - Introduction and value proposition\n * 2. Privacy - Data usage and privacy preferences\n * 3. Demographics - User background information\n * 4. Auth - Authentication setup (email, social, passkey, or anonymous)\n * 5. Profile - Display name, visibility, and notification preferences\n * 6. Complete - Success confirmation and next steps\n * \n * Features:\n * - Automatic auth step skipping for users with existing passkey credentials\n * - Progress tracking and data persistence\n * - Responsive design with mobile-first approach\n * - Integration with Supabase authentication\n * \n * @returns {JSX.Element} The complete onboarding flow interface\n */\nconst BalancedOnboardingFlow: React.FC = () => {\n  const currentStep = useOnboardingStep();\n  const onboardingData = useOnboardingData() as any;\n  const { nextStep, previousStep, updateFormData, completeOnboarding, setCurrentStep } = useOnboardingActions() as any;\n  const loading = useOnboardingLoading();\n  const error = useOnboardingError();\n\n  const user = useUser();\n  const isLoading = useUserLoading();\n\n  // Check if user has already completed onboarding\n  useEffect(() => {\n    const checkOnboardingStatus = async () => {\n    if (!isLoading && user) {\n        try {\n          const supabase = await getSupabaseBrowserClient();\n          const { data: profile } = await supabase\n            .from('user_profiles')\n            .select('onboarding_completed')\n            .eq('user_id', user.id)\n            .single();\n\n          if (profile?.onboarding_completed) {\n            // User has already completed onboarding, redirect to dashboard\n            const { safeNavigate } = await import('@/lib/utils/ssr-safe');\n            safeNavigate('/dashboard');\n          }\n        } catch (error) {\n          console.error('Error checking onboarding status:', error);\n          // Continue with onboarding if we can't check status\n        }\n      }\n    };\n\n    checkOnboardingStatus();\n  }, [user, isLoading]);\n\n  const handleNext = () => {\n    nextStep();\n  };\n\n\n  const handleBack = () => {\n    previousStep();\n  };\n\n  const handleSkip = () => {\n    // Skip to complete step\n    setCurrentStep(5); // Complete step\n  };\n\n  const handleFinish = async () => {\n    try {\n      // Update user profile to mark onboarding as completed\n      if (user) {\n        const supabase = await getSupabaseBrowserClient();\n        const { error } = await supabase\n          .from('user_profiles')\n          .update({ \n            onboarding_completed: true,\n            updated_at: new Date().toISOString()\n          })\n          .eq('user_id', user.id);\n\n        if (error) {\n          console.error('Failed to update onboarding status:', error);\n        }\n      }\n\n    // Complete onboarding\n    completeOnboarding();\n    \n    // Redirect to main app\n    window.location.href = '/civics';\n    } catch (error) {\n      console.error('Error completing onboarding:', error);\n      // Still redirect even if database update fails\n      window.location.href = '/civics';\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"balanced-onboarding\" data-testid=\"balanced-onboarding\">\n      {/* E2E Test Compatibility: Hidden buttons for test automation */}\n      <div style={{ position: 'absolute', left: '-9999px', top: '-9999px' }}>\n        <button data-testid={T.tourNext} onClick={handleNext}>Tour Next</button>\n        <button data-testid={T.dataUsageNext} onClick={handleNext}>Data Usage Next</button>\n        <button data-testid={T.interestsNext} onClick={handleNext}>Interests Next</button>\n        <button data-testid={T.experienceNext} onClick={handleNext}>Experience Next</button>\n      </div>\n\n      <main role=\"main\" aria-label=\"Onboarding flow\" aria-live=\"polite\">\n\n      {currentStep === 0 && (\n        <WelcomeStep onNext={handleNext} onSkip={handleSkip} />\n      )}\n      {currentStep === 1 && (\n        <PrivacyStep\n          onNext={handleNext}\n          onBack={handleBack}\n          privacy={onboardingData?.privacy || { location_sharing: 'disabled', demographic_sharing: 'disabled', analytics_sharing: 'disabled' }}\n          setPrivacy={(privacy) => updateFormData(2, { privacy })}\n        />\n      )}\n      {currentStep === 2 && (\n        <DemographicsStep \n          onNext={handleNext} \n          onBack={handleBack}\n          onSkip={handleNext}\n          demographics={onboardingData?.demographics || {}}\n          setDemographics={(demographics) => updateFormData(0, { demographics })}\n        />\n      )}\n      {currentStep === 3 && (\n        <AuthStep onNext={handleNext} onBack={handleBack} onSkip={handleNext} error={error} isLoading={loading} />\n      )}\n      {currentStep === 4 && (\n        <ProfileStep \n          onNext={handleNext} \n          onBack={handleBack}\n          onSkip={handleSkip}\n          profile={onboardingData?.profile || {}}\n          onUpdate={(profile) => updateFormData(0, { profile })}\n        />\n      )}\n      {currentStep === 5 && (\n        <CompleteStep \n          onFinish={handleFinish}\n          demographics={onboardingData?.demographics || {}}\n        />\n      )}\n      </main>\n    </div>\n  );\n};\n\nexport default BalancedOnboardingFlow;\n"],"names":["WelcomeStep","onNext","onSkip","div","className","h1","p","h3","button","onClick","data-testid","T","welcomeNext","PrivacyStep","onBack","privacy","setPrivacy","h2","label","input","type","checked","location_sharing","onChange","e","withOptional","target","span","demographic_sharing","analytics_sharing","privacyNext","DemographicsStep","demographics","setDemographics","select","value","location","state","option","district","placeholder","age_range","education","political_engagement","profileNext","AuthStep","error","isLoading","authMethod","setAuthMethod","useState","success","setSuccess","handleAuthMethodSelect","method","handlePasskeySuccess","setTimeout","handlePasskeyError","console","handleEmailAuth","safeNavigate","handleGoogleAuth","ul","li","FeatureWrapper","feature","onboardingPasskeySetup","PasskeyRegister","onSuccess","onError","disabled","authPasskeyOption","authEmailOption","authGoogleOption","ProfileStep","profile","onUpdate","displayName","setDisplayName","display_name","bio","setBio","primaryConcerns","primary_concerns","communityFocus","community_focus","participationStyle","setParticipationStyle","participation_style","handleNext","handleSkip","textarea","rows","desc","map","name","CompleteStep","onFinish","router","useRouter","handleFindRepresentatives","push","handleBrowsePolls","handleExploreFeatures","h4","completeOnboarding","BalancedOnboardingFlow","currentStep","useOnboardingStep","onboardingData","useOnboardingData","nextStep","previousStep","updateFormData","setCurrentStep","useOnboardingActions","loading","useOnboardingLoading","useOnboardingError","user","useUser","useUserLoading","useEffect","checkOnboardingStatus","supabase","getSupabaseBrowserClient","data","from","eq","id","single","onboarding_completed","handleBack","handleFinish","update","updated_at","Date","toISOString","window","href","style","position","left","top","tourNext","dataUsageNext","interestsNext","experienceNext","main","role","aria-label","aria-live"],"mappings":"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G;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAAM;sEAAK;;sEACnB,qBAACG;4DAAOH,OAA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"}