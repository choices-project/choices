{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/tests/jest/unit/performance/component-performance.test.tsx"],"sourcesContent":["/**\n * @jest-environment jsdom\n */\n\nimport React from 'react';\nimport { render, screen, waitFor, act } from '@testing-library/react';\nimport { BrowserRouter } from 'react-router-dom';\nimport SuperiorMobileFeed from '@/features/feeds/components/SuperiorMobileFeed';\nimport { T } from '@/lib/testing/testIds';\n\n// Use real functionality - minimal mocking only for test environment setup\n\n// Setup minimal mocks for test environment\nbeforeAll(() => {\n  // Mock localStorage for component functionality\n  Object.defineProperty(window, 'localStorage', {\n    value: {\n      getItem: jest.fn(),\n      setItem: jest.fn(),\n      removeItem: jest.fn(),\n      clear: jest.fn(),\n    },\n    writable: true,\n  });\n  \n  // Mock navigator for online status\n  Object.defineProperty(navigator, 'onLine', {\n    value: true,\n    writable: true,\n  });\n});\n\n// Clean up after each test\nafterEach(() => {\n  jest.clearAllMocks();\n});\n\ndescribe('Component Performance Tests', () => {\n  describe('Rendering Performance', () => {\n    it('should render within performance budget', async () => {\n      const startTime = performance.now();\n      \n      await act(async () => {\n        render(\n          <BrowserRouter>\n            <SuperiorMobileFeed />\n          </BrowserRouter>\n        );\n      });\n      \n      const endTime = performance.now();\n      const renderTime = endTime - startTime;\n      \n      // Performance budget: 300ms for initial render (realistic for test environment)\n      expect(renderTime).toBeLessThan(300);\n      \n      // Log actual performance for monitoring\n      console.log(`Component render time: ${renderTime.toFixed(2)}ms`);\n    });\n\n    it('should handle real data efficiently', async () => {\n      const startTime = performance.now();\n      \n      await act(async () => {\n        render(\n          <BrowserRouter>\n            <SuperiorMobileFeed />\n          </BrowserRouter>\n        );\n      });\n      \n      const endTime = performance.now();\n      const renderTime = endTime - startTime;\n      \n      // Performance budget: 300ms for real data rendering\n      expect(renderTime).toBeLessThan(300);\n      \n      // Log actual performance for monitoring\n      console.log(`Real data render time: ${renderTime.toFixed(2)}ms`);\n    });\n\n    it('should not cause memory leaks', async () => {\n      const initialMemory = performance.memory?.usedJSHeapSize || 0;\n      \n      await act(async () => {\n        render(\n          <BrowserRouter>\n            <SuperiorMobileFeed />\n          </BrowserRouter>\n        );\n      });\n      \n      // Simulate component unmount\n      await act(async () => {\n        render(<div />);\n      });\n      \n      // Force garbage collection if available\n      if (global.gc) {\n        global.gc();\n      }\n      \n      const finalMemory = performance.memory?.usedJSHeapSize || 0;\n      const memoryIncrease = finalMemory - initialMemory;\n      \n      // Memory increase should be minimal (less than 1MB)\n      expect(memoryIncrease).toBeLessThan(1000000);\n    });\n  });\n\n  describe('Interaction Performance', () => {\n    it('should handle rapid state changes efficiently', async () => {\n      await act(async () => {\n        render(\n          <BrowserRouter>\n            <SuperiorMobileFeed />\n          </BrowserRouter>\n        );\n      });\n\n      const startTime = performance.now();\n      \n      // Simulate rapid state changes\n      for (let i = 0; i < 100; i++) {\n        await act(async () => {\n          // Trigger state changes\n          const buttons = screen.getAllByRole('button');\n          if (buttons.length > 0) {\n            buttons[0].click();\n          }\n        });\n      }\n      \n      const endTime = performance.now();\n      const totalTime = endTime - startTime;\n      \n      // Performance budget: 1.5 seconds for 100 rapid interactions (realistic for test environment)\n      expect(totalTime).toBeLessThan(1500);\n    });\n\n    it('should handle scroll events efficiently', async () => {\n      await act(async () => {\n        render(\n          <BrowserRouter>\n            <SuperiorMobileFeed />\n          </BrowserRouter>\n        );\n      });\n\n      const startTime = performance.now();\n      \n      // Simulate scroll events\n      for (let i = 0; i < 50; i++) {\n        await act(async () => {\n          window.dispatchEvent(new Event('scroll'));\n        });\n      }\n      \n      const endTime = performance.now();\n      const totalTime = endTime - startTime;\n      \n      // Performance budget: 500ms for 50 scroll events\n      expect(totalTime).toBeLessThan(500);\n    });\n  });\n\n  describe('Network Performance', () => {\n    it('should handle real network requests efficiently', async () => {\n      const startTime = performance.now();\n      \n      await act(async () => {\n        render(\n          <BrowserRouter>\n            <SuperiorMobileFeed />\n          </BrowserRouter>\n        );\n      });\n      \n      const endTime = performance.now();\n      const renderTime = endTime - startTime;\n      \n      // Should render quickly with real network requests\n      expect(renderTime).toBeLessThan(300);\n      \n      // Log actual network performance\n      console.log(`Real network render time: ${renderTime.toFixed(2)}ms`);\n    });\n\n    it('should handle real API calls gracefully', async () => {\n      const startTime = performance.now();\n      \n      await act(async () => {\n        render(\n          <BrowserRouter>\n            <SuperiorMobileFeed />\n          </BrowserRouter>\n        );\n      });\n      \n      const endTime = performance.now();\n      const renderTime = endTime - startTime;\n      \n      // Should handle real API calls efficiently\n      expect(renderTime).toBeLessThan(400);\n      \n      // Log actual API performance\n      console.log(`Real API render time: ${renderTime.toFixed(2)}ms`);\n    });\n  });\n\n  describe('Memory Performance', () => {\n    it('should not accumulate memory over time', async () => {\n      const memorySnapshots = [];\n      \n      for (let i = 0; i < 10; i++) {\n        await act(async () => {\n          render(\n            <BrowserRouter>\n              <SuperiorMobileFeed />\n            </BrowserRouter>\n          );\n        });\n        \n        // Unmount component\n        await act(async () => {\n          render(<div />);\n        });\n        \n        // Force garbage collection if available\n        if (global.gc) {\n          global.gc();\n        }\n        \n        memorySnapshots.push(performance.memory?.usedJSHeapSize || 0);\n      }\n      \n      // Memory should not continuously increase\n      const firstSnapshot = memorySnapshots[0];\n      const lastSnapshot = memorySnapshots[memorySnapshots.length - 1];\n      const memoryIncrease = lastSnapshot - firstSnapshot;\n      \n      // Memory increase should be minimal\n      expect(memoryIncrease).toBeLessThan(500000); // 500KB\n    });\n  });\n\n  describe('Accessibility Performance', () => {\n    it('should maintain accessibility performance with real data', async () => {\n      const startTime = performance.now();\n      \n      await act(async () => {\n        render(\n          <BrowserRouter>\n            <SuperiorMobileFeed />\n          </BrowserRouter>\n        );\n      });\n      \n      const endTime = performance.now();\n      const renderTime = endTime - startTime;\n      \n      // Accessibility features should not significantly impact performance\n      expect(renderTime).toBeLessThan(300);\n      \n      // Verify accessibility elements are present\n      expect(screen.getByRole('main')).toBeInTheDocument();\n      expect(screen.getByRole('navigation')).toBeInTheDocument();\n      expect(screen.getAllByRole('button').length).toBeGreaterThan(0);\n      \n      // Log accessibility performance\n      console.log(`Accessibility render time: ${renderTime.toFixed(2)}ms`);\n    });\n  });\n\n  describe('Performance Monitoring', () => {\n    it('should measure real performance metrics', async () => {\n      const startTime = performance.now();\n      \n      await act(async () => {\n        render(\n          <BrowserRouter>\n            <SuperiorMobileFeed />\n          </BrowserRouter>\n        );\n      });\n      \n      const endTime = performance.now();\n      const renderTime = endTime - startTime;\n      \n      // Verify we can measure real performance\n      expect(renderTime).toBeGreaterThan(0);\n      expect(renderTime).toBeLessThan(500); // Reasonable upper bound\n      \n      // Log performance metrics for monitoring\n      console.log(`Real component render time: ${renderTime.toFixed(2)}ms`);\n      \n      // Verify performance API is available\n      expect(typeof performance.now).toBe('function');\n    });\n\n    it('should track memory usage', async () => {\n      const initialMemory = performance.memory?.usedJSHeapSize || 0;\n      \n      await act(async () => {\n        render(\n          <BrowserRouter>\n            <SuperiorMobileFeed />\n          </BrowserRouter>\n        );\n      });\n      \n      const finalMemory = performance.memory?.usedJSHeapSize || 0;\n      const memoryUsed = finalMemory - initialMemory;\n      \n      // Verify memory tracking works\n      expect(memoryUsed).toBeGreaterThanOrEqual(0);\n      \n      // Log memory usage for monitoring\n      console.log(`Memory used: ${(memoryUsed / 1024 / 1024).toFixed(2)}MB`);\n    });\n  });\n});\n"],"names":["beforeAll","Object","defineProperty","window","value","getItem","jest","fn","setItem","removeItem","clear","writable","navigator","afterEach","clearAllMocks","describe","it","startTime","performance","now","act","render","BrowserRouter","SuperiorMobileFeed","endTime","renderTime","expect","toBeLessThan","console","log","toFixed","initialMemory","memory","usedJSHeapSize","div","global","gc","finalMemory","memoryIncrease","i","buttons","screen","getAllByRole","length","click","totalTime","dispatchEvent","Event","memorySnapshots","push","firstSnapshot","lastSnapshot","getByRole","toBeInTheDocument","toBeGreaterThan","toBe","memoryUsed","toBeGreaterThanOrEqual"],"mappings":"AAAA;;CAEC;;;;;8DAEiB;wBAC2B;gCACf;2EACC;;;;;;AAG/B,2EAA2E;AAE3E,2CAA2C;AAC3CA,UAAU;IACR,gDAAgD;IAChDC,OAAOC,cAAc,CAACC,QAAQ,gBAAgB;QAC5CC,OAAO;YACLC,SAASC,KAAKC,EAAE;YAChBC,SAASF,KAAKC,EAAE;YAChBE,YAAYH,KAAKC,EAAE;YACnBG,OAAOJ,KAAKC,EAAE;QAChB;QACAI,UAAU;IACZ;IAEA,mCAAmC;IACnCV,OAAOC,cAAc,CAACU,WAAW,UAAU;QACzCR,OAAO;QACPO,UAAU;IACZ;AACF;AAEA,2BAA2B;AAC3BE,UAAU;IACRP,KAAKQ,aAAa;AACpB;AAEAC,SAAS,+BAA+B;IACtCA,SAAS,yBAAyB;QAChCC,GAAG,2CAA2C;YAC5C,MAAMC,YAAYC,YAAYC,GAAG;YAEjC,MAAMC,IAAAA,WAAG,EAAC;gBACRC,IAAAA,cAAM,gBACJ,qBAACC,6BAAa;8BACZ,cAAA,qBAACC,2BAAkB;;YAGzB;YAEA,MAAMC,UAAUN,YAAYC,GAAG;YAC/B,MAAMM,aAAaD,UAAUP;YAE7B,gFAAgF;YAChFS,OAAOD,YAAYE,YAAY,CAAC;YAEhC,wCAAwC;YACxCC,QAAQC,GAAG,CAAC,CAAC,uBAAuB,EAAEJ,WAAWK,OAAO,CAAC,GAAG,EAAE,CAAC;QACjE;QAEAd,GAAG,uCAAuC;YACxC,MAAMC,YAAYC,YAAYC,GAAG;YAEjC,MAAMC,IAAAA,WAAG,EAAC;gBACRC,IAAAA,cAAM,gBACJ,qBAACC,6BAAa;8BACZ,cAAA,qBAACC,2BAAkB;;YAGzB;YAEA,MAAMC,UAAUN,YAAYC,GAAG;YAC/B,MAAMM,aAAaD,UAAUP;YAE7B,oDAAoD;YACpDS,OAAOD,YAAYE,YAAY,CAAC;YAEhC,wCAAwC;YACxCC,QAAQC,GAAG,CAAC,CAAC,uBAAuB,EAAEJ,WAAWK,OAAO,CAAC,GAAG,EAAE,CAAC;QACjE;QAEAd,GAAG,iCAAiC;YAClC,MAAMe,gBAAgBb,YAAYc,MAAM,EAAEC,kBAAkB;YAE5D,MAAMb,IAAAA,WAAG,EAAC;gBACRC,IAAAA,cAAM,gBACJ,qBAACC,6BAAa;8BACZ,cAAA,qBAACC,2BAAkB;;YAGzB;YAEA,6BAA6B;YAC7B,MAAMH,IAAAA,WAAG,EAAC;gBACRC,IAAAA,cAAM,gBAAC,qBAACa;YACV;YAEA,wCAAwC;YACxC,IAAIC,OAAOC,EAAE,EAAE;gBACbD,OAAOC,EAAE;YACX;YAEA,MAAMC,cAAcnB,YAAYc,MAAM,EAAEC,kBAAkB;YAC1D,MAAMK,iBAAiBD,cAAcN;YAErC,oDAAoD;YACpDL,OAAOY,gBAAgBX,YAAY,CAAC;QACtC;IACF;IAEAZ,SAAS,2BAA2B;QAClCC,GAAG,iDAAiD;YAClD,MAAMI,IAAAA,WAAG,EAAC;gBACRC,IAAAA,cAAM,gBACJ,qBAACC,6BAAa;8BACZ,cAAA,qBAACC,2BAAkB;;YAGzB;YAEA,MAAMN,YAAYC,YAAYC,GAAG;YAEjC,+BAA+B;YAC/B,IAAK,IAAIoB,IAAI,GAAGA,IAAI,KAAKA,IAAK;gBAC5B,MAAMnB,IAAAA,WAAG,EAAC;oBACR,wBAAwB;oBACxB,MAAMoB,UAAUC,cAAM,CAACC,YAAY,CAAC;oBACpC,IAAIF,QAAQG,MAAM,GAAG,GAAG;wBACtBH,OAAO,CAAC,EAAE,CAACI,KAAK;oBAClB;gBACF;YACF;YAEA,MAAMpB,UAAUN,YAAYC,GAAG;YAC/B,MAAM0B,YAAYrB,UAAUP;YAE5B,8FAA8F;YAC9FS,OAAOmB,WAAWlB,YAAY,CAAC;QACjC;QAEAX,GAAG,2CAA2C;YAC5C,MAAMI,IAAAA,WAAG,EAAC;gBACRC,IAAAA,cAAM,gBACJ,qBAACC,6BAAa;8BACZ,cAAA,qBAACC,2BAAkB;;YAGzB;YAEA,MAAMN,YAAYC,YAAYC,GAAG;YAEjC,yBAAyB;YACzB,IAAK,IAAIoB,IAAI,GAAGA,IAAI,IAAIA,IAAK;gBAC3B,MAAMnB,IAAAA,WAAG,EAAC;oBACRjB,OAAO2C,aAAa,CAAC,IAAIC,MAAM;gBACjC;YACF;YAEA,MAAMvB,UAAUN,YAAYC,GAAG;YAC/B,MAAM0B,YAAYrB,UAAUP;YAE5B,iDAAiD;YACjDS,OAAOmB,WAAWlB,YAAY,CAAC;QACjC;IACF;IAEAZ,SAAS,uBAAuB;QAC9BC,GAAG,mDAAmD;YACpD,MAAMC,YAAYC,YAAYC,GAAG;YAEjC,MAAMC,IAAAA,WAAG,EAAC;gBACRC,IAAAA,cAAM,gBACJ,qBAACC,6BAAa;8BACZ,cAAA,qBAACC,2BAAkB;;YAGzB;YAEA,MAAMC,UAAUN,YAAYC,GAAG;YAC/B,MAAMM,aAAaD,UAAUP;YAE7B,mDAAmD;YACnDS,OAAOD,YAAYE,YAAY,CAAC;YAEhC,iCAAiC;YACjCC,QAAQC,GAAG,CAAC,CAAC,0BAA0B,EAAEJ,WAAWK,OAAO,CAAC,GAAG,EAAE,CAAC;QACpE;QAEAd,GAAG,2CAA2C;YAC5C,MAAMC,YAAYC,YAAYC,GAAG;YAEjC,MAAMC,IAAAA,WAAG,EAAC;gBACRC,IAAAA,cAAM,gBACJ,qBAACC,6BAAa;8BACZ,cAAA,qBAACC,2BAAkB;;YAGzB;YAEA,MAAMC,UAAUN,YAAYC,GAAG;YAC/B,MAAMM,aAAaD,UAAUP;YAE7B,2CAA2C;YAC3CS,OAAOD,YAAYE,YAAY,CAAC;YAEhC,6BAA6B;YAC7BC,QAAQC,GAAG,CAAC,CAAC,sBAAsB,EAAEJ,WAAWK,OAAO,CAAC,GAAG,EAAE,CAAC;QAChE;IACF;IAEAf,SAAS,sBAAsB;QAC7BC,GAAG,0CAA0C;YAC3C,MAAMgC,kBAAkB,EAAE;YAE1B,IAAK,IAAIT,IAAI,GAAGA,IAAI,IAAIA,IAAK;gBAC3B,MAAMnB,IAAAA,WAAG,EAAC;oBACRC,IAAAA,cAAM,gBACJ,qBAACC,6BAAa;kCACZ,cAAA,qBAACC,2BAAkB;;gBAGzB;gBAEA,oBAAoB;gBACpB,MAAMH,IAAAA,WAAG,EAAC;oBACRC,IAAAA,cAAM,gBAAC,qBAACa;gBACV;gBAEA,wCAAwC;gBACxC,IAAIC,OAAOC,EAAE,EAAE;oBACbD,OAAOC,EAAE;gBACX;gBAEAY,gBAAgBC,IAAI,CAAC/B,YAAYc,MAAM,EAAEC,kBAAkB;YAC7D;YAEA,0CAA0C;YAC1C,MAAMiB,gBAAgBF,eAAe,CAAC,EAAE;YACxC,MAAMG,eAAeH,eAAe,CAACA,gBAAgBL,MAAM,GAAG,EAAE;YAChE,MAAML,iBAAiBa,eAAeD;YAEtC,oCAAoC;YACpCxB,OAAOY,gBAAgBX,YAAY,CAAC,SAAS,QAAQ;QACvD;IACF;IAEAZ,SAAS,6BAA6B;QACpCC,GAAG,4DAA4D;YAC7D,MAAMC,YAAYC,YAAYC,GAAG;YAEjC,MAAMC,IAAAA,WAAG,EAAC;gBACRC,IAAAA,cAAM,gBACJ,qBAACC,6BAAa;8BACZ,cAAA,qBAACC,2BAAkB;;YAGzB;YAEA,MAAMC,UAAUN,YAAYC,GAAG;YAC/B,MAAMM,aAAaD,UAAUP;YAE7B,qEAAqE;YACrES,OAAOD,YAAYE,YAAY,CAAC;YAEhC,4CAA4C;YAC5CD,OAAOe,cAAM,CAACW,SAAS,CAAC,SAASC,iBAAiB;YAClD3B,OAAOe,cAAM,CAACW,SAAS,CAAC,eAAeC,iBAAiB;YACxD3B,OAAOe,cAAM,CAACC,YAAY,CAAC,UAAUC,MAAM,EAAEW,eAAe,CAAC;YAE7D,gCAAgC;YAChC1B,QAAQC,GAAG,CAAC,CAAC,2BAA2B,EAAEJ,WAAWK,OAAO,CAAC,GAAG,EAAE,CAAC;QACrE;IACF;IAEAf,SAAS,0BAA0B;QACjCC,GAAG,2CAA2C;YAC5C,MAAMC,YAAYC,YAAYC,GAAG;YAEjC,MAAMC,IAAAA,WAAG,EAAC;gBACRC,IAAAA,cAAM,gBACJ,qBAACC,6BAAa;8BACZ,cAAA,qBAACC,2BAAkB;;YAGzB;YAEA,MAAMC,UAAUN,YAAYC,GAAG;YAC/B,MAAMM,aAAaD,UAAUP;YAE7B,yCAAyC;YACzCS,OAAOD,YAAY6B,eAAe,CAAC;YACnC5B,OAAOD,YAAYE,YAAY,CAAC,MAAM,yBAAyB;YAE/D,yCAAyC;YACzCC,QAAQC,GAAG,CAAC,CAAC,4BAA4B,EAAEJ,WAAWK,OAAO,CAAC,GAAG,EAAE,CAAC;YAEpE,sCAAsC;YACtCJ,OAAO,OAAOR,YAAYC,GAAG,EAAEoC,IAAI,CAAC;QACtC;QAEAvC,GAAG,6BAA6B;YAC9B,MAAMe,gBAAgBb,YAAYc,MAAM,EAAEC,kBAAkB;YAE5D,MAAMb,IAAAA,WAAG,EAAC;gBACRC,IAAAA,cAAM,gBACJ,qBAACC,6BAAa;8BACZ,cAAA,qBAACC,2BAAkB;;YAGzB;YAEA,MAAMc,cAAcnB,YAAYc,MAAM,EAAEC,kBAAkB;YAC1D,MAAMuB,aAAanB,cAAcN;YAEjC,+BAA+B;YAC/BL,OAAO8B,YAAYC,sBAAsB,CAAC;YAE1C,kCAAkC;YAClC7B,QAAQC,GAAG,CAAC,CAAC,aAAa,EAAE,AAAC2B,CAAAA,aAAa,OAAO,IAAG,EAAG1B,OAAO,CAAC,GAAG,EAAE,CAAC;QACvE;IACF;AACF"}