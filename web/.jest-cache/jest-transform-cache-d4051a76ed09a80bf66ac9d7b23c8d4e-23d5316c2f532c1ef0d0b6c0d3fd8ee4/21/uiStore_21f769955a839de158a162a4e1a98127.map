{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/lib/stores/uiStore.ts"],"sourcesContent":["/**\n * UI Store - Zustand Implementation\n * \n * Centralized UI state management including tabs, modals, forms,\n * loading states, and error states. Consolidates scattered useState\n * patterns into a unified store.\n * \n * Created: January 16, 2025\n * Status: âœ… ACTIVE\n */\n\nimport { create } from 'zustand';\nimport { devtools } from 'zustand/middleware';\nimport { persist } from 'zustand/middleware';\nimport { immer } from 'zustand/middleware/immer';\nimport { enableMapSet } from 'immer';\n\nimport { withOptional } from '@/lib/utils/objects';\nimport { logger } from '@/lib/utils/logger';\n\nimport type { BaseStore } from './types';\n\n// Enable Immer MapSet plugin for Set/Map support\nenableMapSet();\n\n// UI store state interface\ntype UIStore = {\n  // Tab Management\n  activeTab: string;\n  tabHistory: string[];\n  setActiveTab: (tab: string) => void;\n  goBackTab: () => void;\n  clearTabHistory: () => void;\n  \n  // Modal Management\n  activeModal: string | null;\n  modalData: any;\n  modalStack: Array<{\n    id: string;\n    data: any;\n    timestamp: number;\n  }>;\n  openModal: (id: string, data?: any) => void;\n  closeModal: () => void;\n  closeAllModals: () => void;\n  \n  // Form State Management\n  formData: Record<string, any>;\n  formErrors: Record<string, string | null>;\n  formTouched: Record<string, boolean>;\n  setFormData: (key: string, value: any) => void;\n  setFormError: (key: string, error: string | null) => void;\n  setFormTouched: (key: string, touched: boolean) => void;\n  clearForm: (key?: string) => void;\n  validateForm: (key: string) => boolean;\n  \n  // Loading States\n  loadingStates: Record<string, boolean>;\n  setLoading: (key: string, loading: boolean) => void;\n  isLoading: (key: string) => boolean;\n  clearLoading: (key: string) => void;\n  clearAllLoading: () => void;\n  \n  // Error States\n  errors: Record<string, string | null>;\n  setError: (key: string, error: string | null) => void;\n  clearError: (key: string) => void;\n  clearAllErrors: () => void;\n  hasError: (key: string) => boolean;\n  \n  // Toast/Notification States\n  toasts: Array<{\n    id: string;\n    type: 'success' | 'error' | 'warning' | 'info';\n    message: string;\n    duration?: number;\n    timestamp: number;\n  }>;\n  addToast: (toast: Omit<UIStore['toasts'][0], 'id' | 'timestamp'>) => void;\n  removeToast: (id: string) => void;\n  clearToasts: () => void;\n  \n  // Sidebar/Drawer States\n  sidebarOpen: boolean;\n  drawerOpen: boolean;\n  toggleSidebar: () => void;\n  toggleDrawer: () => void;\n  setSidebarOpen: (open: boolean) => void;\n  setDrawerOpen: (open: boolean) => void;\n  \n  // Search States\n  searchQuery: string;\n  searchResults: any[];\n  searchLoading: boolean;\n  setSearchQuery: (query: string) => void;\n  setSearchResults: (results: any[]) => void;\n  setSearchLoading: (loading: boolean) => void;\n  clearSearch: () => void;\n  \n  // Filter States\n  filters: Record<string, any>;\n  setFilter: (key: string, value: any) => void;\n  clearFilter: (key: string) => void;\n  clearAllFilters: () => void;\n  \n  // Pagination States\n  pagination: Record<string, {\n    page: number;\n    limit: number;\n    total: number;\n    hasMore: boolean;\n  }>;\n  setPagination: (key: string, pagination: Partial<UIStore['pagination'][string]>) => void;\n  nextPage: (key: string) => void;\n  prevPage: (key: string) => void;\n  resetPagination: (key: string) => void;\n  \n  // Selection States\n  selections: Record<string, Set<string>>;\n  selectItem: (key: string, itemId: string) => void;\n  deselectItem: (key: string, itemId: string) => void;\n  toggleSelection: (key: string, itemId: string) => void;\n  clearSelection: (key: string) => void;\n  clearAllSelections: () => void;\n  isSelected: (key: string, itemId: string) => boolean;\n  \n  // View States\n  viewMode: Record<string, 'grid' | 'list' | 'table'>;\n  setViewMode: (key: string, mode: 'grid' | 'list' | 'table') => void;\n  \n  // Sort States\n  sortBy: Record<string, string>;\n  sortOrder: Record<string, 'asc' | 'desc'>;\n  setSort: (key: string, by: string, order?: 'asc' | 'desc') => void;\n  toggleSort: (key: string, by: string) => void;\n  \n  // Utility Actions\n  resetUI: () => void;\n  resetSection: (section: keyof UIStore) => void;\n} & BaseStore;\n\n// Create UI store with middleware\nexport const useUIStore = create<UIStore>()(\n  devtools(\n    persist(\n      immer((set, get) => ({\n        // Initial state\n        activeTab: 'feed',\n        tabHistory: ['feed'],\n        \n        // Modal state\n        activeModal: null,\n        modalData: null,\n        modalStack: [],\n        \n        // Form state\n        formData: {},\n        formErrors: {},\n        formTouched: {},\n        \n        // Loading states\n        loadingStates: {},\n        \n        // Error states\n        errors: {},\n        \n        // Toast states\n        toasts: [],\n        \n        // Sidebar/Drawer states\n        sidebarOpen: false,\n        drawerOpen: false,\n        \n        // Search states\n        searchQuery: '',\n        searchResults: [],\n        searchLoading: false,\n        \n        // Filter states\n        filters: {},\n        \n        // Pagination states\n        pagination: {},\n        \n        // Selection states\n        selections: {},\n        \n        // View states\n        viewMode: {},\n        \n        // Sort states\n        sortBy: {},\n        sortOrder: {},\n        \n        // Base store state\n        isLoading: false,\n        error: null,\n        \n        // Base store actions\n        setBaseLoading: (loading) => set((state) => {\n          state.isLoading = loading;\n        }),\n        \n        setBaseError: (error) => set((state) => {\n          state.error = error;\n        }),\n        \n        clearBaseError: () => set((state) => {\n          state.error = null;\n        }),\n        \n        // Tab actions\n        setActiveTab: (tab) => set((state) => {\n          if (state.activeTab !== tab) {\n            state.tabHistory.push(state.activeTab);\n            state.activeTab = tab;\n            logger.info('Tab changed', { from: state.tabHistory[state.tabHistory.length - 1], to: tab });\n          }\n        }),\n        \n        goBackTab: () => set((state) => {\n          if (state.tabHistory.length > 0) {\n            const previousTab = state.tabHistory.pop();\n            if (previousTab) {\n              state.activeTab = previousTab;\n              logger.info('Tab went back', { to: previousTab });\n            }\n          }\n        }),\n        \n        clearTabHistory: () => set((state) => {\n          state.tabHistory = [];\n        }),\n        \n        // Modal actions\n        openModal: (id, data) => set((state) => {\n          state.activeModal = id;\n          state.modalData = data;\n          state.modalStack.push({\n            id,\n            data,\n            timestamp: Date.now()\n          });\n          logger.info('Modal opened', { id, data });\n        }),\n        \n        closeModal: () => set((state) => {\n          if (state.modalStack.length > 0) {\n            state.modalStack.pop();\n            if (state.modalStack.length > 0) {\n              const previousModal = state.modalStack[state.modalStack.length - 1];\n              state.activeModal = previousModal.id;\n              state.modalData = previousModal.data;\n            } else {\n              state.activeModal = null;\n              state.modalData = null;\n            }\n          } else {\n            state.activeModal = null;\n            state.modalData = null;\n          }\n          logger.info('Modal closed');\n        }),\n        \n        closeAllModals: () => set((state) => {\n          state.activeModal = null;\n          state.modalData = null;\n          state.modalStack = [];\n          logger.info('All modals closed');\n        }),\n        \n        // Form actions\n        setFormData: (key, value) => set((state) => {\n          state.formData[key] = value;\n          // Clear error when user starts typing\n          if (state.formErrors[key]) {\n            state.formErrors[key] = null;\n          }\n        }),\n        \n        setFormError: (key, error) => set((state) => {\n          state.formErrors[key] = error;\n        }),\n        \n        setFormTouched: (key, touched) => set((state) => {\n          state.formTouched[key] = touched;\n        }),\n        \n        clearForm: (key) => set((state) => {\n          if (key) {\n            delete state.formData[key];\n            delete state.formErrors[key];\n            delete state.formTouched[key];\n          } else {\n            state.formData = {};\n            state.formErrors = {};\n            state.formTouched = {};\n          }\n        }),\n        \n        validateForm: (key) => {\n          const state = get();\n          return !state.formErrors[key] && state.formTouched[key];\n        },\n        \n        // Loading actions\n        setLoading: (key, loading) => set((state) => {\n          state.loadingStates[key] = loading;\n        }),\n        \n        isLoading: (key) => {\n          const state = get();\n          return state.loadingStates[key] || false;\n        },\n        \n        clearLoading: (key) => set((state) => {\n          delete state.loadingStates[key];\n        }),\n        \n        clearAllLoading: () => set((state) => {\n          state.loadingStates = {};\n        }),\n        \n        // Error actions\n        setError: (key, error) => set((state) => {\n          state.errors[key] = error;\n        }),\n        \n        clearError: (key) => set((state) => {\n          delete state.errors[key];\n        }),\n        \n        clearAllErrors: () => set((state) => {\n          state.errors = {};\n        }),\n        \n        hasError: (key) => {\n          const state = get();\n          return !!state.errors[key];\n        },\n        \n        // Toast actions\n        addToast: (toast) => set((state) => {\n          const id = `toast-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n          state.toasts.push({\n            ...toast,\n            id,\n            timestamp: Date.now()\n          });\n          logger.info('Toast added', { id, type: toast.type, message: toast.message });\n        }),\n        \n        removeToast: (id) => set((state) => {\n          state.toasts = state.toasts.filter(toast => toast.id !== id);\n        }),\n        \n        clearToasts: () => set((state) => {\n          state.toasts = [];\n        }),\n        \n        // Sidebar/Drawer actions\n        toggleSidebar: () => set((state) => {\n          state.sidebarOpen = !state.sidebarOpen;\n        }),\n        \n        toggleDrawer: () => set((state) => {\n          state.drawerOpen = !state.drawerOpen;\n        }),\n        \n        setSidebarOpen: (open) => set((state) => {\n          state.sidebarOpen = open;\n        }),\n        \n        setDrawerOpen: (open) => set((state) => {\n          state.drawerOpen = open;\n        }),\n        \n        // Search actions\n        setSearchQuery: (query) => set((state) => {\n          state.searchQuery = query;\n        }),\n        \n        setSearchResults: (results) => set((state) => {\n          state.searchResults = results;\n        }),\n        \n        setSearchLoading: (loading) => set((state) => {\n          state.searchLoading = loading;\n        }),\n        \n        clearSearch: () => set((state) => {\n          state.searchQuery = '';\n          state.searchResults = [];\n          state.searchLoading = false;\n        }),\n        \n        // Filter actions\n        setFilter: (key, value) => set((state) => {\n          state.filters[key] = value;\n        }),\n        \n        clearFilter: (key) => set((state) => {\n          delete state.filters[key];\n        }),\n        \n        clearAllFilters: () => set((state) => {\n          state.filters = {};\n        }),\n        \n        // Pagination actions\n        setPagination: (key, pagination) => set((state) => {\n          state.pagination[key] = {\n            page: 1,\n            limit: 10,\n            total: 0,\n            hasMore: false,\n            ...state.pagination[key],\n            ...pagination\n          };\n        }),\n        \n        nextPage: (key) => set((state) => {\n          if (state.pagination[key]) {\n            state.pagination[key].page += 1;\n          }\n        }),\n        \n        prevPage: (key) => set((state) => {\n          if (state.pagination[key] && state.pagination[key].page > 1) {\n            state.pagination[key].page -= 1;\n          }\n        }),\n        \n        resetPagination: (key) => set((state) => {\n          if (state.pagination[key]) {\n            state.pagination[key].page = 1;\n          }\n        }),\n        \n        // Selection actions\n        selectItem: (key, itemId) => set((state) => {\n          if (!state.selections[key]) {\n            state.selections[key] = new Set();\n          }\n          state.selections[key].add(itemId);\n        }),\n        \n        deselectItem: (key, itemId) => set((state) => {\n          if (state.selections[key]) {\n            state.selections[key].delete(itemId);\n          }\n        }),\n        \n        toggleSelection: (key, itemId) => set((state) => {\n          if (!state.selections[key]) {\n            state.selections[key] = new Set();\n          }\n          if (state.selections[key].has(itemId)) {\n            state.selections[key].delete(itemId);\n          } else {\n            state.selections[key].add(itemId);\n          }\n        }),\n        \n        clearSelection: (key) => set((state) => {\n          if (state.selections[key]) {\n            state.selections[key].clear();\n          }\n        }),\n        \n        clearAllSelections: () => set((state) => {\n          state.selections = {};\n        }),\n        \n        isSelected: (key, itemId) => {\n          const state = get();\n          return state.selections[key]?.has(itemId) || false;\n        },\n        \n        // View actions\n        setViewMode: (key, mode) => set((state) => {\n          state.viewMode[key] = mode;\n        }),\n        \n        // Sort actions\n        setSort: (key, by, order = 'asc') => set((state) => {\n          state.sortBy[key] = by;\n          state.sortOrder[key] = order;\n        }),\n        \n        toggleSort: (key, by) => set((state) => {\n          if (state.sortBy[key] === by) {\n            state.sortOrder[key] = state.sortOrder[key] === 'asc' ? 'desc' : 'asc';\n          } else {\n            state.sortBy[key] = by;\n            state.sortOrder[key] = 'asc';\n          }\n        }),\n        \n        // Utility actions\n        resetUI: () => set((state) => {\n          state.activeTab = 'feed';\n          state.tabHistory = ['feed'];\n          state.activeModal = null;\n          state.modalData = null;\n          state.modalStack = [];\n          state.formData = {};\n          state.formErrors = {};\n          state.formTouched = {};\n          state.loadingStates = {};\n          state.errors = {};\n          state.toasts = [];\n          state.sidebarOpen = false;\n          state.drawerOpen = false;\n          state.searchQuery = '';\n          state.searchResults = [];\n          state.searchLoading = false;\n          state.filters = {};\n          state.pagination = {};\n          state.selections = {};\n          state.viewMode = {};\n          state.sortBy = {};\n          state.sortOrder = {};\n          state.isLoading = false;\n          state.error = null;\n        }),\n        \n        resetSection: (section) => set((state) => {\n          switch (section) {\n            case 'formData':\n              state.formData = {};\n              state.formErrors = {};\n              state.formTouched = {};\n              break;\n            case 'loadingStates':\n              state.loadingStates = {};\n              break;\n            case 'errors':\n              state.errors = {};\n              break;\n            case 'toasts':\n              state.toasts = [];\n              break;\n            case 'filters':\n              state.filters = {};\n              break;\n            case 'pagination':\n              state.pagination = {};\n              break;\n            case 'selections':\n              state.selections = {};\n              break;\n            default:\n              logger.warn('Unknown section to reset', { section });\n          }\n        }),\n      })),\n      {\n        name: 'ui-store',\n        partialize: (state) => ({\n          activeTab: state.activeTab,\n          sidebarOpen: state.sidebarOpen,\n          viewMode: state.viewMode,\n          sortBy: state.sortBy,\n          sortOrder: state.sortOrder,\n        }),\n      }\n    ),\n    {\n      name: 'ui-store',\n    }\n  )\n);\n\n// Export optimized selectors\nexport const useActiveTab = () => useUIStore(state => state.activeTab);\nexport const useSetActiveTab = () => useUIStore(state => state.setActiveTab);\nexport const useActiveModal = () => useUIStore(state => state.activeModal);\nexport const useModalData = () => useUIStore(state => state.modalData);\nexport const useFormData = (key: string) => useUIStore(state => state.formData[key]);\nexport const useFormError = (key: string) => useUIStore(state => state.formErrors[key]);\nexport const useFormTouched = (key: string) => useUIStore(state => state.formTouched[key]);\nexport const useLoading = (key: string) => useUIStore(state => state.loadingStates[key] || false);\nexport const useError = (key: string) => useUIStore(state => state.errors[key]);\nexport const useToasts = () => useUIStore(state => state.toasts);\nexport const useSidebarOpen = () => useUIStore(state => state.sidebarOpen);\nexport const useDrawerOpen = () => useUIStore(state => state.drawerOpen);\nexport const useSearchQuery = () => useUIStore(state => state.searchQuery);\nexport const useSearchResults = () => useUIStore(state => state.searchResults);\nexport const useSearchLoading = () => useUIStore(state => state.searchLoading);\nexport const useFilters = (key: string) => useUIStore(state => state.filters[key]);\nexport const usePagination = (key: string) => useUIStore(state => state.pagination[key]);\nexport const useSelections = (key: string) => useUIStore(state => state.selections[key]);\nexport const useViewMode = (key: string) => useUIStore(state => state.viewMode[key]);\nexport const useSortBy = (key: string) => useUIStore(state => state.sortBy[key]);\nexport const useSortOrder = (key: string) => useUIStore(state => state.sortOrder[key]);\n\n// Export action selectors\nexport const useUIActions = () => useUIStore(state => ({\n  setActiveTab: state.setActiveTab,\n  goBackTab: state.goBackTab,\n  clearTabHistory: state.clearTabHistory,\n  openModal: state.openModal,\n  closeModal: state.closeModal,\n  closeAllModals: state.closeAllModals,\n  setFormData: state.setFormData,\n  setFormError: state.setFormError,\n  setFormTouched: state.setFormTouched,\n  clearForm: state.clearForm,\n  validateForm: state.validateForm,\n  setLoading: state.setLoading,\n  clearLoading: state.clearLoading,\n  clearAllLoading: state.clearAllLoading,\n  setError: state.setError,\n  clearError: state.clearError,\n  clearAllErrors: state.clearAllErrors,\n  addToast: state.addToast,\n  removeToast: state.removeToast,\n  clearToasts: state.clearToasts,\n  toggleSidebar: state.toggleSidebar,\n  toggleDrawer: state.toggleDrawer,\n  setSidebarOpen: state.setSidebarOpen,\n  setDrawerOpen: state.setDrawerOpen,\n  setSearchQuery: state.setSearchQuery,\n  setSearchResults: state.setSearchResults,\n  setSearchLoading: state.setSearchLoading,\n  clearSearch: state.clearSearch,\n  setFilter: state.setFilter,\n  clearFilter: state.clearFilter,\n  clearAllFilters: state.clearAllFilters,\n  setPagination: state.setPagination,\n  nextPage: state.nextPage,\n  prevPage: state.prevPage,\n  resetPagination: state.resetPagination,\n  selectItem: state.selectItem,\n  deselectItem: state.deselectItem,\n  toggleSelection: state.toggleSelection,\n  clearSelection: state.clearSelection,\n  clearAllSelections: state.clearAllSelections,\n  isSelected: state.isSelected,\n  setViewMode: state.setViewMode,\n  setSort: state.setSort,\n  toggleSort: state.toggleSort,\n  resetUI: state.resetUI,\n  resetSection: state.resetSection,\n}));\n"],"names":["useActiveModal","useActiveTab","useDrawerOpen","useError","useFilters","useFormData","useFormError","useFormTouched","useLoading","useModalData","usePagination","useSearchLoading","useSearchQuery","useSearchResults","useSelections","useSetActiveTab","useSidebarOpen","useSortBy","useSortOrder","useToasts","useUIActions","useUIStore","useViewMode","enableMapSet","create","devtools","persist","immer","set","get","activeTab","tabHistory","activeModal","modalData","modalStack","formData","formErrors","formTouched","loadingStates","errors","toasts","sidebarOpen","drawerOpen","searchQuery","searchResults","searchLoading","filters","pagination","selections","viewMode","sortBy","sortOrder","isLoading","error","setBaseLoading","loading","state","setBaseError","clearBaseError","setActiveTab","tab","push","logger","info","from","length","to","goBackTab","previousTab","pop","clearTabHistory","openModal","id","data","timestamp","Date","now","closeModal","previousModal","closeAllModals","setFormData","key","value","setFormError","setFormTouched","touched","clearForm","validateForm","setLoading","clearLoading","clearAllLoading","setError","clearError","clearAllErrors","hasError","addToast","toast","Math","random","toString","substr","type","message","removeToast","filter","clearToasts","toggleSidebar","toggleDrawer","setSidebarOpen","open","setDrawerOpen","setSearchQuery","query","setSearchResults","results","setSearchLoading","clearSearch","setFilter","clearFilter","clearAllFilters","setPagination","page","limit","total","hasMore","nextPage","prevPage","resetPagination","selectItem","itemId","Set","add","deselectItem","delete","toggleSelection","has","clearSelection","clear","clearAllSelections","isSelected","setViewMode","mode","setSort","by","order","toggleSort","resetUI","resetSection","section","warn","name","partialize"],"mappings":"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"}