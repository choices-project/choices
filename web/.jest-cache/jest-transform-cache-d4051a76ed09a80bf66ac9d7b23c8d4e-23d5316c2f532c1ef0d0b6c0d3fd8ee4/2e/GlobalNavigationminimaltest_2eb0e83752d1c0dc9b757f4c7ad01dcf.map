{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/tests/jest/unit/components/shared/GlobalNavigation-minimal.test.tsx"],"sourcesContent":["/**\n * GlobalNavigation Component Tests - Minimal Mocking Approach\n * \n * Tests the actual component behavior with minimal mocking\n * Focuses on real user interactions and component logic\n */\n\nimport { render, screen, fireEvent, waitFor } from '@testing-library/react'\nimport { BrowserRouter } from 'react-router-dom'\nimport { describe, it, expect, beforeEach, jest } from '@jest/globals'\n\n// Mock lucide-react before importing the component\njest.mock('lucide-react', () => require('@/../../__mocks__/lucide-react.js'))\n\nimport GlobalNavigation from '@/components/shared/GlobalNavigation'\n\n// Mock only what's absolutely necessary\nconst mockSignOut = jest.fn()\nconst mockUser = {\n  id: 'test-user-id',\n  name: 'Test User',\n  email: 'test@example.com',\n  avatar: 'https://example.com/avatar.jpg'\n}\n\n// Mock the stores with actual implementations\njest.mock('@/lib/stores', () => ({\n  useUser: jest.fn(() => mockUser),\n  useUserActions: jest.fn(() => ({\n    signOut: mockSignOut\n  })),\n  useUserStore: jest.fn(() => ({\n    user: mockUser,\n    isAuthenticated: true,\n    signOut: mockSignOut,\n    setUserAndAuth: jest.fn(),\n    setSessionAndDerived: jest.fn(),\n    initializeAuth: jest.fn(),\n    clearUser: jest.fn()\n  }))\n}))\n\n// Mock Next.js navigation\njest.mock('next/navigation', () => ({\n  usePathname: jest.fn(() => '/dashboard')\n}))\n\nconst renderWithRouter = (component: React.ReactElement) => {\n  return render(\n    <BrowserRouter>\n      {component}\n    </BrowserRouter>\n  )\n}\n\ndescribe('GlobalNavigation - Real Behavior Tests', () => {\n  beforeEach(() => {\n    jest.clearAllMocks()\n  })\n\n  describe('Component Rendering', () => {\n    it('should render all navigation items', () => {\n      renderWithRouter(<GlobalNavigation />)\n      \n      // Test actual rendered content\n      expect(screen.getByText('Feed')).toBeInTheDocument()\n      expect(screen.getByText('Polls')).toBeInTheDocument()\n      expect(screen.getByText('Dashboard')).toBeInTheDocument()\n    })\n\n    it('should display user information when authenticated', () => {\n      renderWithRouter(<GlobalNavigation />)\n      \n      // Test that user info is actually displayed\n      expect(screen.getByText('Test User')).toBeInTheDocument()\n    })\n\n    it('should render mobile menu button', () => {\n      renderWithRouter(<GlobalNavigation />)\n      \n      // Look for the actual menu button\n      const menuButton = screen.getByRole('button', { name: /menu/i })\n      expect(menuButton).toBeInTheDocument()\n    })\n  })\n\n  describe('User Interactions', () => {\n    it('should toggle mobile menu when menu button is clicked', () => {\n      renderWithRouter(<GlobalNavigation />)\n      \n      const menuButton = screen.getByRole('button', { name: /menu/i })\n      fireEvent.click(menuButton)\n      \n      // Test that the menu actually opens (check for close button or menu items)\n      expect(screen.getByRole('button', { name: /close/i })).toBeInTheDocument()\n    })\n\n    it('should call signOut when logout is clicked', async () => {\n      renderWithRouter(<GlobalNavigation />)\n      \n      // Open mobile menu first\n      const menuButton = screen.getByRole('button', { name: /menu/i })\n      fireEvent.click(menuButton)\n      \n      // Find and click logout button\n      const logoutButton = screen.getByRole('button', { name: /logout/i })\n      fireEvent.click(logoutButton)\n      \n      expect(mockSignOut).toHaveBeenCalledTimes(1)\n    })\n\n    it('should handle logout errors gracefully', async () => {\n      mockSignOut.mockRejectedValueOnce(new Error('Logout failed'))\n      \n      renderWithRouter(<GlobalNavigation />)\n      \n      // Open mobile menu and click logout\n      const menuButton = screen.getByRole('button', { name: /menu/i })\n      fireEvent.click(menuButton)\n      \n      const logoutButton = screen.getByRole('button', { name: /logout/i })\n      fireEvent.click(logoutButton)\n      \n      expect(mockSignOut).toHaveBeenCalledTimes(1)\n      // Component should handle error gracefully (no crash)\n    })\n  })\n\n  describe('Navigation Links', () => {\n    it('should have correct href attributes', () => {\n      renderWithRouter(<GlobalNavigation />)\n      \n      const feedLink = screen.getByRole('link', { name: /feed/i })\n      const pollsLink = screen.getByRole('link', { name: /polls/i })\n      const dashboardLink = screen.getByRole('link', { name: /dashboard/i })\n      \n      expect(feedLink).toHaveAttribute('href', '/feed')\n      expect(pollsLink).toHaveAttribute('href', '/polls')\n      expect(dashboardLink).toHaveAttribute('href', '/dashboard')\n    })\n\n    it('should highlight active navigation item', () => {\n      renderWithRouter(<GlobalNavigation />)\n      \n      // Since we're mocking usePathname to return '/dashboard', \n      // the dashboard link should be active\n      const dashboardLink = screen.getByRole('link', { name: /dashboard/i })\n      // Check for active styling (adjust class name based on your component)\n      expect(dashboardLink).toHaveClass('bg-blue-50')\n    })\n  })\n\n  describe('Accessibility', () => {\n    it('should have proper ARIA labels', () => {\n      renderWithRouter(<GlobalNavigation />)\n      \n      const navigation = screen.getByRole('navigation')\n      expect(navigation).toBeInTheDocument()\n      \n      const menuButton = screen.getByRole('button', { name: /menu/i })\n      expect(menuButton).toHaveAttribute('aria-label', 'Open menu')\n    })\n\n    it('should support keyboard navigation', () => {\n      renderWithRouter(<GlobalNavigation />)\n      \n      const menuButton = screen.getByRole('button', { name: /menu/i })\n      menuButton.focus()\n      \n      // Test keyboard navigation\n      fireEvent.keyDown(menuButton, { key: 'Enter' })\n      // The menu should open\n      expect(screen.getByRole('button', { name: /close/i })).toBeInTheDocument()\n    })\n  })\n\n  describe('Error Handling', () => {\n    it('should handle missing user data gracefully', () => {\n      // Mock useUser to return null\n      jest.mocked(require('@/lib/stores').useUser).mockReturnValueOnce(null)\n      \n      renderWithRouter(<GlobalNavigation />)\n      \n      // Component should still render without crashing\n      expect(screen.getByRole('navigation')).toBeInTheDocument()\n      // Should show login/signup options instead of user info\n    })\n\n    it('should handle authentication errors', () => {\n      // Mock useUser to return an error state\n      jest.mocked(require('@/lib/stores').useUser).mockReturnValueOnce({\n        error: 'Authentication failed'\n      })\n      \n      renderWithRouter(<GlobalNavigation />)\n      \n      // Component should handle error state gracefully\n      expect(screen.getByRole('navigation')).toBeInTheDocument()\n    })\n  })\n\n  describe('Responsive Behavior', () => {\n    it('should show mobile menu button on small screens', () => {\n      // Mock window.innerWidth for mobile\n      Object.defineProperty(window, 'innerWidth', {\n        writable: true,\n        configurable: true,\n        value: 375,\n      })\n      \n      renderWithRouter(<GlobalNavigation />)\n      \n      const menuButton = screen.getByRole('button', { name: /menu/i })\n      expect(menuButton).toBeInTheDocument()\n    })\n\n    it('should hide mobile menu on desktop screens', () => {\n      // Mock window.innerWidth for desktop\n      Object.defineProperty(window, 'innerWidth', {\n        writable: true,\n        configurable: true,\n        value: 1024,\n      })\n      \n      renderWithRouter(<GlobalNavigation />)\n      \n      // Mobile menu should not be visible by default on desktop\n      expect(screen.queryByRole('button', { name: /close/i })).not.toBeInTheDocument()\n    })\n  })\n})\n\n\n\n\n\n\n\n\n\n\n"],"names":["jest","mock","require","mockSignOut","fn","mockUser","id","name","email","avatar","useUser","useUserActions","signOut","useUserStore","user","isAuthenticated","setUserAndAuth","setSessionAndDerived","initializeAuth","clearUser","usePathname","renderWithRouter","component","render","BrowserRouter","describe","beforeEach","clearAllMocks","it","GlobalNavigation","expect","screen","getByText","toBeInTheDocument","menuButton","getByRole","fireEvent","click","logoutButton","toHaveBeenCalledTimes","mockRejectedValueOnce","Error","feedLink","pollsLink","dashboardLink","toHaveAttribute","toHaveClass","navigation","focus","keyDown","key","mocked","mockReturnValueOnce","error","Object","defineProperty","window","writable","configurable","value","queryByRole","not"],"mappings":"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"}