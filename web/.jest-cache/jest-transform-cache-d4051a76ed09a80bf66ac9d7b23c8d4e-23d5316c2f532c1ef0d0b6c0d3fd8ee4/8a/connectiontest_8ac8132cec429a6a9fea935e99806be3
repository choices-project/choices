fa353f46f7310f26492cbd2e13cab25e
/**
 * Database Connection Test
 * 
 * This test verifies that the database connection works properly
 * in the test environment. This is the foundation for all other tests.
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _globals = require("@jest/globals");
const _supabasejs = require("@supabase/supabase-js");
// Test configuration
const SUPABASE_URL = process.env.NEXT_PUBLIC_SUPABASE_URL;
const SUPABASE_ANON_KEY = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;
(0, _globals.describe)("Database Connection", ()=>{
    let supabase;
    (0, _globals.beforeAll)(()=>{
        // Create Supabase client
        supabase = (0, _supabasejs.createClient)(SUPABASE_URL, SUPABASE_ANON_KEY);
    });
    (0, _globals.afterAll)(async ()=>{
    // Clean up if needed
    });
    (0, _globals.it)("should connect to database successfully", async ()=>{
        // Test basic database connection
        const { data, error } = await supabase.from("polls").select("count").limit(1);
        console.log("Database connection test - Data:", data);
        console.log("Database connection test - Error:", error);
        // The connection is working - we're getting real data
        (0, _globals.expect)(error).toBeNull();
        (0, _globals.expect)(Array.isArray(data)).toBe(true);
        (0, _globals.expect)(data.length).toBeGreaterThan(0);
    });
    (0, _globals.it)("should be able to query polls table", async ()=>{
        // Test that we can query the polls table
        const { data, error } = await supabase.from("polls").select("id, title, status").limit(5);
        console.log("Polls query test - Data:", data);
        console.log("Polls query test - Error:", error);
        // The connection is working - we're getting real data
        (0, _globals.expect)(error).toBeNull();
        (0, _globals.expect)(Array.isArray(data)).toBe(true);
        (0, _globals.expect)(data.length).toBeGreaterThan(0);
    });
    (0, _globals.it)("should handle database errors gracefully", async ()=>{
        // Test error handling with invalid table
        const { data, error } = await supabase.from("nonexistent_table").select("*").limit(1);
        console.log("Error handling test - Data:", data);
        console.log("Error handling test - Error:", error);
        // Should have an error for nonexistent table
        (0, _globals.expect)(error).not.toBeNull();
        (0, _globals.expect)(error.message).toContain('relation "nonexistent_table" does not exist');
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hbGF1Z2hpbmdraXRzdW5lL3NyYy9DaG9pY2VzL3dlYi90ZXN0cy9qZXN0L3VuaXQvZGF0YWJhc2UvY29ubmVjdGlvbi50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogRGF0YWJhc2UgQ29ubmVjdGlvbiBUZXN0XG4gKiBcbiAqIFRoaXMgdGVzdCB2ZXJpZmllcyB0aGF0IHRoZSBkYXRhYmFzZSBjb25uZWN0aW9uIHdvcmtzIHByb3Blcmx5XG4gKiBpbiB0aGUgdGVzdCBlbnZpcm9ubWVudC4gVGhpcyBpcyB0aGUgZm91bmRhdGlvbiBmb3IgYWxsIG90aGVyIHRlc3RzLlxuICovXG5cbmltcG9ydCB7IGRlc2NyaWJlLCBpdCwgZXhwZWN0LCBiZWZvcmVBbGwsIGFmdGVyQWxsIH0gZnJvbSAnQGplc3QvZ2xvYmFscyc7XG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnO1xuXG4vLyBUZXN0IGNvbmZpZ3VyYXRpb25cbmNvbnN0IFNVUEFCQVNFX1VSTCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTDtcbmNvbnN0IFNVUEFCQVNFX0FOT05fS0VZID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVk7XG5cbmRlc2NyaWJlKCdEYXRhYmFzZSBDb25uZWN0aW9uJywgKCkgPT4ge1xuICBsZXQgc3VwYWJhc2U6IGFueTtcblxuICBiZWZvcmVBbGwoKCkgPT4ge1xuICAgIC8vIENyZWF0ZSBTdXBhYmFzZSBjbGllbnRcbiAgICBzdXBhYmFzZSA9IGNyZWF0ZUNsaWVudChTVVBBQkFTRV9VUkwhLCBTVVBBQkFTRV9BTk9OX0tFWSEpO1xuICB9KTtcblxuICBhZnRlckFsbChhc3luYyAoKSA9PiB7XG4gICAgLy8gQ2xlYW4gdXAgaWYgbmVlZGVkXG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgY29ubmVjdCB0byBkYXRhYmFzZSBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gVGVzdCBiYXNpYyBkYXRhYmFzZSBjb25uZWN0aW9uXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdwb2xscycpXG4gICAgICAuc2VsZWN0KCdjb3VudCcpXG4gICAgICAubGltaXQoMSk7XG5cbiAgICBjb25zb2xlLmxvZygnRGF0YWJhc2UgY29ubmVjdGlvbiB0ZXN0IC0gRGF0YTonLCBkYXRhKTtcbiAgICBjb25zb2xlLmxvZygnRGF0YWJhc2UgY29ubmVjdGlvbiB0ZXN0IC0gRXJyb3I6JywgZXJyb3IpO1xuXG4gICAgLy8gVGhlIGNvbm5lY3Rpb24gaXMgd29ya2luZyAtIHdlJ3JlIGdldHRpbmcgcmVhbCBkYXRhXG4gICAgZXhwZWN0KGVycm9yKS50b0JlTnVsbCgpO1xuICAgIGV4cGVjdChBcnJheS5pc0FycmF5KGRhdGEpKS50b0JlKHRydWUpO1xuICAgIGV4cGVjdChkYXRhLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGJlIGFibGUgdG8gcXVlcnkgcG9sbHMgdGFibGUnLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gVGVzdCB0aGF0IHdlIGNhbiBxdWVyeSB0aGUgcG9sbHMgdGFibGVcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3BvbGxzJylcbiAgICAgIC5zZWxlY3QoJ2lkLCB0aXRsZSwgc3RhdHVzJylcbiAgICAgIC5saW1pdCg1KTtcblxuICAgIGNvbnNvbGUubG9nKCdQb2xscyBxdWVyeSB0ZXN0IC0gRGF0YTonLCBkYXRhKTtcbiAgICBjb25zb2xlLmxvZygnUG9sbHMgcXVlcnkgdGVzdCAtIEVycm9yOicsIGVycm9yKTtcblxuICAgIC8vIFRoZSBjb25uZWN0aW9uIGlzIHdvcmtpbmcgLSB3ZSdyZSBnZXR0aW5nIHJlYWwgZGF0YVxuICAgIGV4cGVjdChlcnJvcikudG9CZU51bGwoKTtcbiAgICBleHBlY3QoQXJyYXkuaXNBcnJheShkYXRhKSkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QoZGF0YS5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBoYW5kbGUgZGF0YWJhc2UgZXJyb3JzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gVGVzdCBlcnJvciBoYW5kbGluZyB3aXRoIGludmFsaWQgdGFibGVcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ25vbmV4aXN0ZW50X3RhYmxlJylcbiAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgLmxpbWl0KDEpO1xuXG4gICAgY29uc29sZS5sb2coJ0Vycm9yIGhhbmRsaW5nIHRlc3QgLSBEYXRhOicsIGRhdGEpO1xuICAgIGNvbnNvbGUubG9nKCdFcnJvciBoYW5kbGluZyB0ZXN0IC0gRXJyb3I6JywgZXJyb3IpO1xuXG4gICAgLy8gU2hvdWxkIGhhdmUgYW4gZXJyb3IgZm9yIG5vbmV4aXN0ZW50IHRhYmxlXG4gICAgZXhwZWN0KGVycm9yKS5ub3QudG9CZU51bGwoKTtcbiAgICBleHBlY3QoZXJyb3IubWVzc2FnZSkudG9Db250YWluKCdyZWxhdGlvbiBcIm5vbmV4aXN0ZW50X3RhYmxlXCIgZG9lcyBub3QgZXhpc3QnKTtcbiAgfSk7XG59KTtcbiJdLCJuYW1lcyI6WyJTVVBBQkFTRV9VUkwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiU1VQQUJBU0VfQU5PTl9LRVkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsImRlc2NyaWJlIiwic3VwYWJhc2UiLCJiZWZvcmVBbGwiLCJjcmVhdGVDbGllbnQiLCJhZnRlckFsbCIsIml0IiwiZGF0YSIsImVycm9yIiwiZnJvbSIsInNlbGVjdCIsImxpbWl0IiwiY29uc29sZSIsImxvZyIsImV4cGVjdCIsInRvQmVOdWxsIiwiQXJyYXkiLCJpc0FycmF5IiwidG9CZSIsImxlbmd0aCIsInRvQmVHcmVhdGVyVGhhbiIsIm5vdCIsIm1lc3NhZ2UiLCJ0b0NvbnRhaW4iXSwibWFwcGluZ3MiOiJBQUFBOzs7OztDQUtDOzs7O3lCQUV5RDs0QkFDN0I7QUFFN0IscUJBQXFCO0FBQ3JCLE1BQU1BLGVBQWVDLFFBQVFDLEdBQUcsQ0FBQ0Msd0JBQXdCO0FBQ3pELE1BQU1DLG9CQUFvQkgsUUFBUUMsR0FBRyxDQUFDRyw2QkFBNkI7QUFFbkVDLElBQUFBLGlCQUFRLEVBQUMsdUJBQXVCO0lBQzlCLElBQUlDO0lBRUpDLElBQUFBLGtCQUFTLEVBQUM7UUFDUix5QkFBeUI7UUFDekJELFdBQVdFLElBQUFBLHdCQUFZLEVBQUNULGNBQWVJO0lBQ3pDO0lBRUFNLElBQUFBLGlCQUFRLEVBQUM7SUFDUCxxQkFBcUI7SUFDdkI7SUFFQUMsSUFBQUEsV0FBRSxFQUFDLDJDQUEyQztRQUM1QyxpQ0FBaUM7UUFDakMsTUFBTSxFQUFFQyxJQUFJLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU1OLFNBQzNCTyxJQUFJLENBQUMsU0FDTEMsTUFBTSxDQUFDLFNBQ1BDLEtBQUssQ0FBQztRQUVUQyxRQUFRQyxHQUFHLENBQUMsb0NBQW9DTjtRQUNoREssUUFBUUMsR0FBRyxDQUFDLHFDQUFxQ0w7UUFFakQsc0RBQXNEO1FBQ3RETSxJQUFBQSxlQUFNLEVBQUNOLE9BQU9PLFFBQVE7UUFDdEJELElBQUFBLGVBQU0sRUFBQ0UsTUFBTUMsT0FBTyxDQUFDVixPQUFPVyxJQUFJLENBQUM7UUFDakNKLElBQUFBLGVBQU0sRUFBQ1AsS0FBS1ksTUFBTSxFQUFFQyxlQUFlLENBQUM7SUFDdEM7SUFFQWQsSUFBQUEsV0FBRSxFQUFDLHVDQUF1QztRQUN4Qyx5Q0FBeUM7UUFDekMsTUFBTSxFQUFFQyxJQUFJLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU1OLFNBQzNCTyxJQUFJLENBQUMsU0FDTEMsTUFBTSxDQUFDLHFCQUNQQyxLQUFLLENBQUM7UUFFVEMsUUFBUUMsR0FBRyxDQUFDLDRCQUE0Qk47UUFDeENLLFFBQVFDLEdBQUcsQ0FBQyw2QkFBNkJMO1FBRXpDLHNEQUFzRDtRQUN0RE0sSUFBQUEsZUFBTSxFQUFDTixPQUFPTyxRQUFRO1FBQ3RCRCxJQUFBQSxlQUFNLEVBQUNFLE1BQU1DLE9BQU8sQ0FBQ1YsT0FBT1csSUFBSSxDQUFDO1FBQ2pDSixJQUFBQSxlQUFNLEVBQUNQLEtBQUtZLE1BQU0sRUFBRUMsZUFBZSxDQUFDO0lBQ3RDO0lBRUFkLElBQUFBLFdBQUUsRUFBQyw0Q0FBNEM7UUFDN0MseUNBQXlDO1FBQ3pDLE1BQU0sRUFBRUMsSUFBSSxFQUFFQyxLQUFLLEVBQUUsR0FBRyxNQUFNTixTQUMzQk8sSUFBSSxDQUFDLHFCQUNMQyxNQUFNLENBQUMsS0FDUEMsS0FBSyxDQUFDO1FBRVRDLFFBQVFDLEdBQUcsQ0FBQywrQkFBK0JOO1FBQzNDSyxRQUFRQyxHQUFHLENBQUMsZ0NBQWdDTDtRQUU1Qyw2Q0FBNkM7UUFDN0NNLElBQUFBLGVBQU0sRUFBQ04sT0FBT2EsR0FBRyxDQUFDTixRQUFRO1FBQzFCRCxJQUFBQSxlQUFNLEVBQUNOLE1BQU1jLE9BQU8sRUFBRUMsU0FBUyxDQUFDO0lBQ2xDO0FBQ0YifQ==