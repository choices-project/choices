{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/tests/jest/unit/api/debug-supabase-mock.test.ts"],"sourcesContent":["/**\n * Debug Supabase Mock Test\n * \n * This test is to debug why the Supabase mock is not working\n */\n\nimport { describe, it, expect, beforeEach } from '@jest/globals';\n\n// Mock the Supabase server client\nconst mockSupabaseClient = {\n  from: jest.fn().mockReturnValue({\n    select: jest.fn().mockReturnValue({\n      eq: jest.fn().mockReturnValue({\n        limit: jest.fn().mockResolvedValue({\n          data: [{ id: 'test-poll', title: 'Test Poll' }],\n          error: null,\n        }),\n      }),\n    }),\n  }),\n};\n\n// Mock before any imports\njest.mock('@/utils/supabase/server', () => ({\n  getSupabaseServerClient: jest.fn(() => Promise.resolve(mockSupabaseClient)),\n}));\n\ndescribe('Debug Supabase Mock', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n  });\n\n  it('should mock getSupabaseServerClient correctly', async () => {\n    const { getSupabaseServerClient } = await import('@/utils/supabase/server');\n    \n    const client = await getSupabaseServerClient();\n    \n    console.log('Mock client:', client);\n    console.log('Mock client type:', typeof client);\n    console.log('Mock client from:', typeof client.from);\n    \n    expect(client).toBeDefined();\n    expect(client.from).toBeDefined();\n    expect(typeof client.from).toBe('function');\n  });\n\n  it('should be able to call mock methods', async () => {\n    const { getSupabaseServerClient } = await import('@/utils/supabase/server');\n    \n    const client = await getSupabaseServerClient();\n    \n    console.log('Client from function:', client.from);\n    console.log('Client from call result:', client.from('polls'));\n    \n    // This should work if the mock is applied correctly\n    const fromResult = client.from('polls');\n    console.log('From result:', fromResult);\n    \n    if (fromResult) {\n      const selectResult = fromResult.select();\n      console.log('Select result:', selectResult);\n      \n      const result = await selectResult.eq('status', 'active').limit(10);\n      console.log('Mock result:', result);\n      \n      expect(result).toBeDefined();\n      expect(result.data).toBeDefined();\n    } else {\n      throw new Error('client.from() returned undefined');\n    }\n  });\n});\n"],"names":["jest","mock","getSupabaseServerClient","fn","Promise","resolve","mockSupabaseClient","from","mockReturnValue","select","eq","limit","mockResolvedValue","data","id","title","error","describe","beforeEach","clearAllMocks","it","client","console","log","expect","toBeDefined","toBe","fromResult","selectResult","result","Error"],"mappings":"AAAA;;;;CAIC;AAkBD,0BAA0B;AAC1BA,KAAKC,IAAI,CAAC,2BAA2B,IAAO,CAAA;QAC1CC,yBAAyBF,KAAKG,EAAE,CAAC,IAAMC,QAAQC,OAAO,CAACC;IACzD,CAAA;;;;yBAnBiD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEjD,kCAAkC;AAClC,MAAMA,qBAAqB;IACzBC,MAAMP,KAAKG,EAAE,GAAGK,eAAe,CAAC;QAC9BC,QAAQT,KAAKG,EAAE,GAAGK,eAAe,CAAC;YAChCE,IAAIV,KAAKG,EAAE,GAAGK,eAAe,CAAC;gBAC5BG,OAAOX,KAAKG,EAAE,GAAGS,iBAAiB,CAAC;oBACjCC,MAAM;wBAAC;4BAAEC,IAAI;4BAAaC,OAAO;wBAAY;qBAAE;oBAC/CC,OAAO;gBACT;YACF;QACF;IACF;AACF;AAOAC,IAAAA,iBAAQ,EAAC,uBAAuB;IAC9BC,IAAAA,mBAAU,EAAC;QACTlB,KAAKmB,aAAa;IACpB;IAEAC,IAAAA,WAAE,EAAC,iDAAiD;QAClD,MAAM,EAAElB,uBAAuB,EAAE,GAAG,MAAM,mEAAA,QAAO;QAEjD,MAAMmB,SAAS,MAAMnB;QAErBoB,QAAQC,GAAG,CAAC,gBAAgBF;QAC5BC,QAAQC,GAAG,CAAC,qBAAqB,OAAOF;QACxCC,QAAQC,GAAG,CAAC,qBAAqB,OAAOF,OAAOd,IAAI;QAEnDiB,IAAAA,eAAM,EAACH,QAAQI,WAAW;QAC1BD,IAAAA,eAAM,EAACH,OAAOd,IAAI,EAAEkB,WAAW;QAC/BD,IAAAA,eAAM,EAAC,OAAOH,OAAOd,IAAI,EAAEmB,IAAI,CAAC;IAClC;IAEAN,IAAAA,WAAE,EAAC,uCAAuC;QACxC,MAAM,EAAElB,uBAAuB,EAAE,GAAG,MAAM,mEAAA,QAAO;QAEjD,MAAMmB,SAAS,MAAMnB;QAErBoB,QAAQC,GAAG,CAAC,yBAAyBF,OAAOd,IAAI;QAChDe,QAAQC,GAAG,CAAC,4BAA4BF,OAAOd,IAAI,CAAC;QAEpD,oDAAoD;QACpD,MAAMoB,aAAaN,OAAOd,IAAI,CAAC;QAC/Be,QAAQC,GAAG,CAAC,gBAAgBI;QAE5B,IAAIA,YAAY;YACd,MAAMC,eAAeD,WAAWlB,MAAM;YACtCa,QAAQC,GAAG,CAAC,kBAAkBK;YAE9B,MAAMC,SAAS,MAAMD,aAAalB,EAAE,CAAC,UAAU,UAAUC,KAAK,CAAC;YAC/DW,QAAQC,GAAG,CAAC,gBAAgBM;YAE5BL,IAAAA,eAAM,EAACK,QAAQJ,WAAW;YAC1BD,IAAAA,eAAM,EAACK,OAAOhB,IAAI,EAAEY,WAAW;QACjC,OAAO;YACL,MAAM,IAAIK,MAAM;QAClB;IACF;AACF"}