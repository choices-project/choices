{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/app/api/auth/_shared.ts"],"sourcesContent":["/**\n * Shared Authentication Utilities\n * \n * Common authentication functions used across API routes\n */\n\nimport { NextRequest, NextResponse } from 'next/server';\n\n/**\n * Validate CSRF protection for state-changing operations\n * In a real implementation, this would validate CSRF tokens\n * For now, we'll allow all requests in test environment\n */\nexport function validateCsrfProtection(request: NextRequest): boolean {\n  // In test environment, always allow\n  if (process.env.NODE_ENV === 'test' || process.env.NODE_ENV === 'development') {\n    return true;\n  }\n  \n  // In production, validate CSRF token\n  const csrfToken = request.headers.get('x-csrf-token');\n  const cookieToken = request.cookies.get('csrf-token')?.value;\n  \n  return csrfToken === cookieToken;\n}\n\n/**\n * Create CSRF error response\n */\nexport function createCsrfErrorResponse(): NextResponse {\n  return NextResponse.json(\n    { error: 'CSRF token validation failed' },\n    { status: 403 }\n  );\n}\n"],"names":["createCsrfErrorResponse","validateCsrfProtection","request","process","env","NODE_ENV","csrfToken","headers","get","cookieToken","cookies","value","NextResponse","json","error","status"],"mappings":"AAAA;;;;CAIC;;;;;;;;;;;IAyBeA,uBAAuB;eAAvBA;;IAhBAC,sBAAsB;eAAtBA;;;wBAP0B;AAOnC,SAASA,uBAAuBC,OAAoB;IACzD,oCAAoC;IACpC,IAAIC,QAAQC,GAAG,CAACC,QAAQ,KAAK,UAAUF,QAAQC,GAAG,CAACC,QAAQ,KAAK,eAAe;QAC7E,OAAO;IACT;IAEA,qCAAqC;IACrC,MAAMC,YAAYJ,QAAQK,OAAO,CAACC,GAAG,CAAC;IACtC,MAAMC,cAAcP,QAAQQ,OAAO,CAACF,GAAG,CAAC,eAAeG;IAEvD,OAAOL,cAAcG;AACvB;AAKO,SAAST;IACd,OAAOY,oBAAY,CAACC,IAAI,CACtB;QAAEC,OAAO;IAA+B,GACxC;QAAEC,QAAQ;IAAI;AAElB"}