{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/features/pwa/components/OfflineSync.tsx"],"sourcesContent":["'use client'\n\nimport { RefreshCw, CheckCircle, AlertCircle, Clock } from 'lucide-react'\nimport { useState } from 'react'\n\nimport { usePWA } from '@/hooks/usePWA'\n\ninterface OfflineSyncProps {\n  className?: string\n}\n\nexport default function OfflineSync({ className = '' }: OfflineSyncProps) {\n  const pwa = usePWA()\n  const [syncStatus, setSyncStatus] = useState<'idle' | 'syncing' | 'success' | 'error'>('idle')\n  const [lastSync, setLastSync] = useState<Date | null>(null)\n\n  const handleSync = async () => {\n    setSyncStatus('syncing')\n    try {\n      await pwa.syncOfflineData()\n      setSyncStatus('success')\n      setLastSync(new Date())\n      setTimeout(() => setSyncStatus('idle'), 3000)\n    } catch {\n      setSyncStatus('error')\n      setTimeout(() => setSyncStatus('idle'), 3000)\n    }\n  }\n\n  if (!pwa.hasOfflineData) {\n    return null\n  }\n\n  return (\n    <div className={`bg-blue-50 border border-blue-200 rounded-lg p-4 ${className}`} data-testid=\"offline-sync\">\n      <div className=\"flex items-center justify-between mb-3\">\n        <div className=\"flex items-center space-x-2\">\n          <RefreshCw className=\"w-5 h-5 text-blue-600\" />\n          <h3 className=\"text-sm font-medium text-blue-800\">Background Sync</h3>\n        </div>\n        {lastSync && (\n          <span className=\"text-xs text-blue-600\">\n            Last sync: {lastSync.toLocaleTimeString()}\n          </span>\n        )}\n      </div>\n\n      <div className=\"space-y-2\">\n        <div className=\"flex items-center justify-between p-2 bg-white rounded border\">\n          <div className=\"flex items-center space-x-2\">\n            <Clock className=\"w-4 h-4 text-gray-400\" />\n            <span className=\"text-sm text-gray-700\">3 offline votes pending</span>\n          </div>\n          <span className=\"text-xs text-gray-500\">2 minutes ago</span>\n        </div>\n\n        <div className=\"flex items-center justify-between p-2 bg-white rounded border\">\n          <div className=\"flex items-center space-x-2\">\n            <Clock className=\"w-4 h-4 text-gray-400\" />\n            <span className=\"text-sm text-gray-700\">1 comment pending</span>\n          </div>\n          <span className=\"text-xs text-gray-500\">5 minutes ago</span>\n        </div>\n      </div>\n\n      <button\n        onClick={handleSync}\n        disabled={syncStatus === 'syncing'}\n        className=\"w-full mt-3 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors\"\n      >\n        {syncStatus === 'syncing' ? 'Syncing...' : 'Sync Now'}\n      </button>\n\n      {syncStatus === 'success' && (\n        <div className=\"mt-2 p-2 bg-green-100 rounded border\">\n          <div className=\"flex items-center space-x-2 text-green-800\">\n            <CheckCircle className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Sync completed successfully</span>\n          </div>\n        </div>\n      )}\n\n      {syncStatus === 'error' && (\n        <div className=\"mt-2 p-2 bg-red-100 rounded border\">\n          <div className=\"flex items-center space-x-2 text-red-800\">\n            <AlertCircle className=\"w-4 h-4\" />\n            <span className=\"text-sm\">Sync failed. Please try again.</span>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n"],"names":["OfflineSync","className","pwa","usePWA","syncStatus","setSyncStatus","useState","lastSync","setLastSync","handleSync","syncOfflineData","Date","setTimeout","hasOfflineData","div","data-testid","RefreshCw","h3","span","toLocaleTimeString","Clock","button","onClick","disabled","CheckCircle","AlertCircle"],"mappings":"AAAA;;;;;+BAWA;;;eAAwBA;;;;;;;;uBARC;wBAEF;AAMR,SAASA,YAAY,EAAEC,YAAY,EAAE,EAAoB;IACtE,MAAMC,MAAMC,IAAAA,cAAM;IAClB,MAAM,CAACC,YAAYC,cAAc,GAAGC,IAAAA,eAAQ,EAA2C;IACvF,MAAM,CAACC,UAAUC,YAAY,GAAGF,IAAAA,eAAQ,EAAc;IAEtD,MAAMG,aAAa;QACjBJ,cAAc;QACd,IAAI;YACF,MAAMH,IAAIQ,eAAe;YACzBL,cAAc;YACdG,YAAY,IAAIG;YAChBC,WAAW,IAAMP,cAAc,SAAS;QAC1C,EAAE,OAAM;YACNA,cAAc;YACdO,WAAW,IAAMP,cAAc,SAAS;QAC1C;IACF;IAEA,IAAI,CAACH,IAAIW,cAAc,EAAE;QACvB,OAAO;IACT;IAEA,qBACE,sBAACC;QAAIb,WAAW,CAAC,iDAAiD,EAAEA,UAAU,CAAC;QAAEc,eAAY;;0BAC3F,sBAACD;gBAAIb,WAAU;;kCACb,sBAACa;wBAAIb,WAAU;;0CACb,qBAACe,oBAAS;gCAACf,WAAU;;0CACrB,qBAACgB;gCAAGhB,WAAU;0CAAoC;;;;oBAEnDM,0BACC,sBAACW;wBAAKjB,WAAU;;4BAAwB;4BAC1BM,SAASY,kBAAkB;;;;;0BAK7C,sBAACL;gBAAIb,WAAU;;kCACb,sBAACa;wBAAIb,WAAU;;0CACb,sBAACa;gCAAIb,WAAU;;kDACb,qBAACmB,YAAK;wCAACnB,WAAU;;kDACjB,qBAACiB;wCAAKjB,WAAU;kDAAwB;;;;0CAE1C,qBAACiB;gCAAKjB,WAAU;0CAAwB;;;;kCAG1C,sBAACa;wBAAIb,WAAU;;0CACb,sBAACa;gCAAIb,WAAU;;kDACb,qBAACmB,YAAK;wCAACnB,WAAU;;kDACjB,qBAACiB;wCAAKjB,WAAU;kDAAwB;;;;0CAE1C,qBAACiB;gCAAKjB,WAAU;0CAAwB;;;;;;0BAI5C,qBAACoB;gBACCC,SAASb;gBACTc,UAAUnB,eAAe;gBACzBH,WAAU;0BAETG,eAAe,YAAY,eAAe;;YAG5CA,eAAe,2BACd,qBAACU;gBAAIb,WAAU;0BACb,cAAA,sBAACa;oBAAIb,WAAU;;sCACb,qBAACuB,wBAAW;4BAACvB,WAAU;;sCACvB,qBAACiB;4BAAKjB,WAAU;sCAAU;;;;;YAK/BG,eAAe,yBACd,qBAACU;gBAAIb,WAAU;0BACb,cAAA,sBAACa;oBAAIb,WAAU;;sCACb,qBAACwB,wBAAW;4BAACxB,WAAU;;sCACvB,qBAACiB;4BAAKjB,WAAU;sCAAU;;;;;;;AAMtC"}