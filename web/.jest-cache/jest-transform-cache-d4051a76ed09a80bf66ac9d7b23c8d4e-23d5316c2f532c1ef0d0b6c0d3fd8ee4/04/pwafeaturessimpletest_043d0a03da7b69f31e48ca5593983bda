4555477e49446f4df14f5af60d1d242f
/**
 * @jest-environment jsdom
 */ // Mock window.matchMedia before any imports
"use strict";
// Mock lucide-react icons
jest.mock("lucide-react", ()=>({
        Bell: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "bell-icon"
            }),
        BellOff: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "bell-off-icon"
            }),
        CheckCircle: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "check-circle-icon"
            }),
        AlertCircle: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "alert-circle-icon"
            }),
        Wifi: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "wifi-icon"
            }),
        WifiOff: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "wifi-off-icon"
            }),
        Download: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "download-icon"
            }),
        Settings: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "settings-icon"
            }),
        RefreshCw: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "refresh-icon"
            }),
        Database: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "database-icon"
            }),
        Clock: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "clock-icon"
            }),
        Check: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "check-icon"
            }),
        X: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "x-icon"
            })
    }));
// Mock Zustand PWA store hooks
jest.mock("@/lib/stores", ()=>({
        usePWAInstallation: jest.fn(()=>({
                isInstalled: false,
                canInstall: true,
                install: jest.fn(),
                checkInstallationStatus: jest.fn()
            })),
        usePWAOffline: jest.fn(()=>({
                isOnline: true,
                offlineData: {
                    cachedPages: [],
                    cachedResources: [],
                    queuedActions: []
                },
                syncOfflineData: jest.fn(),
                clearOfflineData: jest.fn()
            })),
        usePWANotifications: jest.fn(()=>({
                permission: "default",
                requestPermission: jest.fn(),
                showNotification: jest.fn()
            })),
        usePWALoading: jest.fn(()=>false),
        usePWAError: jest.fn(()=>null)
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = /*#__PURE__*/ _interop_require_default(require("react"));
const _react1 = require("@testing-library/react");
const _reactrouterdom = require("react-router-dom");
const _PWAFeatures = /*#__PURE__*/ _interop_require_default(require("../../../../../../features/pwa/components/PWAFeatures"));
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
Object.defineProperty(window, "matchMedia", {
    value: jest.fn().mockImplementation((query)=>({
            matches: false,
            media: query,
            onchange: null,
            addListener: jest.fn(),
            removeListener: jest.fn(),
            addEventListener: jest.fn(),
            removeEventListener: jest.fn(),
            dispatchEvent: jest.fn()
        })),
    writable: true
});
// Mock browser APIs
Object.defineProperty(navigator, "serviceWorker", {
    value: {
        register: jest.fn(),
        ready: Promise.resolve()
    },
    writable: true
});
// Mock online/offline events
Object.defineProperty(navigator, "onLine", {
    value: true,
    writable: true
});
// Mock Notification API
Object.defineProperty(window, "Notification", {
    value: {
        permission: "granted",
        requestPermission: jest.fn().mockResolvedValue("granted")
    },
    writable: true
});
// Mock localStorage
Object.defineProperty(window, "localStorage", {
    value: {
        getItem: jest.fn(),
        setItem: jest.fn(),
        removeItem: jest.fn(),
        clear: jest.fn()
    },
    writable: true
});
describe("PWA Features - Simple Testing", ()=>{
    beforeEach(()=>{
        jest.clearAllMocks();
    });
    describe("Component Rendering", ()=>{
        it("should render PWA features when installation is available", ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_reactrouterdom.BrowserRouter, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_PWAFeatures.default, {})
            }));
            // Debug: Check what's actually rendered
            console.log("Rendered HTML:", document.body.innerHTML);
            // Check for basic PWA elements
            expect(_react1.screen.getByTestId("pwa-features")).toBeInTheDocument();
            expect(_react1.screen.getByTestId("offline-features")).toBeInTheDocument();
        });
        it("should not render when PWA is already installed and no features available", ()=>{
            // Mock already installed state
            const { usePWAInstallation } = require("@/lib/stores");
            usePWAInstallation.mockReturnValue({
                isInstalled: true,
                canInstall: false,
                install: jest.fn(),
                isInstalling: false
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_reactrouterdom.BrowserRouter, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_PWAFeatures.default, {})
            }));
            // When PWA is installed and no features available, component returns null
            expect(_react1.screen.queryByTestId("pwa-features")).not.toBeInTheDocument();
        });
        it("should render with custom className", ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_reactrouterdom.BrowserRouter, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_PWAFeatures.default, {
                    className: "custom-class"
                })
            }));
            const container = _react1.screen.getByTestId("pwa-features");
            expect(container).toHaveClass("custom-class");
        });
    });
    describe("Offline Features", ()=>{
        it("should display offline indicator", ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_reactrouterdom.BrowserRouter, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_PWAFeatures.default, {})
            }));
            expect(_react1.screen.getByTestId("offline-features")).toBeInTheDocument();
        });
        it("should show offline polls when cached pages exist", ()=>{
            // Mock offline data with cached pages
            const { usePWAOffline } = require("@/lib/stores");
            usePWAOffline.mockReturnValue({
                isOnline: false,
                offlineData: {
                    cachedPages: [
                        "poll-1",
                        "poll-2"
                    ],
                    queuedActions: []
                },
                syncOfflineData: jest.fn(),
                clearOfflineData: jest.fn()
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_reactrouterdom.BrowserRouter, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_PWAFeatures.default, {})
            }));
            expect(_react1.screen.getByTestId("offline-polls")).toBeInTheDocument();
        });
        it("should show offline queue when queued actions exist", ()=>{
            // Mock offline data with queued actions
            const { usePWAOffline } = require("@/lib/stores");
            usePWAOffline.mockReturnValue({
                isOnline: false,
                offlineData: {
                    cachedPages: [],
                    queuedActions: [
                        "action-1",
                        "action-2"
                    ]
                },
                syncOfflineData: jest.fn(),
                clearOfflineData: jest.fn()
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_reactrouterdom.BrowserRouter, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_PWAFeatures.default, {})
            }));
            expect(_react1.screen.getByTestId("offline-queue")).toBeInTheDocument();
        });
    });
    describe("Notification Features", ()=>{
        it("should display notification features", ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_reactrouterdom.BrowserRouter, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_PWAFeatures.default, {})
            }));
            expect(_react1.screen.getByTestId("notification-features")).toBeInTheDocument();
        });
        it("should show different notification types for different user roles", ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_reactrouterdom.BrowserRouter, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_PWAFeatures.default, {})
            }));
            expect(_react1.screen.getByTestId("regular-user-notifications")).toBeInTheDocument();
            expect(_react1.screen.getByTestId("admin-user-notifications")).toBeInTheDocument();
        });
    });
    describe("Performance", ()=>{
        it("should render within performance budget", ()=>{
            const startTime = performance.now();
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_reactrouterdom.BrowserRouter, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_PWAFeatures.default, {})
            }));
            const endTime = performance.now();
            const renderTime = endTime - startTime;
            expect(renderTime).toBeLessThan(100); // 100ms budget
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hbGF1Z2hpbmdraXRzdW5lL3NyYy9DaG9pY2VzL3dlYi90ZXN0cy9qZXN0L3VuaXQvY29tcG9uZW50cy9mZWF0dXJlcy9wd2EvcHdhLWZlYXR1cmVzLXNpbXBsZS50ZXN0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBqZXN0LWVudmlyb25tZW50IGpzZG9tXG4gKi9cblxuLy8gTW9jayB3aW5kb3cubWF0Y2hNZWRpYSBiZWZvcmUgYW55IGltcG9ydHNcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3csICdtYXRjaE1lZGlhJywge1xuICB2YWx1ZTogamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbihxdWVyeSA9PiAoe1xuICAgIG1hdGNoZXM6IGZhbHNlLFxuICAgIG1lZGlhOiBxdWVyeSxcbiAgICBvbmNoYW5nZTogbnVsbCxcbiAgICBhZGRMaXN0ZW5lcjogamVzdC5mbigpLFxuICAgIHJlbW92ZUxpc3RlbmVyOiBqZXN0LmZuKCksXG4gICAgYWRkRXZlbnRMaXN0ZW5lcjogamVzdC5mbigpLFxuICAgIHJlbW92ZUV2ZW50TGlzdGVuZXI6IGplc3QuZm4oKSxcbiAgICBkaXNwYXRjaEV2ZW50OiBqZXN0LmZuKCksXG4gIH0pKSxcbiAgd3JpdGFibGU6IHRydWUsXG59KTtcblxuLy8gTW9jayBicm93c2VyIEFQSXNcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShuYXZpZ2F0b3IsICdzZXJ2aWNlV29ya2VyJywge1xuICB2YWx1ZToge1xuICAgIHJlZ2lzdGVyOiBqZXN0LmZuKCksXG4gICAgcmVhZHk6IFByb21pc2UucmVzb2x2ZSgpLFxuICB9LFxuICB3cml0YWJsZTogdHJ1ZSxcbn0pO1xuXG4vLyBNb2NrIG9ubGluZS9vZmZsaW5lIGV2ZW50c1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KG5hdmlnYXRvciwgJ29uTGluZScsIHtcbiAgdmFsdWU6IHRydWUsXG4gIHdyaXRhYmxlOiB0cnVlLFxufSk7XG5cbi8vIE1vY2sgbHVjaWRlLXJlYWN0IGljb25zXG5qZXN0Lm1vY2soJ2x1Y2lkZS1yZWFjdCcsICgpID0+ICh7XG4gIEJlbGw6ICgpID0+IDxkaXYgZGF0YS10ZXN0aWQ9XCJiZWxsLWljb25cIiAvPixcbiAgQmVsbE9mZjogKCkgPT4gPGRpdiBkYXRhLXRlc3RpZD1cImJlbGwtb2ZmLWljb25cIiAvPixcbiAgQ2hlY2tDaXJjbGU6ICgpID0+IDxkaXYgZGF0YS10ZXN0aWQ9XCJjaGVjay1jaXJjbGUtaWNvblwiIC8+LFxuICBBbGVydENpcmNsZTogKCkgPT4gPGRpdiBkYXRhLXRlc3RpZD1cImFsZXJ0LWNpcmNsZS1pY29uXCIgLz4sXG4gIFdpZmk6ICgpID0+IDxkaXYgZGF0YS10ZXN0aWQ9XCJ3aWZpLWljb25cIiAvPixcbiAgV2lmaU9mZjogKCkgPT4gPGRpdiBkYXRhLXRlc3RpZD1cIndpZmktb2ZmLWljb25cIiAvPixcbiAgRG93bmxvYWQ6ICgpID0+IDxkaXYgZGF0YS10ZXN0aWQ9XCJkb3dubG9hZC1pY29uXCIgLz4sXG4gIFNldHRpbmdzOiAoKSA9PiA8ZGl2IGRhdGEtdGVzdGlkPVwic2V0dGluZ3MtaWNvblwiIC8+LFxuICBSZWZyZXNoQ3c6ICgpID0+IDxkaXYgZGF0YS10ZXN0aWQ9XCJyZWZyZXNoLWljb25cIiAvPixcbiAgRGF0YWJhc2U6ICgpID0+IDxkaXYgZGF0YS10ZXN0aWQ9XCJkYXRhYmFzZS1pY29uXCIgLz4sXG4gIENsb2NrOiAoKSA9PiA8ZGl2IGRhdGEtdGVzdGlkPVwiY2xvY2staWNvblwiIC8+LFxuICBDaGVjazogKCkgPT4gPGRpdiBkYXRhLXRlc3RpZD1cImNoZWNrLWljb25cIiAvPixcbiAgWDogKCkgPT4gPGRpdiBkYXRhLXRlc3RpZD1cIngtaWNvblwiIC8+LFxufSkpO1xuXG4vLyBNb2NrIFp1c3RhbmQgUFdBIHN0b3JlIGhvb2tzXG5qZXN0Lm1vY2soJ0AvbGliL3N0b3JlcycsICgpID0+ICh7XG4gIHVzZVBXQUluc3RhbGxhdGlvbjogamVzdC5mbigoKSA9PiAoe1xuICAgIGlzSW5zdGFsbGVkOiBmYWxzZSxcbiAgICBjYW5JbnN0YWxsOiB0cnVlLFxuICAgIGluc3RhbGw6IGplc3QuZm4oKSxcbiAgICBjaGVja0luc3RhbGxhdGlvblN0YXR1czogamVzdC5mbigpLFxuICB9KSksXG4gIHVzZVBXQU9mZmxpbmU6IGplc3QuZm4oKCkgPT4gKHtcbiAgICBpc09ubGluZTogdHJ1ZSxcbiAgICBvZmZsaW5lRGF0YToge1xuICAgICAgY2FjaGVkUGFnZXM6IFtdLFxuICAgICAgY2FjaGVkUmVzb3VyY2VzOiBbXSxcbiAgICAgIHF1ZXVlZEFjdGlvbnM6IFtdXG4gICAgfSxcbiAgICBzeW5jT2ZmbGluZURhdGE6IGplc3QuZm4oKSxcbiAgICBjbGVhck9mZmxpbmVEYXRhOiBqZXN0LmZuKCksXG4gIH0pKSxcbiAgdXNlUFdBTm90aWZpY2F0aW9uczogamVzdC5mbigoKSA9PiAoe1xuICAgIHBlcm1pc3Npb246ICdkZWZhdWx0JyxcbiAgICByZXF1ZXN0UGVybWlzc2lvbjogamVzdC5mbigpLFxuICAgIHNob3dOb3RpZmljYXRpb246IGplc3QuZm4oKSxcbiAgfSkpLFxuICB1c2VQV0FMb2FkaW5nOiBqZXN0LmZuKCgpID0+IGZhbHNlKSxcbiAgdXNlUFdBRXJyb3I6IGplc3QuZm4oKCkgPT4gbnVsbCksXG59KSk7XG5cbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyByZW5kZXIsIHNjcmVlbiB9IGZyb20gJ0B0ZXN0aW5nLWxpYnJhcnkvcmVhY3QnO1xuaW1wb3J0IHsgQnJvd3NlclJvdXRlciB9IGZyb20gJ3JlYWN0LXJvdXRlci1kb20nO1xuaW1wb3J0IFBXQUZlYXR1cmVzIGZyb20gJ0AvZmVhdHVyZXMvcHdhL2NvbXBvbmVudHMvUFdBRmVhdHVyZXMnO1xuXG4vLyBNb2NrIE5vdGlmaWNhdGlvbiBBUElcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3csICdOb3RpZmljYXRpb24nLCB7XG4gIHZhbHVlOiB7XG4gICAgcGVybWlzc2lvbjogJ2dyYW50ZWQnLFxuICAgIHJlcXVlc3RQZXJtaXNzaW9uOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoJ2dyYW50ZWQnKSxcbiAgfSxcbiAgd3JpdGFibGU6IHRydWUsXG59KTtcblxuLy8gTW9jayBsb2NhbFN0b3JhZ2Vcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3csICdsb2NhbFN0b3JhZ2UnLCB7XG4gIHZhbHVlOiB7XG4gICAgZ2V0SXRlbTogamVzdC5mbigpLFxuICAgIHNldEl0ZW06IGplc3QuZm4oKSxcbiAgICByZW1vdmVJdGVtOiBqZXN0LmZuKCksXG4gICAgY2xlYXI6IGplc3QuZm4oKSxcbiAgfSxcbiAgd3JpdGFibGU6IHRydWUsXG59KTtcblxuZGVzY3JpYmUoJ1BXQSBGZWF0dXJlcyAtIFNpbXBsZSBUZXN0aW5nJywgKCkgPT4ge1xuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0NvbXBvbmVudCBSZW5kZXJpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZW5kZXIgUFdBIGZlYXR1cmVzIHdoZW4gaW5zdGFsbGF0aW9uIGlzIGF2YWlsYWJsZScsICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEJyb3dzZXJSb3V0ZXI+XG4gICAgICAgICAgPFBXQUZlYXR1cmVzIC8+XG4gICAgICAgIDwvQnJvd3NlclJvdXRlcj5cbiAgICAgICk7XG5cbiAgICAgIC8vIERlYnVnOiBDaGVjayB3aGF0J3MgYWN0dWFsbHkgcmVuZGVyZWRcbiAgICAgIGNvbnNvbGUubG9nKCdSZW5kZXJlZCBIVE1MOicsIGRvY3VtZW50LmJvZHkuaW5uZXJIVE1MKTtcbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgZm9yIGJhc2ljIFBXQSBlbGVtZW50c1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgncHdhLWZlYXR1cmVzJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdvZmZsaW5lLWZlYXR1cmVzJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5vdCByZW5kZXIgd2hlbiBQV0EgaXMgYWxyZWFkeSBpbnN0YWxsZWQgYW5kIG5vIGZlYXR1cmVzIGF2YWlsYWJsZScsICgpID0+IHtcbiAgICAgIC8vIE1vY2sgYWxyZWFkeSBpbnN0YWxsZWQgc3RhdGVcbiAgICAgIGNvbnN0IHsgdXNlUFdBSW5zdGFsbGF0aW9uIH0gPSByZXF1aXJlKCdAL2xpYi9zdG9yZXMnKTtcbiAgICAgIHVzZVBXQUluc3RhbGxhdGlvbi5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICBpc0luc3RhbGxlZDogdHJ1ZSxcbiAgICAgICAgY2FuSW5zdGFsbDogZmFsc2UsXG4gICAgICAgIGluc3RhbGw6IGplc3QuZm4oKSxcbiAgICAgICAgaXNJbnN0YWxsaW5nOiBmYWxzZSxcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxCcm93c2VyUm91dGVyPlxuICAgICAgICAgIDxQV0FGZWF0dXJlcyAvPlxuICAgICAgICA8L0Jyb3dzZXJSb3V0ZXI+XG4gICAgICApO1xuXG4gICAgICAvLyBXaGVuIFBXQSBpcyBpbnN0YWxsZWQgYW5kIG5vIGZlYXR1cmVzIGF2YWlsYWJsZSwgY29tcG9uZW50IHJldHVybnMgbnVsbFxuICAgICAgZXhwZWN0KHNjcmVlbi5xdWVyeUJ5VGVzdElkKCdwd2EtZmVhdHVyZXMnKSkubm90LnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlbmRlciB3aXRoIGN1c3RvbSBjbGFzc05hbWUnLCAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxCcm93c2VyUm91dGVyPlxuICAgICAgICAgIDxQV0FGZWF0dXJlcyBjbGFzc05hbWU9XCJjdXN0b20tY2xhc3NcIiAvPlxuICAgICAgICA8L0Jyb3dzZXJSb3V0ZXI+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBjb250YWluZXIgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ3B3YS1mZWF0dXJlcycpO1xuICAgICAgZXhwZWN0KGNvbnRhaW5lcikudG9IYXZlQ2xhc3MoJ2N1c3RvbS1jbGFzcycpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnT2ZmbGluZSBGZWF0dXJlcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGRpc3BsYXkgb2ZmbGluZSBpbmRpY2F0b3InLCAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxCcm93c2VyUm91dGVyPlxuICAgICAgICAgIDxQV0FGZWF0dXJlcyAvPlxuICAgICAgICA8L0Jyb3dzZXJSb3V0ZXI+XG4gICAgICApO1xuXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdvZmZsaW5lLWZlYXR1cmVzJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNob3cgb2ZmbGluZSBwb2xscyB3aGVuIGNhY2hlZCBwYWdlcyBleGlzdCcsICgpID0+IHtcbiAgICAgIC8vIE1vY2sgb2ZmbGluZSBkYXRhIHdpdGggY2FjaGVkIHBhZ2VzXG4gICAgICBjb25zdCB7IHVzZVBXQU9mZmxpbmUgfSA9IHJlcXVpcmUoJ0AvbGliL3N0b3JlcycpO1xuICAgICAgdXNlUFdBT2ZmbGluZS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICBpc09ubGluZTogZmFsc2UsXG4gICAgICAgIG9mZmxpbmVEYXRhOiB7XG4gICAgICAgICAgY2FjaGVkUGFnZXM6IFsncG9sbC0xJywgJ3BvbGwtMiddLFxuICAgICAgICAgIHF1ZXVlZEFjdGlvbnM6IFtdLFxuICAgICAgICB9LFxuICAgICAgICBzeW5jT2ZmbGluZURhdGE6IGplc3QuZm4oKSxcbiAgICAgICAgY2xlYXJPZmZsaW5lRGF0YTogamVzdC5mbigpLFxuICAgICAgfSk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEJyb3dzZXJSb3V0ZXI+XG4gICAgICAgICAgPFBXQUZlYXR1cmVzIC8+XG4gICAgICAgIDwvQnJvd3NlclJvdXRlcj5cbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXN0SWQoJ29mZmxpbmUtcG9sbHMnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2hvdyBvZmZsaW5lIHF1ZXVlIHdoZW4gcXVldWVkIGFjdGlvbnMgZXhpc3QnLCAoKSA9PiB7XG4gICAgICAvLyBNb2NrIG9mZmxpbmUgZGF0YSB3aXRoIHF1ZXVlZCBhY3Rpb25zXG4gICAgICBjb25zdCB7IHVzZVBXQU9mZmxpbmUgfSA9IHJlcXVpcmUoJ0AvbGliL3N0b3JlcycpO1xuICAgICAgdXNlUFdBT2ZmbGluZS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICBpc09ubGluZTogZmFsc2UsXG4gICAgICAgIG9mZmxpbmVEYXRhOiB7XG4gICAgICAgICAgY2FjaGVkUGFnZXM6IFtdLFxuICAgICAgICAgIHF1ZXVlZEFjdGlvbnM6IFsnYWN0aW9uLTEnLCAnYWN0aW9uLTInXSxcbiAgICAgICAgfSxcbiAgICAgICAgc3luY09mZmxpbmVEYXRhOiBqZXN0LmZuKCksXG4gICAgICAgIGNsZWFyT2ZmbGluZURhdGE6IGplc3QuZm4oKSxcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxCcm93c2VyUm91dGVyPlxuICAgICAgICAgIDxQV0FGZWF0dXJlcyAvPlxuICAgICAgICA8L0Jyb3dzZXJSb3V0ZXI+XG4gICAgICApO1xuXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdvZmZsaW5lLXF1ZXVlJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdOb3RpZmljYXRpb24gRmVhdHVyZXMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBkaXNwbGF5IG5vdGlmaWNhdGlvbiBmZWF0dXJlcycsICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEJyb3dzZXJSb3V0ZXI+XG4gICAgICAgICAgPFBXQUZlYXR1cmVzIC8+XG4gICAgICAgIDwvQnJvd3NlclJvdXRlcj5cbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXN0SWQoJ25vdGlmaWNhdGlvbi1mZWF0dXJlcycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzaG93IGRpZmZlcmVudCBub3RpZmljYXRpb24gdHlwZXMgZm9yIGRpZmZlcmVudCB1c2VyIHJvbGVzJywgKCkgPT4ge1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8QnJvd3NlclJvdXRlcj5cbiAgICAgICAgICA8UFdBRmVhdHVyZXMgLz5cbiAgICAgICAgPC9Ccm93c2VyUm91dGVyPlxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgncmVndWxhci11c2VyLW5vdGlmaWNhdGlvbnMnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXN0SWQoJ2FkbWluLXVzZXItbm90aWZpY2F0aW9ucycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUGVyZm9ybWFuY2UnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZW5kZXIgd2l0aGluIHBlcmZvcm1hbmNlIGJ1ZGdldCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgICAgXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxCcm93c2VyUm91dGVyPlxuICAgICAgICAgIDxQV0FGZWF0dXJlcyAvPlxuICAgICAgICA8L0Jyb3dzZXJSb3V0ZXI+XG4gICAgICApO1xuICAgICAgXG4gICAgICBjb25zdCBlbmRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICBjb25zdCByZW5kZXJUaW1lID0gZW5kVGltZSAtIHN0YXJ0VGltZTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlbmRlclRpbWUpLnRvQmVMZXNzVGhhbigxMDApOyAvLyAxMDBtcyBidWRnZXRcbiAgICB9KTtcbiAgfSk7XG59KTsiXSwibmFtZXMiOlsiamVzdCIsIm1vY2siLCJCZWxsIiwiZGl2IiwiZGF0YS10ZXN0aWQiLCJCZWxsT2ZmIiwiQ2hlY2tDaXJjbGUiLCJBbGVydENpcmNsZSIsIldpZmkiLCJXaWZpT2ZmIiwiRG93bmxvYWQiLCJTZXR0aW5ncyIsIlJlZnJlc2hDdyIsIkRhdGFiYXNlIiwiQ2xvY2siLCJDaGVjayIsIlgiLCJ1c2VQV0FJbnN0YWxsYXRpb24iLCJmbiIsImlzSW5zdGFsbGVkIiwiY2FuSW5zdGFsbCIsImluc3RhbGwiLCJjaGVja0luc3RhbGxhdGlvblN0YXR1cyIsInVzZVBXQU9mZmxpbmUiLCJpc09ubGluZSIsIm9mZmxpbmVEYXRhIiwiY2FjaGVkUGFnZXMiLCJjYWNoZWRSZXNvdXJjZXMiLCJxdWV1ZWRBY3Rpb25zIiwic3luY09mZmxpbmVEYXRhIiwiY2xlYXJPZmZsaW5lRGF0YSIsInVzZVBXQU5vdGlmaWNhdGlvbnMiLCJwZXJtaXNzaW9uIiwicmVxdWVzdFBlcm1pc3Npb24iLCJzaG93Tm90aWZpY2F0aW9uIiwidXNlUFdBTG9hZGluZyIsInVzZVBXQUVycm9yIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJ3aW5kb3ciLCJ2YWx1ZSIsIm1vY2tJbXBsZW1lbnRhdGlvbiIsInF1ZXJ5IiwibWF0Y2hlcyIsIm1lZGlhIiwib25jaGFuZ2UiLCJhZGRMaXN0ZW5lciIsInJlbW92ZUxpc3RlbmVyIiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJkaXNwYXRjaEV2ZW50Iiwid3JpdGFibGUiLCJuYXZpZ2F0b3IiLCJyZWdpc3RlciIsInJlYWR5IiwiUHJvbWlzZSIsInJlc29sdmUiLCJtb2NrUmVzb2x2ZWRWYWx1ZSIsImdldEl0ZW0iLCJzZXRJdGVtIiwicmVtb3ZlSXRlbSIsImNsZWFyIiwiZGVzY3JpYmUiLCJiZWZvcmVFYWNoIiwiY2xlYXJBbGxNb2NrcyIsIml0IiwicmVuZGVyIiwiQnJvd3NlclJvdXRlciIsIlBXQUZlYXR1cmVzIiwiY29uc29sZSIsImxvZyIsImRvY3VtZW50IiwiYm9keSIsImlubmVySFRNTCIsImV4cGVjdCIsInNjcmVlbiIsImdldEJ5VGVzdElkIiwidG9CZUluVGhlRG9jdW1lbnQiLCJyZXF1aXJlIiwibW9ja1JldHVyblZhbHVlIiwiaXNJbnN0YWxsaW5nIiwicXVlcnlCeVRlc3RJZCIsIm5vdCIsImNsYXNzTmFtZSIsImNvbnRhaW5lciIsInRvSGF2ZUNsYXNzIiwic3RhcnRUaW1lIiwicGVyZm9ybWFuY2UiLCJub3ciLCJlbmRUaW1lIiwicmVuZGVyVGltZSIsInRvQmVMZXNzVGhhbiJdLCJtYXBwaW5ncyI6IkFBQUE7O0NBRUMsR0FFRCw0Q0FBNEM7O0FBOEI1QywwQkFBMEI7QUFDMUJBLEtBQUtDLElBQUksQ0FBQyxnQkFBZ0IsSUFBTyxDQUFBO1FBQy9CQyxNQUFNLGtCQUFNLHFCQUFDQztnQkFBSUMsZUFBWTs7UUFDN0JDLFNBQVMsa0JBQU0scUJBQUNGO2dCQUFJQyxlQUFZOztRQUNoQ0UsYUFBYSxrQkFBTSxxQkFBQ0g7Z0JBQUlDLGVBQVk7O1FBQ3BDRyxhQUFhLGtCQUFNLHFCQUFDSjtnQkFBSUMsZUFBWTs7UUFDcENJLE1BQU0sa0JBQU0scUJBQUNMO2dCQUFJQyxlQUFZOztRQUM3QkssU0FBUyxrQkFBTSxxQkFBQ047Z0JBQUlDLGVBQVk7O1FBQ2hDTSxVQUFVLGtCQUFNLHFCQUFDUDtnQkFBSUMsZUFBWTs7UUFDakNPLFVBQVUsa0JBQU0scUJBQUNSO2dCQUFJQyxlQUFZOztRQUNqQ1EsV0FBVyxrQkFBTSxxQkFBQ1Q7Z0JBQUlDLGVBQVk7O1FBQ2xDUyxVQUFVLGtCQUFNLHFCQUFDVjtnQkFBSUMsZUFBWTs7UUFDakNVLE9BQU8sa0JBQU0scUJBQUNYO2dCQUFJQyxlQUFZOztRQUM5QlcsT0FBTyxrQkFBTSxxQkFBQ1o7Z0JBQUlDLGVBQVk7O1FBQzlCWSxH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