{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/lib/stores/feedsStore.ts"],"sourcesContent":["/**\n * Feeds Store - Zustand Implementation\n * \n * Comprehensive content feed state management including feed data,\n * filtering, search, user preferences, and content interactions.\n * Consolidates feed state management and content preferences.\n * \n * Created: October 10, 2025\n * Status: âœ… ACTIVE\n */\n\nimport { create } from 'zustand';\nimport { devtools } from 'zustand/middleware';\nimport { persist } from 'zustand/middleware';\n\nimport { logger } from '@/lib/utils/logger';\nimport { withOptional } from '@/lib/utils/objects';\n\n// Feed data types\ninterface FeedItem {\n  id: string;\n  title: string;\n  content: string;\n  summary: string;\n  author: {\n    id: string;\n    name: string;\n    avatar?: string;\n    verified: boolean;\n  };\n  category: string;\n  tags: string[];\n  type: 'article' | 'video' | 'podcast' | 'poll' | 'event' | 'news';\n  source: {\n    name: string;\n    url: string;\n    logo?: string;\n    verified: boolean;\n  };\n  publishedAt: string;\n  updatedAt: string;\n  readTime: number; // minutes\n  engagement: {\n    likes: number;\n    shares: number;\n    comments: number;\n    views: number;\n  };\n  userInteraction: {\n    liked: boolean;\n    shared: boolean;\n    bookmarked: boolean;\n    read: boolean;\n    readAt?: string;\n  };\n  metadata: {\n    image?: string;\n    videoUrl?: string;\n    audioUrl?: string;\n    externalUrl?: string;\n    location?: string;\n    language: string;\n  };\n}\n\ninterface FeedCategory {\n  id: string;\n  name: string;\n  description: string;\n  color: string;\n  icon: string;\n  count: number;\n  enabled: boolean;\n}\n\ninterface FeedFilters {\n  categories: string[];\n  types: string[];\n  sources: string[];\n  dateRange: {\n    start: string;\n    end: string;\n  };\n  readStatus: 'all' | 'read' | 'unread';\n  engagement: 'all' | 'popular' | 'trending';\n  language: string;\n  tags: string[];\n}\n\ninterface FeedPreferences {\n  defaultView: 'list' | 'grid' | 'magazine';\n  sortBy: 'newest' | 'oldest' | 'popular' | 'trending' | 'relevance';\n  itemsPerPage: number;\n  autoRefresh: boolean;\n  refreshInterval: number; // minutes\n  notifications: {\n    newContent: boolean;\n    trendingContent: boolean;\n    categoryUpdates: boolean;\n    authorUpdates: boolean;\n  };\n  privacy: {\n    showReadHistory: boolean;\n    showBookmarks: boolean;\n    showLikes: boolean;\n    shareActivity: boolean;\n  };\n  content: {\n    showImages: boolean;\n    showVideos: boolean;\n    showAudio: boolean;\n    autoPlay: boolean;\n    quality: 'low' | 'medium' | 'high';\n  };\n}\n\ninterface FeedSearch {\n  query: string;\n  results: FeedItem[];\n  totalResults: number;\n  currentPage: number;\n  totalPages: number;\n  filters: FeedFilters;\n  suggestions: string[];\n  recentSearches: string[];\n}\n\n// Feeds store state interface\ninterface FeedsStore {\n  // Feed data\n  feeds: FeedItem[];\n  filteredFeeds: FeedItem[];\n  categories: FeedCategory[];\n  search: FeedSearch;\n  \n  // UI state\n  currentView: 'list' | 'grid' | 'magazine';\n  selectedFeed: FeedItem | null;\n  selectedCategory: string | null;\n  \n  // Filters and preferences\n  filters: FeedFilters;\n  preferences: FeedPreferences;\n  \n  // Loading states\n  isLoading: boolean;\n  isSearching: boolean;\n  isRefreshing: boolean;\n  isUpdating: boolean;\n  error: string | null;\n  \n  // Actions - Feed management\n  setFeeds: (feeds: FeedItem[]) => void;\n  addFeed: (feed: FeedItem) => void;\n  updateFeed: (id: string, updates: Partial<FeedItem>) => void;\n  removeFeed: (id: string) => void;\n  refreshFeeds: () => Promise<void>;\n  loadMoreFeeds: () => Promise<void>;\n  \n  // Actions - Filtering and search\n  setFilters: (filters: Partial<FeedFilters>) => void;\n  clearFilters: () => void;\n  searchFeeds: (query: string) => Promise<void>;\n  setSearchQuery: (query: string) => void;\n  clearSearch: () => void;\n  \n  // Actions - Feed interactions\n  likeFeed: (id: string) => void;\n  unlikeFeed: (id: string) => void;\n  shareFeed: (id: string) => void;\n  bookmarkFeed: (id: string) => void;\n  unbookmarkFeed: (id: string) => void;\n  markAsRead: (id: string) => void;\n  markAsUnread: (id: string) => void;\n  \n  // Actions - Categories\n  setCategories: (categories: FeedCategory[]) => void;\n  toggleCategory: (categoryId: string) => void;\n  setSelectedCategory: (categoryId: string | null) => void;\n  \n  // Actions - Preferences\n  updatePreferences: (preferences: Partial<FeedPreferences>) => void;\n  resetPreferences: () => void;\n  \n  // Actions - View management\n  setCurrentView: (view: 'list' | 'grid' | 'magazine') => void;\n  setSelectedFeed: (feed: FeedItem | null) => void;\n  \n  // Actions - Data operations\n  loadFeeds: (category?: string) => Promise<void>;\n  loadCategories: () => Promise<void>;\n  saveUserInteraction: (feedId: string, interaction: Partial<FeedItem['userInteraction']>) => Promise<void>;\n  \n  // Actions - Loading states\n  setLoading: (loading: boolean) => void;\n  setSearching: (searching: boolean) => void;\n  setRefreshing: (refreshing: boolean) => void;\n  setUpdating: (updating: boolean) => void;\n  setError: (error: string | null) => void;\n  clearError: () => void;\n}\n\n// Default feed preferences\nconst defaultPreferences: FeedPreferences = {\n  defaultView: 'list',\n  sortBy: 'newest',\n  itemsPerPage: 20,\n  autoRefresh: true,\n  refreshInterval: 15,\n  notifications: {\n    newContent: true,\n    trendingContent: true,\n    categoryUpdates: false,\n    authorUpdates: false,\n  },\n  privacy: {\n    showReadHistory: false,\n    showBookmarks: true,\n    showLikes: true,\n    shareActivity: false,\n  },\n  content: {\n    showImages: true,\n    showVideos: true,\n    showAudio: true,\n    autoPlay: false,\n    quality: 'medium',\n  },\n};\n\n// Default feed filters\nconst defaultFilters: FeedFilters = {\n  categories: [],\n  types: [],\n  sources: [],\n  dateRange: {\n    start: '',\n    end: '',\n  },\n  readStatus: 'all',\n  engagement: 'all',\n  language: 'en',\n  tags: [],\n};\n\n// Create feeds store with middleware\nexport const useFeedsStore = create<FeedsStore>()(\n  devtools(\n    persist(\n      (set, get) => ({\n        // Initial state\n        feeds: [],\n        filteredFeeds: [],\n        categories: [],\n        search: {\n          query: '',\n          results: [],\n          totalResults: 0,\n          currentPage: 1,\n          totalPages: 1,\n          filters: defaultFilters,\n          suggestions: [],\n          recentSearches: [],\n        },\n        currentView: 'list',\n        selectedFeed: null,\n        selectedCategory: null,\n        filters: defaultFilters,\n        preferences: defaultPreferences,\n        isLoading: false,\n        isSearching: false,\n        isRefreshing: false,\n        isUpdating: false,\n        error: null,\n        \n        // Feed management actions\n        setFeeds: (feeds) => set({ feeds, filteredFeeds: feeds }),\n        \n        addFeed: (feed) => set((state) => ({\n          feeds: [feed, ...state.feeds],\n          filteredFeeds: [feed, ...state.filteredFeeds],\n        })),\n        \n        updateFeed: (id, updates) => set((state) => ({\n          feeds: state.feeds.map(feed =>\n            feed.id === id ? { ...feed, ...updates } : feed\n          ),\n          filteredFeeds: state.filteredFeeds.map(feed =>\n            feed.id === id ? { ...feed, ...updates } : feed\n          ),\n        })),\n        \n        removeFeed: (id) => set((state) => ({\n          feeds: state.feeds.filter(feed => feed.id !== id),\n          filteredFeeds: state.filteredFeeds.filter(feed => feed.id !== id),\n        })),\n        \n        refreshFeeds: async () => {\n          const { isRefreshing } = get();\n          if (isRefreshing) return; // Prevent multiple simultaneous calls\n          \n          try {\n            set({ isRefreshing: true, error: null });\n            \n            const response = await fetch('/api/feeds', {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({ category: null }),\n            });\n            \n            if (!response.ok) {\n              throw new Error('Failed to refresh feeds');\n            }\n            \n            const feeds = await response.json();\n            set({ feeds, filteredFeeds: feeds, isRefreshing: false });\n            \n            logger.info('Feeds refreshed successfully');\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            set({ error: errorMessage, isRefreshing: false });\n            logger.error('Failed to refresh feeds:', error instanceof Error ? error : new Error(errorMessage));\n          }\n        },\n        \n        loadMoreFeeds: async () => {\n          const { isLoading } = get();\n          if (isLoading) return; // Prevent multiple simultaneous calls\n          \n          try {\n            set({ isLoading: true, error: null });\n            \n            const response = await fetch('/api/feeds', {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({ category: null }),\n            });\n            \n            if (!response.ok) {\n              throw new Error('Failed to load more feeds');\n            }\n            \n            const newFeeds = await response.json();\n            set((state) => ({\n              feeds: [...state.feeds, ...newFeeds],\n              filteredFeeds: [...state.filteredFeeds, ...newFeeds],\n              isLoading: false\n            }));\n            \n            logger.info('More feeds loaded');\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            set({ error: errorMessage, isLoading: false });\n            logger.error('Failed to load more feeds:', error instanceof Error ? error : new Error(errorMessage));\n          }\n        },\n        \n        // Filtering and search actions\n        setFilters: (filters) => set((state) => {\n          const newFilters = { ...state.filters, ...filters };\n          \n          // Apply filters to feeds\n          const filtered = state.feeds.filter(feed => {\n            if (newFilters.categories && newFilters.categories.length > 0 && !newFilters.categories.includes(feed.category)) {\n              return false;\n            }\n            if (newFilters.types && newFilters.types.length > 0 && !newFilters.types.includes(feed.type)) {\n              return false;\n            }\n            if (newFilters.sources && newFilters.sources.length > 0 && !newFilters.sources.includes(feed.source.name)) {\n              return false;\n            }\n            if (newFilters.readStatus === 'read' && !feed.userInteraction.read) {\n              return false;\n            }\n            if (newFilters.readStatus === 'unread' && feed.userInteraction.read) {\n              return false;\n            }\n            if (newFilters.tags && newFilters.tags.length > 0 && !newFilters.tags.some(tag => feed.tags.includes(tag))) {\n              return false;\n            }\n            return true;\n          });\n          \n          return { filters: newFilters, filteredFeeds: filtered };\n        }),\n        \n        clearFilters: () => set((state) => ({\n          filters: defaultFilters,\n          filteredFeeds: state.feeds,\n        })),\n        \n        searchFeeds: async (query) => {\n          const { setSearching, setError } = get();\n          \n          try {\n            setSearching(true);\n            setError(null);\n            \n            const response = await fetch('/api/feeds/search', {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({ query }),\n            });\n            \n            if (!response.ok) {\n              throw new Error('Failed to search feeds');\n            }\n            \n            const results = await response.json();\n            \n            set((state) => ({\n              search: {\n                ...state.search,\n                query,\n                results: results.items,\n                totalResults: results.total,\n                currentPage: 1,\n                totalPages: Math.ceil(results.total / state.preferences.itemsPerPage),\n              },\n            }));\n            \n            logger.info('Feeds searched', {\n              query,\n              results: results.items.length,\n              total: results.total\n            });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to search feeds:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setSearching(false);\n          }\n        },\n        \n        setSearchQuery: (query) => set((state) => ({\n          search: { ...state.search, query }\n        })),\n        \n        clearSearch: () => set((state) => ({\n          search: {\n            ...state.search,\n            query: '',\n            results: [],\n            totalResults: 0,\n            currentPage: 1,\n            totalPages: 1,\n          }\n        })),\n        \n        // Feed interaction actions\n        likeFeed: (id) => set((state) => ({\n          feeds: state.feeds.map(feed =>\n            feed.id === id \n              ? { \n                  ...feed,\n                  userInteraction: { ...feed.userInteraction, liked: true },\n                  engagement: { ...feed.engagement, likes: feed.engagement.likes + 1 }\n                }\n              : feed\n          ),\n          filteredFeeds: state.filteredFeeds.map(feed =>\n            feed.id === id \n              ? { \n                  ...feed,\n                  userInteraction: { ...feed.userInteraction, liked: true },\n                  engagement: { ...feed.engagement, likes: feed.engagement.likes + 1 }\n                }\n              : feed\n          ),\n        })),\n        \n        unlikeFeed: (id) => set((state) => ({\n          feeds: state.feeds.map(feed =>\n            feed.id === id \n              ? { \n                  ...feed,\n                  userInteraction: { ...feed.userInteraction, liked: false },\n                  engagement: { ...feed.engagement, likes: Math.max(0, feed.engagement.likes - 1) }\n                }\n              : feed\n          ),\n          filteredFeeds: state.filteredFeeds.map(feed =>\n            feed.id === id \n              ? { \n                  ...feed,\n                  userInteraction: { ...feed.userInteraction, liked: false },\n                  engagement: { ...feed.engagement, likes: Math.max(0, feed.engagement.likes - 1) }\n                }\n              : feed\n          ),\n        })),\n        \n        shareFeed: (id) => set((state) => ({\n          feeds: state.feeds.map(feed =>\n            feed.id === id \n              ? { \n                  ...feed,\n                  userInteraction: { ...feed.userInteraction, shared: true },\n                  engagement: { ...feed.engagement, shares: feed.engagement.shares + 1 }\n                }\n              : feed\n          ),\n          filteredFeeds: state.filteredFeeds.map(feed =>\n            feed.id === id \n              ? { \n                  ...feed,\n                  userInteraction: { ...feed.userInteraction, shared: true },\n                  engagement: { ...feed.engagement, shares: feed.engagement.shares + 1 }\n                }\n              : feed\n          ),\n        })),\n        \n        bookmarkFeed: (id) => set((state) => ({\n          feeds: state.feeds.map(feed =>\n            feed.id === id \n              ? { ...feed, userInteraction: { ...feed.userInteraction, bookmarked: true } }\n              : feed\n          ),\n          filteredFeeds: state.filteredFeeds.map(feed =>\n            feed.id === id \n              ? { ...feed, userInteraction: { ...feed.userInteraction, bookmarked: true } }\n              : feed\n          ),\n        })),\n        \n        unbookmarkFeed: (id) => set((state) => ({\n          feeds: state.feeds.map(feed =>\n            feed.id === id \n              ? { ...feed, userInteraction: { ...feed.userInteraction, bookmarked: false } }\n              : feed\n          ),\n          filteredFeeds: state.filteredFeeds.map(feed =>\n            feed.id === id \n              ? { ...feed, userInteraction: { ...feed.userInteraction, bookmarked: false } }\n              : feed\n          ),\n        })),\n        \n        markAsRead: (id) => set((state) => ({\n          feeds: state.feeds.map(feed =>\n            feed.id === id \n              ? { \n                  ...feed,\n                  userInteraction: { \n                    ...feed.userInteraction, \n                    read: true, \n                    readAt: new Date().toISOString() \n                  }\n                }\n              : feed\n          ),\n          filteredFeeds: state.filteredFeeds.map(feed =>\n            feed.id === id \n              ? { \n                  ...feed,\n                  userInteraction: { \n                    ...feed.userInteraction, \n                    read: true, \n                    readAt: new Date().toISOString() \n                  }\n                }\n              : feed\n          ),\n        })),\n        \n        markAsUnread: (id) => set((state) => ({\n          feeds: state.feeds.map(feed =>\n            feed.id === id \n              ? { \n                  ...feed,\n                  userInteraction: { \n                    ...feed.userInteraction, \n                    read: false, \n                    readAt: undefined \n                  }\n                }\n              : feed\n          ),\n          filteredFeeds: state.filteredFeeds.map(feed =>\n            feed.id === id \n              ? { \n                  ...feed,\n                  userInteraction: { \n                    ...feed.userInteraction, \n                    read: false, \n                    readAt: undefined \n                  }\n                }\n              : feed\n          ),\n        })),\n        \n        // Category actions\n        setCategories: (categories) => set({ categories }),\n        \n        toggleCategory: (categoryId) => set((state) => ({\n          categories: state.categories.map(category =>\n            category.id === categoryId \n              ? { ...category, enabled: !category.enabled }\n              : category\n          )\n        })),\n        \n        setSelectedCategory: (categoryId) => set({ selectedCategory: categoryId }),\n        \n        // Preferences actions\n        updatePreferences: (preferences) => set((state) => ({\n          preferences: { ...state.preferences, ...preferences }\n        })),\n        \n        resetPreferences: () => set({ preferences: defaultPreferences }),\n        \n        // View management actions\n        setCurrentView: (view) => set({ currentView: view }),\n        \n        setSelectedFeed: (feed) => set({ selectedFeed: feed }),\n        \n        // Data operations\n        loadFeeds: async (category) => {\n          try {\n            set({ isLoading: true, error: null });\n            \n            const response = await fetch('/api/feeds', {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({ category }),\n            });\n            \n            if (response && response.ok) {\n              const feeds = await response.json();\n              set({ feeds, filteredFeeds: feeds, isLoading: false });\n              \n              logger.info('Feeds loaded', {\n                category,\n                count: feeds.length\n              });\n            } else {\n              // No fallback data - just set empty state\n              set({ feeds: [], filteredFeeds: [], isLoading: false });\n            }\n          } catch (error) {\n            // No fallback data - just set empty state on error\n            set({ feeds: [], filteredFeeds: [], isLoading: false });\n            logger.info('API error, using empty state:', { error: error instanceof Error ? error.message : 'Unknown error' });\n          }\n        },\n        \n        loadCategories: async () => {\n          try {\n            set({ isLoading: true, error: null });\n            \n            const response = await fetch('/api/feeds/categories');\n            \n            if (!response.ok) {\n              throw new Error('Failed to load categories');\n            }\n            \n            const categories = await response.json();\n            set({ categories, isLoading: false });\n            \n            logger.info('Feed categories loaded', {\n              count: categories.length\n            });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            set({ error: errorMessage, isLoading: false });\n            logger.error('Failed to load categories:', error instanceof Error ? error : new Error(errorMessage));\n          }\n        },\n        \n        saveUserInteraction: async (feedId, interaction) => {\n          try {\n            set({ isUpdating: true, error: null });\n            \n            const response = await fetch('/api/feeds/interactions', {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({ feedId, interaction }),\n            });\n            \n            if (!response.ok) {\n              throw new Error('Failed to save user interaction');\n            }\n            \n            set({ isUpdating: false });\n            logger.info('User interaction saved', {\n              feedId,\n              interaction\n            });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            set({ error: errorMessage, isUpdating: false });\n            logger.error('Failed to save user interaction:', error instanceof Error ? error : new Error(errorMessage));\n          }\n        },\n        \n        // Loading state actions\n        setLoading: (loading) => set({ isLoading: loading }),\n        setSearching: (searching) => set({ isSearching: searching }),\n        setRefreshing: (refreshing) => set({ isRefreshing: refreshing }),\n        setUpdating: (updating) => set({ isUpdating: updating }),\n        setError: (error) => set({ error }),\n        clearError: () => set({ error: null }),\n      }),\n      {\n        name: 'feeds-store',\n        partialize: (state) => ({\n          feeds: state.feeds,\n          categories: state.categories,\n          preferences: state.preferences,\n          filters: state.filters,\n          currentView: state.currentView,\n        }),\n      }\n    ),\n    { name: 'feeds-store' }\n  )\n);\n\n// Store selectors for optimized re-renders\nexport const useFeeds = () => useFeedsStore(state => state.feeds);\nexport const useFilteredFeeds = () => useFeedsStore(state => state.filteredFeeds);\nexport const useFeedCategories = () => useFeedsStore(state => state.categories);\nexport const useFeedSearch = () => useFeedsStore(state => state.search);\nexport const useSelectedFeed = () => useFeedsStore(state => state.selectedFeed);\nexport const useFeedPreferences = () => useFeedsStore(state => state.preferences);\nexport const useFeedFilters = () => useFeedsStore(state => state.filters);\nexport const useFeedsLoading = () => useFeedsStore(state => state.isLoading);\nexport const useFeedsError = () => useFeedsStore(state => state.error);\n\n// Action selectors - FIXED: Use individual selectors to prevent infinite re-renders\nexport const useFeedsActions = () => useFeedsStore(state => state);\n\n// Computed selectors\nexport const useFeedsStats = () => useFeedsStore(state => ({\n  totalFeeds: state.feeds.length,\n  filteredFeeds: state.filteredFeeds.length,\n  totalCategories: state.categories.length,\n  enabledCategories: state.categories.filter(cat => cat.enabled).length,\n  searchResults: state.search.results.length,\n  isLoading: state.isLoading,\n  isSearching: state.isSearching,\n  error: state.error,\n}));\n\nexport const useBookmarkedFeeds = () => useFeedsStore(state => \n  state.feeds.filter(feed => feed.userInteraction.bookmarked)\n);\n\nexport const useUnreadFeeds = () => useFeedsStore(state => \n  state.feeds.filter(feed => !feed.userInteraction.read)\n);\n\nexport const useLikedFeeds = () => useFeedsStore(state => \n  state.feeds.filter(feed => feed.userInteraction.liked)\n);\n\n// Store utilities\nexport const feedsStoreUtils = {\n  /**\n   * Get feeds summary\n   */\n  getFeedsSummary: () => {\n    const state = useFeedsStore.getState();\n    return {\n      totalFeeds: state.feeds.length,\n      filteredFeeds: state.filteredFeeds.length,\n      categories: state.categories.length,\n      searchResults: state.search.results.length,\n      preferences: state.preferences,\n    };\n  },\n  \n  /**\n   * Get feeds by category\n   */\n  getFeedsByCategory: (category: string) => {\n    const state = useFeedsStore.getState();\n    return state.feeds.filter(feed => feed.category === category);\n  },\n  \n  /**\n   * Get feeds by type\n   */\n  getFeedsByType: (type: string) => {\n    const state = useFeedsStore.getState();\n    return state.feeds.filter(feed => feed.type === type);\n  },\n  \n  /**\n   * Get trending feeds\n   */\n  getTrendingFeeds: () => {\n    const state = useFeedsStore.getState();\n    return state.feeds\n      .sort((a, b) => (b.engagement.likes + b.engagement.shares) - (a.engagement.likes + a.engagement.shares))\n      .slice(0, 10);\n  },\n  \n  /**\n   * Get recent feeds\n   */\n  getRecentFeeds: (limit: number = 10) => {\n    const state = useFeedsStore.getState();\n    return state.feeds\n      .sort((a, b) => new Date(b.publishedAt).getTime() - new Date(a.publishedAt).getTime())\n      .slice(0, limit);\n  }\n};\n\n// Store subscriptions for external integrations\nexport const feedsStoreSubscriptions = {\n  /**\n   * Subscribe to feeds changes\n   */\n  onFeedsChange: (callback: (feeds: FeedItem[]) => void) => {\n    return useFeedsStore.subscribe(\n      (state) => {\n        callback(state.feeds);\n      }\n    );\n  },\n  \n  /**\n   * Subscribe to search results changes\n   */\n  onSearchResultsChange: (callback: (results: FeedItem[]) => void) => {\n    return useFeedsStore.subscribe(\n      (state) => {\n        callback(state.search.results);\n      }\n    );\n  },\n  \n  /**\n   * Subscribe to preferences changes\n   */\n  onPreferencesChange: (callback: (preferences: FeedPreferences) => void) => {\n    return useFeedsStore.subscribe(\n      (state) => {\n        callback(state.preferences);\n      }\n    );\n  }\n};\n\n// Store debugging utilities\nexport const feedsStoreDebug = {\n  /**\n   * Log current feeds state\n   */\n  logState: () => {\n    const state = useFeedsStore.getState();\n    console.log('Feeds Store State:', {\n      totalFeeds: state.feeds.length,\n      filteredFeeds: state.filteredFeeds.length,\n      categories: state.categories.length,\n      searchResults: state.search.results.length,\n      currentView: state.currentView,\n      selectedCategory: state.selectedCategory,\n      isLoading: state.isLoading,\n      error: state.error\n    });\n  },\n  \n  /**\n   * Log feeds summary\n   */\n  logSummary: () => {\n    const summary = feedsStoreUtils.getFeedsSummary();\n    console.log('Feeds Summary:', summary);\n  },\n  \n  /**\n   * Log feeds by category\n   */\n  logFeedsByCategory: () => {\n    const state = useFeedsStore.getState();\n    const byCategory = state.feeds.reduce((acc, feed) => {\n      acc[feed.category] = (acc[feed.category] || 0) + 1;\n      return acc;\n    }, {} as Record<string, number>);\n    console.log('Feeds by Category:', byCategory);\n  },\n  \n  /**\n   * Reset feeds store\n   */\n  reset: () => {\n    useFeedsStore.getState().clearFilters();\n    useFeedsStore.getState().resetPreferences();\n    console.log('Feeds store reset');\n  }\n};\n"],"names":["feedsStoreDebug","feedsStoreSubscriptions","feedsStoreUtils","useBookmarkedFeeds","useFeedCategories","useFeedFilters","useFeedPreferences","useFeedSearch","useFeeds","useFeedsActions","useFeedsError","useFeedsLoading","useFeedsStats","useFeedsStore","useFilteredFeeds","useLikedFeeds","useSelectedFeed","useUnreadFeeds","defaultPreferences","defaultView","sortBy","itemsPerPage","autoRefresh","refreshInterval","notifications","newContent","trendingContent","categoryUpdates","authorUpdates","privacy","showReadHistory","showBookmarks","showLikes","shareActivity","content","showImages","showVideos","showAudio","autoPlay","quality","defaultFilters","categories","types","sources","dateRange","start","end","readStatus","engagement","language","tags","create","devtools","persist","set","get","feeds","filteredFeeds","search","query","results","totalResults","currentPage","totalPages","filters","suggestions","recentSearches","currentView","selectedFeed","selectedCategory","preferences","isLoading","isSearching","isRefreshing","isUpdating","error","setFeeds","addFeed","feed","state","updateFeed","id","updates","map","removeFeed","filter","refreshFeeds","response","fetch","method","headers","body","JSON","stringify","category","ok","Error","json","logger","info","errorMessage","message","loadMoreFeeds","newFeeds","setFilters","newFilters","filtered","length","includes","type","source","name","userInteraction","read","some","tag","clearFilters","searchFeeds","setSearching","setError","items","total","Math","ceil","setSearchQuery","clearSearch","likeFeed","liked","likes","unlikeFeed","max","shareFeed","shared","shares","bookmarkFeed","bookmarked","unbookmarkFeed","markAsRead","readAt","Date","toISOString","markAsUnread","undefined","setCategories","toggleCategory","categoryId","enabled","setSelectedCategory","updatePreferences","resetPreferences","setCurrentView","view","setSelectedFeed","loadFeeds","count","loadCategories","saveUserInteraction","feedId","interaction","setLoading","loading","searching","setRefreshing","refreshing","setUpdating","updating","clearError","partialize","totalFeeds","totalCategories","enabledCategories","cat","searchResults","getFeedsSummary","getState","getFeedsByCategory","getFeedsByType","getTrendingFeeds","sort","a","b","slice","getRecentFeeds","limit","publishedAt","getTime","onFeedsChange","callback","subscribe","onSearchResultsChange","onPreferencesChange","logState","console","log","logSummary","summary","logFeedsByCategory","byCategory","reduce","acc","reset"],"mappings":"AAAA;;;;;;;;;CASC;;;;;;;;;;;IAy0BYA,eAAe;eAAfA;;IApCAC,uBAAuB;eAAvBA;;IArDAC,eAAe;eAAfA;;IAbAC,kBAAkB;eAAlBA;;IAvBAC,iBAAiB;eAAjBA;;IAIAC,cAAc;eAAdA;;IADAC,kBAAkB;eAAlBA;;IAFAC,aAAa;eAAbA;;IAHAC,QAAQ;eAARA;;IAWAC,eAAe;eAAfA;;IAHAC,aAAa;eAAbA;;IADAC,eAAe;eAAfA;;IAOAC,aAAa;eAAbA;;IA3eAC,aAAa;eAAbA;;IA8dAC,gBAAgB;eAAhBA;;IAgCAC,aAAa;eAAbA;;IA7BAC,eAAe;eAAfA;;IAyBAC,cAAc;eAAdA;;;yBAruBU;4BACE;wBAGF;AA2LvB,2BAA2B;AAC3B,MAAMC,qBAAsC;IAC1CC,aAAa;IACbC,QAAQ;IACRC,cAAc;IACdC,aAAa;IACbC,iBAAiB;IACjBC,eAAe;QACbC,YAAY;QACZC,iBAAiB;QACjBC,iBAAiB;QACjBC,eAAe;IACjB;IACAC,SAAS;QACPC,iBAAiB;QACjBC,eAAe;QACfC,WAAW;QACXC,eAAe;IACjB;IACAC,SAAS;QACPC,YAAY;QACZC,YAAY;QACZC,WAAW;QACXC,UAAU;QACVC,SAAS;IACX;AACF;AAEA,uBAAuB;AACvB,MAAMC,iBAA8B;IAClCC,YAAY,EAAE;IACdC,OAAO,EAAE;IACTC,SAAS,EAAE;IACXC,WAAW;QACTC,OAAO;QACPC,KAAK;IACP;IACAC,YAAY;IACZC,YAAY;IACZC,UAAU;IACVC,MAAM,EAAE;AACV;AAGO,MAAMrC,gBAAgBsC,IAAAA,eAAM,IACjCC,IAAAA,oBAAQ,EACNC,IAAAA,mBAAO,EACL,CAACC,KAAKC,MAAS,CAAA;QACb,gBAAgB;QAChBC,OAAO,EAAE;QACTC,eAAe,EAAE;QACjBhB,YAAY,EAAE;QACdiB,QAAQ;YACNC,OAAO;YACPC,SAAS,EAAE;YACXC,cAAc;YACdC,aAAa;YACbC,YAAY;YACZC,SAASxB;YACTyB,aAAa,EAAE;YACfC,gBAAgB,EAAE;QACpB;QACAC,aAAa;QACbC,cAAc;QACdC,kBAAkB;QAClBL,SAASxB;QACT8B,aAAapD;QACbqD,WAAW;QACXC,aAAa;QACbC,cAAc;QACdC,YAAY;QACZC,OAAO;QAEP,0BAA0B;QAC1BC,UAAU,CAACpB,QAAUF,IAAI;gBAAEE;gBAAOC,eAAeD;YAAM;QAEvDqB,SAAS,CAACC,OAASxB,IAAI,CAACyB,QAAW,CAAA;oBACjCvB,OAAO;wBAACsB;2BAASC,MAAMvB,KAAK;qBAAC;oBAC7BC,eAAe;wBAACqB;2BAASC,MAAMtB,aAAa;qBAAC;gBAC/C,CAAA;QAEAuB,YAAY,CAACC,IAAIC,UAAY5B,IAAI,CAACyB,QAAW,CAAA;oBAC3CvB,OAAOuB,MAAMvB,KAAK,CAAC2B,GAAG,CAACL,CAAAA,OACrBA,KAAKG,EAAE,KAAKA,KAAK;4BAAE,GAAGH,IAAI;4BAAE,GAAGI,OAAO;wBAAC,IAAIJ;oBAE7CrB,eAAesB,MAAMtB,aAAa,CAAC0B,GAAG,CAACL,CAAAA,OACrCA,KAAKG,EAAE,KAAKA,KAAK;4BAAE,GAAGH,IAAI;4BAAE,GAAGI,OAAO;wBAAC,IAAIJ;gBAE/C,CAAA;QAEAM,YAAY,CAACH,KAAO3B,IAAI,CAACyB,QAAW,CAAA;oBAClCvB,OAAOuB,MAAMvB,KAAK,CAAC6B,MAAM,CAACP,CAAAA,OAAQA,KAAKG,EAAE,KAAKA;oBAC9CxB,eAAesB,MAAMtB,aAAa,CAAC4B,MAAM,CAACP,CAAAA,OAAQA,KAAKG,EAAE,KAAKA;gBAChE,CAAA;QAEAK,cAAc;YACZ,MAAM,EAAEb,YAAY,EAAE,GAAGlB;YACzB,IAAIkB,cAAc,QAAQ,sCAAsC;YAEhE,IAAI;gBACFnB,IAAI;oBAAEmB,cAAc;oBAAME,OAAO;gBAAK;gBAEtC,MAAMY,WAAW,MAAMC,MAAM,cAAc;oBACzCC,QAAQ;oBACRC,SAAS;wBAAE,gBAAgB;oBAAmB;oBAC9CC,MAAMC,KAAKC,SAAS,CAAC;wBAAEC,UAAU;oBAAK;gBACxC;gBAEA,IAAI,CAACP,SAASQ,EAAE,EAAE;oBAChB,MAAM,IAAIC,MAAM;gBAClB;gBAEA,MAAMxC,QAAQ,MAAM+B,SAASU,IAAI;gBACjC3C,IAAI;oBAAEE;oBAAOC,eAAeD;oBAAOiB,cAAc;gBAAM;gBAEvDyB,cAAM,CAACC,IAAI,CAAC;YACd,EAAE,OAAOxB,OAAO;gBACd,MAAMyB,eAAezB,iBAAiBqB,QAAQrB,MAAM0B,OAAO,GAAG;gBAC9D/C,IAAI;oBAAEqB,OAAOyB;oBAAc3B,cAAc;gBAAM;gBAC/CyB,cAAM,CAACvB,KAAK,CAAC,4BAA4BA,iBAAiBqB,QAAQrB,QAAQ,IAAIqB,MAAMI;YACtF;QACF;QAEAE,eAAe;YACb,MAAM,EAAE/B,SAAS,EAAE,GAAGhB;YACtB,IAAIgB,WAAW,QAAQ,sCAAsC;YAE7D,IAAI;gBACFjB,IAAI;oBAAEiB,WAAW;oBAAMI,OAAO;gBAAK;gBAEnC,MAAMY,WAAW,MAAMC,MAAM,cAAc;oBACzCC,QAAQ;oBACRC,SAAS;wBAAE,gBAAgB;oBAAmB;oBAC9CC,MAAMC,KAAKC,SAAS,CAAC;wBAAEC,UAAU;oBAAK;gBACxC;gBAEA,IAAI,CAACP,SAASQ,EAAE,EAAE;oBAChB,MAAM,IAAIC,MAAM;gBAClB;gBAEA,MAAMO,WAAW,MAAMhB,SAASU,IAAI;gBACpC3C,IAAI,CAACyB,QAAW,CAAA;wBACdvB,OAAO;+BAAIuB,MAAMvB,KAAK;+BAAK+C;yBAAS;wBACpC9C,eAAe;+BAAIsB,MAAMtB,aAAa;+BAAK8C;yBAAS;wBACpDhC,WAAW;oBACb,CAAA;gBAEA2B,cAAM,CAACC,IAAI,CAAC;YACd,EAAE,OAAOxB,OAAO;gBACd,MAAMyB,eAAezB,iBAAiBqB,QAAQrB,MAAM0B,OAAO,GAAG;gBAC9D/C,IAAI;oBAAEqB,OAAOyB;oBAAc7B,WAAW;gBAAM;gBAC5C2B,cAAM,CAACvB,KAAK,CAAC,8BAA8BA,iBAAiBqB,QAAQrB,QAAQ,IAAIqB,MAAMI;YACxF;QACF;QAEA,+BAA+B;QAC/BI,YAAY,CAACxC,UAAYV,IAAI,CAACyB;gBAC5B,MAAM0B,aAAa;oBAAE,GAAG1B,MAAMf,OAAO;oBAAE,GAAGA,OAAO;gBAAC;gBAElD,yBAAyB;gBACzB,MAAM0C,WAAW3B,MAAMvB,KAAK,CAAC6B,MAAM,CAACP,CAAAA;oBAClC,IAAI2B,WAAWhE,UAAU,IAAIgE,WAAWhE,UAAU,CAACkE,MAAM,GAAG,KAAK,CAACF,WAAWhE,UAAU,CAACmE,QAAQ,CAAC9B,KAAKgB,QAAQ,GAAG;wBAC/G,OAAO;oBACT;oBACA,IAAIW,WAAW/D,KAAK,IAAI+D,WAAW/D,KAAK,CAACiE,MAAM,GAAG,KAAK,CAACF,WAAW/D,KAAK,CAACkE,QAAQ,CAAC9B,KAAK+B,IAAI,GAAG;wBAC5F,OAAO;oBACT;oBACA,IAAIJ,WAAW9D,OAAO,IAAI8D,WAAW9D,OAAO,CAACgE,MAAM,GAAG,KAAK,CAACF,WAAW9D,OAAO,CAACiE,QAAQ,CAAC9B,KAAKgC,MAAM,CAACC,IAAI,GAAG;wBACzG,OAAO;oBACT;oBACA,IAAIN,WAAW1D,UAAU,KAAK,UAAU,CAAC+B,KAAKkC,eAAe,CAACC,IAAI,EAAE;wBAClE,OAAO;oBACT;oBACA,IAAIR,WAAW1D,UAAU,KAAK,YAAY+B,KAAKkC,eAAe,CAACC,IAAI,EAAE;wBACnE,OAAO;oBACT;oBACA,IAAIR,WAAWvD,IAAI,IAAIuD,WAAWvD,IAAI,CAACyD,MAAM,GAAG,KAAK,CAACF,WAAWvD,IAAI,CAACgE,IAAI,CAACC,CAAAA,MAAOrC,KAAK5B,IAAI,CAAC0D,QAAQ,CAACO,OAAO;wBAC1G,OAAO;oBACT;oBACA,OAAO;gBACT;gBAEA,OAAO;oBAAEnD,SAASyC;oBAAYhD,eAAeiD;gBAAS;YACxD;QAEAU,cAAc,IAAM9D,IAAI,CAACyB,QAAW,CAAA;oBAClCf,SAASxB;oBACTiB,eAAesB,MAAMvB,KAAK;gBAC5B,CAAA;QAEA6D,aAAa,OAAO1D;YAClB,MAAM,EAAE2D,YAAY,EAAEC,QAAQ,EAAE,GAAGhE;YAEnC,IAAI;gBACF+D,aAAa;gBACbC,SAAS;gBAET,MAAMhC,WAAW,MAAMC,MAAM,qBAAqB;oBAChDC,QAAQ;oBACRC,SAAS;wBAAE,gBAAgB;oBAAmB;oBAC9CC,MAAMC,KAAKC,SAAS,CAAC;wBAAElC;oBAAM;gBAC/B;gBAEA,IAAI,CAAC4B,SAASQ,EAAE,EAAE;oBAChB,MAAM,IAAIC,MAAM;gBAClB;gBAEA,MAAMpC,UAAU,MAAM2B,SAASU,IAAI;gBAEnC3C,IAAI,CAACyB,QAAW,CAAA;wBACdrB,QAAQ;4BACN,GAAGqB,MAAMrB,MAAM;4BACfC;4BACAC,SAASA,QAAQ4D,KAAK;4BACtB3D,cAAcD,QAAQ6D,KAAK;4BAC3B3D,aAAa;4BACbC,YAAY2D,KAAKC,IAAI,CAAC/D,QAAQ6D,KAAK,GAAG1C,MAAMT,WAAW,CAACjD,YAAY;wBACtE;oBACF,CAAA;gBAEA6E,cAAM,CAACC,IAAI,CAAC,kBAAkB;oBAC5BxC;oBACAC,SAASA,QAAQ4D,KAAK,CAACb,MAAM;oBAC7Bc,OAAO7D,QAAQ6D,KAAK;gBACtB;YACF,EAAE,OAAO9C,OAAO;gBACd,MAAMyB,eAAezB,iBAAiBqB,QAAQrB,MAAM0B,OAAO,GAAG;gBAC9DkB,SAASnB;gBACTF,cAAM,CAACvB,KAAK,CAAC,2BAA2BA,iBAAiBqB,QAAQrB,QAAQ,IAAIqB,MAAMI;YACrF,SAAU;gBACRkB,aAAa;YACf;QACF;QAEAM,gBAAgB,CAACjE,QAAUL,IAAI,CAACyB,QAAW,CAAA;oBACzCrB,QAAQ;wBAAE,GAAGqB,MAAMrB,MAAM;wBAAEC;oBAAM;gBACnC,CAAA;QAEAkE,aAAa,IAAMvE,IAAI,CAACyB,QAAW,CAAA;oBACjCrB,QAAQ;wBACN,GAAGqB,MAAMrB,MAAM;wBACfC,OAAO;wBACPC,SAAS,EAAE;wBACXC,cAAc;wBACdC,aAAa;wBACbC,YAAY;oBACd;gBACF,CAAA;QAEA,2BAA2B;QAC3B+D,UAAU,CAAC7C,KAAO3B,IAAI,CAACyB,QAAW,CAAA;oBAChCvB,OAAOuB,MAAMvB,KAAK,CAAC2B,GAAG,CAACL,CAAAA,OACrBA,KAAKG,EAAE,KAAKA,KACR;4BACE,GAAGH,IAAI;4BACPkC,iBAAiB;gCAAE,GAAGlC,KAAKkC,eAAe;gCAAEe,OAAO;4BAAK;4BACxD/E,YAAY;gCAAE,GAAG8B,KAAK9B,UAAU;gCAAEgF,OAAOlD,KAAK9B,UAAU,CAACgF,KAAK,GAAG;4BAAE;wBACrE,IACAlD;oBAENrB,eAAesB,MAAMtB,aAAa,CAAC0B,GAAG,CAACL,CAAAA,OACrCA,KAAKG,EAAE,KAAKA,KACR;4BACE,GAAGH,IAAI;4BACPkC,iBAAiB;gCAAE,GAAGlC,KAAKkC,eAAe;gCAAEe,OAAO;4BAAK;4BACxD/E,YAAY;gCAAE,GAAG8B,KAAK9B,UAAU;gCAAEgF,OAAOlD,KAAK9B,UAAU,CAACgF,KAAK,GAAG;4BAAE;wBACrE,IACAlD;gBAER,CAAA;QAEAmD,YAAY,CAAChD,KAAO3B,IAAI,CAACyB,QAAW,CAAA;oBAClCvB,OAAOuB,MAAMvB,KAAK,CAAC2B,GAAG,CAACL,CAAAA,OACrBA,KAAKG,EAAE,KAAKA,KACR;4BACE,GAAGH,IAAI;4BACPkC,iBAAiB;gCAAE,GAAGlC,KAAKkC,eAAe;gCAAEe,OAAO;4BAAM;4BACzD/E,YAAY;gCAAE,GAAG8B,KAAK9B,UAAU;gCAAEgF,OAAON,KAAKQ,GAAG,CAAC,GAAGpD,KAAK9B,UAAU,CAACgF,KAAK,GAAG;4BAAG;wBAClF,IACAlD;oBAENrB,eAAesB,MAAMtB,aAAa,CAAC0B,GAAG,CAACL,CAAAA,OACrCA,KAAKG,EAAE,KAAKA,KACR;4BACE,GAAGH,IAAI;4BACPkC,iBAAiB;gCAAE,GAAGlC,KAAKkC,eAAe;gCAAEe,OAAO;4BAAM;4BACzD/E,YAAY;gCAAE,GAAG8B,KAAK9B,UAAU;gCAAEgF,OAAON,KAAKQ,GAAG,CAAC,GAAGpD,KAAK9B,UAAU,CAACgF,KAAK,GAAG;4BAAG;wBAClF,IACAlD;gBAER,CAAA;QAEAqD,WAAW,CAAClD,KAAO3B,IAAI,CAACyB,QAAW,CAAA;oBACjCvB,OAAOuB,MAAMvB,KAAK,CAAC2B,GAAG,CAACL,CAAAA,OACrBA,KAAKG,EAAE,KAAKA,KACR;4BACE,GAAGH,IAAI;4BACPkC,iBAAiB;gCAAE,GAAGlC,KAAKkC,eAAe;gCAAEoB,QAAQ;4BAAK;4BACzDpF,YAAY;gCAAE,GAAG8B,KAAK9B,UAAU;gCAAEqF,QAAQvD,KAAK9B,UAAU,CAACqF,MAAM,GAAG;4BAAE;wBACvE,IACAvD;oBAENrB,eAAesB,MAAMtB,aAAa,CAAC0B,GAAG,CAACL,CAAAA,OACrCA,KAAKG,EAAE,KAAKA,KACR;4BACE,GAAGH,IAAI;4BACPkC,iBAAiB;gCAAE,GAAGlC,KAAKkC,eAAe;gCAAEoB,QAAQ;4BAAK;4BACzDpF,YAAY;gCAAE,GAAG8B,KAAK9B,UAAU;gCAAEqF,QAAQvD,KAAK9B,UAAU,CAACqF,MAAM,GAAG;4BAAE;wBACvE,IACAvD;gBAER,CAAA;QAEAwD,cAAc,CAACrD,KAAO3B,IAAI,CAACyB,QAAW,CAAA;oBACpCvB,OAAOuB,MAAMvB,KAAK,CAAC2B,GAAG,CAACL,CAAAA,OACrBA,KAAKG,EAAE,KAAKA,KACR;4BAAE,GAAGH,IAAI;4BAAEkC,iBAAiB;gCAAE,GAAGlC,KAAKkC,eAAe;gCAAEuB,YAAY;4BAAK;wBAAE,IAC1EzD;oBAENrB,eAAesB,MAAMtB,aAAa,CAAC0B,GAAG,CAACL,CAAAA,OACrCA,KAAKG,EAAE,KAAKA,KACR;4BAAE,GAAGH,IAAI;4BAAEkC,iBAAiB;gCAAE,GAAGlC,KAAKkC,eAAe;gCAAEuB,YAAY;4BAAK;wBAAE,IAC1EzD;gBAER,CAAA;QAEA0D,gBAAgB,CAACvD,KAAO3B,IAAI,CAACyB,QAAW,CAAA;oBACtCvB,OAAOuB,MAAMvB,KAAK,CAAC2B,GAAG,CAACL,CAAAA,OACrBA,KAAKG,EAAE,KAAKA,KACR;4BAAE,GAAGH,IAAI;4BAAEkC,iBAAiB;gCAAE,GAAGlC,KAAKkC,eAAe;gCAAEuB,YAAY;4BAAM;wBAAE,IAC3EzD;oBAENrB,eAAesB,MAAMtB,aAAa,CAAC0B,GAAG,CAACL,CAAAA,OACrCA,KAAKG,EAAE,KAAKA,KACR;4BAAE,GAAGH,IAAI;4BAAEkC,iBAAiB;gCAAE,GAAGlC,KAAKkC,eAAe;gCAAEuB,YAAY;4BAAM;wBAAE,IAC3EzD;gBAER,CAAA;QAEA2D,YAAY,CAACxD,KAAO3B,IAAI,CAACyB,QAAW,CAAA;oBAClCvB,OAAOuB,MAAMvB,KAAK,CAAC2B,GAAG,CAACL,CAAAA,OACrBA,KAAKG,EAAE,KAAKA,KACR;4BACE,GAAGH,IAAI;4BACPkC,iBAAiB;gCACf,GAAGlC,KAAKkC,eAAe;gCACvBC,MAAM;gCACNyB,QAAQ,IAAIC,OAAOC,WAAW;4BAChC;wBACF,IACA9D;oBAENrB,eAAesB,MAAMtB,aAAa,CAAC0B,GAAG,CAACL,CAAAA,OACrCA,KAAKG,EAAE,KAAKA,KACR;4BACE,GAAGH,IAAI;4BACPkC,iBAAiB;gCACf,GAAGlC,KAAKkC,eAAe;gCACvBC,MAAM;gCACNyB,QAAQ,IAAIC,OAAOC,WAAW;4BAChC;wBACF,IACA9D;gBAER,CAAA;QAEA+D,cAAc,CAAC5D,KAAO3B,IAAI,CAACyB,QAAW,CAAA;oBACpCvB,OAAOuB,MAAMvB,KAAK,CAAC2B,GAAG,CAACL,CAAAA,OACrBA,KAAKG,EAAE,KAAKA,KACR;4BACE,GAAGH,IAAI;4BACPkC,iBAAiB;gCACf,GAAGlC,KAAKkC,eAAe;gCACvBC,MAAM;gCACNyB,QAAQI;4BACV;wBACF,IACAhE;oBAENrB,eAAesB,MAAMtB,aAAa,CAAC0B,GAAG,CAACL,CAAAA,OACrCA,KAAKG,EAAE,KAAKA,KACR;4BACE,GAAGH,IAAI;4BACPkC,iBAAiB;gCACf,GAAGlC,KAAKkC,eAAe;gCACvBC,MAAM;gCACNyB,QAAQI;4BACV;wBACF,IACAhE;gBAER,CAAA;QAEA,mBAAmB;QACnBiE,eAAe,CAACtG,aAAea,IAAI;gBAAEb;YAAW;QAEhDuG,gBAAgB,CAACC,aAAe3F,IAAI,CAACyB,QAAW,CAAA;oBAC9CtC,YAAYsC,MAAMtC,UAAU,CAAC0C,GAAG,CAACW,CAAAA,WAC/BA,SAASb,EAAE,KAAKgE,aACZ;4BAAE,GAAGnD,QAAQ;4BAAEoD,SAAS,CAACpD,SAASoD,OAAO;wBAAC,IAC1CpD;gBAER,CAAA;QAEAqD,qBAAqB,CAACF,aAAe3F,IAAI;gBAAEe,kBAAkB4E;YAAW;QAExE,sBAAsB;QACtBG,mBAAmB,CAAC9E,cAAgBhB,IAAI,CAACyB,QAAW,CAAA;oBAClDT,aAAa;wBAAE,GAAGS,MAAMT,WAAW;wBAAE,GAAGA,WAAW;oBAAC;gBACtD,CAAA;QAEA+E,kBAAkB,IAAM/F,IAAI;gBAAEgB,aAAapD;YAAmB;QAE9D,0BAA0B;QAC1BoI,gBAAgB,CAACC,OAASjG,IAAI;gBAAEa,aAAaoF;YAAK;QAElDC,iBAAiB,CAAC1E,OAASxB,IAAI;gBAAEc,cAAcU;YAAK;QAEpD,kBAAkB;QAClB2E,WAAW,OAAO3D;YAChB,IAAI;gBACFxC,IAAI;oBAAEiB,WAAW;oBAAMI,OAAO;gBAAK;gBAEnC,MAAMY,WAAW,MAAMC,MAAM,cAAc;oBACzCC,QAAQ;oBACRC,SAAS;wBAAE,gBAAgB;oBAAmB;oBAC9CC,MAAMC,KAAKC,SAAS,CAAC;wBAAEC;oBAAS;gBAClC;gBAEA,IAAIP,YAAYA,SAASQ,EAAE,EAAE;oBAC3B,MAAMvC,QAAQ,MAAM+B,SAASU,IAAI;oBACjC3C,IAAI;wBAAEE;wBAAOC,eAAeD;wBAAOe,WAAW;oBAAM;oBAEpD2B,cAAM,CAACC,IAAI,CAAC,gBAAgB;wBAC1BL;wBACA4D,OAAOlG,MAAMmD,MAAM;oBACrB;gBACF,OAAO;oBACL,0CAA0C;oBAC1CrD,IAAI;wBAAEE,OAAO,EAAE;wBAAEC,eAAe,EAAE;wBAAEc,WAAW;oBAAM;gBACvD;YACF,EAAE,OAAOI,OAAO;gBACd,mDAAmD;gBACnDrB,IAAI;oBAAEE,OAAO,EAAE;oBAAEC,eAAe,EAAE;oBAAEc,WAAW;gBAAM;gBACrD2B,cAAM,CAACC,IAAI,CAAC,iCAAiC;oBAAExB,OAAOA,iBAAiBqB,QAAQrB,MAAM0B,OAAO,GAAG;gBAAgB;YACjH;QACF;QAEAsD,gBAAgB;YACd,IAAI;gBACFrG,IAAI;oBAAEiB,WAAW;oBAAMI,OAAO;gBAAK;gBAEnC,MAAMY,WAAW,MAAMC,MAAM;gBAE7B,IAAI,CAACD,SAASQ,EAAE,EAAE;oBAChB,MAAM,IAAIC,MAAM;gBAClB;gBAEA,MAAMvD,aAAa,MAAM8C,SAASU,IAAI;gBACtC3C,IAAI;oBAAEb;oBAAY8B,WAAW;gBAAM;gBAEnC2B,cAAM,CAACC,IAAI,CAAC,0BAA0B;oBACpCuD,OAAOjH,WAAWkE,MAAM;gBAC1B;YACF,EAAE,OAAOhC,OAAO;gBACd,MAAMyB,eAAezB,iBAAiBqB,QAAQrB,MAAM0B,OAAO,GAAG;gBAC9D/C,IAAI;oBAAEqB,OAAOyB;oBAAc7B,WAAW;gBAAM;gBAC5C2B,cAAM,CAACvB,KAAK,CAAC,8BAA8BA,iBAAiBqB,QAAQrB,QAAQ,IAAIqB,MAAMI;YACxF;QACF;QAEAwD,qBAAqB,OAAOC,QAAQC;YAClC,IAAI;gBACFxG,IAAI;oBAAEoB,YAAY;oBAAMC,OAAO;gBAAK;gBAEpC,MAAMY,WAAW,MAAMC,MAAM,2BAA2B;oBACtDC,QAAQ;oBACRC,SAAS;wBAAE,gBAAgB;oBAAmB;oBAC9CC,MAAMC,KAAKC,SAAS,CAAC;wBAAEgE;wBAAQC;oBAAY;gBAC7C;gBAEA,IAAI,CAACvE,SAASQ,EAAE,EAAE;oBAChB,MAAM,IAAIC,MAAM;gBAClB;gBAEA1C,IAAI;oBAAEoB,YAAY;gBAAM;gBACxBwB,cAAM,CAACC,IAAI,CAAC,0BAA0B;oBACpC0D;oBACAC;gBACF;YACF,EAAE,OAAOnF,OAAO;gBACd,MAAMyB,eAAezB,iBAAiBqB,QAAQrB,MAAM0B,OAAO,GAAG;gBAC9D/C,IAAI;oBAAEqB,OAAOyB;oBAAc1B,YAAY;gBAAM;gBAC7CwB,cAAM,CAACvB,KAAK,CAAC,oCAAoCA,iBAAiBqB,QAAQrB,QAAQ,IAAIqB,MAAMI;YAC9F;QACF;QAEA,wBAAwB;QACxB2D,YAAY,CAACC,UAAY1G,IAAI;gBAAEiB,WAAWyF;YAAQ;QAClD1C,cAAc,CAAC2C,YAAc3G,IAAI;gBAAEkB,aAAayF;YAAU;QAC1DC,eAAe,CAACC,aAAe7G,IAAI;gBAAEmB,cAAc0F;YAAW;QAC9DC,aAAa,CAACC,WAAa/G,IAAI;gBAAEoB,YAAY2F;YAAS;QACtD9C,UAAU,CAAC5C,QAAUrB,IAAI;gBAAEqB;YAAM;QACjC2F,YAAY,IAAMhH,IAAI;gBAAEqB,OAAO;YAAK;IACtC,CAAA,GACA;IACEoC,MAAM;IACNwD,YAAY,CAACxF,QAAW,CAAA;YACtBvB,OAAOuB,MAAMvB,KAAK;YAClBf,YAAYsC,MAAMtC,UAAU;YAC5B6B,aAAaS,MAAMT,WAAW;YAC9BN,SAASe,MAAMf,OAAO;YACtBG,aAAaY,MAAMZ,WAAW;QAChC,CAAA;AACF,IAEF;IAAE4C,MAAM;AAAc;AAKnB,MAAMvG,WAAW,IAAMK,cAAckE,CAAAA,QAASA,MAAMvB,KAAK;AACzD,MAAM1C,mBAAmB,IAAMD,cAAckE,CAAAA,QAASA,MAAMtB,aAAa;AACzE,MAAMrD,oBAAoB,IAAMS,cAAckE,CAAAA,QAASA,MAAMtC,UAAU;AACvE,MAAMlC,gBAAgB,IAAMM,cAAckE,CAAAA,QAASA,MAAMrB,MAAM;AAC/D,MAAM1C,kBAAkB,IAAMH,cAAckE,CAAAA,QAASA,MAAMX,YAAY;AACvE,MAAM9D,qBAAqB,IAAMO,cAAckE,CAAAA,QAASA,MAAMT,WAAW;AACzE,MAAMjE,iBAAiB,IAAMQ,cAAckE,CAAAA,QAASA,MAAMf,OAAO;AACjE,MAAMrD,kBAAkB,IAAME,cAAckE,CAAAA,QAASA,MAAMR,SAAS;AACpE,MAAM7D,gBAAgB,IAAMG,cAAckE,CAAAA,QAASA,MAAMJ,KAAK;AAG9D,MAAMlE,kBAAkB,IAAMI,cAAckE,CAAAA,QAASA;AAGrD,MAAMnE,gBAAgB,IAAMC,cAAckE,CAAAA,QAAU,CAAA;YACzDyF,YAAYzF,MAAMvB,KAAK,CAACmD,MAAM;YAC9BlD,eAAesB,MAAMtB,aAAa,CAACkD,MAAM;YACzC8D,iBAAiB1F,MAAMtC,UAAU,CAACkE,MAAM;YACxC+D,mBAAmB3F,MAAMtC,UAAU,CAAC4C,MAAM,CAACsF,CAAAA,MAAOA,IAAIzB,OAAO,EAAEvC,MAAM;YACrEiE,eAAe7F,MAAMrB,MAAM,CAACE,OAAO,CAAC+C,MAAM;YAC1CpC,WAAWQ,MAAMR,SAAS;YAC1BC,aAAaO,MAAMP,WAAW;YAC9BG,OAAOI,MAAMJ,KAAK;QACpB,CAAA;AAEO,MAAMxE,qBAAqB,IAAMU,cAAckE,CAAAA,QACpDA,MAAMvB,KAAK,CAAC6B,MAAM,CAACP,CAAAA,OAAQA,KAAKkC,eAAe,CAACuB,UAAU;AAGrD,MAAMtH,iBAAiB,IAAMJ,cAAckE,CAAAA,QAChDA,MAAMvB,KAAK,CAAC6B,MAAM,CAACP,CAAAA,OAAQ,CAACA,KAAKkC,eAAe,CAACC,IAAI;AAGhD,MAAMlG,gBAAgB,IAAMF,cAAckE,CAAAA,QAC/CA,MAAMvB,KAAK,CAAC6B,MAAM,CAACP,CAAAA,OAAQA,KAAKkC,eAAe,CAACe,KAAK;AAIhD,MAAM7H,kBAAkB;IAC7B;;GAEC,GACD2K,iBAAiB;QACf,MAAM9F,QAAQlE,cAAciK,QAAQ;QACpC,OAAO;YACLN,YAAYzF,MAAMvB,KAAK,CAACmD,MAAM;YAC9BlD,eAAesB,MAAMtB,aAAa,CAACkD,MAAM;YACzClE,YAAYsC,MAAMtC,UAAU,CAACkE,MAAM;YACnCiE,eAAe7F,MAAMrB,MAAM,CAACE,OAAO,CAAC+C,MAAM;YAC1CrC,aAAaS,MAAMT,WAAW;QAChC;IACF;IAEA;;GAEC,GACDyG,oBAAoB,CAACjF;QACnB,MAAMf,QAAQlE,cAAciK,QAAQ;QACpC,OAAO/F,MAAMvB,KAAK,CAAC6B,MAAM,CAACP,CAAAA,OAAQA,KAAKgB,QAAQ,KAAKA;IACtD;IAEA;;GAEC,GACDkF,gBAAgB,CAACnE;QACf,MAAM9B,QAAQlE,cAAciK,QAAQ;QACpC,OAAO/F,MAAMvB,KAAK,CAAC6B,MAAM,CAACP,CAAAA,OAAQA,KAAK+B,IAAI,KAAKA;IAClD;IAEA;;GAEC,GACDoE,kBAAkB;QAChB,MAAMlG,QAAQlE,cAAciK,QAAQ;QACpC,OAAO/F,MAAMvB,KAAK,CACf0H,IAAI,CAAC,CAACC,GAAGC,IAAM,AAACA,EAAEpI,UAAU,CAACgF,KAAK,GAAGoD,EAAEpI,UAAU,CAACqF,MAAM,GAAK8C,CAAAA,EAAEnI,UAAU,CAACgF,KAAK,GAAGmD,EAAEnI,UAAU,CAACqF,MAAM,AAAD,GACpGgD,KAAK,CAAC,GAAG;IACd;IAEA;;GAEC,GACDC,gBAAgB,CAACC,QAAgB,EAAE;QACjC,MAAMxG,QAAQlE,cAAciK,QAAQ;QACpC,OAAO/F,MAAMvB,KAAK,CACf0H,IAAI,CAAC,CAACC,GAAGC,IAAM,IAAIzC,KAAKyC,EAAEI,WAAW,EAAEC,OAAO,KAAK,IAAI9C,KAAKwC,EAAEK,WAAW,EAAEC,OAAO,IAClFJ,KAAK,CAAC,GAAGE;IACd;AACF;AAGO,MAAMtL,0BAA0B;IACrC;;GAEC,GACDyL,eAAe,CAACC;QACd,OAAO9K,cAAc+K,SAAS,CAC5B,CAAC7G;YACC4G,SAAS5G,MAAMvB,KAAK;QACtB;IAEJ;IAEA;;GAEC,GACDqI,uBAAuB,CAACF;QACtB,OAAO9K,cAAc+K,SAAS,CAC5B,CAAC7G;YACC4G,SAAS5G,MAAMrB,MAAM,CAACE,OAAO;QAC/B;IAEJ;IAEA;;GAEC,GACDkI,qBAAqB,CAACH;QACpB,OAAO9K,cAAc+K,SAAS,CAC5B,CAAC7G;YACC4G,SAAS5G,MAAMT,WAAW;QAC5B;IAEJ;AACF;AAGO,MAAMtE,kBAAkB;IAC7B;;GAEC,GACD+L,UAAU;QACR,MAAMhH,QAAQlE,cAAciK,QAAQ;QACpCkB,QAAQC,GAAG,CAAC,sBAAsB;YAChCzB,YAAYzF,MAAMvB,KAAK,CAACmD,MAAM;YAC9BlD,eAAesB,MAAMtB,aAAa,CAACkD,MAAM;YACzClE,YAAYsC,MAAMtC,UAAU,CAACkE,MAAM;YACnCiE,eAAe7F,MAAMrB,MAAM,CAACE,OAAO,CAAC+C,MAAM;YAC1CxC,aAAaY,MAAMZ,WAAW;YAC9BE,kBAAkBU,MAAMV,gBAAgB;YACxCE,WAAWQ,MAAMR,SAAS;YAC1BI,OAAOI,MAAMJ,KAAK;QACpB;IACF;IAEA;;GAEC,GACDuH,YAAY;QACV,MAAMC,UAAUjM,gBAAgB2K,eAAe;QAC/CmB,QAAQC,GAAG,CAAC,kBAAkBE;IAChC;IAEA;;GAEC,GACDC,oBAAoB;QAClB,MAAMrH,QAAQlE,cAAciK,QAAQ;QACpC,MAAMuB,aAAatH,MAAMvB,KAAK,CAAC8I,MAAM,CAAC,CAACC,KAAKzH;YAC1CyH,GAAG,CAACzH,KAAKgB,QAAQ,CAAC,GAAG,AAACyG,CAAAA,GAAG,CAACzH,KAAKgB,QAAQ,CAAC,IAAI,CAAA,IAAK;YACjD,OAAOyG;QACT,GAAG,CAAC;QACJP,QAAQC,GAAG,CAAC,sBAAsBI;IACpC;IAEA;;GAEC,GACDG,OAAO;QACL3L,cAAciK,QAAQ,GAAG1D,YAAY;QACrCvG,cAAciK,QAAQ,GAAGzB,gBAAgB;QACzC2C,QAAQC,GAAG,CAAC;IACd;AACF"}