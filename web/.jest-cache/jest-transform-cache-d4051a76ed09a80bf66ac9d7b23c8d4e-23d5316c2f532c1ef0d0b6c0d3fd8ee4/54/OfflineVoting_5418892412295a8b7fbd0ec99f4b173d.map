{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/features/pwa/components/OfflineVoting.tsx"],"sourcesContent":["'use client'\n\nimport { WifiOff, CheckCircle, AlertCircle } from 'lucide-react'\nimport { useState, useEffect } from 'react'\n\nimport { usePWA } from '@/hooks/usePWA'\n\ninterface OfflineVotingProps {\n  pollId: string\n  className?: string\n}\n\nexport default function OfflineVoting({ pollId, className = '' }: OfflineVotingProps) {\n  const pwa = usePWA()\n  const [offlineVotes, setOfflineVotes] = useState<any[]>([])\n  const [_isVoting, setIsVoting] = useState(false)\n\n  useEffect(() => {\n    // Simulate offline votes for this poll\n    const mockVotes = [\n      { id: '1', pollId, choice: 0, timestamp: Date.now() - 300000 },\n      { id: '2', pollId, choice: 1, timestamp: Date.now() - 180000 }\n    ]\n    setOfflineVotes(mockVotes)\n  }, [pollId])\n\n  const _handleVote = async (choice: number) => {\n    setIsVoting(true)\n    try {\n      // Simulate storing offline vote\n      const newVote = {\n        id: Date.now().toString(),\n        pollId,\n        choice,\n        timestamp: Date.now()\n      }\n      setOfflineVotes(prev => [...prev, newVote])\n    } catch (error) {\n      console.error('Vote failed:', error)\n    } finally {\n      setIsVoting(false)\n    }\n  }\n\n  if (!pwa.hasOfflineData && offlineVotes.length === 0) {\n    return null\n  }\n\n  return (\n    <div className={`bg-orange-50 border border-orange-200 rounded-lg p-4 ${className}`} data-testid=\"offline-voting\">\n      <div className=\"flex items-center justify-between mb-3\">\n        <div className=\"flex items-center space-x-2\">\n          <WifiOff className=\"w-5 h-5 text-orange-600\" />\n          <h3 className=\"text-sm font-medium text-orange-800\">Offline Voting</h3>\n        </div>\n        <span className=\"text-sm text-orange-700\">{offlineVotes.length} votes</span>\n      </div>\n\n      <div className=\"space-y-2\">\n        {offlineVotes.map((vote) => (\n          <div key={vote.id} className=\"flex items-center justify-between p-2 bg-white rounded border\">\n            <div className=\"flex items-center space-x-2\">\n              <CheckCircle className=\"w-4 h-4 text-green-500\" />\n              <span className=\"text-sm text-gray-700\">\n                Vote for Option {vote.choice + 1}\n              </span>\n            </div>\n            <span className=\"text-xs text-gray-500\">\n              {new Date(vote.timestamp).toLocaleTimeString()}\n            </span>\n          </div>\n        ))}\n      </div>\n\n      <div className=\"mt-3 p-3 bg-orange-100 rounded border\">\n        <div className=\"flex items-center space-x-2 text-orange-800\">\n          <AlertCircle className=\"w-4 h-4\" />\n          <span className=\"text-sm font-medium\">Votes will sync when online</span>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":["OfflineVoting","pollId","className","pwa","usePWA","offlineVotes","setOfflineVotes","useState","_isVoting","setIsVoting","useEffect","mockVotes","id","choice","timestamp","Date","now","_handleVote","newVote","toString","prev","error","console","hasOfflineData","length","div","data-testid","WifiOff","h3","span","map","vote","CheckCircle","toLocaleTimeString","AlertCircle"],"mappings":"AAAA;;;;;+BAYA;;;eAAwBA;;;;;;;uBATY;wBAEb;AAOR,SAASA,cAAc,EAAEC,MAAM,EAAEC,YAAY,EAAE,EAAsB;IAClF,MAAMC,MAAMC,IAAAA,cAAM;IAClB,MAAM,CAACC,cAAcC,gBAAgB,GAAGC,IAAAA,eAAQ,EAAQ,EAAE;IAC1D,MAAM,CAACC,WAAWC,YAAY,GAAGF,IAAAA,eAAQ,EAAC;IAE1CG,IAAAA,gBAAS,EAAC;QACR,uCAAuC;QACvC,MAAMC,YAAY;YAChB;gBAAEC,IAAI;gBAAKX;gBAAQY,QAAQ;gBAAGC,WAAWC,KAAKC,GAAG,KAAK;YAAO;YAC7D;gBAAEJ,IAAI;gBAAKX;gBAAQY,QAAQ;gBAAGC,WAAWC,KAAKC,GAAG,KAAK;YAAO;SAC9D;QACDV,gBAAgBK;IAClB,GAAG;QAACV;KAAO;IAEX,MAAMgB,cAAc,OAAOJ;QACzBJ,YAAY;QACZ,IAAI;YACF,gCAAgC;YAChC,MAAMS,UAAU;gBACdN,IAAIG,KAAKC,GAAG,GAAGG,QAAQ;gBACvBlB;gBACAY;gBACAC,WAAWC,KAAKC,GAAG;YACrB;YACAV,gBAAgBc,CAAAA,OAAQ;uBAAIA;oBAAMF;iBAAQ;QAC5C,EAAE,OAAOG,OAAO;YACdC,QAAQD,KAAK,CAAC,gBAAgBA;QAChC,SAAU;YACRZ,YAAY;QACd;IACF;IAEA,IAAI,CAACN,IAAIoB,cAAc,IAAIlB,aAAamB,MAAM,KAAK,GAAG;QACpD,OAAO;IACT;IAEA,qBACE,sBAACC;QAAIvB,WAAW,CAAC,qDAAqD,EAAEA,UAAU,CAAC;QAAEwB,eAAY;;0BAC/F,sBAACD;gBAAIvB,WAAU;;kCACb,sBAACuB;wBAAIvB,WAAU;;0CACb,qBAACyB,gBAAO;gCAACzB,WAAU;;0CACnB,qBAAC0B;gCAAG1B,WAAU;0CAAsC;;;;kCAEtD,sBAAC2B;wBAAK3B,WAAU;;4BAA2BG,aAAamB,MAAM;4BAAC;;;;;0BAGjE,qBAACC;gBAAIvB,WAAU;0BACZG,aAAayB,GAAG,CAAC,CAACC,qBACjB,sBAACN;wBAAkBvB,WAAU;;0CAC3B,sBAACuB;gCAAIvB,WAAU;;kDACb,qBAAC8B,wBAAW;wCAAC9B,WAAU;;kDACvB,sBAAC2B;wCAAK3B,WAAU;;4CAAwB;4CACrB6B,KAAKlB,MAAM,GAAG;;;;;0CAGnC,qBAACgB;gCAAK3B,WAAU;0CACb,IAAIa,KAAKgB,KAAKjB,SAAS,EAAEmB,kBAAkB;;;uBARtCF,KAAKnB,EAAE;;0BAcrB,qBAACa;gBAAIvB,WAAU;0BACb,cAAA,sBAACuB;oBAAIvB,WAAU;;sCACb,qBAACgC,wBAAW;4BAAChC,WAAU;;sCACvB,qBAAC2B;4BAAK3B,WAAU;sCAAsB;;;;;;;AAKhD"}