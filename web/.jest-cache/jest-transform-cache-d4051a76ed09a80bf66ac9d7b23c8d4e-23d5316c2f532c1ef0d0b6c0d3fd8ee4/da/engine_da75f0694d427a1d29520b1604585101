89cda085f34cbe953d0bf264865bfd9a
/**
 * Core Voting Engine
 * 
 * This module provides the main voting engine that orchestrates different voting strategies
 * and handles vote processing, validation, and results calculation.
 * 
 * Created: September 15, 2025
 * Updated: September 15, 2025
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    VoteEngine: function() {
        return VoteEngine;
    },
    voteEngine: function() {
        return voteEngine;
    }
});
const _logger = require("../utils/logger");
const _approval = require("./strategies/approval");
const _quadratic = require("./strategies/quadratic");
const _range = require("./strategies/range");
const _ranked = require("./strategies/ranked");
const _singlechoice = require("./strategies/single-choice");
class VoteEngine {
    constructor(config = {}){
        this.config = Object.assign({
            maxVotesPerPoll: 10000,
            allowMultipleVotes: false,
            requireAuthentication: true,
            minTrustTier: "T0",
            rateLimitPerUser: 10,
            rateLimitWindowMs: 60000
        }, config);
        // Initialize rate limiting tracker
        this.rateLimitTracker = new Map();
        // Initialize voting strategies
        this.strategies = new Map([
            [
                "single",
                new _singlechoice.SingleChoiceStrategy()
            ],
            [
                "single-choice",
                new _singlechoice.SingleChoiceStrategy()
            ],
            [
                "approval",
                new _approval.ApprovalStrategy()
            ],
            [
                "ranked",
                new _ranked.RankedStrategy()
            ],
            [
                "ranked-choice",
                new _ranked.RankedStrategy()
            ],
            [
                "quadratic",
                new _quadratic.QuadraticStrategy()
            ],
            [
                "range",
                new _range.RangeStrategy()
            ]
        ]);
        (0, _logger.devLog)("VoteEngine initialized with strategies:", Array.from(this.strategies.keys()));
    }
    /**
   * Get the appropriate voting strategy for a poll
   */ getStrategy(method) {
        const strategy = this.strategies.get(method);
        if (!strategy) {
            throw new Error(`Unsupported voting method: ${method}`);
        }
        return strategy;
    }
    /**
   * Validate a vote request
   */ async validateVote(request, poll) {
        const startTime = Date.now();
        try {
            // Basic validation
            if (!request.pollId || !request.voteData) {
                return {
                    valid: false,
                    errors: [
                        "Missing required vote data"
                    ],
                    requiresAuthentication: this.config.requireAuthentication,
                    requiresTokens: false
                };
            }
            // Check if poll exists and is active
            if (!poll || poll.status !== "active") {
                return {
                    valid: false,
                    errors: [
                        "Poll is not active"
                    ],
                    requiresAuthentication: this.config.requireAuthentication,
                    requiresTokens: false
                };
            }
            // Check poll end time
            if (poll.endTime && new Date(poll.endTime) < new Date()) {
                return {
                    valid: false,
                    errors: [
                        "Poll has ended"
                    ],
                    requiresAuthentication: this.config.requireAuthentication,
                    requiresTokens: false
                };
            }
            // Check authentication requirements
            if (this.config.requireAuthentication && !request.userId) {
                return {
                    valid: false,
                    errors: [
                        "Authentication required to vote"
                    ],
                    requiresAuthentication: true,
                    requiresTokens: false
                };
            }
            // Check rate limiting
            if (request.userId) {
                const rateLimitKey = `${request.userId}:${request.pollId}`;
                const now = Date.now();
                const rateLimitData = this.rateLimitTracker.get(rateLimitKey);
                if (rateLimitData) {
                    if (now < rateLimitData.resetTime) {
                        if (rateLimitData.count >= this.config.rateLimitPerUser) {
                            return {
                                valid: false,
                                errors: [
                                    "Rate limit exceeded. Please try again later."
                                ],
                                requiresAuthentication: this.config.requireAuthentication,
                                requiresTokens: false
                            };
                        }
                    } else {
                        // Reset the counter if the window has expired
                        rateLimitData.count = 0;
                        rateLimitData.resetTime = now + this.config.rateLimitWindowMs;
                    }
                } else {
                    // Initialize rate limit tracking
                    this.rateLimitTracker.set(rateLimitKey, {
                        count: 0,
                        resetTime: now + this.config.rateLimitWindowMs
                    });
                }
            }
            // Get the appropriate strategy and validate the vote
            const strategy = this.getStrategy(poll.votingMethod);
            const strategyValidation = await strategy.validateVote(request, poll);
            if (!strategyValidation.valid) {
                return Object.assign({}, strategyValidation, {
                    requiresAuthentication: this.config.requireAuthentication,
                    requiresTokens: false
                });
            }
            (0, _logger.devLog)("Vote validation completed", {
                pollId: request.pollId,
                userId: request.userId,
                method: poll.votingMethod,
                duration: Date.now() - startTime
            });
            return {
                valid: true,
                errors: [],
                requiresAuthentication: this.config.requireAuthentication,
                requiresTokens: false
            };
        } catch (error) {
            (0, _logger.devLog)("Vote validation error:", error);
            return {
                valid: false,
                errors: [
                    error instanceof Error ? error.message : "Validation failed"
                ],
                requiresAuthentication: this.config.requireAuthentication,
                requiresTokens: false
            };
        }
    }
    /**
   * Process a vote
   */ async processVote(request, poll) {
        const startTime = Date.now();
        try {
            // Validate the vote first
            const validation = await this.validateVote(request, poll);
            if (!validation.valid) {
                return {
                    success: false,
                    error: validation.errors?.[0] || "Vote validation failed",
                    pollId: request.pollId,
                    responseTime: Date.now() - startTime
                };
            }
            // Get the appropriate strategy and process the vote
            const strategy = this.getStrategy(poll.votingMethod);
            const result = await strategy.processVote(request, poll);
            // Increment rate limit counter
            if (request.userId) {
                const rateLimitKey = `${request.userId}:${request.pollId}`;
                const rateLimitData = this.rateLimitTracker.get(rateLimitKey);
                if (rateLimitData) {
                    rateLimitData.count++;
                }
            }
            (0, _logger.devLog)("Vote processed successfully", {
                pollId: request.pollId,
                userId: request.userId,
                method: poll.votingMethod,
                voteId: result.voteId,
                duration: Date.now() - startTime
            });
            return {
                success: true,
                voteId: result.voteId || `vote-${Date.now()}`,
                pollId: request.pollId,
                responseTime: Date.now() - startTime
            };
        } catch (error) {
            (0, _logger.devLog)("Vote processing error:", error);
            return {
                success: false,
                error: error instanceof Error ? error.message : "Vote processing failed",
                pollId: request.pollId,
                responseTime: Date.now() - startTime
            };
        }
    }
    /**
   * Calculate results for a poll
   */ async calculateResults(poll, votes) {
        const startTime = Date.now();
        try {
            const strategy = this.getStrategy(poll.votingMethod);
            const results = await strategy.calculateResults(poll, votes);
            (0, _logger.devLog)("Results calculated successfully", {
                pollId: poll.id,
                method: poll.votingMethod,
                totalVotes: votes.length,
                duration: Date.now() - startTime
            });
            return results;
        } catch (error) {
            (0, _logger.devLog)("Results calculation error:", error);
            // Return a basic results structure for unsupported methods
            return {
                pollId: poll.id,
                votingMethod: poll.votingMethod,
                totalVotes: votes.length,
                participationRate: votes.length / 100,
                results: {
                    winner: votes.length > 0 ? poll.options[0]?.id : undefined,
                    winnerVotes: votes.length,
                    winnerPercentage: 100,
                    optionVotes: poll.options.reduce((acc, option)=>{
                        acc[option.id] = votes.length;
                        return acc;
                    }, {}),
                    optionPercentages: poll.options.reduce((acc, option)=>{
                        acc[option.id] = 100;
                        return acc;
                    }, {}),
                    abstentions: 0,
                    abstentionPercentage: 0
                },
                calculatedAt: new Date().toISOString(),
                metadata: {
                    calculationTime: Date.now() - startTime,
                    error: error instanceof Error ? error.message : "Unknown error"
                }
            };
        }
    }
    /**
   * Get voting method configuration
   */ getVotingMethodConfig(method) {
        const strategy = this.getStrategy(method);
        return strategy.getConfiguration();
    }
    /**
   * Update engine configuration
   */ updateConfig(newConfig) {
        this.config = Object.assign({}, this.config, newConfig);
        (0, _logger.devLog)("VoteEngine configuration updated:", this.config);
    }
    /**
   * Get current configuration
   */ getConfig() {
        return {
            ...this.config
        };
    }
}
const voteEngine = new VoteEngine();

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hbGF1Z2hpbmdraXRzdW5lL3NyYy9DaG9pY2VzL3dlYi9saWIvdm90ZS9lbmdpbmUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3JlIFZvdGluZyBFbmdpbmVcbiAqIFxuICogVGhpcyBtb2R1bGUgcHJvdmlkZXMgdGhlIG1haW4gdm90aW5nIGVuZ2luZSB0aGF0IG9yY2hlc3RyYXRlcyBkaWZmZXJlbnQgdm90aW5nIHN0cmF0ZWdpZXNcbiAqIGFuZCBoYW5kbGVzIHZvdGUgcHJvY2Vzc2luZywgdmFsaWRhdGlvbiwgYW5kIHJlc3VsdHMgY2FsY3VsYXRpb24uXG4gKiBcbiAqIENyZWF0ZWQ6IFNlcHRlbWJlciAxNSwgMjAyNVxuICogVXBkYXRlZDogU2VwdGVtYmVyIDE1LCAyMDI1XG4gKi9cblxuaW1wb3J0IHsgZGV2TG9nIH0gZnJvbSAnQC9saWIvdXRpbHMvbG9nZ2VyJztcbmltcG9ydCB7IHdpdGhPcHRpb25hbCB9IGZyb20gJ0AvbGliL3V0aWxzL29iamVjdHMnO1xuXG5pbXBvcnQgeyBBcHByb3ZhbFN0cmF0ZWd5IH0gZnJvbSAnLi9zdHJhdGVnaWVzL2FwcHJvdmFsJztcbmltcG9ydCB7IFF1YWRyYXRpY1N0cmF0ZWd5IH0gZnJvbSAnLi9zdHJhdGVnaWVzL3F1YWRyYXRpYyc7XG5pbXBvcnQgeyBSYW5nZVN0cmF0ZWd5IH0gZnJvbSAnLi9zdHJhdGVnaWVzL3JhbmdlJztcbmltcG9ydCB7IFJhbmtlZFN0cmF0ZWd5IH0gZnJvbSAnLi9zdHJhdGVnaWVzL3JhbmtlZCc7XG5pbXBvcnQgeyBTaW5nbGVDaG9pY2VTdHJhdGVneSB9IGZyb20gJy4vc3RyYXRlZ2llcy9zaW5nbGUtY2hvaWNlJztcbmltcG9ydCB0eXBlIHsgXG4gIFZvdGVSZXF1ZXN0LCBcbiAgVm90ZVJlc3BvbnNlLCBcbiAgVm90ZVZhbGlkYXRpb24sIFxuICBWb3RpbmdTdHJhdGVneSxcbiAgUG9sbERhdGEsXG4gIFZvdGVEYXRhLFxuICBSZXN1bHRzRGF0YSxcbiAgVm90aW5nTWV0aG9kXG59IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFZvdGVFbmdpbmVDb25maWcge1xuICBtYXhWb3Rlc1BlclBvbGw6IG51bWJlcjtcbiAgYWxsb3dNdWx0aXBsZVZvdGVzOiBib29sZWFuO1xuICByZXF1aXJlQXV0aGVudGljYXRpb246IGJvb2xlYW47XG4gIG1pblRydXN0VGllcjogc3RyaW5nO1xuICByYXRlTGltaXRQZXJVc2VyOiBudW1iZXI7XG4gIHJhdGVMaW1pdFdpbmRvd01zOiBudW1iZXI7XG59XG5cbmV4cG9ydCBjbGFzcyBWb3RlRW5naW5lIHtcbiAgcHJpdmF0ZSBzdHJhdGVnaWVzOiBNYXA8Vm90aW5nTWV0aG9kLCBWb3RpbmdTdHJhdGVneT47XG4gIHByaXZhdGUgY29uZmlnOiBWb3RlRW5naW5lQ29uZmlnO1xuICBwcml2YXRlIHJhdGVMaW1pdFRyYWNrZXI6IE1hcDxzdHJpbmcsIHsgY291bnQ6IG51bWJlcjsgcmVzZXRUaW1lOiBudW1iZXIgfT47XG5cbiAgY29uc3RydWN0b3IoY29uZmlnOiBQYXJ0aWFsPFZvdGVFbmdpbmVDb25maWc+ID0ge30pIHtcbiAgICB0aGlzLmNvbmZpZyA9IE9iamVjdC5hc3NpZ24oe1xuICAgICAgbWF4Vm90ZXNQZXJQb2xsOiAxMDAwMCxcbiAgICAgIGFsbG93TXVsdGlwbGVWb3RlczogZmFsc2UsXG4gICAgICByZXF1aXJlQXV0aGVudGljYXRpb246IHRydWUsXG4gICAgICBtaW5UcnVzdFRpZXI6ICdUMCcsXG4gICAgICByYXRlTGltaXRQZXJVc2VyOiAxMCxcbiAgICAgIHJhdGVMaW1pdFdpbmRvd01zOiA2MDAwMCwgLy8gMSBtaW51dGVcbiAgICB9LCBjb25maWcpO1xuXG4gICAgLy8gSW5pdGlhbGl6ZSByYXRlIGxpbWl0aW5nIHRyYWNrZXJcbiAgICB0aGlzLnJhdGVMaW1pdFRyYWNrZXIgPSBuZXcgTWFwKCk7XG5cbiAgICAvLyBJbml0aWFsaXplIHZvdGluZyBzdHJhdGVnaWVzXG4gICAgdGhpcy5zdHJhdGVnaWVzID0gbmV3IE1hcChbXG4gICAgICBbJ3NpbmdsZScsIG5ldyBTaW5nbGVDaG9pY2VTdHJhdGVneSgpXSxcbiAgICAgIFsnc2luZ2xlLWNob2ljZScsIG5ldyBTaW5nbGVDaG9pY2VTdHJhdGVneSgpXSxcbiAgICAgIFsnYXBwcm92YWwnLCBuZXcgQXBwcm92YWxTdHJhdGVneSgpXSxcbiAgICAgIFsncmFua2VkJywgbmV3IFJhbmtlZFN0cmF0ZWd5KCldLFxuICAgICAgWydyYW5rZWQtY2hvaWNlJywgbmV3IFJhbmtlZFN0cmF0ZWd5KCldLFxuICAgICAgWydxdWFkcmF0aWMnLCBuZXcgUXVhZHJhdGljU3RyYXRlZ3koKV0sXG4gICAgICBbJ3JhbmdlJywgbmV3IFJhbmdlU3RyYXRlZ3koKV1cbiAgICBdKTtcblxuICAgIGRldkxvZygnVm90ZUVuZ2luZSBpbml0aWFsaXplZCB3aXRoIHN0cmF0ZWdpZXM6JywgQXJyYXkuZnJvbSh0aGlzLnN0cmF0ZWdpZXMua2V5cygpKSk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBhcHByb3ByaWF0ZSB2b3Rpbmcgc3RyYXRlZ3kgZm9yIGEgcG9sbFxuICAgKi9cbiAgcHJpdmF0ZSBnZXRTdHJhdGVneShtZXRob2Q6IFZvdGluZ01ldGhvZCk6IFZvdGluZ1N0cmF0ZWd5IHtcbiAgICBjb25zdCBzdHJhdGVneSA9IHRoaXMuc3RyYXRlZ2llcy5nZXQobWV0aG9kKTtcbiAgICBpZiAoIXN0cmF0ZWd5KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIHZvdGluZyBtZXRob2Q6ICR7bWV0aG9kfWApO1xuICAgIH1cbiAgICByZXR1cm4gc3RyYXRlZ3k7XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgYSB2b3RlIHJlcXVlc3RcbiAgICovXG4gIGFzeW5jIHZhbGlkYXRlVm90ZShyZXF1ZXN0OiBWb3RlUmVxdWVzdCwgcG9sbDogUG9sbERhdGEpOiBQcm9taXNlPFZvdGVWYWxpZGF0aW9uPiB7XG4gICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICBcbiAgICB0cnkge1xuICAgICAgLy8gQmFzaWMgdmFsaWRhdGlvblxuICAgICAgaWYgKCFyZXF1ZXN0LnBvbGxJZCB8fCAhcmVxdWVzdC52b3RlRGF0YSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcnM6IFsnTWlzc2luZyByZXF1aXJlZCB2b3RlIGRhdGEnXSxcbiAgICAgICAgICByZXF1aXJlc0F1dGhlbnRpY2F0aW9uOiB0aGlzLmNvbmZpZy5yZXF1aXJlQXV0aGVudGljYXRpb24sXG4gICAgICAgICAgcmVxdWlyZXNUb2tlbnM6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGlmIHBvbGwgZXhpc3RzIGFuZCBpcyBhY3RpdmVcbiAgICAgIGlmICghcG9sbCB8fCBwb2xsLnN0YXR1cyAhPT0gJ2FjdGl2ZScpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgZXJyb3JzOiBbJ1BvbGwgaXMgbm90IGFjdGl2ZSddLFxuICAgICAgICAgIHJlcXVpcmVzQXV0aGVudGljYXRpb246IHRoaXMuY29uZmlnLnJlcXVpcmVBdXRoZW50aWNhdGlvbixcbiAgICAgICAgICByZXF1aXJlc1Rva2VuczogZmFsc2VcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgcG9sbCBlbmQgdGltZVxuICAgICAgaWYgKHBvbGwuZW5kVGltZSAmJiBuZXcgRGF0ZShwb2xsLmVuZFRpbWUpIDwgbmV3IERhdGUoKSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcnM6IFsnUG9sbCBoYXMgZW5kZWQnXSxcbiAgICAgICAgICByZXF1aXJlc0F1dGhlbnRpY2F0aW9uOiB0aGlzLmNvbmZpZy5yZXF1aXJlQXV0aGVudGljYXRpb24sXG4gICAgICAgICAgcmVxdWlyZXNUb2tlbnM6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGF1dGhlbnRpY2F0aW9uIHJlcXVpcmVtZW50c1xuICAgICAgaWYgKHRoaXMuY29uZmlnLnJlcXVpcmVBdXRoZW50aWNhdGlvbiAmJiAhcmVxdWVzdC51c2VySWQpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgZXJyb3JzOiBbJ0F1dGhlbnRpY2F0aW9uIHJlcXVpcmVkIHRvIHZvdGUnXSxcbiAgICAgICAgICByZXF1aXJlc0F1dGhlbnRpY2F0aW9uOiB0cnVlLFxuICAgICAgICAgIHJlcXVpcmVzVG9rZW5zOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICAvLyBDaGVjayByYXRlIGxpbWl0aW5nXG4gICAgICBpZiAocmVxdWVzdC51c2VySWQpIHtcbiAgICAgICAgY29uc3QgcmF0ZUxpbWl0S2V5ID0gYCR7cmVxdWVzdC51c2VySWR9OiR7cmVxdWVzdC5wb2xsSWR9YDtcbiAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgY29uc3QgcmF0ZUxpbWl0RGF0YSA9IHRoaXMucmF0ZUxpbWl0VHJhY2tlci5nZXQocmF0ZUxpbWl0S2V5KTtcbiAgICAgICAgXG4gICAgICAgIGlmIChyYXRlTGltaXREYXRhKSB7XG4gICAgICAgICAgaWYgKG5vdyA8IHJhdGVMaW1pdERhdGEucmVzZXRUaW1lKSB7XG4gICAgICAgICAgICBpZiAocmF0ZUxpbWl0RGF0YS5jb3VudCA+PSB0aGlzLmNvbmZpZy5yYXRlTGltaXRQZXJVc2VyKSB7XG4gICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yczogWydSYXRlIGxpbWl0IGV4Y2VlZGVkLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLiddLFxuICAgICAgICAgICAgICAgIHJlcXVpcmVzQXV0aGVudGljYXRpb246IHRoaXMuY29uZmlnLnJlcXVpcmVBdXRoZW50aWNhdGlvbixcbiAgICAgICAgICAgICAgICByZXF1aXJlc1Rva2VuczogZmFsc2VcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gUmVzZXQgdGhlIGNvdW50ZXIgaWYgdGhlIHdpbmRvdyBoYXMgZXhwaXJlZFxuICAgICAgICAgICAgcmF0ZUxpbWl0RGF0YS5jb3VudCA9IDA7XG4gICAgICAgICAgICByYXRlTGltaXREYXRhLnJlc2V0VGltZSA9IG5vdyArIHRoaXMuY29uZmlnLnJhdGVMaW1pdFdpbmRvd01zO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBJbml0aWFsaXplIHJhdGUgbGltaXQgdHJhY2tpbmdcbiAgICAgICAgICB0aGlzLnJhdGVMaW1pdFRyYWNrZXIuc2V0KHJhdGVMaW1pdEtleSwge1xuICAgICAgICAgICAgY291bnQ6IDAsXG4gICAgICAgICAgICByZXNldFRpbWU6IG5vdyArIHRoaXMuY29uZmlnLnJhdGVMaW1pdFdpbmRvd01zXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gR2V0IHRoZSBhcHByb3ByaWF0ZSBzdHJhdGVneSBhbmQgdmFsaWRhdGUgdGhlIHZvdGVcbiAgICAgIGNvbnN0IHN0cmF0ZWd5ID0gdGhpcy5nZXRTdHJhdGVneShwb2xsLnZvdGluZ01ldGhvZCk7XG4gICAgICBjb25zdCBzdHJhdGVneVZhbGlkYXRpb24gPSBhd2FpdCBzdHJhdGVneS52YWxpZGF0ZVZvdGUocmVxdWVzdCwgcG9sbCk7XG5cbiAgICAgIGlmICghc3RyYXRlZ3lWYWxpZGF0aW9uLnZhbGlkKSB7XG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBzdHJhdGVneVZhbGlkYXRpb24sIHtcbiAgICAgICAgICByZXF1aXJlc0F1dGhlbnRpY2F0aW9uOiB0aGlzLmNvbmZpZy5yZXF1aXJlQXV0aGVudGljYXRpb24sXG4gICAgICAgICAgcmVxdWlyZXNUb2tlbnM6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBkZXZMb2coJ1ZvdGUgdmFsaWRhdGlvbiBjb21wbGV0ZWQnLCB7XG4gICAgICAgIHBvbGxJZDogcmVxdWVzdC5wb2xsSWQsXG4gICAgICAgIHVzZXJJZDogcmVxdWVzdC51c2VySWQsXG4gICAgICAgIG1ldGhvZDogcG9sbC52b3RpbmdNZXRob2QsXG4gICAgICAgIGR1cmF0aW9uOiBEYXRlLm5vdygpIC0gc3RhcnRUaW1lXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsaWQ6IHRydWUsXG4gICAgICAgIGVycm9yczogW10sXG4gICAgICAgIHJlcXVpcmVzQXV0aGVudGljYXRpb246IHRoaXMuY29uZmlnLnJlcXVpcmVBdXRoZW50aWNhdGlvbixcbiAgICAgICAgcmVxdWlyZXNUb2tlbnM6IGZhbHNlXG4gICAgICB9O1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGRldkxvZygnVm90ZSB2YWxpZGF0aW9uIGVycm9yOicsIGVycm9yKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgZXJyb3JzOiBbZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVmFsaWRhdGlvbiBmYWlsZWQnXSxcbiAgICAgICAgcmVxdWlyZXNBdXRoZW50aWNhdGlvbjogdGhpcy5jb25maWcucmVxdWlyZUF1dGhlbnRpY2F0aW9uLFxuICAgICAgICByZXF1aXJlc1Rva2VuczogZmFsc2VcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFByb2Nlc3MgYSB2b3RlXG4gICAqL1xuICBhc3luYyBwcm9jZXNzVm90ZShyZXF1ZXN0OiBWb3RlUmVxdWVzdCwgcG9sbDogUG9sbERhdGEpOiBQcm9taXNlPFZvdGVSZXNwb25zZT4ge1xuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIC8vIFZhbGlkYXRlIHRoZSB2b3RlIGZpcnN0XG4gICAgICBjb25zdCB2YWxpZGF0aW9uID0gYXdhaXQgdGhpcy52YWxpZGF0ZVZvdGUocmVxdWVzdCwgcG9sbCk7XG4gICAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjogdmFsaWRhdGlvbi5lcnJvcnM/LlswXSB8fCAnVm90ZSB2YWxpZGF0aW9uIGZhaWxlZCcsXG4gICAgICAgICAgcG9sbElkOiByZXF1ZXN0LnBvbGxJZCxcbiAgICAgICAgICByZXNwb25zZVRpbWU6IERhdGUubm93KCkgLSBzdGFydFRpbWVcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gR2V0IHRoZSBhcHByb3ByaWF0ZSBzdHJhdGVneSBhbmQgcHJvY2VzcyB0aGUgdm90ZVxuICAgICAgY29uc3Qgc3RyYXRlZ3kgPSB0aGlzLmdldFN0cmF0ZWd5KHBvbGwudm90aW5nTWV0aG9kKTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHN0cmF0ZWd5LnByb2Nlc3NWb3RlKHJlcXVlc3QsIHBvbGwpO1xuXG4gICAgICAvLyBJbmNyZW1lbnQgcmF0ZSBsaW1pdCBjb3VudGVyXG4gICAgICBpZiAocmVxdWVzdC51c2VySWQpIHtcbiAgICAgICAgY29uc3QgcmF0ZUxpbWl0S2V5ID0gYCR7cmVxdWVzdC51c2VySWR9OiR7cmVxdWVzdC5wb2xsSWR9YDtcbiAgICAgICAgY29uc3QgcmF0ZUxpbWl0RGF0YSA9IHRoaXMucmF0ZUxpbWl0VHJhY2tlci5nZXQocmF0ZUxpbWl0S2V5KTtcbiAgICAgICAgaWYgKHJhdGVMaW1pdERhdGEpIHtcbiAgICAgICAgICByYXRlTGltaXREYXRhLmNvdW50Kys7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZGV2TG9nKCdWb3RlIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHknLCB7XG4gICAgICAgIHBvbGxJZDogcmVxdWVzdC5wb2xsSWQsXG4gICAgICAgIHVzZXJJZDogcmVxdWVzdC51c2VySWQsXG4gICAgICAgIG1ldGhvZDogcG9sbC52b3RpbmdNZXRob2QsXG4gICAgICAgIHZvdGVJZDogcmVzdWx0LnZvdGVJZCxcbiAgICAgICAgZHVyYXRpb246IERhdGUubm93KCkgLSBzdGFydFRpbWVcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICB2b3RlSWQ6IHJlc3VsdC52b3RlSWQgfHwgYHZvdGUtJHtEYXRlLm5vdygpfWAsXG4gICAgICAgIHBvbGxJZDogcmVxdWVzdC5wb2xsSWQsXG4gICAgICAgIHJlc3BvbnNlVGltZTogRGF0ZS5ub3coKSAtIHN0YXJ0VGltZVxuICAgICAgfTtcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBkZXZMb2coJ1ZvdGUgcHJvY2Vzc2luZyBlcnJvcjonLCBlcnJvcik7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1ZvdGUgcHJvY2Vzc2luZyBmYWlsZWQnLFxuICAgICAgICBwb2xsSWQ6IHJlcXVlc3QucG9sbElkLFxuICAgICAgICByZXNwb25zZVRpbWU6IERhdGUubm93KCkgLSBzdGFydFRpbWVcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZSByZXN1bHRzIGZvciBhIHBvbGxcbiAgICovXG4gIGFzeW5jIGNhbGN1bGF0ZVJlc3VsdHMocG9sbDogUG9sbERhdGEsIHZvdGVzOiBWb3RlRGF0YVtdKTogUHJvbWlzZTxSZXN1bHRzRGF0YT4ge1xuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHN0cmF0ZWd5ID0gdGhpcy5nZXRTdHJhdGVneShwb2xsLnZvdGluZ01ldGhvZCk7XG4gICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgc3RyYXRlZ3kuY2FsY3VsYXRlUmVzdWx0cyhwb2xsLCB2b3Rlcyk7XG5cbiAgICAgIGRldkxvZygnUmVzdWx0cyBjYWxjdWxhdGVkIHN1Y2Nlc3NmdWxseScsIHtcbiAgICAgICAgcG9sbElkOiBwb2xsLmlkLFxuICAgICAgICBtZXRob2Q6IHBvbGwudm90aW5nTWV0aG9kLFxuICAgICAgICB0b3RhbFZvdGVzOiB2b3Rlcy5sZW5ndGgsXG4gICAgICAgIGR1cmF0aW9uOiBEYXRlLm5vdygpIC0gc3RhcnRUaW1lXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHJlc3VsdHM7XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgZGV2TG9nKCdSZXN1bHRzIGNhbGN1bGF0aW9uIGVycm9yOicsIGVycm9yKTtcbiAgICAgIFxuICAgICAgLy8gUmV0dXJuIGEgYmFzaWMgcmVzdWx0cyBzdHJ1Y3R1cmUgZm9yIHVuc3VwcG9ydGVkIG1ldGhvZHNcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHBvbGxJZDogcG9sbC5pZCxcbiAgICAgICAgdm90aW5nTWV0aG9kOiBwb2xsLnZvdGluZ01ldGhvZCxcbiAgICAgICAgdG90YWxWb3Rlczogdm90ZXMubGVuZ3RoLFxuICAgICAgICBwYXJ0aWNpcGF0aW9uUmF0ZTogdm90ZXMubGVuZ3RoIC8gMTAwLCAvLyBNb2NrIHBhcnRpY2lwYXRpb24gcmF0ZVxuICAgICAgICByZXN1bHRzOiB7XG4gICAgICAgICAgd2lubmVyOiB2b3Rlcy5sZW5ndGggPiAwID8gcG9sbC5vcHRpb25zWzBdPy5pZCA6IHVuZGVmaW5lZCxcbiAgICAgICAgICB3aW5uZXJWb3Rlczogdm90ZXMubGVuZ3RoLFxuICAgICAgICAgIHdpbm5lclBlcmNlbnRhZ2U6IDEwMCxcbiAgICAgICAgICBvcHRpb25Wb3RlczogcG9sbC5vcHRpb25zLnJlZHVjZSgoYWNjLCBvcHRpb24pID0+IHtcbiAgICAgICAgICAgIGFjY1tvcHRpb24uaWRdID0gdm90ZXMubGVuZ3RoO1xuICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgICB9LCB7fSBhcyBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+KSxcbiAgICAgICAgICBvcHRpb25QZXJjZW50YWdlczogcG9sbC5vcHRpb25zLnJlZHVjZSgoYWNjLCBvcHRpb24pID0+IHtcbiAgICAgICAgICAgIGFjY1tvcHRpb24uaWRdID0gMTAwO1xuICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgICB9LCB7fSBhcyBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+KSxcbiAgICAgICAgICBhYnN0ZW50aW9uczogMCxcbiAgICAgICAgICBhYnN0ZW50aW9uUGVyY2VudGFnZTogMFxuICAgICAgICB9LFxuICAgICAgICBjYWxjdWxhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICBjYWxjdWxhdGlvblRpbWU6IERhdGUubm93KCkgLSBzdGFydFRpbWUsXG4gICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCB2b3RpbmcgbWV0aG9kIGNvbmZpZ3VyYXRpb25cbiAgICovXG4gIGdldFZvdGluZ01ldGhvZENvbmZpZyhtZXRob2Q6IFZvdGluZ01ldGhvZCk6IFJlY29yZDxzdHJpbmcsIHVua25vd24+IHtcbiAgICBjb25zdCBzdHJhdGVneSA9IHRoaXMuZ2V0U3RyYXRlZ3kobWV0aG9kKTtcbiAgICByZXR1cm4gc3RyYXRlZ3kuZ2V0Q29uZmlndXJhdGlvbigpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBlbmdpbmUgY29uZmlndXJhdGlvblxuICAgKi9cbiAgdXBkYXRlQ29uZmlnKG5ld0NvbmZpZzogUGFydGlhbDxWb3RlRW5naW5lQ29uZmlnPik6IHZvaWQge1xuICAgIHRoaXMuY29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5jb25maWcsIG5ld0NvbmZpZyk7XG4gICAgZGV2TG9nKCdWb3RlRW5naW5lIGNvbmZpZ3VyYXRpb24gdXBkYXRlZDonLCB0aGlzLmNvbmZpZyk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGN1cnJlbnQgY29uZmlndXJhdGlvblxuICAgKi9cbiAgZ2V0Q29uZmlnKCk6IFZvdGVFbmdpbmVDb25maWcge1xuICAgIHJldHVybiB7IC4uLnRoaXMuY29uZmlnIH07XG4gIH1cbn1cblxuLy8gRXhwb3J0IGEgZGVmYXVsdCBpbnN0YW5jZVxuZXhwb3J0IGNvbnN0IHZvdGVFbmdpbmUgPSBuZXcgVm90ZUVuZ2luZSgpO1xuIl0sIm5hbWVzIjpbIlZvdGVFbmdpbmUiLCJ2b3RlRW5naW5lIiwiY29uc3RydWN0b3IiLCJjb25maWciLCJPYmplY3QiLCJhc3NpZ24iLCJtYXhWb3Rlc1BlclBvbGwiLCJhbGxvd011bHRpcGxlVm90ZXMiLCJyZXF1aXJlQXV0aGVudGljYXRpb24iLCJtaW5UcnVzdFRpZXIiLCJyYXRlTGltaXRQZXJVc2VyIiwicmF0ZUxpbWl0V2luZG93TXMiLCJyYXRlTGltaXRUcmFja2VyIiwiTWFwIiwic3RyYXRlZ2llcyIsIlNpbmdsZUNob2ljZVN0cmF0ZWd5IiwiQXBwcm92YWxTdHJhdGVneSIsIlJhbmtlZFN0cmF0ZWd5IiwiUXVhZHJhdGljU3RyYXRlZ3kiLCJSYW5nZVN0cmF0ZWd5IiwiZGV2TG9nIiwiQXJyYXkiLCJmcm9tIiwia2V5cyIsImdldFN0cmF0ZWd5IiwibWV0aG9kIiwic3RyYXRlZ3kiLCJnZXQiLCJFcnJvciIsInZhbGlkYXRlVm90ZSIsInJlcXVlc3QiLCJwb2xsIiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsInBvbGxJZCIsInZvdGVEYXRhIiwidmFsaWQiLCJlcnJvcnMiLCJyZXF1aXJlc0F1dGhlbnRpY2F0aW9uIiwicmVxdWlyZXNUb2tlbnMiLCJzdGF0dXMiLCJlbmRUaW1lIiwidXNlcklkIiwicmF0ZUxpbWl0S2V5IiwicmF0ZUxpbWl0RGF0YSIsInJlc2V0VGltZSIsImNvdW50Iiwic2V0Iiwidm90aW5nTWV0aG9kIiwic3RyYXRlZ3lWYWxpZGF0aW9uIiwiZHVyYXRpb24iLCJlcnJvciIsIm1lc3NhZ2UiLCJwcm9jZXNzVm90ZSIsInZhbGlkYXRpb24iLCJzdWNjZXNzIiwicmVzcG9uc2VUaW1lIiwicmVzdWx0Iiwidm90ZUlkIiwiY2FsY3VsYXRlUmVzdWx0cyIsInZvdGVzIiwicmVzdWx0cyIsImlkIiwidG90YWxWb3RlcyIsImxlbmd0aCIsInBhcnRpY2lwYXRpb25SYXRlIiwid2lubmVyIiwib3B0aW9ucyIsInVuZGVmaW5lZCIsIndpbm5lclZvdGVzIiwid2lubmVyUGVyY2VudGFnZSIsIm9wdGlvblZvdGVzIiwicmVkdWNlIiwiYWNjIiwib3B0aW9uIiwib3B0aW9uUGVyY2VudGFnZXMiLCJhYnN0ZW50aW9ucyIsImFic3RlbnRpb25QZXJjZW50YWdlIiwiY2FsY3VsYXRlZEF0IiwidG9JU09TdHJpbmciLCJtZXRhZGF0YSIsImNhbGN1bGF0aW9uVGltZSIsImdldFZvdGluZ01ldGhvZENvbmZpZyIsImdldENvbmZpZ3VyYXRpb24iLCJ1cGRhdGVDb25maWciLCJuZXdDb25maWciLCJnZXRDb25maWciXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7OztDQVFDOzs7Ozs7Ozs7OztJQThCWUEsVUFBVTtlQUFWQTs7SUFrU0FDLFVBQVU7ZUFBVkE7Ozt3QkE5VFU7MEJBR1U7MkJBQ0M7dUJBQ0o7d0JBQ0M7OEJBQ007QUFxQjlCLE1BQU1EO0lBS1hFLFlBQVlDLFNBQW9DLENBQUMsQ0FBQyxDQUFFO1FBQ2xELElBQUksQ0FBQ0EsTUFBTSxHQUFHQyxPQUFPQyxNQUFNLENBQUM7WUFDMUJDLGlCQUFpQjtZQUNqQkMsb0JBQW9CO1lBQ3BCQyx1QkFBdUI7WUFDdkJDLGNBQWM7WUFD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