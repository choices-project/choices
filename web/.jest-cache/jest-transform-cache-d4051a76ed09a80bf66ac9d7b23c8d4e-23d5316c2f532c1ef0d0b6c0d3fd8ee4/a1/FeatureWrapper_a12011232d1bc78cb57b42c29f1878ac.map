{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/components/shared/FeatureWrapper.tsx"],"sourcesContent":["/**\n * Feature Wrapper Component\n * \n * A React component that conditionally renders content based on feature flags.\n * Provides a clean way to wrap components or sections that depend on specific features.\n */\n\nimport type { ReactNode } from 'react';\nimport React from 'react';\n\nimport { useFeatureFlag, useFeatureFlagsBatch, useFeatureFlagWithDependencies, useFeatureFlags } from '@/hooks/useFeatureFlags';\n\nexport interface FeatureWrapperProps {\n  /** Feature flag ID to check */\n  feature: string;\n  /** Content to render when feature is enabled */\n  children: ReactNode;\n  /** Content to render when feature is disabled (optional) */\n  fallback?: ReactNode;\n  /** Whether to show loading state while checking flag */\n  showLoading?: boolean;\n  /** Loading component to show */\n  loadingComponent?: ReactNode;\n  /** Whether to render nothing when disabled (default: false) */\n  hideWhenDisabled?: boolean;\n  /** Additional CSS classes */\n  className?: string;\n  /** Additional styles */\n  style?: React.CSSProperties;\n}\n\n/**\n * Wrapper component for a single feature flag\n */\nexport function FeatureWrapper({\n  feature,\n  children,\n  fallback = null,\n  showLoading = false,\n  loadingComponent = <div>Loading...</div>,\n  hideWhenDisabled = false,\n  className,\n  style\n}: FeatureWrapperProps): React.ReactElement | null {\n  const { enabled, disabled: _disabled, loading } = useFeatureFlag(feature);\n\n  // Show loading state if requested and loading\n  if (showLoading && loading) {\n    return <>{loadingComponent}</>;\n  }\n\n  // If feature is enabled, render children\n  if (enabled) {\n    return (\n      <div className={className} style={style}>\n        {children}\n      </div>\n    );\n  }\n\n  // If feature is disabled\n  if (hideWhenDisabled) {\n    return null;\n  }\n\n  // Render fallback if provided\n  return (\n    <div className={className} style={style}>\n      {fallback}\n    </div>\n  );\n}\n\nexport interface FeatureWrapperBatchProps {\n  /** Array of feature flag IDs to check */\n  features: string[];\n  /** Content to render when all features are enabled */\n  children: ReactNode;\n  /** Content to render when any feature is disabled (optional) */\n  fallback?: ReactNode;\n  /** Whether to render when any feature is enabled (default: false, requires all) */\n  anyEnabled?: boolean;\n  /** Whether to show loading state while checking flags */\n  showLoading?: boolean;\n  /** Loading component to show */\n  loadingComponent?: ReactNode;\n  /** Whether to render nothing when conditions not met */\n  hideWhenDisabled?: boolean;\n  /** Additional CSS classes */\n  className?: string;\n  /** Additional styles */\n  style?: React.CSSProperties;\n}\n\n/**\n * Wrapper component for multiple feature flags\n */\nexport function FeatureWrapperBatch({\n  features,\n  children,\n  fallback = null,\n  anyEnabled = false,\n  showLoading = false,\n  loadingComponent = <div>Loading...</div>,\n  hideWhenDisabled = false,\n  className,\n  style\n}: FeatureWrapperBatchProps): React.ReactElement | null {\n  const { enabled, anyEnabled: anyEnabledResult, loading } = useFeatureFlagsBatch(features);\n\n  // Show loading state if requested and loading\n  if (showLoading && loading) {\n    return <>{loadingComponent}</>;\n  }\n\n  // Check if conditions are met\n  const shouldRender = anyEnabled ? anyEnabledResult : enabled;\n\n  // If conditions are met, render children\n  if (shouldRender) {\n    return (\n      <div className={className} style={style}>\n        {children}\n      </div>\n    );\n  }\n\n  // If conditions are not met\n  if (hideWhenDisabled) {\n    return null;\n  }\n\n  // Render fallback if provided\n  return (\n    <div className={className} style={style}>\n      {fallback}\n    </div>\n  );\n}\n\nexport interface FeatureWrapperWithDependenciesProps {\n  /** Feature flag ID to check */\n  feature: string;\n  /** Content to render when feature is enabled and dependencies are met */\n  children: ReactNode;\n  /** Content to render when feature is disabled (optional) */\n  fallback?: ReactNode;\n  /** Content to render when dependencies are not met (optional) */\n  dependenciesFallback?: ReactNode;\n  /** Whether to show loading state while checking flag */\n  showLoading?: boolean;\n  /** Loading component to show */\n  loadingComponent?: ReactNode;\n  /** Whether to render nothing when disabled */\n  hideWhenDisabled?: boolean;\n  /** Additional CSS classes */\n  className?: string;\n  /** Additional styles */\n  style?: React.CSSProperties;\n}\n\n/**\n * Wrapper component for feature flags with dependencies\n */\nexport function FeatureWrapperWithDependencies({\n  feature,\n  children,\n  fallback = null,\n  dependenciesFallback = null,\n  showLoading = false,\n  loadingComponent = <div>Loading...</div>,\n  hideWhenDisabled = false,\n  className,\n  style\n}: FeatureWrapperWithDependenciesProps): React.ReactElement | null {\n  const { enabled, disabled: _disabled, dependenciesMet, loading } = useFeatureFlagWithDependencies(feature);\n\n  // Show loading state if requested and loading\n  if (showLoading && loading) {\n    return <>{loadingComponent}</>;\n  }\n\n  // If feature is enabled and dependencies are met, render children\n  if (enabled && dependenciesMet) {\n    return (\n      <div className={className} style={style}>\n        {children}\n      </div>\n    );\n  }\n\n  // If dependencies are not met, render dependencies fallback\n  if (!dependenciesMet && dependenciesFallback !== null) {\n    return (\n      <div className={className} style={style}>\n        {dependenciesFallback}\n      </div>\n    );\n  }\n\n  // If feature is disabled\n  if (hideWhenDisabled) {\n    return null;\n  }\n\n  // Render fallback if provided\n  return (\n    <div className={className} style={style}>\n      {fallback}\n    </div>\n  );\n}\n\n/**\n * Higher-order component for wrapping components with feature flags\n */\nexport function withFeatureFlag<P extends object>(\n  WrappedComponent: React.ComponentType<P>,\n  feature: string,\n  fallback?: React.ComponentType<P>\n) {\n  return function WithFeatureFlagComponent(props: P): React.ReactElement | null {\n    const { enabled, disabled: _disabled, loading } = useFeatureFlag(feature);\n\n    if (loading) {\n      return <div>Loading...</div>;\n    }\n\n    if (enabled) {\n      return <WrappedComponent {...props} />;\n    }\n\n    if (fallback) {\n      const FallbackComponent = fallback;\n      return <FallbackComponent {...props} />;\n    }\n\n    return null;\n  };\n}\n\n/**\n * Higher-order component for wrapping components with multiple feature flags\n */\nexport function withFeatureFlagsBatch<P extends object>(\n  WrappedComponent: React.ComponentType<P>,\n  features: string[],\n  fallback?: React.ComponentType<P>,\n  anyEnabled = false\n) {\n  return function WithFeatureFlagsBatchComponent(props: P): React.ReactElement | null {\n    const { anyEnabled: anyEnabledResult, loading } = useFeatureFlagsBatch(features);\n\n    if (loading) {\n      return <div>Loading...</div>;\n    }\n\n    const shouldRender = anyEnabled ? anyEnabledResult : true;\n\n    if (shouldRender) {\n      return <WrappedComponent {...props} />;\n    }\n\n    if (fallback) {\n      const FallbackComponent = fallback;\n      return <FallbackComponent {...props} />;\n    }\n\n    return null;\n  };\n}\n\n/**\n * Utility component for debugging feature flags\n */\nexport function FeatureFlagDebugger(): React.ReactElement {\n  const { getAllFlags, systemInfo, loading } = useFeatureFlags();\n  \n  if (loading) {\n    return <div>Loading feature flags...</div>;\n  }\n\n  const flags = Array.from(getAllFlags().values());\n\n  return (\n    <div style={{ padding: '1rem', border: '1px solid #ccc', borderRadius: '4px', margin: '1rem 0' }}>\n      <h3>Feature Flags Debugger</h3>\n      <div>\n        <strong>System Info:</strong>\n        <ul>\n          <li>Total Flags: {systemInfo.totalFlags}</li>\n          <li>Enabled: {systemInfo.enabledFlags}</li>\n          <li>Disabled: {systemInfo.disabledFlags}</li>\n          <li>Environment: {systemInfo.environment}</li>\n        </ul>\n      </div>\n      <div>\n        <strong>Flags:</strong>\n        <ul>\n          {flags.map(flag => (\n            <li key={flag.id} style={{ color: flag.enabled ? 'green' : 'red' }}>\n              {flag.name} ({flag.id}): {flag.enabled ? 'ENABLED' : 'DISABLED'}\n              <br />\n              <small>{flag.description}</small>\n            </li>\n          ))}\n        </ul>\n      </div>\n    </div>\n  );\n}\n\n// Export convenience components\nexport const AuthFeature = (props: Omit<FeatureWrapperProps, 'feature'>) => (\n  <FeatureWrapper feature=\"authentication\" {...props} />\n);\n\nexport const VotingFeature = (props: Omit<FeatureWrapperProps, 'feature'>) => (\n  <FeatureWrapper feature=\"voting\" {...props} />\n);\n\nexport const DatabaseFeature = (props: Omit<FeatureWrapperProps, 'feature'>) => (\n  <FeatureWrapper feature=\"database\" {...props} />\n);\n\nexport const APIFeature = (props: Omit<FeatureWrapperProps, 'feature'>) => (\n  <FeatureWrapper feature=\"api\" {...props} />\n);\n\nexport const UIFeature = (props: Omit<FeatureWrapperProps, 'feature'>) => (\n  <FeatureWrapper feature=\"ui\" {...props} />\n);\n\nexport const AdvancedPrivacyFeature = (props: Omit<FeatureWrapperProps, 'feature'>) => (\n  <FeatureWrapper feature=\"advancedPrivacy\" {...props} />\n);\n\nexport const AnalyticsFeature = (props: Omit<FeatureWrapperProps, 'feature'>) => (\n  <FeatureWrapper feature=\"analytics\" {...props} />\n);\n\nexport const PWAFeature = (props: Omit<FeatureWrapperProps, 'feature'>) => (\n  <FeatureWrapper feature=\"pwa\" {...props} />\n);\n\nexport const AdminFeature = (props: Omit<FeatureWrapperProps, 'feature'>) => (\n  <FeatureWrapper feature=\"admin\" {...props} />\n);\n\nexport const AuditFeature = (props: Omit<FeatureWrapperProps, 'feature'>) => (\n  <FeatureWrapper feature=\"audit\" {...props} />\n);\n\nexport const ExperimentalUIFeature = (props: Omit<FeatureWrapperProps, 'feature'>) => (\n  <FeatureWrapper feature=\"experimentalUI\" {...props} />\n);\n\nexport const AIFeaturesFeature = (props: Omit<FeatureWrapperProps, 'feature'>) => (\n  <FeatureWrapper feature=\"aiFeatures\" {...props} />\n);\n"],"names":["AIFeaturesFeature","APIFeature","AdminFeature","AdvancedPrivacyFeature","AnalyticsFeature","AuditFeature","AuthFeature","DatabaseFeature","ExperimentalUIFeature","FeatureFlagDebugger","FeatureWrapper","FeatureWrapperBatch","FeatureWrapperWithDependencies","PWAFeature","UIFeature","VotingFeature","withFeatureFlag","withFeatureFlagsBatch","feature","children","fallback","showLoading","loadingComponent","div","hideWhenDisabled","className","style","enabled","disabled","_disabled","loading","useFeatureFlag","features","anyEnabled","anyEnabledResult","useFeatureFlagsBatch","shouldRender","dependenciesFallback","dependenciesMet","useFeatureFlagWithDependencies","WrappedComponent","WithFeatureFlagComponent","props","FallbackComponent","WithFeatureFlagsBatchComponent","getAllFlags","systemInfo","useFeatureFlags","flags","Array","from","values","padding","border","borderRadius","margin","h3","strong","ul","li","totalFlags","enabledFlags","disabledFlags","environment","map","flag","color","name","id","br","small","description"],"mappings":"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"}