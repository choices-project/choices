5ff45a13a0c275f6e2e7f2a2561a630f
/**
 * Ranked Choice Voting Strategy
 * 
 * Implements ranked choice voting where voters rank options in order of preference.
 * Uses instant runoff voting (IRV) to determine the winner.
 * 
 * Created: September 15, 2025
 * Updated: September 15, 2025
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "RankedStrategy", {
    enumerable: true,
    get: function() {
        return RankedStrategy;
    }
});
const _logger = require("../../utils/logger");
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {
        __proto__: null
    };
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
class RankedStrategy {
    getVotingMethod() {
        return "ranked";
    }
    async validateVote(request, poll) {
        await Promise.resolve(); // Satisfy require-await rule
        try {
            const voteData = request.voteData;
            // Validate rankings array exists
            if (!voteData.rankings || !Array.isArray(voteData.rankings)) {
                return {
                    valid: false,
                    isValid: false,
                    error: "Rankings must be an array",
                    errors: [
                        "Rankings must be an array"
                    ],
                    requiresAuthentication: false,
                    requiresTokens: false
                };
            }
            // Validate rankings array is not empty
            if (voteData.rankings.length === 0) {
                return {
                    valid: false,
                    isValid: false,
                    error: "At least one ranking is required",
                    errors: [
                        "At least one ranking is required"
                    ],
                    requiresAuthentication: false,
                    requiresTokens: false
                };
            }
            // Validate all rankings are valid integers
            for (const ranking of voteData.rankings){
                if (typeof ranking !== "number" || !Number.isInteger(ranking)) {
                    return {
                        valid: false,
                        isValid: false,
                        error: "Rankings must be integers",
                        errors: [
                            "Rankings must be integers"
                        ],
                        requiresAuthentication: false,
                        requiresTokens: false
                    };
                }
                if (ranking < 0 || ranking >= poll.options.length) {
                    return {
                        valid: false,
                        isValid: false,
                        error: "Invalid option selected",
                        errors: [
                            "Invalid option selected"
                        ],
                        requiresAuthentication: false,
                        requiresTokens: false
                    };
                }
            }
            // Check for duplicate rankings
            const uniqueRankings = new Set(voteData.rankings);
            if (uniqueRankings.size !== voteData.rankings.length) {
                return {
                    valid: false,
                    isValid: false,
                    error: "Duplicate rankings are not allowed",
                    errors: [
                        "Duplicate rankings are not allowed"
                    ],
                    requiresAuthentication: false,
                    requiresTokens: false
                };
            }
            // Check maximum rankings limit
            const maxRankings = poll.votingConfig.maxChoices || poll.options.length;
            if (voteData.rankings.length > maxRankings) {
                return {
                    valid: false,
                    isValid: false,
                    error: `Maximum ${maxRankings} rankings allowed`,
                    errors: [
                        `Maximum ${maxRankings} rankings allowed`
                    ],
                    requiresAuthentication: false,
                    requiresTokens: false
                };
            }
            (0, _logger.devLog)("Ranked vote validated successfully", {
                pollId: request.pollId,
                rankings: voteData.rankings,
                userId: request.userId
            });
            return {
                valid: true,
                isValid: true,
                requiresAuthentication: false,
                requiresTokens: false
            };
        } catch (error) {
            (0, _logger.devLog)("Ranked vote validation error:", {
                error: error instanceof Error ? error.message : String(error)
            });
            return {
                valid: false,
                isValid: false,
                error: "Ranked vote validation failed",
                errors: [
                    "Ranked vote validation failed"
                ],
                requiresAuthentication: false,
                requiresTokens: false
            };
        }
    }
    async processVote(request, poll) {
        await Promise.resolve(); // Satisfy require-await rule
        try {
            const voteData = request.voteData;
            // Create vote data for storage
            const voteRecord = {
                id: `vote_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
                pollId: request.pollId,
                userId: request.userId,
                rankings: voteData.rankings,
                privacyLevel: "standard",
                auditReceipt: `audit_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
                timestamp: new Date(),
                ipAddress: request.ipAddress,
                userAgent: request.userAgent
            };
            (0, _logger.devLog)("Ranked vote processed successfully", {
                pollId: request.pollId,
                userId: request.userId,
                rankings: voteData.rankings,
                voteId: voteRecord.id
            });
            return {
                success: true,
                voteId: voteRecord.id,
                message: "Vote recorded successfully",
                pollId: request.pollId
            };
        } catch (error) {
            (0, _logger.devLog)("Ranked vote processing error:", {
                error: error instanceof Error ? error.message : String(error)
            });
            return {
                success: false,
                error: "Failed to process ranked vote",
                message: "Failed to process ranked vote",
                pollId: request.pollId
            };
        }
    }
    async calculateResults(poll, votes) {
        await Promise.resolve(); // Satisfy require-await rule
        try {
            const startTime = Date.now();
            // Import IRV calculator for proper ranked choice implementation
            const { IRVCalculator } = await Promise.resolve().then(()=>/*#__PURE__*/ _interop_require_wildcard(require("../irv-calculator")));
            // Convert poll options to candidates format
            const candidates = poll.options.map((option)=>({
                    id: option.id,
                    name: option.text,
                    description: option.description || ""
                }));
            // Convert votes to user rankings format
            const userRankings = votes.filter((vote)=>vote.voteData?.rankings && vote.voteData.rankings.length > 0 && vote.userId).map((vote)=>({
                    pollId: poll.id,
                    userId: vote.userId,
                    ranking: vote.voteData?.rankings?.map((index)=>{
                        const option = poll.options[index];
                        return option?.id;
                    }).filter((id)=>Boolean(id)) ?? [],
                    createdAt: new Date(vote.timestamp)
                }));
            // Create IRV calculator and calculate results
            const calculator = new IRVCalculator(poll.id, candidates);
            const irvResults = calculator.calculateResults(userRankings);
            // Convert IRV results to our format
            const optionVotes = {};
            const optionPercentages = {};
            // Initialize all options with zero scores
            poll.options.forEach((option)=>{
                optionVotes[option.id] = 0;
                optionPercentages[option.id] = 0;
            });
            // Count votes from first round
            if (irvResults.rounds.length > 0) {
                const firstRound = irvResults.rounds[0];
                if (firstRound) {
                    Object.entries(firstRound.votes).forEach(([optionId, votes])=>{
                        optionVotes[optionId] = Number(votes);
                    });
                }
            }
            const totalVotes = irvResults.totalVotes || 0;
            // Calculate percentages
            if (totalVotes > 0) {
                Object.keys(optionVotes).forEach((optionId)=>{
                    const votes = optionVotes[optionId] || 0;
                    optionPercentages[optionId] = votes / totalVotes * 100;
                });
            }
            // Get winner from IRV results
            const winner = irvResults.winner;
            const winnerVotes = winner ? optionVotes[winner] || 0 : 0;
            const winnerPercentage = winner ? optionPercentages[winner] || 0 : 0;
            const results = {
                winner: winner || undefined,
                winnerVotes,
                winnerPercentage,
                optionVotes,
                optionPercentages,
                abstentions: 0,
                abstentionPercentage: 0
            };
            (0, _logger.devLog)("Ranked results calculated with IRV", {
                pollId: poll.id,
                totalVotes,
                winner,
                winnerVotes,
                winnerPercentage,
                rounds: irvResults.rounds.length,
                calculationTime: Date.now() - startTime
            });
            return {
                pollId: poll.id,
                votingMethod: poll.votingMethod,
                totalVotes,
                participationRate: totalVotes / 100,
                results,
                calculatedAt: new Date().toISOString(),
                metadata: {
                    calculationTime: Date.now() - startTime,
                    method: "ranked",
                    rounds: irvResults.rounds.length,
                    eliminated: irvResults.rounds.filter((round)=>round.eliminated).map((round)=>round.eliminated)
                }
            };
        } catch (error) {
            (0, _logger.devLog)("Ranked results calculation error:", {
                error: error instanceof Error ? error.message : String(error)
            });
            // Return empty results on error
            return {
                pollId: poll.id,
                votingMethod: poll.votingMethod,
                totalVotes: 0,
                participationRate: 0,
                results: {
                    winner: undefined,
                    winnerVotes: 0,
                    winnerPercentage: 0,
                    optionVotes: {},
                    optionPercentages: {},
                    abstentions: 0,
                    abstentionPercentage: 0
                },
                calculatedAt: new Date().toISOString(),
                metadata: {
                    calculationTime: 0,
                    error: error instanceof Error ? error.message : "Unknown error"
                }
            };
        }
    }
    getConfiguration() {
        return {
            method: "ranked",
            description: "Voters rank options in order of preference",
            allowsMultipleSelections: true,
            requiresRanking: true,
            maxSelections: "configurable",
            algorithm: "instant runoff voting"
        };
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hbGF1Z2hpbmdraXRzdW5lL3NyYy9DaG9pY2VzL3dlYi9saWIvdm90ZS9zdHJhdGVnaWVzL3JhbmtlZC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFJhbmtlZCBDaG9pY2UgVm90aW5nIFN0cmF0ZWd5XG4gKiBcbiAqIEltcGxlbWVudHMgcmFua2VkIGNob2ljZSB2b3Rpbmcgd2hlcmUgdm90ZXJzIHJhbmsgb3B0aW9ucyBpbiBvcmRlciBvZiBwcmVmZXJlbmNlLlxuICogVXNlcyBpbnN0YW50IHJ1bm9mZiB2b3RpbmcgKElSVikgdG8gZGV0ZXJtaW5lIHRoZSB3aW5uZXIuXG4gKiBcbiAqIENyZWF0ZWQ6IFNlcHRlbWJlciAxNSwgMjAyNVxuICogVXBkYXRlZDogU2VwdGVtYmVyIDE1LCAyMDI1XG4gKi9cblxuaW1wb3J0IHsgZGV2TG9nIH0gZnJvbSAnQC9saWIvdXRpbHMvbG9nZ2VyJztcblxuaW1wb3J0IHR5cGUgeyBcbiAgVm90aW5nU3RyYXRlZ3ksIFxuICBWb3RlUmVxdWVzdCwgXG4gIFZvdGVSZXNwb25zZSwgXG4gIFZvdGVWYWxpZGF0aW9uLCBcbiAgUG9sbERhdGEsIFxuICBWb3RlRGF0YSwgXG4gIFJlc3VsdHNEYXRhLFxuICBWb3RpbmdNZXRob2QsXG4gIFBvbGxSZXN1bHRzXG59IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIFJhbmtlZFN0cmF0ZWd5IGltcGxlbWVudHMgVm90aW5nU3RyYXRlZ3kge1xuICBcbiAgZ2V0Vm90aW5nTWV0aG9kKCk6IFZvdGluZ01ldGhvZCB7XG4gICAgcmV0dXJuICdyYW5rZWQnO1xuICB9XG5cbiAgYXN5bmMgdmFsaWRhdGVWb3RlKHJlcXVlc3Q6IFZvdGVSZXF1ZXN0LCBwb2xsOiBQb2xsRGF0YSk6IFByb21pc2U8Vm90ZVZhbGlkYXRpb24+IHtcbiAgICBhd2FpdCBQcm9taXNlLnJlc29sdmUoKTsgLy8gU2F0aXNmeSByZXF1aXJlLWF3YWl0IHJ1bGVcbiAgICB0cnkge1xuICAgICAgY29uc3Qgdm90ZURhdGEgPSByZXF1ZXN0LnZvdGVEYXRhO1xuXG4gICAgICAvLyBWYWxpZGF0ZSByYW5raW5ncyBhcnJheSBleGlzdHNcbiAgICAgIGlmICghdm90ZURhdGEucmFua2luZ3MgfHwgIUFycmF5LmlzQXJyYXkodm90ZURhdGEucmFua2luZ3MpKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgIGlzVmFsaWQ6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiAnUmFua2luZ3MgbXVzdCBiZSBhbiBhcnJheScsXG4gICAgICAgICAgZXJyb3JzOiBbJ1JhbmtpbmdzIG11c3QgYmUgYW4gYXJyYXknXSxcbiAgICAgICAgICByZXF1aXJlc0F1dGhlbnRpY2F0aW9uOiBmYWxzZSxcbiAgICAgICAgICByZXF1aXJlc1Rva2VuczogZmFsc2VcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gVmFsaWRhdGUgcmFua2luZ3MgYXJyYXkgaXMgbm90IGVtcHR5XG4gICAgICBpZiAodm90ZURhdGEucmFua2luZ3MubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgIGlzVmFsaWQ6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiAnQXQgbGVhc3Qgb25lIHJhbmtpbmcgaXMgcmVxdWlyZWQnLFxuICAgICAgICAgIGVycm9yczogWydBdCBsZWFzdCBvbmUgcmFua2luZyBpcyByZXF1aXJlZCddLFxuICAgICAgICAgIHJlcXVpcmVzQXV0aGVudGljYXRpb246IGZhbHNlLFxuICAgICAgICAgIHJlcXVpcmVzVG9rZW5zOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICAvLyBWYWxpZGF0ZSBhbGwgcmFua2luZ3MgYXJlIHZhbGlkIGludGVnZXJzXG4gICAgICBmb3IgKGNvbnN0IHJhbmtpbmcgb2Ygdm90ZURhdGEucmFua2luZ3MpIHtcbiAgICAgICAgaWYgKHR5cGVvZiByYW5raW5nICE9PSAnbnVtYmVyJyB8fCAhTnVtYmVyLmlzSW50ZWdlcihyYW5raW5nKSkge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgIGVycm9yOiAnUmFua2luZ3MgbXVzdCBiZSBpbnRlZ2VycycsXG4gICAgICAgICAgICBlcnJvcnM6IFsnUmFua2luZ3MgbXVzdCBiZSBpbnRlZ2VycyddLFxuICAgICAgICAgICAgcmVxdWlyZXNBdXRoZW50aWNhdGlvbjogZmFsc2UsXG4gICAgICAgICAgICByZXF1aXJlc1Rva2VuczogZmFsc2VcbiAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHJhbmtpbmcgPCAwIHx8IHJhbmtpbmcgPj0gcG9sbC5vcHRpb25zLmxlbmd0aCkge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgIGVycm9yOiAnSW52YWxpZCBvcHRpb24gc2VsZWN0ZWQnLFxuICAgICAgICAgICAgZXJyb3JzOiBbJ0ludmFsaWQgb3B0aW9uIHNlbGVjdGVkJ10sXG4gICAgICAgICAgICByZXF1aXJlc0F1dGhlbnRpY2F0aW9uOiBmYWxzZSxcbiAgICAgICAgICAgIHJlcXVpcmVzVG9rZW5zOiBmYWxzZVxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgZm9yIGR1cGxpY2F0ZSByYW5raW5nc1xuICAgICAgY29uc3QgdW5pcXVlUmFua2luZ3MgPSBuZXcgU2V0KHZvdGVEYXRhLnJhbmtpbmdzKTtcbiAgICAgIGlmICh1bmlxdWVSYW5raW5ncy5zaXplICE9PSB2b3RlRGF0YS5yYW5raW5ncy5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgaXNWYWxpZDogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6ICdEdXBsaWNhdGUgcmFua2luZ3MgYXJlIG5vdCBhbGxvd2VkJyxcbiAgICAgICAgICBlcnJvcnM6IFsnRHVwbGljYXRlIHJhbmtpbmdzIGFyZSBub3QgYWxsb3dlZCddLFxuICAgICAgICAgIHJlcXVpcmVzQXV0aGVudGljYXRpb246IGZhbHNlLFxuICAgICAgICAgIHJlcXVpcmVzVG9rZW5zOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICAvLyBDaGVjayBtYXhpbXVtIHJhbmtpbmdzIGxpbWl0XG4gICAgICBjb25zdCBtYXhSYW5raW5ncyA9IHBvbGwudm90aW5nQ29uZmlnLm1heENob2ljZXMgfHwgcG9sbC5vcHRpb25zLmxlbmd0aDtcbiAgICAgIGlmICh2b3RlRGF0YS5yYW5raW5ncy5sZW5ndGggPiBtYXhSYW5raW5ncykge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjogYE1heGltdW0gJHttYXhSYW5raW5nc30gcmFua2luZ3MgYWxsb3dlZGAsXG4gICAgICAgICAgZXJyb3JzOiBbYE1heGltdW0gJHttYXhSYW5raW5nc30gcmFua2luZ3MgYWxsb3dlZGBdLFxuICAgICAgICAgIHJlcXVpcmVzQXV0aGVudGljYXRpb246IGZhbHNlLFxuICAgICAgICAgIHJlcXVpcmVzVG9rZW5zOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICBkZXZMb2coJ1JhbmtlZCB2b3RlIHZhbGlkYXRlZCBzdWNjZXNzZnVsbHknLCB7XG4gICAgICAgIHBvbGxJZDogcmVxdWVzdC5wb2xsSWQsXG4gICAgICAgIHJhbmtpbmdzOiB2b3RlRGF0YS5yYW5raW5ncyxcbiAgICAgICAgdXNlcklkOiByZXF1ZXN0LnVzZXJJZFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbGlkOiB0cnVlLFxuICAgICAgICBpc1ZhbGlkOiB0cnVlLFxuICAgICAgICByZXF1aXJlc0F1dGhlbnRpY2F0aW9uOiBmYWxzZSxcbiAgICAgICAgcmVxdWlyZXNUb2tlbnM6IGZhbHNlXG4gICAgICB9O1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGRldkxvZygnUmFua2VkIHZvdGUgdmFsaWRhdGlvbiBlcnJvcjonLCB7IGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcikgfSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgIGlzVmFsaWQ6IGZhbHNlLFxuICAgICAgICBlcnJvcjogJ1JhbmtlZCB2b3RlIHZhbGlkYXRpb24gZmFpbGVkJyxcbiAgICAgICAgZXJyb3JzOiBbJ1JhbmtlZCB2b3RlIHZhbGlkYXRpb24gZmFpbGVkJ10sXG4gICAgICAgIHJlcXVpcmVzQXV0aGVudGljYXRpb246IGZhbHNlLFxuICAgICAgICByZXF1aXJlc1Rva2VuczogZmFsc2VcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcHJvY2Vzc1ZvdGUocmVxdWVzdDogVm90ZVJlcXVlc3QsIHBvbGw6IFBvbGxEYXRhKTogUHJvbWlzZTxWb3RlUmVzcG9uc2U+IHtcbiAgICBhd2FpdCBQcm9taXNlLnJlc29sdmUoKTsgLy8gU2F0aXNmeSByZXF1aXJlLWF3YWl0IHJ1bGVcbiAgICB0cnkge1xuICAgICAgY29uc3Qgdm90ZURhdGEgPSByZXF1ZXN0LnZvdGVEYXRhO1xuICAgICAgXG4gICAgICAvLyBDcmVhdGUgdm90ZSBkYXRhIGZvciBzdG9yYWdlXG4gICAgICBjb25zdCB2b3RlUmVjb3JkOiBWb3RlRGF0YSA9IHtcbiAgICAgICAgaWQ6IGB2b3RlXyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YCxcbiAgICAgICAgcG9sbElkOiByZXF1ZXN0LnBvbGxJZCxcbiAgICAgICAgdXNlcklkOiByZXF1ZXN0LnVzZXJJZCxcbiAgICAgICAgcmFua2luZ3M6IHZvdGVEYXRhLnJhbmtpbmdzLFxuICAgICAgICBwcml2YWN5TGV2ZWw6ICdzdGFuZGFyZCcsXG4gICAgICAgIGF1ZGl0UmVjZWlwdDogYGF1ZGl0XyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YCxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICBpcEFkZHJlc3M6IHJlcXVlc3QuaXBBZGRyZXNzLFxuICAgICAgICB1c2VyQWdlbnQ6IHJlcXVlc3QudXNlckFnZW50XG4gICAgICB9O1xuXG4gICAgICBkZXZMb2coJ1JhbmtlZCB2b3RlIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHknLCB7XG4gICAgICAgIHBvbGxJZDogcmVxdWVzdC5wb2xsSWQsXG4gICAgICAgIHVzZXJJZDogcmVxdWVzdC51c2VySWQsXG4gICAgICAgIHJhbmtpbmdzOiB2b3RlRGF0YS5yYW5raW5ncyxcbiAgICAgICAgdm90ZUlkOiB2b3RlUmVjb3JkLmlkXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgdm90ZUlkOiB2b3RlUmVjb3JkLmlkLFxuICAgICAgICBtZXNzYWdlOiAnVm90ZSByZWNvcmRlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgICBwb2xsSWQ6IHJlcXVlc3QucG9sbElkXG4gICAgICB9O1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGRldkxvZygnUmFua2VkIHZvdGUgcHJvY2Vzc2luZyBlcnJvcjonLCB7IGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcikgfSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6ICdGYWlsZWQgdG8gcHJvY2VzcyByYW5rZWQgdm90ZScsXG4gICAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gcHJvY2VzcyByYW5rZWQgdm90ZScsXG4gICAgICAgIHBvbGxJZDogcmVxdWVzdC5wb2xsSWRcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgY2FsY3VsYXRlUmVzdWx0cyhwb2xsOiBQb2xsRGF0YSwgdm90ZXM6IFZvdGVEYXRhW10pOiBQcm9taXNlPFJlc3VsdHNEYXRhPiB7XG4gICAgYXdhaXQgUHJvbWlzZS5yZXNvbHZlKCk7IC8vIFNhdGlzZnkgcmVxdWlyZS1hd2FpdCBydWxlXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgICBcbiAgICAgIC8vIEltcG9ydCBJUlYgY2FsY3VsYXRvciBmb3IgcHJvcGVyIHJhbmtlZCBjaG9pY2UgaW1wbGVtZW50YXRpb25cbiAgICAgIGNvbnN0IHsgSVJWQ2FsY3VsYXRvciB9ID0gYXdhaXQgaW1wb3J0KCcuLi9pcnYtY2FsY3VsYXRvcicpO1xuICAgICAgXG4gICAgICAvLyBDb252ZXJ0IHBvbGwgb3B0aW9ucyB0byBjYW5kaWRhdGVzIGZvcm1hdFxuICAgICAgY29uc3QgY2FuZGlkYXRlcyA9IHBvbGwub3B0aW9ucy5tYXAob3B0aW9uID0+ICh7XG4gICAgICAgIGlkOiBvcHRpb24uaWQsXG4gICAgICAgIG5hbWU6IG9wdGlvbi50ZXh0LFxuICAgICAgICBkZXNjcmlwdGlvbjogb3B0aW9uLmRlc2NyaXB0aW9uIHx8ICcnXG4gICAgICB9KSk7XG5cbiAgICAgIC8vIENvbnZlcnQgdm90ZXMgdG8gdXNlciByYW5raW5ncyBmb3JtYXRcbiAgICAgIGNvbnN0IHVzZXJSYW5raW5ncyA9IHZvdGVzXG4gICAgICAgIC5maWx0ZXIodm90ZSA9PiB2b3RlLnZvdGVEYXRhPy5yYW5raW5ncyAmJiB2b3RlLnZvdGVEYXRhLnJhbmtpbmdzLmxlbmd0aCA+IDAgJiYgdm90ZS51c2VySWQpXG4gICAgICAgIC5tYXAodm90ZSA9PiAoe1xuICAgICAgICAgIHBvbGxJZDogcG9sbC5pZCxcbiAgICAgICAgICB1c2VySWQ6IHZvdGUudXNlcklkISxcbiAgICAgICAgICByYW5raW5nOiB2b3RlLnZvdGVEYXRhPy5yYW5raW5ncz8ubWFwKGluZGV4ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG9wdGlvbiA9IHBvbGwub3B0aW9uc1tpbmRleF07XG4gICAgICAgICAgICByZXR1cm4gb3B0aW9uPy5pZDtcbiAgICAgICAgICB9KS5maWx0ZXIoKGlkKTogaWQgaXMgc3RyaW5nID0+IEJvb2xlYW4oaWQpKSA/PyBbXSxcbiAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKHZvdGUudGltZXN0YW1wKVxuICAgICAgICB9KSk7XG5cbiAgICAgIC8vIENyZWF0ZSBJUlYgY2FsY3VsYXRvciBhbmQgY2FsY3VsYXRlIHJlc3VsdHNcbiAgICAgIGNvbnN0IGNhbGN1bGF0b3IgPSBuZXcgSVJWQ2FsY3VsYXRvcihwb2xsLmlkLCBjYW5kaWRhdGVzKTtcbiAgICAgIGNvbnN0IGlydlJlc3VsdHMgPSBjYWxjdWxhdG9yLmNhbGN1bGF0ZVJlc3VsdHModXNlclJhbmtpbmdzKTtcblxuICAgICAgLy8gQ29udmVydCBJUlYgcmVzdWx0cyB0byBvdXIgZm9ybWF0XG4gICAgICBjb25zdCBvcHRpb25Wb3RlczogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xuICAgICAgY29uc3Qgb3B0aW9uUGVyY2VudGFnZXM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcblxuICAgICAgLy8gSW5pdGlhbGl6ZSBhbGwgb3B0aW9ucyB3aXRoIHplcm8gc2NvcmVzXG4gICAgICBwb2xsLm9wdGlvbnMuZm9yRWFjaChvcHRpb24gPT4ge1xuICAgICAgICBvcHRpb25Wb3Rlc1tvcHRpb24uaWRdID0gMDtcbiAgICAgICAgb3B0aW9uUGVyY2VudGFnZXNbb3B0aW9uLmlkXSA9IDA7XG4gICAgICB9KTtcblxuICAgICAgLy8gQ291bnQgdm90ZXMgZnJvbSBmaXJzdCByb3VuZFxuICAgICAgaWYgKGlydlJlc3VsdHMucm91bmRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgZmlyc3RSb3VuZCA9IGlydlJlc3VsdHMucm91bmRzWzBdO1xuICAgICAgICBpZiAoZmlyc3RSb3VuZCkge1xuICAgICAgICAgIE9iamVjdC5lbnRyaWVzKGZpcnN0Um91bmQudm90ZXMpLmZvckVhY2goKFtvcHRpb25JZCwgdm90ZXNdKSA9PiB7XG4gICAgICAgICAgICBvcHRpb25Wb3Rlc1tvcHRpb25JZF0gPSBOdW1iZXIodm90ZXMpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHRvdGFsVm90ZXMgPSBpcnZSZXN1bHRzLnRvdGFsVm90ZXMgfHwgMDtcblxuICAgICAgLy8gQ2FsY3VsYXRlIHBlcmNlbnRhZ2VzXG4gICAgICBpZiAodG90YWxWb3RlcyA+IDApIHtcbiAgICAgICAgT2JqZWN0LmtleXMob3B0aW9uVm90ZXMpLmZvckVhY2gob3B0aW9uSWQgPT4ge1xuICAgICAgICAgIGNvbnN0IHZvdGVzID0gb3B0aW9uVm90ZXNbb3B0aW9uSWRdIHx8IDA7XG4gICAgICAgICAgb3B0aW9uUGVyY2VudGFnZXNbb3B0aW9uSWRdID0gKHZvdGVzIC8gdG90YWxWb3RlcykgKiAxMDA7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBHZXQgd2lubmVyIGZyb20gSVJWIHJlc3VsdHNcbiAgICAgIGNvbnN0IHdpbm5lciA9IGlydlJlc3VsdHMud2lubmVyO1xuICAgICAgY29uc3Qgd2lubmVyVm90ZXMgPSB3aW5uZXIgPyBvcHRpb25Wb3Rlc1t3aW5uZXJdIHx8IDAgOiAwO1xuICAgICAgY29uc3Qgd2lubmVyUGVyY2VudGFnZSA9IHdpbm5lciA/IG9wdGlvblBlcmNlbnRhZ2VzW3dpbm5lcl0gfHwgMCA6IDA7XG5cbiAgICAgIGNvbnN0IHJlc3VsdHM6IFBvbGxSZXN1bHRzID0ge1xuICAgICAgICB3aW5uZXI6IHdpbm5lciB8fCB1bmRlZmluZWQsXG4gICAgICAgIHdpbm5lclZvdGVzLFxuICAgICAgICB3aW5uZXJQZXJjZW50YWdlLFxuICAgICAgICBvcHRpb25Wb3RlcyxcbiAgICAgICAgb3B0aW9uUGVyY2VudGFnZXMsXG4gICAgICAgIGFic3RlbnRpb25zOiAwLFxuICAgICAgICBhYnN0ZW50aW9uUGVyY2VudGFnZTogMFxuICAgICAgfTtcblxuICAgICAgZGV2TG9nKCdSYW5rZWQgcmVzdWx0cyBjYWxjdWxhdGVkIHdpdGggSVJWJywge1xuICAgICAgICBwb2xsSWQ6IHBvbGwuaWQsXG4gICAgICAgIHRvdGFsVm90ZXMsXG4gICAgICAgIHdpbm5lcixcbiAgICAgICAgd2lubmVyVm90ZXMsXG4gICAgICAgIHdpbm5lclBlcmNlbnRhZ2UsXG4gICAgICAgIHJvdW5kczogaXJ2UmVzdWx0cy5yb3VuZHMubGVuZ3RoLFxuICAgICAgICBjYWxjdWxhdGlvblRpbWU6IERhdGUubm93KCkgLSBzdGFydFRpbWVcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBwb2xsSWQ6IHBvbGwuaWQsXG4gICAgICAgIHZvdGluZ01ldGhvZDogcG9sbC52b3RpbmdNZXRob2QsXG4gICAgICAgIHRvdGFsVm90ZXMsXG4gICAgICAgIHBhcnRpY2lwYXRpb25SYXRlOiB0b3RhbFZvdGVzIC8gMTAwLCAvLyBNb2NrIHBhcnRpY2lwYXRpb24gcmF0ZVxuICAgICAgICByZXN1bHRzLFxuICAgICAgICBjYWxjdWxhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICBjYWxjdWxhdGlvblRpbWU6IERhdGUubm93KCkgLSBzdGFydFRpbWUsXG4gICAgICAgICAgbWV0aG9kOiAncmFua2VkJyxcbiAgICAgICAgICByb3VuZHM6IGlydlJlc3VsdHMucm91bmRzLmxlbmd0aCxcbiAgICAgICAgICBlbGltaW5hdGVkOiBpcnZSZXN1bHRzLnJvdW5kc1xuICAgICAgICAgICAgLmZpbHRlcigocm91bmQ6IGFueSkgPT4gcm91bmQuZWxpbWluYXRlZClcbiAgICAgICAgICAgIC5tYXAoKHJvdW5kOiBhbnkpID0+IHJvdW5kLmVsaW1pbmF0ZWQpXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgZGV2TG9nKCdSYW5rZWQgcmVzdWx0cyBjYWxjdWxhdGlvbiBlcnJvcjonLCB7IGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcikgfSk7XG4gICAgICBcbiAgICAgIC8vIFJldHVybiBlbXB0eSByZXN1bHRzIG9uIGVycm9yXG4gICAgICByZXR1cm4ge1xuICAgICAgICBwb2xsSWQ6IHBvbGwuaWQsXG4gICAgICAgIHZvdGluZ01ldGhvZDogcG9sbC52b3RpbmdNZXRob2QsXG4gICAgICAgIHRvdGFsVm90ZXM6IDAsXG4gICAgICAgIHBhcnRpY2lwYXRpb25SYXRlOiAwLFxuICAgICAgICByZXN1bHRzOiB7XG4gICAgICAgICAgd2lubmVyOiB1bmRlZmluZWQsXG4gICAgICAgICAgd2lubmVyVm90ZXM6IDAsXG4gICAgICAgICAgd2lubmVyUGVyY2VudGFnZTogMCxcbiAgICAgICAgICBvcHRpb25Wb3Rlczoge30sXG4gICAgICAgICAgb3B0aW9uUGVyY2VudGFnZXM6IHt9LFxuICAgICAgICAgIGFic3RlbnRpb25zOiAwLFxuICAgICAgICAgIGFic3RlbnRpb25QZXJjZW50YWdlOiAwXG4gICAgICAgIH0sXG4gICAgICAgIGNhbGN1bGF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgIGNhbGN1bGF0aW9uVGltZTogMCxcbiAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICBnZXRDb25maWd1cmF0aW9uKCk6IFJlY29yZDxzdHJpbmcsIHVua25vd24+IHtcbiAgICByZXR1cm4ge1xuICAgICAgbWV0aG9kOiAncmFua2VkJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnVm90ZXJzIHJhbmsgb3B0aW9ucyBpbiBvcmRlciBvZiBwcmVmZXJlbmNlJyxcbiAgICAgIGFsbG93c011bHRpcGxlU2VsZWN0aW9uczogdHJ1ZSxcbiAgICAgIHJlcXVpcmVzUmFua2luZzogdHJ1ZSxcbiAgICAgIG1heFNlbGVjdGlvbnM6ICdjb25maWd1cmFibGUnLFxuICAgICAgYWxnb3JpdGhtOiAnaW5zdGFudCBydW5vZmYgdm90aW5nJ1xuICAgIH07XG4gIH1cbn0iXSwibmFtZXMiOlsiUmFua2VkU3RyYXRlZ3kiLCJnZXRWb3RpbmdNZXRob2QiLCJ2YWxpZGF0ZVZvdGUiLCJyZXF1ZXN0IiwicG9sbCIsIlByb21pc2UiLCJyZXNvbHZlIiwidm90ZURhdGEiLCJyYW5raW5ncyIsIkFycmF5IiwiaXNBcnJheSIsInZhbGlkIiwiaXNWYWxpZCIsImVycm9yIiwiZXJyb3JzIiwicmVxdWlyZXNBdXRoZW50aWNhdGlvbiIsInJlcXVpcmVzVG9rZW5zIiwibGVuZ3RoIiwicmFua2luZyIsIk51bWJlciIsImlzSW50ZWdlciIsIm9wdGlvbnMiLCJ1bmlxdWVSYW5raW5ncyIsIlNldCIsInNpemUiLCJtYXhSYW5raW5ncyIsInZvdGluZ0NvbmZpZyIsIm1heENob2ljZXMiLCJkZXZMb2ciLCJwb2xsSWQiLCJ1c2VySWQiLCJFcnJvciIsIm1lc3NhZ2UiLCJTdHJpbmciLCJwcm9jZXNzVm90ZSIsInZvdGVSZWNvcmQiLCJpZCIsIkRhdGUiLCJub3ciLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHIiLCJwcml2YWN5TGV2ZWwiLCJhdWRpdFJlY2VpcHQiLCJ0aW1lc3RhbXAiLCJpcEFkZHJlc3MiLCJ1c2VyQWdlbnQiLCJ2b3RlSWQiLCJzdWNjZXNzIiwiY2FsY3VsYXRlUmVzdWx0cyIsInZvdGVzIiwic3RhcnRUaW1lIiwiSVJWQ2FsY3VsYXRvciIsImNhbmRpZGF0ZXMiLCJtYXAiLCJvcHRpb24iLCJuYW1lIiwidGV4dCIsImRlc2NyaXB0aW9uIiwidXNlclJhbmtpbmdzIiwiZmlsdGVyIiwidm90ZSIsImluZGV4IiwiQm9vbGVhbiIsImNyZWF0ZWRBdCIsImNhbGN1bGF0b3IiLCJpcnZSZXN1bHRzIiwib3B0aW9uVm90ZXMiLCJvcHRpb25QZXJjZW50YWdlcyIsImZvckVhY2giLCJyb3VuZHMiLCJmaXJzdFJvdW5kIiwiT2JqZWN0IiwiZW50cmllcyIsIm9wdGlvbklkIiwidG90YWxWb3RlcyIsImtleXMiLCJ3aW5uZXIiLCJ3aW5uZXJWb3RlcyIsIndpbm5lclBlcmNlbnRhZ2UiLCJyZXN1bHRzIiwidW5kZWZpbmVkIiwiYWJzdGVudGlvbnMiLCJhYnN0ZW50aW9uUGVyY2VudGFnZSIsImNhbGN1bGF0aW9uVGltZSIsInZvdGluZ01ldGhvZCIsInBhcnRpY2lwYXRpb25SYXRlIiwiY2FsY3VsYXRlZEF0IiwidG9JU09TdHJpbmciLCJtZXRhZGF0YSIsIm1ldGhvZCIsImVsaW1pbmF0ZWQiLCJyb3VuZCIsImdldENvbmZpZ3VyYXRpb24iLCJhbGxvd3NNdWx0aXBsZVNlbGVjdGlvbnMiLCJyZXF1aXJlc1JhbmtpbmciLCJtYXhTZWxlY3Rpb25zIiwiYWxnb3JpdGhtIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Q0FRQzs7OzsrQkFnQllBOzs7ZUFBQUE7Ozt3QkFkVTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBY2hCLE1BQU1BO0lBRVhDLGtCQUFnQztRQUM5QixPQUFPO0lBQ1Q7SUFFQSxNQUFNQyxhQUFhQyxPQUFvQixFQUFFQyxJQUFjLEVBQTJCO1FBQ2hGLE1BQU1DLFFBQVFDLE9BQU8sSUFBSSw2QkFBNkI7UUFDdEQsSUFBSTtZQUNGLE1BQU1DLFdBQVdKLFFBQVFJLFFBQVE7WUFFakMsaUNBQWlDO1lBQ2pDLElBQUksQ0FBQ0Es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