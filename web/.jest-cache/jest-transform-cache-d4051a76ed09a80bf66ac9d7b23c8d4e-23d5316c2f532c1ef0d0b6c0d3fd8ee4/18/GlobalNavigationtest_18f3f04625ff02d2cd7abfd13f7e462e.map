{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/tests/jest/unit/components/shared/GlobalNavigation.test.tsx"],"sourcesContent":["/**\n * GlobalNavigation Component Tests\n * \n * Comprehensive tests for the main navigation component\n * Tests user interactions, authentication states, and responsive behavior\n */\n\nimport { render, screen, fireEvent, waitFor } from '@testing-library/react'\nimport { BrowserRouter } from 'react-router-dom'\nimport { describe, it, expect, beforeEach, jest } from '@jest/globals'\n\n// Mock lucide-react before importing the component\njest.mock('lucide-react', () => require('@/../../__mocks__/lucide-react.js'))\n\nimport GlobalNavigation from '@/components/shared/GlobalNavigation'\n\n// Mock the stores\nconst mockSignOut = jest.fn()\nconst mockUser = {\n  id: 'test-user-id',\n  name: 'Test User',\n  email: 'test@example.com',\n  avatar: 'https://example.com/avatar.jpg'\n}\n\njest.mock('@/lib/stores', () => ({\n  useUser: jest.fn(() => mockUser),\n  useUserActions: jest.fn(() => ({\n    signOut: mockSignOut\n  }))\n}))\n\n// Mock Next.js navigation\njest.mock('next/navigation', () => ({\n  usePathname: jest.fn(() => '/dashboard')\n}))\n\nconst renderWithRouter = (component: React.ReactElement) => {\n  return render(\n    <BrowserRouter>\n      {component}\n    </BrowserRouter>\n  )\n}\n\ndescribe('GlobalNavigation', () => {\n  beforeEach(() => {\n    jest.clearAllMocks()\n  })\n\n  describe('Rendering', () => {\n    it('should render navigation items', () => {\n      renderWithRouter(<GlobalNavigation />)\n      \n      expect(screen.getByText('Feed')).toBeInTheDocument()\n      expect(screen.getByText('Polls')).toBeInTheDocument()\n      expect(screen.getByText('Dashboard')).toBeInTheDocument()\n    })\n\n    it('should render user information when authenticated', () => {\n      renderWithRouter(<GlobalNavigation />)\n      \n      expect(screen.getByText('Test User')).toBeInTheDocument()\n    })\n\n    it('should render mobile menu button', () => {\n      renderWithRouter(<GlobalNavigation />)\n      \n      const menuButton = screen.getByRole('button', { name: /menu/i })\n      expect(menuButton).toBeInTheDocument()\n    })\n  })\n\n  describe('Mobile Menu', () => {\n    it('should toggle mobile menu when menu button is clicked', () => {\n      renderWithRouter(<GlobalNavigation />)\n      \n      const menuButton = screen.getByRole('button', { name: /menu/i })\n      fireEvent.click(menuButton)\n      \n      // Check if mobile menu is open (you might need to adjust this based on your component structure)\n      expect(screen.getByRole('navigation')).toBeInTheDocument()\n    })\n\n    it('should close mobile menu when close button is clicked', async () => {\n      renderWithRouter(<GlobalNavigation />)\n      \n      const menuButton = screen.getByRole('button', { name: /menu/i })\n      fireEvent.click(menuButton)\n      \n      // Wait for menu to open, then find and click close button\n      await waitFor(() => {\n        const closeButton = screen.getByRole('button', { name: /close/i })\n        fireEvent.click(closeButton)\n      })\n    })\n  })\n\n  describe('Navigation Links', () => {\n    it('should have correct href attributes for navigation items', () => {\n      renderWithRouter(<GlobalNavigation />)\n      \n      const feedLink = screen.getByRole('link', { name: /feed/i })\n      const pollsLink = screen.getByRole('link', { name: /polls/i })\n      const dashboardLink = screen.getByRole('link', { name: /dashboard/i })\n      \n      expect(feedLink).toHaveAttribute('href', '/feed')\n      expect(pollsLink).toHaveAttribute('href', '/polls')\n      expect(dashboardLink).toHaveAttribute('href', '/dashboard')\n    })\n\n    it('should highlight active navigation item', () => {\n      renderWithRouter(<GlobalNavigation />)\n      \n      // Since we're mocking usePathname to return '/dashboard', the dashboard link should be active\n      const dashboardLink = screen.getByRole('link', { name: /dashboard/i })\n      expect(dashboardLink).toHaveClass('bg-blue-50') // Adjust class name based on your component\n    })\n  })\n\n  describe('User Actions', () => {\n    it('should call signOut when logout button is clicked', async () => {\n      renderWithRouter(<GlobalNavigation />)\n      \n      // Open mobile menu first\n      const menuButton = screen.getByRole('button', { name: /menu/i })\n      fireEvent.click(menuButton)\n      \n      // Find and click logout button\n      await waitFor(() => {\n        const logoutButton = screen.getByRole('button', { name: /logout/i })\n        fireEvent.click(logoutButton)\n      })\n      \n      expect(mockSignOut).toHaveBeenCalledTimes(1)\n    })\n\n    it('should handle logout errors gracefully', async () => {\n      mockSignOut.mockRejectedValueOnce(new Error('Logout failed'))\n      \n      renderWithRouter(<GlobalNavigation />)\n      \n      // Open mobile menu and click logout\n      const menuButton = screen.getByRole('button', { name: /menu/i })\n      fireEvent.click(menuButton)\n      \n      await waitFor(() => {\n        const logoutButton = screen.getByRole('button', { name: /logout/i })\n        fireEvent.click(logoutButton)\n      })\n      \n      expect(mockSignOut).toHaveBeenCalledTimes(1)\n      // The component should handle the error gracefully\n    })\n  })\n\n  describe('Responsive Behavior', () => {\n    it('should show mobile menu button on small screens', () => {\n      // Mock window.innerWidth for mobile\n      Object.defineProperty(window, 'innerWidth', {\n        writable: true,\n        configurable: true,\n        value: 375,\n      })\n      \n      renderWithRouter(<GlobalNavigation />)\n      \n      const menuButton = screen.getByRole('button', { name: /menu/i })\n      expect(menuButton).toBeInTheDocument()\n    })\n\n    it('should hide mobile menu on desktop screens', () => {\n      // Mock window.innerWidth for desktop\n      Object.defineProperty(window, 'innerWidth', {\n        writable: true,\n        configurable: true,\n        value: 1024,\n      })\n      \n      renderWithRouter(<GlobalNavigation />)\n      \n      // Mobile menu should not be visible by default on desktop\n      expect(screen.queryByRole('button', { name: /close/i })).not.toBeInTheDocument()\n    })\n  })\n\n  describe('Accessibility', () => {\n    it('should have proper ARIA labels', () => {\n      renderWithRouter(<GlobalNavigation />)\n      \n      const navigation = screen.getByRole('navigation')\n      expect(navigation).toBeInTheDocument()\n      \n      const menuButton = screen.getByRole('button', { name: /menu/i })\n      expect(menuButton).toHaveAttribute('aria-label', 'Open menu')\n    })\n\n    it('should support keyboard navigation', () => {\n      renderWithRouter(<GlobalNavigation />)\n      \n      const menuButton = screen.getByRole('button', { name: /menu/i })\n      menuButton.focus()\n      \n      // Test keyboard navigation\n      fireEvent.keyDown(menuButton, { key: 'Enter' })\n      // Add more keyboard navigation tests as needed\n    })\n  })\n\n  describe('Error Handling', () => {\n    it('should handle missing user data gracefully', () => {\n      // Mock useUser to return null\n      jest.mocked(require('@/lib/stores').useUser).mockReturnValueOnce(null)\n      \n      renderWithRouter(<GlobalNavigation />)\n      \n      // Component should still render without crashing\n      expect(screen.getByRole('navigation')).toBeInTheDocument()\n    })\n\n    it('should handle authentication errors', () => {\n      // Mock useUser to return an error state\n      jest.mocked(require('@/lib/stores').useUser).mockReturnValueOnce({\n        error: 'Authentication failed'\n      })\n      \n      renderWithRouter(<GlobalNavigation />)\n      \n      // Component should handle error state gracefully\n      expect(screen.getByRole('navigation')).toBeInTheDocument()\n    })\n  })\n});\n\n"],"names":["jest","mock","require","mockSignOut","fn","mockUser","id","name","email","avatar","useUser","useUserActions","signOut","usePathname","renderWithRouter","component","render","BrowserRouter","describe","beforeEach","clearAllMocks","it","GlobalNavigation","expect","screen","getByText","toBeInTheDocument","menuButton","getByRole","fireEvent","click","waitFor","closeButton","feedLink","pollsLink","dashboardLink","toHaveAttribute","toHaveClass","logoutButton","toHaveBeenCalledTimes","mockRejectedValueOnce","Error","Object","defineProperty","window","writable","configurable","value","queryByRole","not","navigation","focus","keyDown","key","mocked","mockReturnValueOnce","error"],"mappings":"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"}