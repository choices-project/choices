2f9dd9c971f3457ee86483101e81273e
/**
 * Centralized flags with case-insensitive lookups and typed keys.
 * Add new flags here; remove when dead.
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    FEATURE_FLAGS: function() {
        return FEATURE_FLAGS;
    },
    FeatureFlagManager: function() {
        return FeatureFlagManager;
    },
    disableFeature: function() {
        return disableFeature;
    },
    enableFeature: function() {
        return enableFeature;
    },
    featureFlagManager: function() {
        return featureFlagManager;
    },
    getAllFeatureFlags: function() {
        return getAllFeatureFlags;
    },
    getFeatureFlag: function() {
        return getFeatureFlag;
    },
    getFeatureFlags: function() {
        return getFeatureFlags;
    },
    isFeatureEnabled: function() {
        return isFeatureEnabled;
    },
    setFeatureFlags: function() {
        return setFeatureFlags;
    },
    toggleFeature: function() {
        return toggleFeature;
    }
});
const _objects = require("../utils/objects");
const FEATURE_FLAGS = {
    // ===== CORE MVP FEATURES (Always Enabled) =====
    WEBAUTHN: true,
    PWA: true,
    ADMIN: true,
    FEEDBACK_WIDGET: true,
    // ===== ADMIN FEATURES (Nice-to-have for MVP) =====
    USER_SUGGESTIONS_MANAGER: false,
    // ===== ENHANCED MVP FEATURES (FULLY IMPLEMENTED) =====
    ENHANCED_PROFILE: true,
    // ENHANCED_AUTH: true,               // REMOVED: SSR-safe utilities are core infrastructure, not optional features
    // ENHANCED_DASHBOARD: true,         // REMOVED: Now the default dashboard (no feature flag needed)
    ENHANCED_POLLS: true,
    ENHANCED_VOTING: true,
    CIVICS_ADDRESS_LOOKUP: true,
    CIVICS_REPRESENTATIVE_DATABASE: true,
    CIVICS_CAMPAIGN_FINANCE: true,
    CIVICS_VOTING_RECORDS: true,
    CANDIDATE_ACCOUNTABILITY: true,
    CANDIDATE_CARDS: true,
    ALTERNATIVE_CANDIDATES: true,
    // ===== FUTURE FEATURES (Development Required) =====
    AUTOMATED_POLLS: false,
    DEMOGRAPHIC_FILTERING: false,
    TRENDING_POLLS: false,
    ADVANCED_PRIVACY: false,
    MEDIA_BIAS_ANALYSIS: false,
    POLL_NARRATIVE_SYSTEM: false,
    SOCIAL_SHARING: true,
    SOCIAL_SHARING_POLLS: false,
    SOCIAL_SHARING_CIVICS: false,
    SOCIAL_SHARING_VISUAL: false,
    SOCIAL_SHARING_OG: false,
    SOCIAL_SIGNUP: false,
    CONTACT_INFORMATION_SYSTEM: false,
    CIVICS_TESTING_STRATEGY: false,
    DEVICE_FLOW_AUTH: false,
    // ===== PERFORMANCE & OPTIMIZATION =====
    PERFORMANCE_OPTIMIZATION: true,
    FEATURE_DB_OPTIMIZATION_SUITE: true,
    ANALYTICS: true,
    // Removed experimental features that aren't actually implemented
    // ===== SYSTEM FEATURES =====
    PUSH_NOTIFICATIONS: true,
    THEMES: true,
    ACCESSIBILITY: true,
    INTERNATIONALIZATION: false
};
// also accept lowercase legacy names found in code: 'pwa', 'advancedPrivacy'
const ALIASES = {
    pwa: "PWA",
    advancedprivacy: "ADVANCED_PRIVACY",
    "advanced-privacy": "ADVANCED_PRIVACY",
    analytics: "ANALYTICS",
    admin: "ADMIN",
    civics: "CIVICS_ADDRESS_LOOKUP",
    "civics-address-lookup": "CIVICS_ADDRESS_LOOKUP"
};
function normalize(key) {
    if (key in FEATURE_FLAGS) return key;
    const alias = ALIASES[key.toLowerCase()];
    return alias || null;
}
// Subscriptions for flag changes
const subscribers = new Set();
function notifySubscribers() {
    const snapshot = (0, _objects.withOptional)({}, mutableFlags);
    subscribers.forEach((cb)=>{
        try {
            cb(snapshot);
        } catch  {}
    });
}
function isFeatureEnabled(key) {
    const normalizedKey = normalize(key);
    if (normalizedKey && normalizedKey in FEATURE_FLAGS) {
        return FEATURE_FLAGS[normalizedKey];
    }
    // Unknown flags default to false but don't crash
    return false;
}
// Create a mutable copy of FEATURE_FLAGS for runtime modifications
const mutableFlags = (0, _objects.withOptional)({}, FEATURE_FLAGS);
// Helper function to categorize flags
function categorizeFlag(flagId) {
    const categories = {
        // Core MVP features
        core: [
            "CORE_AUTH",
            "CORE_POLLS",
            "CORE_USERS",
            "WEBAUTHN",
            "PWA",
            "ADMIN",
            "FEEDBACK_WIDGET"
        ],
        // Enhanced MVP features ready for implementation
        enhanced: [
            "ENHANCED_PROFILE",
            "ENHANCED_POLLS",
            "ENHANCED_VOTING"
        ],
        // Future features requiring development
        future: [
            "AUTOMATED_POLLS",
            "ADVANCED_PRIVACY",
            "CIVICS_ADDRESS_LOOKUP",
            "SOCIAL_SHARING",
            "SOCIAL_SHARING_POLLS",
            "SOCIAL_SHARING_CIVICS",
            "SOCIAL_SHARING_VISUAL",
            "SOCIAL_SHARING_OG",
            "SOCIAL_SIGNUP"
        ],
        // Performance and optimization
        performance: [
            "PERFORMANCE_OPTIMIZATION",
            "FEATURE_DB_OPTIMIZATION_SUITE",
            "ANALYTICS"
        ],
        // Experimental features removed - not actually implemented
        // System features
        system: [
            "NOTIFICATIONS",
            "THEMES",
            "ACCESSIBILITY",
            "INTERNATIONALIZATION"
        ]
    };
    for (const [category, flags] of Object.entries(categories)){
        if (flags.includes(flagId)) {
            return category;
        }
    }
    return "general";
}
const featureFlagManager = {
    enable: (k)=>{
        const key = normalize(String(k));
        if (key && key in mutableFlags) {
            mutableFlags[key] = true;
            notifySubscribers();
            return true;
        }
        return false;
    },
    disable: (k)=>{
        const key = normalize(String(k));
        if (key && key in mutableFlags) {
            mutableFlags[key] = false;
            notifySubscribers();
            return true;
        }
        return false;
    },
    toggle: (k)=>{
        const key = normalize(String(k));
        if (key && key in mutableFlags) {
            mutableFlags[key] = !mutableFlags[key];
            notifySubscribers();
            return true;
        }
        return false;
    },
    get: (key)=>{
        const normalizedKey = normalize(String(key));
        if (normalizedKey && normalizedKey in mutableFlags) {
            return mutableFlags[normalizedKey] || false;
        }
        return false;
    },
    all: ()=>(0, _objects.withOptional)({}, mutableFlags),
    // Additional methods expected by useFeatureFlags hook
    getAllFlags: ()=>{
        const flags = Object.entries(mutableFlags).map(([key, enabled])=>({
                id: key,
                name: key.replace(/_/g, " ").toLowerCase().replace(/\b\w/g, (l)=>l.toUpperCase()),
                enabled,
                description: `Feature flag for ${key.toLowerCase().replace(/_/g, " ")}`,
                key: key,
                category: categorizeFlag(key)
            }));
        return new Map(flags.map((flag)=>[
                flag.id,
                flag
            ]));
    },
    isEnabled: (key)=>{
        const normalizedKey = normalize(String(key));
        if (normalizedKey && normalizedKey in mutableFlags) {
            return mutableFlags[normalizedKey] || false;
        }
        return false;
    },
    getFlag: (flagId)=>{
        const normalizedKey = normalize(flagId);
        if (normalizedKey && normalizedKey in mutableFlags) {
            const enabled = mutableFlags[normalizedKey] || false;
            return {
                id: flagId,
                name: flagId.replace(/_/g, " ").toLowerCase().replace(/\b\w/g, (l)=>l.toUpperCase()),
                enabled,
                description: `Feature flag for ${flagId.toLowerCase().replace(/_/g, " ")}`,
                key: normalizedKey,
                category: categorizeFlag(flagId)
            };
        }
        return null;
    },
    getEnabledFlags: ()=>Object.entries(mutableFlags).filter(([_, enabled])=>enabled).map(([key, enabled])=>({
                id: key,
                name: key.replace(/_/g, " ").toLowerCase().replace(/\b\w/g, (l)=>l.toUpperCase()),
                enabled,
                description: `Feature flag for ${key.toLowerCase().replace(/_/g, " ")}`,
                key: key,
                category: categorizeFlag(key)
            })),
    getDisabledFlags: ()=>Object.entries(mutableFlags).filter(([_, enabled])=>!enabled).map(([key, enabled])=>({
                id: key,
                name: key.replace(/_/g, " ").toLowerCase().replace(/\b\w/g, (l)=>l.toUpperCase()),
                enabled,
                description: `Feature flag for ${key.toLowerCase().replace(/_/g, " ")}`,
                key: key,
                category: categorizeFlag(key)
            })),
    getFlagsByCategory: (category)=>{
        const categories = {
            // Core MVP features (always enabled)
            core: [
                "WEBAUTHN",
                "PWA",
                "ADMIN",
                "FEEDBACK_WIDGET"
            ],
            // Enhanced MVP features ready for implementation
            enhanced: [
                "ENHANCED_PROFILE",
                "ENHANCED_POLLS",
                "ENHANCED_VOTING",
                "CIVICS_ADDRESS_LOOKUP"
            ],
            // Future features requiring development
            future: [
                "AUTOMATED_POLLS",
                "ADVANCED_PRIVACY",
                "SOCIAL_SHARING",
                "SOCIAL_SHARING_POLLS",
                "SOCIAL_SHARING_CIVICS",
                "SOCIAL_SHARING_VISUAL",
                "SOCIAL_SHARING_OG",
                "SOCIAL_SIGNUP"
            ],
            // Performance and optimization
            performance: [
                "PERFORMANCE_OPTIMIZATION",
                "FEATURE_DB_OPTIMIZATION_SUITE",
                "ANALYTICS"
            ],
            // Experimental features
            experimental: [
                "EXPERIMENTAL_UI",
                "EXPERIMENTAL_ANALYTICS",
                "EXPERIMENTAL_COMPONENTS"
            ],
            // System features
            system: [
                "NOTIFICATIONS",
                "THEMES",
                "ACCESSIBILITY",
                "INTERNATIONALIZATION"
            ]
        };
        const flagIds = categories[category] || [];
        return flagIds.map((flagId)=>({
                id: flagId,
                name: flagId.replace(/_/g, " ").toLowerCase().replace(/\b\w/g, (l)=>l.toUpperCase()),
                enabled: mutableFlags[flagId] || false,
                description: `Feature flag for ${flagId.toLowerCase().replace(/_/g, " ")}`,
                key: flagId,
                category
            }));
    },
    getSystemInfo: ()=>({
            totalFlags: Object.keys(mutableFlags).length,
            enabledFlags: Object.values(mutableFlags).filter(Boolean).length,
            disabledFlags: Object.values(mutableFlags).filter((f)=>!f).length,
            environment: process.env.NODE_ENV || "development",
            categories: {
                core: 4,
                enhanced: 5,
                future: 8,
                performance: 3,
                // experimental: 0, // Removed - not actually implemented
                system: 4 // NOTIFICATIONS, THEMES, ACCESSIBILITY, INTERNATIONALIZATION
            }
        }),
    areDependenciesEnabled: (flagId)=>{
        // Enhanced dependency check for all features
        const dependencies = {
            // Enhanced feature dependencies (simplified - no core dependencies needed)
            "ENHANCED_PROFILE": [],
            "ENHANCED_DASHBOARD": [],
            "ENHANCED_POLLS": [],
            "ENHANCED_VOTING": [],
            "CIVICS_ADDRESS_LOOKUP": [],
            // Future feature dependencies
            "AUTOMATED_POLLS": [
                "ADMIN"
            ],
            "SOCIAL_SHARING": [],
            "SOCIAL_SHARING_POLLS": [
                "SOCIAL_SHARING"
            ],
            "SOCIAL_SHARING_CIVICS": [
                "SOCIAL_SHARING",
                "CIVICS_ADDRESS_LOOKUP"
            ],
            "SOCIAL_SHARING_VISUAL": [
                "SOCIAL_SHARING"
            ],
            "SOCIAL_SHARING_OG": [
                "SOCIAL_SHARING"
            ],
            "SOCIAL_SIGNUP": [],
            // Performance dependencies
            "PERFORMANCE_OPTIMIZATION": [],
            "ANALYTICS": [],
            // System feature dependencies
            "NOTIFICATIONS": [
                "PWA"
            ],
            "THEMES": [],
            "ACCESSIBILITY": [],
            "INTERNATIONALIZATION": []
        };
        const deps = dependencies[flagId] || [];
        return deps.every((dep)=>{
            const normalizedKey = normalize(dep);
            return normalizedKey ? mutableFlags[normalizedKey] : false;
        });
    },
    subscribe: (callback)=>{
        // Register and provide unsubscribe
        if (typeof callback === "function") {
            subscribers.add(callback);
            // Immediately push current state to new subscriber
            try {
                callback((0, _objects.withOptional)({}, mutableFlags));
            } catch  {}
        }
        return {
            unsubscribe: ()=>subscribers.delete(callback)
        };
    },
    updateFlagMetadata: (flagId, metadata)=>{
        // For now, just return true - in a real app, this would update flag metadata
        console.log(`Updating metadata for flag ${flagId}:`, metadata);
        return true;
    },
    reset: ()=>{
        // Reset all flags to their default values
        Object.keys(FEATURE_FLAGS).forEach((key)=>{
            const flagKey = key;
            mutableFlags[flagKey] = FEATURE_FLAGS[flagKey];
        });
        notifySubscribers();
    },
    exportConfig: ()=>{
        // Export current flag configuration
        return {
            flags: (0, _objects.withOptional)({}, mutableFlags),
            timestamp: new Date().toISOString(),
            version: "1.0.0"
        };
    },
    importConfig: (config)=>{
        // Import flag configuration
        if (config && config.flags) {
            Object.entries(config.flags).forEach(([key, value])=>{
                const normalizedKey = normalize(key);
                if (normalizedKey && normalizedKey in mutableFlags && typeof value === "boolean") {
                    mutableFlags[normalizedKey] = value;
                }
            });
            notifySubscribers();
        }
    }
};
const enableFeature = featureFlagManager.enable;
const disableFeature = featureFlagManager.disable;
const toggleFeature = featureFlagManager.toggle;
const getFeatureFlag = (k)=>isFeatureEnabled(k);
async function getFeatureFlags() {
    return featureFlagManager.all();
}
async function setFeatureFlags(flags) {
    Object.entries(flags).forEach(([key, value])=>{
        const normalizedKey = normalize(key);
        if (normalizedKey && normalizedKey in mutableFlags && typeof value === "boolean") {
            mutableFlags[normalizedKey] = value;
        }
    });
    notifySubscribers();
}
const getAllFeatureFlags = ()=>featureFlagManager.all();
const FeatureFlagManager = featureFlagManager;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hbGF1Z2hpbmdraXRzdW5lL3NyYy9DaG9pY2VzL3dlYi9saWIvY29yZS9mZWF0dXJlLWZsYWdzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ2VudHJhbGl6ZWQgZmxhZ3Mgd2l0aCBjYXNlLWluc2Vuc2l0aXZlIGxvb2t1cHMgYW5kIHR5cGVkIGtleXMuXG4gKiBBZGQgbmV3IGZsYWdzIGhlcmU7IHJlbW92ZSB3aGVuIGRlYWQuXG4gKi9cblxuaW1wb3J0IHsgd2l0aE9wdGlvbmFsIH0gZnJvbSAnQC9saWIvdXRpbHMvb2JqZWN0cyc7XG5leHBvcnQgY29uc3QgRkVBVFVSRV9GTEFHUyA9IHtcbiAgLy8gPT09PT0gQ09SRSBNVlAgRkVBVFVSRVMgKEFsd2F5cyBFbmFibGVkKSA9PT09PVxuICBXRUJBVVRITjogdHJ1ZSxcbiAgUFdBOiB0cnVlLFxuICBBRE1JTjogdHJ1ZSxcbiAgRkVFREJBQ0tfV0lER0VUOiB0cnVlLCAgICAgICAgLy8gQ1JJVElDQUw6IFVzZXIgZmVlZGJhY2sgY29sbGVjdGlvbiB3aWRnZXRcbiAgXG4gIC8vID09PT09IEFETUlOIEZFQVRVUkVTIChOaWNlLXRvLWhhdmUgZm9yIE1WUCkgPT09PT1cbiAgVVNFUl9TVUdHRVNUSU9OU19NQU5BR0VSOiBmYWxzZSwgLy8gQWRtaW4gY2FuIGFjY2VzcyBmcm9tIGxhcHRvcCBmb3Igbm93XG4gIFxuICAvLyA9PT09PSBFTkhBTkNFRCBNVlAgRkVBVFVSRVMgKEZVTExZIElNUExFTUVOVEVEKSA9PT09PVxuICBFTkhBTkNFRF9QUk9GSUxFOiB0cnVlLCAgICAgICAgICAgIC8vIEFkdmFuY2VkIHByb2ZpbGUgbWFuYWdlbWVudCB3aXRoIHByaXZhY3kgY29udHJvbHNcbiAgLy8gRU5IQU5DRURfQVVUSDogdHJ1ZSwgICAgICAgICAgICAgICAvLyBSRU1PVkVEOiBTU1Itc2FmZSB1dGlsaXRpZXMgYXJlIGNvcmUgaW5mcmFzdHJ1Y3R1cmUsIG5vdCBvcHRpb25hbCBmZWF0dXJlc1xuICAvLyBFTkhBTkNFRF9EQVNIQk9BUkQ6IHRydWUsICAgICAgICAgLy8gUkVNT1ZFRDogTm93IHRoZSBkZWZhdWx0IGRhc2hib2FyZCAobm8gZmVhdHVyZSBmbGFnIG5lZWRlZClcbiAgRU5IQU5DRURfUE9MTFM6IHRydWUsICAgICAgICAgICAgICAvLyBBZHZhbmNlZCBwb2xsIGNyZWF0aW9uIGFuZCBtYW5hZ2VtZW50IHN5c3RlbSAoMTY0IHBvbGxzIGFjdGl2ZSlcbiAgRU5IQU5DRURfVk9USU5HOiB0cnVlLCAgICAgICAgICAgICAvLyBBZHZhbmNlZCB2b3RpbmcgbWV0aG9kcyBhbmQgYW5hbHl0aWNzICgzIHZvdGVzIGFjdGl2ZSlcbiAgQ0lWSUNTX0FERFJFU1NfTE9PS1VQOiB0cnVlLCAgICAgICAvLyBBZGRyZXNzLWJhc2VkIHJlcHJlc2VudGF0aXZlIGxvb2t1cCBzeXN0ZW0gKElNUExFTUVOVEVEKVxuICBDSVZJQ1NfUkVQUkVTRU5UQVRJVkVfREFUQUJBU0U6IHRydWUsIC8vIEZlZGVyYWwsIHN0YXRlLCBhbmQgbG9jYWwgcmVwcmVzZW50YXRpdmUgZGF0YWJhc2UgKElNUExFTUVOVEVEIC0gMSwyNzMgcmVwcmVzZW50YXRpdmVzKVxuICBDSVZJQ1NfQ0FNUEFJR05fRklOQU5DRTogdHJ1ZSwgICAgIC8vIEZFQyBjYW1wYWlnbiBmaW5hbmNlIGRhdGEgaW50ZWdyYXRpb24gKElNUExFTUVOVEVEIC0gOTIgRkVDIHJlY29yZHMpXG4gIENJVklDU19WT1RJTkdfUkVDT1JEUzogdHJ1ZSwgICAgICAgLy8gQ29uZ3Jlc3Npb25hbCB2b3RpbmcgcmVjb3JkcyBhbmQgYW5hbHlzaXMgKElNUExFTUVOVEVEIC0gMiwxODUgdm90aW5nIHJlY29yZHMpXG4gIENBTkRJREFURV9BQ0NPVU5UQUJJTElUWTogdHJ1ZSwgICAgLy8gUHJvbWlzZSB0cmFja2luZyBhbmQgcGVyZm9ybWFuY2UgbWV0cmljcyAoSU1QTEVNRU5URUQpXG4gIENBTkRJREFURV9DQVJEUzogdHJ1ZSwgICAgICAgICAgICAgLy8gQ29tcHJlaGVuc2l2ZSBjYW5kaWRhdGUgaW5mb3JtYXRpb24gY2FyZHMgKDIgY2FuZGlkYXRlcylcbiAgQUxURVJOQVRJVkVfQ0FORElEQVRFUzogdHJ1ZSwgICAgICAvLyBQbGF0Zm9ybSBmb3Igbm9uLWR1b3BvbHkgY2FuZGlkYXRlcyAoSU1QTEVNRU5URUQpXG4gIFxuICAvLyA9PT09PSBGVVRVUkUgRkVBVFVSRVMgKERldmVsb3BtZW50IFJlcXVpcmVkKSA9PT09PVxuICBBVVRPTUFURURfUE9MTFM6IGZhbHNlLCAgICAgICAgICAgIC8vIEFJLXBvd2VyZWQgcG9sbCBnZW5lcmF0aW9uIGZyb20gdHJlbmRpbmcgdG9waWNzXG4gIERFTU9HUkFQSElDX0ZJTFRFUklORzogZmFsc2UsICAgICAgLy8gUGVyc29uYWxpemUgY29udGVudCBiYXNlZCBvbiB1c2VyIGRlbW9ncmFwaGljcyAoTk9UIElNUExFTUVOVEVEKVxuICBUUkVORElOR19QT0xMUzogZmFsc2UsICAgICAgICAgICAgIC8vIElkZW50aWZ5IGFuZCBzdXJmYWNlIHRyZW5kaW5nIHBvbGxzIGFuZCB0b3BpY3MgKE5PVCBJTVBMRU1FTlRFRClcbiAgQURWQU5DRURfUFJJVkFDWTogZmFsc2UsICAgICAgICAgICAvLyBaZXJvLWtub3dsZWRnZSBwcm9vZnMgYW5kIGRpZmZlcmVudGlhbCBwcml2YWN5IChQQVJUSUFMTFkgSU1QTEVNRU5URUQgLSAzMCUpXG4gIE1FRElBX0JJQVNfQU5BTFlTSVM6IGZhbHNlLCAgICAgICAgLy8gTWVkaWEgYmlhcyBkZXRlY3Rpb24gYW5kIGFuYWx5c2lzIChub3QgTVZQIHJlYWR5KVxuICBQT0xMX05BUlJBVElWRV9TWVNURU06IGZhbHNlLCAgICAgIC8vIEFJLXBvd2VyZWQgcG9sbCBuYXJyYXRpdmUgZ2VuZXJhdGlvbiAoUEFSVElBTExZIElNUExFTUVOVEVEIC0gNzAlKVxuICBTT0NJQUxfU0hBUklORzogdHJ1ZSwgICAgICAgICAgICAgIC8vIE1hc3RlciBzd2l0Y2ggZm9yIGFsbCBzb2NpYWwgZmVhdHVyZXMgKElNUExFTUVOVEVEIC0gMTAwJSlcbiAgU09DSUFMX1NIQVJJTkdfUE9MTFM6IGZhbHNlLCAgICAgICAvLyBQb2xsIHNoYXJpbmcgKFR3aXR0ZXIsIEZhY2Vib29rLCBMaW5rZWRJbikgKFBBUlRJQUxMWSBJTVBMRU1FTlRFRCAtIDYwJSlcbiAgU09DSUFMX1NIQVJJTkdfQ0lWSUNTOiBmYWxzZSwgICAgICAvLyBSZXByZXNlbnRhdGl2ZSBzaGFyaW5nIChQQVJUSUFMTFkgSU1QTEVNRU5URUQgLSA2MCUpXG4gIFNPQ0lBTF9TSEFSSU5HX1ZJU1VBTDogZmFsc2UsICAgICAgLy8gVmlzdWFsIGNvbnRlbnQgZ2VuZXJhdGlvbiAoSUcsIFRpa1RvaykgKE5PVCBJTVBMRU1FTlRFRClcbiAgU09DSUFMX1NIQVJJTkdfT0c6IGZhbHNlLCAgICAgICAgICAvLyBEeW5hbWljIE9wZW4gR3JhcGggaW1hZ2UgZ2VuZXJhdGlvbiAoTk9UIElNUExFTUVOVEVEKVxuICBTT0NJQUxfU0lHTlVQOiBmYWxzZSwgICAgICAgICAgICAgIC8vIFNvY2lhbCBPQXV0aCBzaWdudXAgKE5PVCBJTVBMRU1FTlRFRClcbiAgQ09OVEFDVF9JTkZPUk1BVElPTl9TWVNURU06IGZhbHNlLCAvLyBDb250YWN0IGluZm9ybWF0aW9uIHN5c3RlbSAoUEFSVElBTExZIElNUExFTUVOVEVEIC0gNTAlKVxuICBDSVZJQ1NfVEVTVElOR19TVFJBVEVHWTogZmFsc2UsICAgIC8vIENpdmljcyB0ZXN0aW5nIHN0cmF0ZWd5IChOT1QgSU1QTEVNRU5URUQpXG4gIERFVklDRV9GTE9XX0FVVEg6IGZhbHNlLCAgICAgICAgICAgLy8gT0F1dGggMi4wIERldmljZSBBdXRob3JpemF0aW9uIEdyYW50IGZsb3cgKFBBUlRJQUxMWSBJTVBMRU1FTlRFRCAtIDgwJSlcbiAgXG4gIC8vID09PT09IFBFUkZPUk1BTkNFICYgT1BUSU1JWkFUSU9OID09PT09XG4gIFBFUkZPUk1BTkNFX09QVElNSVpBVElPTjogdHJ1ZSwgICAvLyBJbWFnZSBvcHRpbWl6YXRpb24sIHZpcnR1YWwgc2Nyb2xsaW5nLCBsYXp5IGxvYWRpbmcgKGVuYWJsZWQgZm9yIG1vYmlsZSlcbiAgRkVBVFVSRV9EQl9PUFRJTUlaQVRJT05fU1VJVEU6IHRydWUsIC8vIERhdGFiYXNlIG9wdGltaXphdGlvbiBzdWl0ZSAtIGVuYWJsZWQgZm9yIHBlcmZvcm1hbmNlXG4gIEFOQUxZVElDUzogdHJ1ZSwgICAgICAgICAgICAgICAgICAgLy8gQWR2YW5jZWQgYW5hbHl0aWNzIGFuZCB1c2VyIGluc2lnaHRzXG4gIC8vIFJlbW92ZWQgZXhwZXJpbWVudGFsIGZlYXR1cmVzIHRoYXQgYXJlbid0IGFjdHVhbGx5IGltcGxlbWVudGVkXG4gIFxuICAvLyA9PT09PSBTWVNURU0gRkVBVFVSRVMgPT09PT1cbiAgUFVTSF9OT1RJRklDQVRJT05TOiB0cnVlLCAgICAgICAgICAvLyBQdXNoIG5vdGlmaWNhdGlvbnMgYW5kIGFsZXJ0cyAoZW5hYmxlZCBmb3IgbW9iaWxlIFBXQSlcbiAgVEhFTUVTOiB0cnVlLCAgICAgICAgICAgICAgICAgICAgICAvLyBEYXJrIG1vZGUgYW5kIHRoZW1lIGN1c3RvbWl6YXRpb24gKGVuYWJsZWQgZm9yIG1vYmlsZSBVWClcbiAgQUNDRVNTSUJJTElUWTogdHJ1ZSwgICAgICAgICAgICAgICAvLyBBZHZhbmNlZCBhY2Nlc3NpYmlsaXR5IGZlYXR1cmVzIChlbmFibGVkIGZvciBtb2JpbGUgYWNjZXNzaWJpbGl0eSlcbiAgSU5URVJOQVRJT05BTElaQVRJT046IGZhbHNlLCAgICAgICAvLyBNdWx0aS1sYW5ndWFnZSBzdXBwb3J0XG59IGFzIGNvbnN0O1xuXG4vLyBEZWZpbmUgcHJvcGVyIHR5cGVzIGZvciBmZWF0dXJlIGZsYWcgc3lzdGVtXG5leHBvcnQgaW50ZXJmYWNlIEZlYXR1cmVGbGFnIHtcbiAgaWQ6IHN0cmluZztcbiAgbmFtZTogc3RyaW5nO1xuICBlbmFibGVkOiBib29sZWFuO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICBrZXk/OiBGZWF0dXJlRmxhZ0tleTtcbiAgY2F0ZWdvcnk/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmVhdHVyZUZsYWdNZXRhZGF0YSB7XG4gIGRlc2NyaXB0aW9uPzogc3RyaW5nO1xuICBjYXRlZ29yeT86IHN0cmluZztcbiAgZGVwZW5kZW5jaWVzPzogc3RyaW5nW107XG4gIGV4cGVyaW1lbnRhbD86IGJvb2xlYW47XG4gIGRlcHJlY2F0ZWQ/OiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZlYXR1cmVGbGFnQ29uZmlnIHtcbiAgW2tleTogc3RyaW5nXTogdW5rbm93bjtcbiAgZmxhZ3M6IFJlY29yZDxzdHJpbmcsIGJvb2xlYW4+O1xuICB0aW1lc3RhbXA6IHN0cmluZztcbiAgdmVyc2lvbjogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZlYXR1cmVGbGFnU3Vic2NyaXB0aW9uIHtcbiAgdW5zdWJzY3JpYmU6ICgpID0+IHZvaWQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmVhdHVyZUZsYWdTeXN0ZW1JbmZvIHtcbiAgdG90YWxGbGFnczogbnVtYmVyO1xuICBlbmFibGVkRmxhZ3M6IG51bWJlcjtcbiAgZGlzYWJsZWRGbGFnczogbnVtYmVyO1xuICBlbnZpcm9ubWVudDogc3RyaW5nO1xuICBjYXRlZ29yaWVzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xufVxuXG50eXBlIF9Lbm93bkZsYWcgPSBrZXlvZiB0eXBlb2YgRkVBVFVSRV9GTEFHUztcblxuLy8gRGVmaW5lIHRoZSBtaXNzaW5nIEZlYXR1cmVGbGFnS2V5IHR5cGVcbmV4cG9ydCB0eXBlIEZlYXR1cmVGbGFnS2V5ID0ga2V5b2YgdHlwZW9mIEZFQVRVUkVfRkxBR1M7XG5cbmV4cG9ydCB0eXBlIEZlYXR1cmVGbGFnTWFuYWdlciA9IHR5cGVvZiBmZWF0dXJlRmxhZ01hbmFnZXI7XG5cbi8vIGFsc28gYWNjZXB0IGxvd2VyY2FzZSBsZWdhY3kgbmFtZXMgZm91bmQgaW4gY29kZTogJ3B3YScsICdhZHZhbmNlZFByaXZhY3knXG5jb25zdCBBTElBU0VTOiBSZWNvcmQ8c3RyaW5nLCBGZWF0dXJlRmxhZ0tleT4gPSB7XG4gIHB3YTogJ1BXQScsXG4gIGFkdmFuY2VkcHJpdmFjeTogJ0FEVkFOQ0VEX1BSSVZBQ1knLFxuICAnYWR2YW5jZWQtcHJpdmFjeSc6ICdBRFZBTkNFRF9QUklWQUNZJyxcbiAgYW5hbHl0aWNzOiAnQU5BTFlUSUNTJyxcbiAgYWRtaW46ICdBRE1JTicsXG4gIGNpdmljczogJ0NJVklDU19BRERSRVNTX0xPT0tVUCcsXG4gICdjaXZpY3MtYWRkcmVzcy1sb29rdXAnOiAnQ0lWSUNTX0FERFJFU1NfTE9PS1VQJyxcbn07XG5cbmZ1bmN0aW9uIG5vcm1hbGl6ZShrZXk6IHN0cmluZyk6IEZlYXR1cmVGbGFnS2V5IHwgbnVsbCB7XG4gIGlmIChrZXkgaW4gRkVBVFVSRV9GTEFHUykgcmV0dXJuIGtleSBhcyBGZWF0dXJlRmxhZ0tleTtcbiAgY29uc3QgYWxpYXMgPSBBTElBU0VTW2tleS50b0xvd2VyQ2FzZSgpXTtcbiAgcmV0dXJuIGFsaWFzIHx8IG51bGw7XG59XG5cbi8vIFN1YnNjcmlwdGlvbnMgZm9yIGZsYWcgY2hhbmdlc1xuY29uc3Qgc3Vic2NyaWJlcnMgPSBuZXcgU2V0PChmbGFnczogUmVjb3JkPHN0cmluZywgYm9vbGVhbj4pID0+IHZvaWQ+KCk7XG5mdW5jdGlvbiBub3RpZnlTdWJzY3JpYmVycygpIHtcbiAgY29uc3Qgc25hcHNob3QgPSB3aXRoT3B0aW9uYWwoe30sIG11dGFibGVGbGFncyk7XG4gIHN1YnNjcmliZXJzLmZvckVhY2goY2IgPT4ge1xuICAgIHRyeSB7IGNiKHNuYXBzaG90KTsgfSBjYXRjaCB7IC8qIG5vb3AgKi8gfVxuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRmVhdHVyZUVuYWJsZWQ8SyBleHRlbmRzIHN0cmluZz4oa2V5OiBLKTogYm9vbGVhbiB7XG4gIGNvbnN0IG5vcm1hbGl6ZWRLZXkgPSBub3JtYWxpemUoa2V5KTtcbiAgaWYgKG5vcm1hbGl6ZWRLZXkgJiYgbm9ybWFsaXplZEtleSBpbiBGRUFUVVJFX0ZMQUdTKSB7XG4gICAgcmV0dXJuIEZFQVRVUkVfRkxBR1Nbbm9ybWFsaXplZEtleV07XG4gIH1cbiAgLy8gVW5rbm93biBmbGFncyBkZWZhdWx0IHRvIGZhbHNlIGJ1dCBkb24ndCBjcmFzaFxuICByZXR1cm4gZmFsc2U7XG59XG5cbi8vIENyZWF0ZSBhIG11dGFibGUgY29weSBvZiBGRUFUVVJFX0ZMQUdTIGZvciBydW50aW1lIG1vZGlmaWNhdGlvbnNcbmNvbnN0IG11dGFibGVGbGFnczogUmVjb3JkPHN0cmluZywgYm9vbGVhbj4gPSB3aXRoT3B0aW9uYWwoe30sIEZFQVRVUkVfRkxBR1MpO1xuXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gY2F0ZWdvcml6ZSBmbGFnc1xuZnVuY3Rpb24gY2F0ZWdvcml6ZUZsYWcoZmxhZ0lkOiBzdHJpbmcpOiBzdHJpbmcge1xuICBjb25zdCBjYXRlZ29yaWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4gPSB7XG4gICAgLy8gQ29yZSBNVlAgZmVhdHVyZXNcbiAgICBjb3JlOiBbJ0NPUkVfQVVUSCcsICdDT1JFX1BPTExTJywgJ0NPUkVfVVNFUlMnLCAnV0VCQVVUSE4nLCAnUFdBJywgJ0FETUlOJywgJ0ZFRURCQUNLX1dJREdFVCddLFxuICAgIFxuICAgIC8vIEVuaGFuY2VkIE1WUCBmZWF0dXJlcyByZWFkeSBmb3IgaW1wbGVtZW50YXRpb25cbiAgICBlbmhhbmNlZDogWydFTkhBTkNFRF9QUk9GSUxFJywgJ0VOSEFOQ0VEX1BPTExTJywgJ0VOSEFOQ0VEX1ZPVElORyddLFxuICAgIFxuICAgIC8vIEZ1dHVyZSBmZWF0dXJlcyByZXF1aXJpbmcgZGV2ZWxvcG1lbnRcbiAgICBmdXR1cmU6IFsnQVVUT01BVEVEX1BPTExTJywgJ0FEVkFOQ0VEX1BSSVZBQ1knLCAnQ0lWSUNTX0FERFJFU1NfTE9PS1VQJywgJ1NPQ0lBTF9TSEFSSU5HJywgJ1NPQ0lBTF9TSEFSSU5HX1BPTExTJywgJ1NPQ0lBTF9TSEFSSU5HX0NJVklDUycsICdTT0NJQUxfU0hBUklOR19WSVNVQUwnLCAnU09DSUFMX1NIQVJJTkdfT0cnLCAnU09DSUFMX1NJR05VUCddLFxuICAgIFxuICAgIC8vIFBlcmZvcm1hbmNlIGFuZCBvcHRpbWl6YXRpb25cbiAgICBwZXJmb3JtYW5jZTogWydQRVJGT1JNQU5DRV9PUFRJTUlaQVRJT04nLCAnRkVBVFVSRV9EQl9PUFRJTUlaQVRJT05fU1VJVEUnLCAnQU5BTFlUSUNTJ10sXG4gICAgXG4gICAgLy8gRXhwZXJpbWVudGFsIGZlYXR1cmVzIHJlbW92ZWQgLSBub3QgYWN0dWFsbHkgaW1wbGVtZW50ZWRcbiAgICBcbiAgICAvLyBTeXN0ZW0gZmVhdHVyZXNcbiAgICBzeXN0ZW06IFsnTk9USUZJQ0FUSU9OUycsICdUSEVNRVMnLCAnQUNDRVNTSUJJTElUWScsICdJTlRFUk5BVElPTkFMSVpBVElPTiddXG4gIH07XG4gIFxuICBmb3IgKGNvbnN0IFtjYXRlZ29yeSwgZmxhZ3NdIG9mIE9iamVjdC5lbnRyaWVzKGNhdGVnb3JpZXMpKSB7XG4gICAgaWYgKGZsYWdzLmluY2x1ZGVzKGZsYWdJZCkpIHtcbiAgICAgIHJldHVybiBjYXRlZ29yeTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuICdnZW5lcmFsJztcbn1cblxuZXhwb3J0IGNvbnN0IGZlYXR1cmVGbGFnTWFuYWdlciA9IHtcbiAgZW5hYmxlOiAoazogc3RyaW5nIHwgRmVhdHVyZUZsYWdLZXkpOiBib29sZWFuID0+IHtcbiAgICBjb25zdCBrZXkgPSBub3JtYWxpemUoU3RyaW5nKGspKTsgXG4gICAgaWYgKGtleSAmJiBrZXkgaW4gbXV0YWJsZUZsYWdzKSB7XG4gICAgICBtdXRhYmxlRmxhZ3Nba2V5XSA9IHRydWU7XG4gICAgICBub3RpZnlTdWJzY3JpYmVycygpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfSxcbiAgZGlzYWJsZTogKGs6IHN0cmluZyB8IEZlYXR1cmVGbGFnS2V5KTogYm9vbGVhbiA9PiB7XG4gICAgY29uc3Qga2V5ID0gbm9ybWFsaXplKFN0cmluZyhrKSk7IFxuICAgIGlmIChrZXkgJiYga2V5IGluIG11dGFibGVGbGFncykge1xuICAgICAgbXV0YWJsZUZsYWdzW2tleV0gPSBmYWxzZTtcbiAgICAgIG5vdGlmeVN1YnNjcmliZXJzKCk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9LFxuICB0b2dnbGU6IChrOiBzdHJpbmcgfCBGZWF0dXJlRmxhZ0tleSk6IGJvb2xlYW4gPT4ge1xuICAgIGNvbnN0IGtleSA9IG5vcm1hbGl6ZShTdHJpbmcoaykpOyBcbiAgICBpZiAoa2V5ICYmIGtleSBpbiBtdXRhYmxlRmxhZ3MpIHtcbiAgICAgIG11dGFibGVGbGFnc1trZXldID0gIW11dGFibGVGbGFnc1trZXldO1xuICAgICAgbm90aWZ5U3Vic2NyaWJlcnMoKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0sXG4gIGdldDogKGtleTogc3RyaW5nIHwgRmVhdHVyZUZsYWdLZXkpOiBib29sZWFuID0+IHtcbiAgICBjb25zdCBub3JtYWxpemVkS2V5ID0gbm9ybWFsaXplKFN0cmluZyhrZXkpKTtcbiAgICBpZiAobm9ybWFsaXplZEtleSAmJiBub3JtYWxpemVkS2V5IGluIG11dGFibGVGbGFncykge1xuICAgICAgcmV0dXJuIG11dGFibGVGbGFnc1tub3JtYWxpemVkS2V5XSB8fCBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9LFxuICBhbGw6ICgpID0+IHdpdGhPcHRpb25hbCh7fSwgbXV0YWJsZUZsYWdzKSxcbiAgXG4gIC8vIEFkZGl0aW9uYWwgbWV0aG9kcyBleHBlY3RlZCBieSB1c2VGZWF0dXJlRmxhZ3MgaG9va1xuICBnZXRBbGxGbGFnczogKCk6IE1hcDxzdHJpbmcsIEZlYXR1cmVGbGFnPiA9PiB7XG4gICAgY29uc3QgZmxhZ3M6IEZlYXR1cmVGbGFnW10gPSBPYmplY3QuZW50cmllcyhtdXRhYmxlRmxhZ3MpLm1hcCgoW2tleSwgZW5hYmxlZF0pID0+ICh7XG4gICAgICBpZDoga2V5LFxuICAgICAgbmFtZToga2V5LnJlcGxhY2UoL18vZywgJyAnKS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xcYlxcdy9nLCBsID0+IGwudG9VcHBlckNhc2UoKSksXG4gICAgICBlbmFibGVkLFxuICAgICAgZGVzY3JpcHRpb246IGBGZWF0dXJlIGZsYWcgZm9yICR7a2V5LnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXy9nLCAnICcpfWAsXG4gICAgICBrZXk6IGtleSBhcyBGZWF0dXJlRmxhZ0tleSxcbiAgICAgIGNhdGVnb3J5OiBjYXRlZ29yaXplRmxhZyhrZXkpXG4gICAgfSkpO1xuICAgIHJldHVybiBuZXcgTWFwKGZsYWdzLm1hcChmbGFnID0+IFtmbGFnLmlkLCBmbGFnXSkpO1xuICB9LFxuICBpc0VuYWJsZWQ6IChrZXk6IHN0cmluZyB8IEZlYXR1cmVGbGFnS2V5KTogYm9vbGVhbiA9PiB7XG4gICAgY29uc3Qgbm9ybWFsaXplZEtleSA9IG5vcm1hbGl6ZShTdHJpbmcoa2V5KSk7XG4gICAgaWYgKG5vcm1hbGl6ZWRLZXkgJiYgbm9ybWFsaXplZEtleSBpbiBtdXRhYmxlRmxhZ3MpIHtcbiAgICAgIHJldHVybiBtdXRhYmxlRmxhZ3Nbbm9ybWFsaXplZEtleV0gfHwgZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfSxcbiAgZ2V0RmxhZzogKGZsYWdJZDogc3RyaW5nKTogRmVhdHVyZUZsYWcgfCBudWxsID0+IHtcbiAgICBjb25zdCBub3JtYWxpemVkS2V5ID0gbm9ybWFsaXplKGZsYWdJZCk7XG4gICAgaWYgKG5vcm1hbGl6ZWRLZXkgJiYgbm9ybWFsaXplZEtleSBpbiBtdXRhYmxlRmxhZ3MpIHtcbiAgICAgIGNvbnN0IGVuYWJsZWQgPSBtdXRhYmxlRmxhZ3Nbbm9ybWFsaXplZEtleV0gfHwgZmFsc2U7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBpZDogZmxhZ0lkLFxuICAgICAgICBuYW1lOiBmbGFnSWQucmVwbGFjZSgvXy9nLCAnICcpLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXFxiXFx3L2csIGwgPT4gbC50b1VwcGVyQ2FzZSgpKSxcbiAgICAgICAgZW5hYmxlZCxcbiAgICAgICAgZGVzY3JpcHRpb246IGBGZWF0dXJlIGZsYWcgZm9yICR7ZmxhZ0lkLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXy9nLCAnICcpfWAsXG4gICAgICAgIGtleTogbm9ybWFsaXplZEtleSxcbiAgICAgICAgY2F0ZWdvcnk6IGNhdGVnb3JpemVGbGFnKGZsYWdJZClcbiAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9LFxuICBnZXRFbmFibGVkRmxhZ3M6ICgpOiBGZWF0dXJlRmxhZ1tdID0+IE9iamVjdC5lbnRyaWVzKG11dGFibGVGbGFncylcbiAgICAuZmlsdGVyKChbXywgZW5hYmxlZF0pID0+IGVuYWJsZWQpXG4gICAgLm1hcCgoW2tleSwgZW5hYmxlZF0pID0+ICh7XG4gICAgICBpZDoga2V5LFxuICAgICAgbmFtZToga2V5LnJlcGxhY2UoL18vZywgJyAnKS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xcYlxcdy9nLCBsID0+IGwudG9VcHBlckNhc2UoKSksXG4gICAgICBlbmFibGVkLFxuICAgICAgZGVzY3JpcHRpb246IGBGZWF0dXJlIGZsYWcgZm9yICR7a2V5LnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXy9nLCAnICcpfWAsXG4gICAgICBrZXk6IGtleSBhcyBGZWF0dXJlRmxhZ0tleSxcbiAgICAgIGNhdGVnb3J5OiBjYXRlZ29yaXplRmxhZyhrZXkpXG4gICAgfSkpLFxuICBnZXREaXNhYmxlZEZsYWdzOiAoKTogRmVhdHVyZUZsYWdbXSA9PiBPYmplY3QuZW50cmllcyhtdXRhYmxlRmxhZ3MpXG4gICAgLmZpbHRlcigoW18sIGVuYWJsZWRdKSA9PiAhZW5hYmxlZClcbiAgICAubWFwKChba2V5LCBlbmFibGVkXSkgPT4gKHtcbiAgICAgIGlkOiBrZXksXG4gICAgICBuYW1lOiBrZXkucmVwbGFjZSgvXy9nLCAnICcpLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXFxiXFx3L2csIGwgPT4gbC50b1VwcGVyQ2FzZSgpKSxcbiAgICAgIGVuYWJsZWQsXG4gICAgICBkZXNjcmlwdGlvbjogYEZlYXR1cmUgZmxhZyBmb3IgJHtrZXkudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9fL2csICcgJyl9YCxcbiAgICAgIGtleToga2V5IGFzIEZlYXR1cmVGbGFnS2V5LFxuICAgICAgY2F0ZWdvcnk6IGNhdGVnb3JpemVGbGFnKGtleSlcbiAgICB9KSksXG4gIGdldEZsYWdzQnlDYXRlZ29yeTogKGNhdGVnb3J5OiBzdHJpbmcpOiBGZWF0dXJlRmxhZ1tdID0+IHtcbiAgICBjb25zdCBjYXRlZ29yaWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4gPSB7XG4gICAgICAvLyBDb3JlIE1WUCBmZWF0dXJlcyAoYWx3YXlzIGVuYWJsZWQpXG4gICAgICBjb3JlOiBbJ1dFQkFVVEhOJywgJ1BXQScsICdBRE1JTicsICdGRUVEQkFDS19XSURHRVQnXSxcbiAgICAgIFxuICAgICAgLy8gRW5oYW5jZWQgTVZQIGZlYXR1cmVzIHJlYWR5IGZvciBpbXBsZW1lbnRhdGlvblxuICAgICAgZW5oYW5jZWQ6IFsnRU5IQU5DRURfUFJPRklMRScsICdFTkhBTkNFRF9QT0xMUycsICdFTkhBTkNFRF9WT1RJTkcnLCAnQ0lWSUNTX0FERFJFU1NfTE9PS1VQJ10sXG4gICAgICBcbiAgICAgIC8vIEZ1dHVyZSBmZWF0dXJlcyByZXF1aXJpbmcgZGV2ZWxvcG1lbnRcbiAgICAgIGZ1dHVyZTogWydBVVRPTUFURURfUE9MTFMnLCAnQURWQU5DRURfUFJJVkFDWScsICdTT0NJQUxfU0hBUklORycsICdTT0NJQUxfU0hBUklOR19QT0xMUycsICdTT0NJQUxfU0hBUklOR19DSVZJQ1MnLCAnU09DSUFMX1NIQVJJTkdfVklTVUFMJywgJ1NPQ0lBTF9TSEFSSU5HX09HJywgJ1NPQ0lBTF9TSUdOVVAnXSxcbiAgICAgIFxuICAgICAgLy8gUGVyZm9ybWFuY2UgYW5kIG9wdGltaXphdGlvblxuICAgICAgcGVyZm9ybWFuY2U6IFsnUEVSRk9STUFOQ0VfT1BUSU1JWkFUSU9OJywgJ0ZFQVRVUkVfREJfT1BUSU1JWkFUSU9OX1NVSVRFJywgJ0FOQUxZVElDUyddLFxuICAgICAgXG4gICAgICAvLyBFeHBlcmltZW50YWwgZmVhdHVyZXNcbiAgICAgIGV4cGVyaW1lbnRhbDogWydFWFBFUklNRU5UQUxfVUknLCAnRVhQRVJJTUVOVEFMX0FOQUxZVElDUycsICdFWFBFUklNRU5UQUxfQ09NUE9ORU5UUyddLFxuICAgICAgXG4gICAgICAvLyBTeXN0ZW0gZmVhdHVyZXNcbiAgICAgIHN5c3RlbTogWydOT1RJRklDQVRJT05TJywgJ1RIRU1FUycsICdBQ0NFU1NJQklMSVRZJywgJ0lOVEVSTkFUSU9OQUxJWkFUSU9OJ11cbiAgICB9O1xuICAgIGNvbnN0IGZsYWdJZHMgPSBjYXRlZ29yaWVzW2NhdGVnb3J5XSB8fCBbXTtcbiAgICByZXR1cm4gZmxhZ0lkcy5tYXAoZmxhZ0lkID0+ICh7XG4gICAgICBpZDogZmxhZ0lkLFxuICAgICAgbmFtZTogZmxhZ0lkLnJlcGxhY2UoL18vZywgJyAnKS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xcYlxcdy9nLCBsID0+IGwudG9VcHBlckNhc2UoKSksXG4gICAgICBlbmFibGVkOiBtdXRhYmxlRmxhZ3NbZmxhZ0lkIGFzIEZlYXR1cmVGbGFnS2V5XSB8fCBmYWxzZSxcbiAgICAgIGRlc2NyaXB0aW9uOiBgRmVhdHVyZSBmbGFnIGZvciAke2ZsYWdJZC50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL18vZywgJyAnKX1gLFxuICAgICAga2V5OiBmbGFnSWQgYXMgRmVhdHVyZUZsYWdLZXksXG4gICAgICBjYXRlZ29yeVxuICAgIH0pKTtcbiAgfSxcbiAgZ2V0U3lzdGVtSW5mbzogKCk6IEZlYXR1cmVGbGFnU3lzdGVtSW5mbyA9PiAoe1xuICAgIHRvdGFsRmxhZ3M6IE9iamVjdC5rZXlzKG11dGFibGVGbGFncykubGVuZ3RoLFxuICAgIGVuYWJsZWRGbGFnczogT2JqZWN0LnZhbHVlcyhtdXRhYmxlRmxhZ3MpLmZpbHRlcihCb29sZWFuKS5sZW5ndGgsXG4gICAgZGlzYWJsZWRGbGFnczogT2JqZWN0LnZhbHVlcyhtdXRhYmxlRmxhZ3MpLmZpbHRlcihmID0+ICFmKS5sZW5ndGgsXG4gICAgZW52aXJvbm1lbnQ6IHByb2Nlc3MuZW52Lk5PREVfRU5WIHx8ICdkZXZlbG9wbWVudCcsXG4gICAgY2F0ZWdvcmllczoge1xuICAgICAgY29yZTogNCwgICAgICAgIC8vIFdFQkFVVEhOLCBQV0EsIEFETUlOLCBGRUVEQkFDS19XSURHRVRcbiAgICAgIGVuaGFuY2VkOiA1LCAgICAvLyBFTkhBTkNFRF9QUk9GSUxFLCBFTkhBTkNFRF9QT0xMUywgRU5IQU5DRURfVk9USU5HLCBDSVZJQ1NfQUREUkVTU19MT09LVVAsIENJVklDU19SRVBSRVNFTlRBVElWRV9EQVRBQkFTRVxuICAgICAgZnV0dXJlOiA4LCAgICAgIC8vIEFVVE9NQVRFRF9QT0xMUywgQURWQU5DRURfUFJJVkFDWSwgU09DSUFMX1NIQVJJTkcgKyA1IHN1Yi1mZWF0dXJlc1xuICAgICAgcGVyZm9ybWFuY2U6IDMsIC8vIFBFUkZPUk1BTkNFX09QVElNSVpBVElPTiwgRkVBVFVSRV9EQl9PUFRJTUlaQVRJT05fU1VJVEUsIEFOQUxZVElDU1xuICAgICAgLy8gZXhwZXJpbWVudGFsOiAwLCAvLyBSZW1vdmVkIC0gbm90IGFjdHVhbGx5IGltcGxlbWVudGVkXG4gICAgICBzeXN0ZW06IDQgICAgICAgLy8gTk9USUZJQ0FUSU9OUywgVEhFTUVTLCBBQ0NFU1NJQklMSVRZLCBJTlRFUk5BVElPTkFMSVpBVElPTlxuICAgIH1cbiAgfSksXG4gIGFyZURlcGVuZGVuY2llc0VuYWJsZWQ6IChmbGFnSWQ6IHN0cmluZyk6IGJvb2xlYW4gPT4ge1xuICAgIC8vIEVuaGFuY2VkIGRlcGVuZGVuY3kgY2hlY2sgZm9yIGFsbCBmZWF0dXJlc1xuICAgIGNvbnN0IGRlcGVuZGVuY2llczogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+ID0ge1xuICAgICAgLy8gRW5oYW5jZWQgZmVhdHVyZSBkZXBlbmRlbmNpZXMgKHNpbXBsaWZpZWQgLSBubyBjb3JlIGRlcGVuZGVuY2llcyBuZWVkZWQpXG4gICAgICAnRU5IQU5DRURfUFJPRklMRSc6IFtdLFxuICAgICAgJ0VOSEFOQ0VEX0RBU0hCT0FSRCc6IFtdLFxuICAgICAgJ0VOSEFOQ0VEX1BPTExTJzogW10sXG4gICAgICAnRU5IQU5DRURfVk9USU5HJzogW10sXG4gICAgICAnQ0lWSUNTX0FERFJFU1NfTE9PS1VQJzogW10sXG4gICAgICBcbiAgICAgIC8vIEZ1dHVyZSBmZWF0dXJlIGRlcGVuZGVuY2llc1xuICAgICAgJ0FVVE9NQVRFRF9QT0xMUyc6IFsnQURNSU4nXSxcbiAgICAgICdTT0NJQUxfU0hBUklORyc6IFtdLFxuICAgICAgJ1NPQ0lBTF9TSEFSSU5HX1BPTExTJzogWydTT0NJQUxfU0hBUklORyddLFxuICAgICAgJ1NPQ0lBTF9TSEFSSU5HX0NJVklDUyc6IFsnU09DSUFMX1NIQVJJTkcnLCAnQ0lWSUNTX0FERFJFU1NfTE9PS1VQJ10sXG4gICAgICAnU09DSUFMX1NIQVJJTkdfVklTVUFMJzogWydTT0NJQUxfU0hBUklORyddLFxuICAgICAgJ1NPQ0lBTF9TSEFSSU5HX09HJzogWydTT0NJQUxfU0hBUklORyddLFxuICAgICAgJ1NPQ0lBTF9TSUdOVVAnOiBbXSxcbiAgICAgIFxuICAgICAgLy8gUGVyZm9ybWFuY2UgZGVwZW5kZW5jaWVzXG4gICAgICAnUEVSRk9STUFOQ0VfT1BUSU1JWkFUSU9OJzogW10sXG4gICAgICAnQU5BTFlUSUNTJzogW10sXG4gICAgICBcbiAgICAgIC8vIFN5c3RlbSBmZWF0dXJlIGRlcGVuZGVuY2llc1xuICAgICAgJ05PVElGSUNBVElPTlMnOiBbJ1BXQSddLFxuICAgICAgJ1RIRU1FUyc6IFtdLFxuICAgICAgJ0FDQ0VTU0lCSUxJVFknOiBbXSxcbiAgICAgICdJTlRFUk5BVElPTkFMSVpBVElPTic6IFtdXG4gICAgfTtcbiAgICBjb25zdCBkZXBzID0gZGVwZW5kZW5jaWVzW2ZsYWdJZF0gfHwgW107XG4gICAgcmV0dXJuIGRlcHMuZXZlcnkoZGVwID0+IHtcbiAgICAgIGNvbnN0IG5vcm1hbGl6ZWRLZXkgPSBub3JtYWxpemUoZGVwKTtcbiAgICAgIHJldHVybiBub3JtYWxpemVkS2V5ID8gbXV0YWJsZUZsYWdzW25vcm1hbGl6ZWRLZXldIDogZmFsc2U7XG4gICAgfSk7XG4gIH0sXG4gIHN1YnNjcmliZTogKGNhbGxiYWNrOiAoZmxhZ3M6IFJlY29yZDxzdHJpbmcsIGJvb2xlYW4+KSA9PiB2b2lkKTogRmVhdHVyZUZsYWdTdWJzY3JpcHRpb24gPT4ge1xuICAgIC8vIFJlZ2lzdGVyIGFuZCBwcm92aWRlIHVuc3Vic2NyaWJlXG4gICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgc3Vic2NyaWJlcnMuYWRkKGNhbGxiYWNrKTtcbiAgICAgIC8vIEltbWVkaWF0ZWx5IHB1c2ggY3VycmVudCBzdGF0ZSB0byBuZXcgc3Vic2NyaWJlclxuICAgICAgdHJ5IHsgY2FsbGJhY2sod2l0aE9wdGlvbmFsKHt9LCBtdXRhYmxlRmxhZ3MpKTsgfSBjYXRjaCB7IC8qIG5vb3AgKi8gfVxuICAgIH1cbiAgICByZXR1cm4geyB1bnN1YnNjcmliZTogKCkgPT4gc3Vic2NyaWJlcnMuZGVsZXRlKGNhbGxiYWNrKSB9O1xuICB9LFxuICB1cGRhdGVGbGFnTWV0YWRhdGE6IChmbGFnSWQ6IHN0cmluZywgbWV0YWRhdGE6IEZlYXR1cmVGbGFnTWV0YWRhdGEpOiBib29sZWFuID0+IHtcbiAgICAvLyBGb3Igbm93LCBqdXN0IHJldHVybiB0cnVlIC0gaW4gYSByZWFsIGFwcCwgdGhpcyB3b3VsZCB1cGRhdGUgZmxhZyBtZXRhZGF0YVxuICAgIGNvbnNvbGUubG9nKGBVcGRhdGluZyBtZXRhZGF0YSBmb3IgZmxhZyAke2ZsYWdJZH06YCwgbWV0YWRhdGEpO1xuICAgIHJldHVybiB0cnVlO1xuICB9LFxuICByZXNldDogKCk6IHZvaWQgPT4ge1xuICAgIC8vIFJlc2V0IGFsbCBmbGFncyB0byB0aGVpciBkZWZhdWx0IHZhbHVlc1xuICAgIE9iamVjdC5rZXlzKEZFQVRVUkVfRkxBR1MpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgIGNvbnN0IGZsYWdLZXkgPSBrZXkgYXMgRmVhdHVyZUZsYWdLZXk7XG4gICAgICBtdXRhYmxlRmxhZ3NbZmxhZ0tleV0gPSBGRUFUVVJFX0ZMQUdTW2ZsYWdLZXldO1xuICAgIH0pO1xuICAgIG5vdGlmeVN1YnNjcmliZXJzKCk7XG4gIH0sXG4gIGV4cG9ydENvbmZpZzogKCk6IEZlYXR1cmVGbGFnQ29uZmlnID0+IHtcbiAgICAvLyBFeHBvcnQgY3VycmVudCBmbGFnIGNvbmZpZ3VyYXRpb25cbiAgICByZXR1cm4ge1xuICAgICAgZmxhZ3M6IHdpdGhPcHRpb25hbCh7fSwgbXV0YWJsZUZsYWdzKSxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgdmVyc2lvbjogJzEuMC4wJ1xuICAgIH07XG4gIH0sXG4gIGltcG9ydENvbmZpZzogKGNvbmZpZzogRmVhdHVyZUZsYWdDb25maWcpOiB2b2lkID0+IHtcbiAgICAvLyBJbXBvcnQgZmxhZyBjb25maWd1cmF0aW9uXG4gICAgaWYgKGNvbmZpZyAmJiBjb25maWcuZmxhZ3MpIHtcbiAgICAgIE9iamVjdC5lbnRyaWVzKGNvbmZpZy5mbGFncykuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRLZXkgPSBub3JtYWxpemUoa2V5KTtcbiAgICAgICAgaWYgKG5vcm1hbGl6ZWRLZXkgJiYgbm9ybWFsaXplZEtleSBpbiBtdXRhYmxlRmxhZ3MgJiYgdHlwZW9mIHZhbHVlID09PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICBtdXRhYmxlRmxhZ3Nbbm9ybWFsaXplZEtleV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBub3RpZnlTdWJzY3JpYmVycygpO1xuICAgIH1cbiAgfVxufTtcblxuLy8gTmFtZWQgaGVscGVycyBrZXB0IGZvciBjb21wYXRpYmlsaXR5XG5leHBvcnQgY29uc3QgZW5hYmxlRmVhdHVyZSA9IGZlYXR1cmVGbGFnTWFuYWdlci5lbmFibGU7XG5leHBvcnQgY29uc3QgZGlzYWJsZUZlYXR1cmUgPSBmZWF0dXJlRmxhZ01hbmFnZXIuZGlzYWJsZTtcbmV4cG9ydCBjb25zdCB0b2dnbGVGZWF0dXJlID0gZmVhdHVyZUZsYWdNYW5hZ2VyLnRvZ2dsZTtcbmV4cG9ydCBjb25zdCBnZXRGZWF0dXJlRmxhZyA9IChrOiBzdHJpbmcgfCBGZWF0dXJlRmxhZ0tleSkgPT4gaXNGZWF0dXJlRW5hYmxlZChrKTtcblxuLy8gRTJFIEFQSSBmdW5jdGlvbnNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRGZWF0dXJlRmxhZ3MoKTogUHJvbWlzZTxSZWNvcmQ8c3RyaW5nLCBib29sZWFuPj4ge1xuICByZXR1cm4gZmVhdHVyZUZsYWdNYW5hZ2VyLmFsbCgpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2V0RmVhdHVyZUZsYWdzKGZsYWdzOiBSZWNvcmQ8c3RyaW5nLCBib29sZWFuPik6IFByb21pc2U8dm9pZD4ge1xuICBPYmplY3QuZW50cmllcyhmbGFncykuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgY29uc3Qgbm9ybWFsaXplZEtleSA9IG5vcm1hbGl6ZShrZXkpO1xuICAgIGlmIChub3JtYWxpemVkS2V5ICYmIG5vcm1hbGl6ZWRLZXkgaW4gbXV0YWJsZUZsYWdzICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICBtdXRhYmxlRmxhZ3Nbbm9ybWFsaXplZEtleV0gPSB2YWx1ZTtcbiAgICB9XG4gIH0pO1xuICBub3RpZnlTdWJzY3JpYmVycygpO1xufVxuZXhwb3J0IGNvbnN0IGdldEFsbEZlYXR1cmVGbGFncyA9ICgpID0+IGZlYXR1cmVGbGFnTWFuYWdlci5hbGwoKTtcblxuLy8gQWRkaXRpb25hbCBleHBvcnRzIGV4cGVjdGVkIGJ5IHVzZUZlYXR1cmVGbGFncyBob29rXG5leHBvcnQgY29uc3QgRmVhdHVyZUZsYWdNYW5hZ2VyID0gZmVhdHVyZUZsYWdNYW5hZ2VyOyJdLCJuYW1lcyI6WyJGRUFUVVJFX0ZMQUdTIiwiRmVhdHVyZUZsYWdNYW5hZ2VyIiwiZGlzYWJsZUZlYXR1cmUiLCJlbmFibGVGZWF0dXJlIiwiZmVhdHVyZUZsYWdNYW5hZ2VyIiwiZ2V0QWxsRmVhdHVyZUZsYWdzIiwiZ2V0RmVhdHVyZUZsYWciLCJnZXRGZWF0dXJlRmxhZ3MiLCJpc0ZlYXR1cmVFbmFibGVkIiwic2V0RmVhdHVyZUZsYWdzIiwidG9nZ2xlRmVhdHVyZSIsIldFQkFVVEhOIiwiUFdBIiwiQURNSU4iLCJGRUVEQkFDS19XSURHRVQiLCJVU0VSX1NVR0dFU1RJT05TX01BTkFHRVIiLCJFTkhBTkNFRF9QUk9GSUxFIiwiRU5IQU5DRURfUE9MTFMiLCJFTkhBTkNFRF9WT1RJTkciLCJDSVZJQ1NfQUREUkVTU19MT09LVVAiLCJDSVZJQ1NfUkVQUkVTRU5UQVRJVkVfREFUQUJBU0UiLCJDSVZJQ1NfQ0FNUEFJR05fRklOQU5DRSIsIkNJVklDU19WT1RJTkdfUkVDT1JEUyIsIkNBTkRJREFURV9BQ0NPVU5UQUJJTElUWSIsIkNBTkRJREFURV9DQVJEUyIsIkFMVEVSTkFUSVZFX0NBTkRJREFURVMiLCJBVVRPTUFURURfUE9MTFMiLCJERU1PR1JBUEhJQ19GSUxURVJJTkciLCJUUkVORElOR19QT0xMUyIsIkFEVkFOQ0VEX1BSSVZBQ1kiLCJNRURJQV9CSUFTX0FOQUxZU0lTIiwiUE9MTF9OQVJSQVRJVkVfU1lTVEVNIiwiU09DSUFMX1NIQVJJTkciLCJTT0NJQUxfU0hBUklOR19QT0xMUyIsIlNPQ0lBTF9TSEFSSU5HX0NJVklDUyIsIlNPQ0lBTF9TSEFSSU5HX1ZJU1VBTCIsIlNPQ0lBTF9TSEFSSU5HX09HIiwiU09DSUFMX1NJR05VUCIsIkNPTlRBQ1RfSU5GT1JNQVRJT05fU1lTVEVNIiwiQ0lWSUNTX1RFU1RJTkdfU1RSQVRFR1kiLCJERVZJQ0VfRkxPV19BVVRIIiwiUEVSRk9STUFOQ0VfT1BUSU1JWkFUSU9OIiwiRkVBVFVSRV9EQl9PUFRJTUlaQVRJT05fU1VJVEUiLCJBTkFMWVRJQ1MiLCJQVVNIX05PVElGSUNBVElPTlMiLCJUSEVNRVMiLCJBQ0NFU1NJQklMSVRZIiwiSU5URVJOQVRJT05BTElaQVRJT04iLCJBTElBU0VTIiwicHdhIiwiYWR2YW5jZWRwcml2YWN5IiwiYW5hbHl0aWNzIiwiYWRtaW4iLCJjaXZpY3MiLCJub3JtYWxpemUiLCJrZXkiLCJhbGlhcyIsInRvTG93ZXJDYXNlIiwic3Vic2NyaWJlcnMiLCJTZXQiLCJub3RpZnlTdWJzY3JpYmVycyIsInNuYXBzaG90Iiwid2l0aE9wdGlvbmFsIiwibXV0YWJsZUZsYWdzIiwiZm9yRWFjaCIsImNiIiwibm9ybWFsaXplZEtleSIsImNhdGVnb3JpemVGbGFnIiwiZmxhZ0lkIiwiY2F0ZWdvcmllcyIsImNvcmUiLCJlbmhhbmNlZCIsImZ1dHVyZSIsInBlcmZvcm1hbmNlIiwic3lzdGVtIiwiY2F0ZWdvcnkiLCJmbGFncyIsIk9iamVjdCIsImVudHJpZXMiLCJpbmNsdWRlcyIsImVuYWJsZSIsImsiLCJTdHJpbmciLCJkaXNhYmxlIiwidG9nZ2xlIiwiZ2V0IiwiYWxsIiwiZ2V0QWxsRmxhZ3MiLCJtYXAiLCJlbmFibGVkIiwiaWQiLCJuYW1lIiwicmVwbGFjZSIsImwiLCJ0b1VwcGVyQ2FzZSIsImRlc2NyaXB0aW9uIiwiTWFwIiwiZmxhZyIsImlzRW5hYmxlZCIsImdldEZsYWciLCJnZXRFbmFibGVkRmxhZ3MiLCJmaWx0ZXIiLCJfIiwiZ2V0RGlzYWJsZWRGbGFncyIsImdldEZsYWdzQnlDYXRlZ29yeSIsImV4cGVyaW1lbnRhbCIsImZsYWdJZHMiLCJnZXRTeXN0ZW1JbmZvIiwidG90YWxGbGFncyIsImtleXMiLCJsZW5ndGgiLCJlbmFibGVkRmxhZ3MiLCJ2YWx1ZXMiLCJCb29sZWFuIiwiZGlzYWJsZWRGbGFncyIsImYiLCJlbnZpcm9ubWVudCIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsImFyZURlcGVuZGVuY2llc0VuYWJsZWQiLCJkZXBlbmRlbmNpZXMiLCJkZXBzIiwiZXZlcnkiLCJkZXAiLCJzdWJzY3JpYmUiLCJjYWxsYmFjayIsImFkZCIsInVuc3Vic2NyaWJlIiwiZGVsZXRlIiwidXBkYXRlRmxhZ01ldGFkYXRhIiwibWV0YWRhdGEiLCJjb25zb2xlIiwibG9nIiwicmVzZXQiLCJmbGFnS2V5IiwiZXhwb3J0Q29uZmlnIiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwidmVyc2lvbiIsImltcG9ydENvbmZpZyIsImNvbmZpZyIsInZhbHVlIl0sIm1hcHBpbmdzIjoiQUFBQTs7O0NBR0M7Ozs7Ozs7Ozs7O0lBR1lBLGFBQWE7ZUFBYkE7O0lBa1pBQyxrQkFBa0I7ZUFBbEJBOztJQXJCQUMsY0FBYztlQUFkQTs7SUFEQUMsYUFBYTtlQUFiQTs7SUF2TkFDLGtCQUFrQjtlQUFsQkE7O0lBME9BQyxrQkFBa0I7ZUFBbEJBOztJQWhCQUMsY0FBYztlQUFkQTs7SUFHU0MsZUFBZTtlQUFmQTs7SUF0UU5DLGdCQUFnQjtlQUFoQkE7O0lBMFFNQyxlQUFlO2VBQWZBOztJQVJUQyxhQUFhO2VBQWJBOzs7eUJBL1hnQjtBQUN0QixNQUFNVixnQkFBZ0I7SUFDM0IsaURBQWlEO0lBQ2pEVyxVQUFVO0lBQ1ZDLEtBQUs7SUFDTEMsT0FBTztJQUNQQyxpQkFBaUI7SUFFakIsb0RBQW9EO0lBQ3BEQywwQkFBMEI7SUFFMUIsd0RBQXdEO0lBQ3hEQyxrQkFBa0I7SUFDbEIsbUhBQW1IO0lBQ25ILG1HQUFtRztJQUNuR0MsZ0JBQWdCO0lBQ2hCQyxpQkFBaUI7SUFDakJDLHVCQUF1QjtJQUN2QkMsZ0NBQWdDO0lBQ2hDQyx5QkFBeUI7SUFDekJDLHVCQUF1QjtJQUN2QkMsMEJBQTBCO0lB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