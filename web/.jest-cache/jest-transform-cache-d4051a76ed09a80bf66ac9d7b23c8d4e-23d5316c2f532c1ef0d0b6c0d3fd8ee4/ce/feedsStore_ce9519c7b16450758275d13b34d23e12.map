{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/lib/stores/feedsStore.ts"],"sourcesContent":["/**\n * Feeds Store - Zustand Implementation\n * \n * Comprehensive content feed state management including feed data,\n * filtering, search, user preferences, and content interactions.\n * Consolidates feed state management and content preferences.\n * \n * Created: October 10, 2025\n * Status: âœ… ACTIVE\n */\n\nimport { create } from 'zustand';\nimport { devtools } from 'zustand/middleware';\nimport { persist } from 'zustand/middleware';\n\nimport { logger } from '@/lib/utils/logger';\nimport { withOptional } from '@/lib/utils/objects';\n\n// Feed data types\ninterface FeedItem {\n  id: string;\n  title: string;\n  content: string;\n  summary: string;\n  author: {\n    id: string;\n    name: string;\n    avatar?: string;\n    verified: boolean;\n  };\n  category: string;\n  tags: string[];\n  type: 'article' | 'video' | 'podcast' | 'poll' | 'event' | 'news';\n  source: {\n    name: string;\n    url: string;\n    logo?: string;\n    verified: boolean;\n  };\n  publishedAt: string;\n  updatedAt: string;\n  readTime: number; // minutes\n  engagement: {\n    likes: number;\n    shares: number;\n    comments: number;\n    views: number;\n  };\n  userInteraction: {\n    liked: boolean;\n    shared: boolean;\n    bookmarked: boolean;\n    read: boolean;\n    readAt?: string;\n  };\n  metadata: {\n    image?: string;\n    videoUrl?: string;\n    audioUrl?: string;\n    externalUrl?: string;\n    location?: string;\n    language: string;\n  };\n}\n\ninterface FeedCategory {\n  id: string;\n  name: string;\n  description: string;\n  color: string;\n  icon: string;\n  count: number;\n  enabled: boolean;\n}\n\ninterface FeedFilters {\n  categories: string[];\n  types: string[];\n  sources: string[];\n  dateRange: {\n    start: string;\n    end: string;\n  };\n  readStatus: 'all' | 'read' | 'unread';\n  engagement: 'all' | 'popular' | 'trending';\n  language: string;\n  tags: string[];\n}\n\ninterface FeedPreferences {\n  defaultView: 'list' | 'grid' | 'magazine';\n  sortBy: 'newest' | 'oldest' | 'popular' | 'trending' | 'relevance';\n  itemsPerPage: number;\n  autoRefresh: boolean;\n  refreshInterval: number; // minutes\n  notifications: {\n    newContent: boolean;\n    trendingContent: boolean;\n    categoryUpdates: boolean;\n    authorUpdates: boolean;\n  };\n  privacy: {\n    showReadHistory: boolean;\n    showBookmarks: boolean;\n    showLikes: boolean;\n    shareActivity: boolean;\n  };\n  content: {\n    showImages: boolean;\n    showVideos: boolean;\n    showAudio: boolean;\n    autoPlay: boolean;\n    quality: 'low' | 'medium' | 'high';\n  };\n}\n\ninterface FeedSearch {\n  query: string;\n  results: FeedItem[];\n  totalResults: number;\n  currentPage: number;\n  totalPages: number;\n  filters: FeedFilters;\n  suggestions: string[];\n  recentSearches: string[];\n}\n\n// Feeds store state interface\ninterface FeedsStore {\n  // Feed data\n  feeds: FeedItem[];\n  filteredFeeds: FeedItem[];\n  categories: FeedCategory[];\n  search: FeedSearch;\n  \n  // UI state\n  currentView: 'list' | 'grid' | 'magazine';\n  selectedFeed: FeedItem | null;\n  selectedCategory: string | null;\n  \n  // Filters and preferences\n  filters: FeedFilters;\n  preferences: FeedPreferences;\n  \n  // Loading states\n  isLoading: boolean;\n  isSearching: boolean;\n  isRefreshing: boolean;\n  isUpdating: boolean;\n  error: string | null;\n  \n  // Actions - Feed management\n  setFeeds: (feeds: FeedItem[]) => void;\n  addFeed: (feed: FeedItem) => void;\n  updateFeed: (id: string, updates: Partial<FeedItem>) => void;\n  removeFeed: (id: string) => void;\n  refreshFeeds: () => Promise<void>;\n  loadMoreFeeds: () => Promise<void>;\n  \n  // Actions - Filtering and search\n  setFilters: (filters: Partial<FeedFilters>) => void;\n  clearFilters: () => void;\n  searchFeeds: (query: string) => Promise<void>;\n  setSearchQuery: (query: string) => void;\n  clearSearch: () => void;\n  \n  // Actions - Feed interactions\n  likeFeed: (id: string) => void;\n  unlikeFeed: (id: string) => void;\n  shareFeed: (id: string) => void;\n  bookmarkFeed: (id: string) => void;\n  unbookmarkFeed: (id: string) => void;\n  markAsRead: (id: string) => void;\n  markAsUnread: (id: string) => void;\n  \n  // Actions - Categories\n  setCategories: (categories: FeedCategory[]) => void;\n  toggleCategory: (categoryId: string) => void;\n  setSelectedCategory: (categoryId: string | null) => void;\n  \n  // Actions - Preferences\n  updatePreferences: (preferences: Partial<FeedPreferences>) => void;\n  resetPreferences: () => void;\n  \n  // Actions - View management\n  setCurrentView: (view: 'list' | 'grid' | 'magazine') => void;\n  setSelectedFeed: (feed: FeedItem | null) => void;\n  \n  // Actions - Data operations\n  loadFeeds: (category?: string) => Promise<void>;\n  loadCategories: () => Promise<void>;\n  saveUserInteraction: (feedId: string, interaction: Partial<FeedItem['userInteraction']>) => Promise<void>;\n  \n  // Actions - Loading states\n  setLoading: (loading: boolean) => void;\n  setSearching: (searching: boolean) => void;\n  setRefreshing: (refreshing: boolean) => void;\n  setUpdating: (updating: boolean) => void;\n  setError: (error: string | null) => void;\n  clearError: () => void;\n}\n\n// Default feed preferences\nconst defaultPreferences: FeedPreferences = {\n  defaultView: 'list',\n  sortBy: 'newest',\n  itemsPerPage: 20,\n  autoRefresh: true,\n  refreshInterval: 15,\n  notifications: {\n    newContent: true,\n    trendingContent: true,\n    categoryUpdates: false,\n    authorUpdates: false,\n  },\n  privacy: {\n    showReadHistory: false,\n    showBookmarks: true,\n    showLikes: true,\n    shareActivity: false,\n  },\n  content: {\n    showImages: true,\n    showVideos: true,\n    showAudio: true,\n    autoPlay: false,\n    quality: 'medium',\n  },\n};\n\n// Default feed filters\nconst defaultFilters: FeedFilters = {\n  categories: [],\n  types: [],\n  sources: [],\n  dateRange: {\n    start: '',\n    end: '',\n  },\n  readStatus: 'all',\n  engagement: 'all',\n  language: 'en',\n  tags: [],\n};\n\n// Create feeds store with middleware\nexport const useFeedsStore = create<FeedsStore>()(\n  devtools(\n    persist(\n      (set, get) => ({\n        // Initial state\n        feeds: [],\n        filteredFeeds: [],\n        categories: [],\n        search: {\n          query: '',\n          results: [],\n          totalResults: 0,\n          currentPage: 1,\n          totalPages: 1,\n          filters: defaultFilters,\n          suggestions: [],\n          recentSearches: [],\n        },\n        currentView: 'list',\n        selectedFeed: null,\n        selectedCategory: null,\n        filters: defaultFilters,\n        preferences: defaultPreferences,\n        isLoading: false,\n        isSearching: false,\n        isRefreshing: false,\n        isUpdating: false,\n        error: null,\n        \n        // Feed management actions\n        setFeeds: (feeds) => set({ feeds, filteredFeeds: feeds }),\n        \n        addFeed: (feed) => set((state) => ({\n          feeds: [feed, ...state.feeds],\n          filteredFeeds: [feed, ...state.filteredFeeds],\n        })),\n        \n        updateFeed: (id, updates) => set((state) => ({\n          feeds: state.feeds.map(feed =>\n            feed.id === id ? withOptional(feed, updates) : feed\n          ),\n          filteredFeeds: state.filteredFeeds.map(feed =>\n            feed.id === id ? withOptional(feed, updates) : feed\n          ),\n        })),\n        \n        removeFeed: (id) => set((state) => ({\n          feeds: state.feeds.filter(feed => feed.id !== id),\n          filteredFeeds: state.filteredFeeds.filter(feed => feed.id !== id),\n        })),\n        \n        refreshFeeds: async () => {\n          const { isRefreshing } = get();\n          if (isRefreshing) return; // Prevent multiple simultaneous calls\n          \n          try {\n            set({ isRefreshing: true, error: null });\n            \n            const response = await fetch('/api/feeds', {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({ category: null }),\n            });\n            \n            if (!response.ok) {\n              throw new Error('Failed to refresh feeds');\n            }\n            \n            const feeds = await response.json();\n            set({ feeds, filteredFeeds: feeds, isRefreshing: false });\n            \n            logger.info('Feeds refreshed successfully');\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            set({ error: errorMessage, isRefreshing: false });\n            logger.error('Failed to refresh feeds:', error instanceof Error ? error : new Error(errorMessage));\n          }\n        },\n        \n        loadMoreFeeds: async () => {\n          const { isLoading } = get();\n          if (isLoading) return; // Prevent multiple simultaneous calls\n          \n          try {\n            set({ isLoading: true, error: null });\n            \n            const response = await fetch('/api/feeds', {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({ category: null }),\n            });\n            \n            if (!response.ok) {\n              throw new Error('Failed to load more feeds');\n            }\n            \n            const newFeeds = await response.json();\n            set((state) => ({\n              feeds: [...state.feeds, ...newFeeds],\n              filteredFeeds: [...state.filteredFeeds, ...newFeeds],\n              isLoading: false\n            }));\n            \n            logger.info('More feeds loaded');\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            set({ error: errorMessage, isLoading: false });\n            logger.error('Failed to load more feeds:', error instanceof Error ? error : new Error(errorMessage));\n          }\n        },\n        \n        // Filtering and search actions\n        setFilters: (filters) => set((state) => {\n          const newFilters = withOptional(state.filters, filters);\n          \n          // Apply filters to feeds\n          const filtered = state.feeds.filter(feed => {\n            if (newFilters.categories.length > 0 && !newFilters.categories.includes(feed.category)) {\n              return false;\n            }\n            if (newFilters.types.length > 0 && !newFilters.types.includes(feed.type)) {\n              return false;\n            }\n            if (newFilters.sources.length > 0 && !newFilters.sources.includes(feed.source.name)) {\n              return false;\n            }\n            if (newFilters.readStatus === 'read' && !feed.userInteraction.read) {\n              return false;\n            }\n            if (newFilters.readStatus === 'unread' && feed.userInteraction.read) {\n              return false;\n            }\n            if (newFilters.tags.length > 0 && !newFilters.tags.some(tag => feed.tags.includes(tag))) {\n              return false;\n            }\n            return true;\n          });\n          \n          return { filters: newFilters, filteredFeeds: filtered };\n        }),\n        \n        clearFilters: () => set((state) => ({\n          filters: defaultFilters,\n          filteredFeeds: state.feeds,\n        })),\n        \n        searchFeeds: async (query) => {\n          const { setSearching, setError } = get();\n          \n          try {\n            setSearching(true);\n            setError(null);\n            \n            const response = await fetch('/api/feeds/search', {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({ query }),\n            });\n            \n            if (!response.ok) {\n              throw new Error('Failed to search feeds');\n            }\n            \n            const results = await response.json();\n            \n            set((state) => ({\n              search: {\n                ...state.search,\n                query,\n                results: results.items,\n                totalResults: results.total,\n                currentPage: 1,\n                totalPages: Math.ceil(results.total / state.preferences.itemsPerPage),\n              },\n            }));\n            \n            logger.info('Feeds searched', {\n              query,\n              results: results.items.length,\n              total: results.total\n            });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to search feeds:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setSearching(false);\n          }\n        },\n        \n        setSearchQuery: (query) => set((state) => ({\n          search: { ...state.search, query }\n        })),\n        \n        clearSearch: () => set((state) => ({\n          search: {\n            ...state.search,\n            query: '',\n            results: [],\n            totalResults: 0,\n            currentPage: 1,\n            totalPages: 1,\n          }\n        })),\n        \n        // Feed interaction actions\n        likeFeed: (id) => set((state) => ({\n          feeds: state.feeds.map(feed =>\n            feed.id === id \n              ? withOptional(feed, { \n                  userInteraction: withOptional(feed.userInteraction, { liked: true }),\n                  engagement: withOptional(feed.engagement, { likes: feed.engagement.likes + 1 })\n                })\n              : feed\n          ),\n          filteredFeeds: state.filteredFeeds.map(feed =>\n            feed.id === id \n              ? withOptional(feed, { \n                  userInteraction: withOptional(feed.userInteraction, { liked: true }),\n                  engagement: { ...feed.engagement, likes: feed.engagement.likes + 1 }\n                })\n              : feed\n          ),\n        })),\n        \n        unlikeFeed: (id) => set((state) => ({\n          feeds: state.feeds.map(feed =>\n            feed.id === id \n              ? withOptional(feed, { \n                  userInteraction: withOptional(feed.userInteraction, { liked: false }),\n                  engagement: withOptional(feed.engagement, { likes: Math.max(0, feed.engagement.likes - 1) })\n                })\n              : feed\n          ),\n          filteredFeeds: state.filteredFeeds.map(feed =>\n            feed.id === id \n              ? withOptional(feed, { \n                  userInteraction: withOptional(feed.userInteraction, { liked: false }),\n                  engagement: withOptional(feed.engagement, { likes: Math.max(0, feed.engagement.likes - 1) })\n                })\n              : feed\n          ),\n        })),\n        \n        shareFeed: (id) => set((state) => ({\n          feeds: state.feeds.map(feed =>\n            feed.id === id \n              ? withOptional(feed, { \n                  userInteraction: withOptional(feed.userInteraction, { shared: true }),\n                  engagement: withOptional(feed.engagement, { shares: feed.engagement.shares + 1 })\n                })\n              : feed\n          ),\n          filteredFeeds: state.filteredFeeds.map(feed =>\n            feed.id === id \n              ? withOptional(feed, { \n                  userInteraction: withOptional(feed.userInteraction, { shared: true }),\n                  engagement: withOptional(feed.engagement, { shares: feed.engagement.shares + 1 })\n                })\n              : feed\n          ),\n        })),\n        \n        bookmarkFeed: (id) => set((state) => ({\n          feeds: state.feeds.map(feed =>\n            feed.id === id \n              ? withOptional(feed, { userInteraction: withOptional(feed.userInteraction, { bookmarked: true }) })\n              : feed\n          ),\n          filteredFeeds: state.filteredFeeds.map(feed =>\n            feed.id === id \n              ? withOptional(feed, { userInteraction: withOptional(feed.userInteraction, { bookmarked: true }) })\n              : feed\n          ),\n        })),\n        \n        unbookmarkFeed: (id) => set((state) => ({\n          feeds: state.feeds.map(feed =>\n            feed.id === id \n              ? withOptional(feed, { userInteraction: withOptional(feed.userInteraction, { bookmarked: false }) })\n              : feed\n          ),\n          filteredFeeds: state.filteredFeeds.map(feed =>\n            feed.id === id \n              ? withOptional(feed, { userInteraction: withOptional(feed.userInteraction, { bookmarked: false }) })\n              : feed\n          ),\n        })),\n        \n        markAsRead: (id) => set((state) => ({\n          feeds: state.feeds.map(feed =>\n            feed.id === id \n              ? withOptional(feed, { \n                  userInteraction: withOptional(feed.userInteraction, { \n                    read: true, \n                    readAt: new Date().toISOString() \n                  })\n                })\n              : feed\n          ),\n          filteredFeeds: state.filteredFeeds.map(feed =>\n            feed.id === id \n              ? withOptional(feed, { \n                  userInteraction: withOptional(feed.userInteraction, { \n                    read: true, \n                    readAt: new Date().toISOString() \n                  })\n                })\n              : feed\n          ),\n        })),\n        \n        markAsUnread: (id) => set((state) => ({\n          feeds: state.feeds.map(feed =>\n            feed.id === id \n              ? withOptional(feed, { \n                  userInteraction: withOptional(feed.userInteraction, { \n                    read: false, \n                    readAt: undefined \n                  })\n                })\n              : feed\n          ),\n          filteredFeeds: state.filteredFeeds.map(feed =>\n            feed.id === id \n              ? withOptional(feed, { \n                  userInteraction: withOptional(feed.userInteraction, { \n                    read: false, \n                    readAt: undefined \n                  })\n                })\n              : feed\n          ),\n        })),\n        \n        // Category actions\n        setCategories: (categories) => set({ categories }),\n        \n        toggleCategory: (categoryId) => set((state) => ({\n          categories: state.categories.map(category =>\n            category.id === categoryId \n              ? withOptional(category, { enabled: !category.enabled })\n              : category\n          )\n        })),\n        \n        setSelectedCategory: (categoryId) => set({ selectedCategory: categoryId }),\n        \n        // Preferences actions\n        updatePreferences: (preferences) => set((state) => ({\n          preferences: withOptional(state.preferences, preferences)\n        })),\n        \n        resetPreferences: () => set({ preferences: defaultPreferences }),\n        \n        // View management actions\n        setCurrentView: (view) => set({ currentView: view }),\n        \n        setSelectedFeed: (feed) => set({ selectedFeed: feed }),\n        \n        // Data operations\n        loadFeeds: async (category) => {\n          try {\n            set({ isLoading: true, error: null });\n            \n            const response = await fetch('/api/feeds', {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({ category }),\n            });\n            \n            if (response && response.ok) {\n              const feeds = await response.json();\n              set({ feeds, filteredFeeds: feeds, isLoading: false });\n              \n              logger.info('Feeds loaded', {\n                category,\n                count: feeds.length\n              });\n            } else {\n              // Fallback to mock data if API is not available\n              const mockFeeds = [\n                {\n                  id: '1',\n                  title: 'Sample Civic Activity',\n                  description: 'A sample civic activity for testing',\n                  category: 'civic',\n                  timestamp: new Date().toISOString(),\n                  source: 'test'\n                }\n              ];\n              set({ feeds: mockFeeds, filteredFeeds: mockFeeds, isLoading: false });\n            }\n          } catch (error) {\n            // Fallback to mock data on error\n            const mockFeeds = [\n              {\n                id: '1',\n                title: 'Sample Civic Activity',\n                description: 'A sample civic activity for testing',\n                category: 'civic',\n                timestamp: new Date().toISOString(),\n                source: 'test'\n              }\n            ];\n            set({ feeds: mockFeeds, filteredFeeds: mockFeeds, isLoading: false });\n            logger.info('Using fallback data due to API error:', error);\n          }\n        },\n        \n        loadCategories: async () => {\n          try {\n            set({ isLoading: true, error: null });\n            \n            const response = await fetch('/api/feeds/categories');\n            \n            if (!response.ok) {\n              throw new Error('Failed to load categories');\n            }\n            \n            const categories = await response.json();\n            set({ categories, isLoading: false });\n            \n            logger.info('Feed categories loaded', {\n              count: categories.length\n            });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            set({ error: errorMessage, isLoading: false });\n            logger.error('Failed to load categories:', error instanceof Error ? error : new Error(errorMessage));\n          }\n        },\n        \n        saveUserInteraction: async (feedId, interaction) => {\n          try {\n            set({ isUpdating: true, error: null });\n            \n            const response = await fetch('/api/feeds/interactions', {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({ feedId, interaction }),\n            });\n            \n            if (!response.ok) {\n              throw new Error('Failed to save user interaction');\n            }\n            \n            set({ isUpdating: false });\n            logger.info('User interaction saved', {\n              feedId,\n              interaction\n            });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            set({ error: errorMessage, isUpdating: false });\n            logger.error('Failed to save user interaction:', error instanceof Error ? error : new Error(errorMessage));\n          }\n        },\n        \n        // Loading state actions\n        setLoading: (loading) => set({ isLoading: loading }),\n        setSearching: (searching) => set({ isSearching: searching }),\n        setRefreshing: (refreshing) => set({ isRefreshing: refreshing }),\n        setUpdating: (updating) => set({ isUpdating: updating }),\n        setError: (error) => set({ error }),\n        clearError: () => set({ error: null }),\n      }),\n      {\n        name: 'feeds-store',\n        partialize: (state) => ({\n          feeds: state.feeds,\n          categories: state.categories,\n          preferences: state.preferences,\n          filters: state.filters,\n          currentView: state.currentView,\n        }),\n      }\n    ),\n    { name: 'feeds-store' }\n  )\n);\n\n// Store selectors for optimized re-renders\nexport const useFeeds = () => useFeedsStore(state => state.feeds);\nexport const useFilteredFeeds = () => useFeedsStore(state => state.filteredFeeds);\nexport const useFeedCategories = () => useFeedsStore(state => state.categories);\nexport const useFeedSearch = () => useFeedsStore(state => state.search);\nexport const useSelectedFeed = () => useFeedsStore(state => state.selectedFeed);\nexport const useFeedPreferences = () => useFeedsStore(state => state.preferences);\nexport const useFeedFilters = () => useFeedsStore(state => state.filters);\nexport const useFeedsLoading = () => useFeedsStore(state => state.isLoading);\nexport const useFeedsError = () => useFeedsStore(state => state.error);\n\n// Action selectors - FIXED: Use individual selectors to prevent infinite re-renders\nexport const useFeedsActions = () => useFeedsStore(state => state);\n\n// Computed selectors\nexport const useFeedsStats = () => useFeedsStore(state => ({\n  totalFeeds: state.feeds.length,\n  filteredFeeds: state.filteredFeeds.length,\n  totalCategories: state.categories.length,\n  enabledCategories: state.categories.filter(cat => cat.enabled).length,\n  searchResults: state.search.results.length,\n  isLoading: state.isLoading,\n  isSearching: state.isSearching,\n  error: state.error,\n}));\n\nexport const useBookmarkedFeeds = () => useFeedsStore(state => \n  state.feeds.filter(feed => feed.userInteraction.bookmarked)\n);\n\nexport const useUnreadFeeds = () => useFeedsStore(state => \n  state.feeds.filter(feed => !feed.userInteraction.read)\n);\n\nexport const useLikedFeeds = () => useFeedsStore(state => \n  state.feeds.filter(feed => feed.userInteraction.liked)\n);\n\n// Store utilities\nexport const feedsStoreUtils = {\n  /**\n   * Get feeds summary\n   */\n  getFeedsSummary: () => {\n    const state = useFeedsStore.getState();\n    return {\n      totalFeeds: state.feeds.length,\n      filteredFeeds: state.filteredFeeds.length,\n      categories: state.categories.length,\n      searchResults: state.search.results.length,\n      preferences: state.preferences,\n    };\n  },\n  \n  /**\n   * Get feeds by category\n   */\n  getFeedsByCategory: (category: string) => {\n    const state = useFeedsStore.getState();\n    return state.feeds.filter(feed => feed.category === category);\n  },\n  \n  /**\n   * Get feeds by type\n   */\n  getFeedsByType: (type: string) => {\n    const state = useFeedsStore.getState();\n    return state.feeds.filter(feed => feed.type === type);\n  },\n  \n  /**\n   * Get trending feeds\n   */\n  getTrendingFeeds: () => {\n    const state = useFeedsStore.getState();\n    return state.feeds\n      .sort((a, b) => (b.engagement.likes + b.engagement.shares) - (a.engagement.likes + a.engagement.shares))\n      .slice(0, 10);\n  },\n  \n  /**\n   * Get recent feeds\n   */\n  getRecentFeeds: (limit: number = 10) => {\n    const state = useFeedsStore.getState();\n    return state.feeds\n      .sort((a, b) => new Date(b.publishedAt).getTime() - new Date(a.publishedAt).getTime())\n      .slice(0, limit);\n  }\n};\n\n// Store subscriptions for external integrations\nexport const feedsStoreSubscriptions = {\n  /**\n   * Subscribe to feeds changes\n   */\n  onFeedsChange: (callback: (feeds: FeedItem[]) => void) => {\n    return useFeedsStore.subscribe(\n      (state) => {\n        callback(state.feeds);\n      }\n    );\n  },\n  \n  /**\n   * Subscribe to search results changes\n   */\n  onSearchResultsChange: (callback: (results: FeedItem[]) => void) => {\n    return useFeedsStore.subscribe(\n      (state) => {\n        callback(state.search.results);\n      }\n    );\n  },\n  \n  /**\n   * Subscribe to preferences changes\n   */\n  onPreferencesChange: (callback: (preferences: FeedPreferences) => void) => {\n    return useFeedsStore.subscribe(\n      (state) => {\n        callback(state.preferences);\n      }\n    );\n  }\n};\n\n// Store debugging utilities\nexport const feedsStoreDebug = {\n  /**\n   * Log current feeds state\n   */\n  logState: () => {\n    const state = useFeedsStore.getState();\n    console.log('Feeds Store State:', {\n      totalFeeds: state.feeds.length,\n      filteredFeeds: state.filteredFeeds.length,\n      categories: state.categories.length,\n      searchResults: state.search.results.length,\n      currentView: state.currentView,\n      selectedCategory: state.selectedCategory,\n      isLoading: state.isLoading,\n      error: state.error\n    });\n  },\n  \n  /**\n   * Log feeds summary\n   */\n  logSummary: () => {\n    const summary = feedsStoreUtils.getFeedsSummary();\n    console.log('Feeds Summary:', summary);\n  },\n  \n  /**\n   * Log feeds by category\n   */\n  logFeedsByCategory: () => {\n    const state = useFeedsStore.getState();\n    const byCategory = state.feeds.reduce((acc, feed) => {\n      acc[feed.category] = (acc[feed.category] || 0) + 1;\n      return acc;\n    }, {} as Record<string, number>);\n    console.log('Feeds by Category:', byCategory);\n  },\n  \n  /**\n   * Reset feeds store\n   */\n  reset: () => {\n    useFeedsStore.getState().clearFilters();\n    useFeedsStore.getState().resetPreferences();\n    console.log('Feeds store reset');\n  }\n};\n"],"names":["feedsStoreDebug","feedsStoreSubscriptions","feedsStoreUtils","useBookmarkedFeeds","useFeedCategories","useFeedFilters","useFeedPreferences","useFeedSearch","useFeeds","useFeedsActions","useFeedsError","useFeedsLoading","useFeedsStats","useFeedsStore","useFilteredFeeds","useLikedFeeds","useSelectedFeed","useUnreadFeeds","defaultPreferences","defaultView","sortBy","itemsPerPage","autoRefresh","refreshInterval","notifications","newContent","trendingContent","categoryUpdates","authorUpdates","privacy","showReadHistory","showBookmarks","showLikes","shareActivity","content","showImages","showVideos","showAudio","autoPlay","quality","defaultFilters","categories","types","sources","dateRange","start","end","readStatus","engagement","language","tags","create","devtools","persist","set","get","feeds","filteredFeeds","search","query","results","totalResults","currentPage","totalPages","filters","suggestions","recentSearches","currentView","selectedFeed","selectedCategory","preferences","isLoading","isSearching","isRefreshing","isUpdating","error","setFeeds","addFeed","feed","state","updateFeed","id","updates","map","withOptional","removeFeed","filter","refreshFeeds","response","fetch","method","headers","body","JSON","stringify","category","ok","Error","json","logger","info","errorMessage","message","loadMoreFeeds","newFeeds","setFilters","newFilters","filtered","length","includes","type","source","name","userInteraction","read","some","tag","clearFilters","searchFeeds","setSearching","setError","items","total","Math","ceil","setSearchQuery","clearSearch","likeFeed","liked","likes","unlikeFeed","max","shareFeed","shared","shares","bookmarkFeed","bookmarked","unbookmarkFeed","markAsRead","readAt","Date","toISOString","markAsUnread","undefined","setCategories","toggleCategory","categoryId","enabled","setSelectedCategory","updatePreferences","resetPreferences","setCurrentView","view","setSelectedFeed","loadFeeds","count","mockFeeds","title","description","timestamp","loadCategories","saveUserInteraction","feedId","interaction","setLoading","loading","searching","setRefreshing","refreshing","setUpdating","updating","clearError","partialize","totalFeeds","totalCategories","enabledCategories","cat","searchResults","getFeedsSummary","getState","getFeedsByCategory","getFeedsByType","getTrendingFeeds","sort","a","b","slice","getRecentFeeds","limit","publishedAt","getTime","onFeedsChange","callback","subscribe","onSearchResultsChange","onPreferencesChange","logState","console","log","logSummary","summary","logFeedsByCategory","byCategory","reduce","acc","reset"],"mappings":"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"}