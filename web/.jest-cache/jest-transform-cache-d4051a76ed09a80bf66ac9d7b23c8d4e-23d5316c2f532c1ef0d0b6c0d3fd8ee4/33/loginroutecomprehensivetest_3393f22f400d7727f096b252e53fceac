659035c69edd0cfaea0f8773fba4e817
/**
 * @jest-environment node
 */ // Mock rate limiting first - before any imports
"use strict";
jest.mock("@/lib/core/security/rate-limit", ()=>({
        rateLimiters: {
            auth: {
                check: jest.fn().mockResolvedValue({
                    allowed: true,
                    success: true,
                    remaining: 10,
                    resetTime: new Date(),
                    retryAfter: null
                })
            }
        }
    }));
// Mock Supabase client
jest.mock("@/utils/supabase/server", ()=>({
        getSupabaseServerClient: jest.fn()
    }));
// Mock Next.js headers
jest.mock("next/headers", ()=>({
        cookies: ()=>({
                get: jest.fn(),
                set: jest.fn()
            })
    }));
// Mock logger to capture error messages
jest.mock("@/lib/utils/logger", ()=>({
        logger: {
            info: jest.fn(),
            error: jest.fn(),
            warn: jest.fn()
        }
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _server = require("next/server");
const _route = require("../../../../../app/api/auth/login/route");
const _server1 = require("../../../../../utils/supabase/server");
// CSRF protection is handled by Next.js middleware, no mocking needed
describe("Auth Login Route - Comprehensive Testing", ()=>{
    let mockSupabaseClient;
    let mockRequest;
    beforeEach(()=>{
        // Set required environment variables
        process.env.NEXT_PUBLIC_SUPABASE_URL = "https://test.supabase.co";
        process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY = "test-anon-key";
        process.env.SUPABASE_SECRET_KEY = "test-secret-key";
    });
    beforeEach(()=>{
        jest.clearAllMocks();
        // Mock Supabase client
        mockSupabaseClient = {
            auth: {
                signInWithPassword: jest.fn(),
                getUser: jest.fn()
            },
            from: jest.fn(()=>({
                    select: jest.fn(()=>({
                            eq: jest.fn(()=>({
                                    single: jest.fn()
                                }))
                        }))
                }))
        };
        _server1.getSupabaseServerClient.mockResolvedValue(mockSupabaseClient);
    });
    describe("Successful Authentication", ()=>{
        it("should authenticate user with valid credentials", async ()=>{
            // Mock successful authentication
            mockSupabaseClient.auth.signInWithPassword.mockResolvedValue({
                data: {
                    user: {
                        id: "user-123",
                        email: "test@example.com",
                        email_confirmed_at: new Date().toISOString()
                    },
                    session: {
                        access_token: "access-token",
                        refresh_token: "refresh-token"
                    }
                },
                error: null
            });
            // Mock user profile lookup
            mockSupabaseClient.from().select().eq().single.mockResolvedValue({
                data: {
                    id: "user-123",
                    email: "test@example.com",
                    display_name: "Test User",
                    is_active: true
                },
                error: null
            });
            // Create request with valid credentials and headers needed for rate limiting
            mockRequest = new _server.NextRequest("http://localhost:3000/api/auth/login", {
                method: "POST",
                body: JSON.stringify({
                    email: "test@example.com",
                    password: "password123"
                }),
                headers: {
                    "Content-Type": "application/json",
                    "x-forwarded-for": "127.0.0.1",
                    "user-agent": "test-agent"
                }
            });
            const response = await (0, _route.POST)(mockRequest);
            const data = await response.json();
            console.log("Response status:", response.status);
            console.log("Response data:", data);
            // Check what error was logged
            const { logger } = require("@/lib/utils/logger");
            if (logger.error.mock.calls.length > 0) {
                console.log("Logged error:", logger.error.mock.calls[0]);
            }
            expect(response.status).toBe(200);
            expect(data.success).toBe(true);
            expect(data.user).toBeDefined();
            expect(data.user.email).toBe("test@example.com");
            expect(data.session).toBeDefined();
        });
        it("should handle user with confirmed email", async ()=>{
            // Mock successful authentication with confirmed email
            mockSupabaseClient.auth.signInWithPassword.mockResolvedValue({
                data: {
                    user: {
                        id: "user-123",
                        email: "test@example.com",
                        email_confirmed_at: new Date().toISOString()
                    },
                    session: {
                        access_token: "access-token",
                        refresh_token: "refresh-token"
                    }
                },
                error: null
            });
            // Mock active user profile
            mockSupabaseClient.from().select().eq().single.mockResolvedValue({
                data: {
                    id: "user-123",
                    email: "test@example.com",
                    display_name: "Test User",
                    is_active: true
                },
                error: null
            });
            mockRequest = new _server.NextRequest("http://localhost:3000/api/auth/login", {
                method: "POST",
                body: JSON.stringify({
                    email: "test@example.com",
                    password: "password123"
                }),
                headers: {
                    "Content-Type": "application/json"
                }
            });
            const response = await (0, _route.POST)(mockRequest);
            const data = await response.json();
            console.log("Response status:", response.status);
            console.log("Response data:", data);
            expect(response.status).toBe(200);
            expect(data.success).toBe(true);
            expect(data.user.email_confirmed).toBe(true);
        });
    });
    describe("Authentication Failures", ()=>{
        it("should reject invalid credentials", async ()=>{
            // Mock authentication failure
            mockSupabaseClient.auth.signInWithPassword.mockResolvedValue({
                data: {
                    user: null,
                    session: null
                },
                error: {
                    message: "Invalid login credentials"
                }
            });
            mockRequest = new _server.NextRequest("http://localhost:3000/api/auth/login", {
                method: "POST",
                body: JSON.stringify({
                    email: "test@example.com",
                    password: "wrongpassword"
                }),
                headers: {
                    "Content-Type": "application/json"
                }
            });
            const response = await (0, _route.POST)(mockRequest);
            const data = await response.json();
            expect(response.status).toBe(401);
            expect(data.success).toBe(false);
            expect(data.error).toBe("Invalid login credentials");
        });
        it("should reject inactive user", async ()=>{
            // Mock successful authentication but inactive user
            mockSupabaseClient.auth.signInWithPassword.mockResolvedValue({
                data: {
                    user: {
                        id: "user-123",
                        email: "test@example.com",
                        email_confirmed_at: new Date().toISOString()
                    },
                    session: {
                        access_token: "access-token",
                        refresh_token: "refresh-token"
                    }
                },
                error: null
            });
            // Mock inactive user profile
            mockSupabaseClient.from().select().eq().single.mockResolvedValue({
                data: {
                    id: "user-123",
                    email: "test@example.com",
                    display_name: "Test User",
                    is_active: false
                },
                error: null
            });
            mockRequest = new _server.NextRequest("http://localhost:3000/api/auth/login", {
                method: "POST",
                body: JSON.stringify({
                    email: "test@example.com",
                    password: "password123"
                }),
                headers: {
                    "Content-Type": "application/json"
                }
            });
            const response = await (0, _route.POST)(mockRequest);
            const data = await response.json();
            expect(response.status).toBe(403);
            expect(data.success).toBe(false);
            expect(data.error).toBe("Account is inactive");
        });
        it("should reject unconfirmed email", async ()=>{
            // Mock successful authentication but unconfirmed email
            mockSupabaseClient.auth.signInWithPassword.mockResolvedValue({
                data: {
                    user: {
                        id: "user-123",
                        email: "test@example.com",
                        email_confirmed_at: null
                    },
                    session: {
                        access_token: "access-token",
                        refresh_token: "refresh-token"
                    }
                },
                error: null
            });
            // Mock active user profile
            mockSupabaseClient.from().select().eq().single.mockResolvedValue({
                data: {
                    id: "user-123",
                    email: "test@example.com",
                    display_name: "Test User",
                    is_active: true
                },
                error: null
            });
            mockRequest = new _server.NextRequest("http://localhost:3000/api/auth/login", {
                method: "POST",
                body: JSON.stringify({
                    email: "test@example.com",
                    password: "password123"
                }),
                headers: {
                    "Content-Type": "application/json"
                }
            });
            const response = await (0, _route.POST)(mockRequest);
            const data = await response.json();
            expect(response.status).toBe(403);
            expect(data.success).toBe(false);
            expect(data.error).toBe("Email not confirmed");
        });
    });
    describe("Input Validation", ()=>{
        it("should validate email format", async ()=>{
            mockRequest = new _server.NextRequest("http://localhost:3000/api/auth/login", {
                method: "POST",
                body: JSON.stringify({
                    email: "invalid-email",
                    password: "password123"
                }),
                headers: {
                    "Content-Type": "application/json"
                }
            });
            const response = await (0, _route.POST)(mockRequest);
            const data = await response.json();
            expect(response.status).toBe(400);
            expect(data.success).toBe(false);
            expect(data.error).toContain("Invalid email format");
        });
        it("should validate password strength", async ()=>{
            mockRequest = new _server.NextRequest("http://localhost:3000/api/auth/login", {
                method: "POST",
                body: JSON.stringify({
                    email: "test@example.com",
                    password: "123"
                }),
                headers: {
                    "Content-Type": "application/json"
                }
            });
            const response = await (0, _route.POST)(mockRequest);
            const data = await response.json();
            expect(response.status).toBe(400);
            expect(data.success).toBe(false);
            expect(data.error).toContain("Password too weak");
        });
        it("should require both email and password", async ()=>{
            mockRequest = new _server.NextRequest("http://localhost:3000/api/auth/login", {
                method: "POST",
                body: JSON.stringify({
                    email: "test@example.com"
                }),
                headers: {
                    "Content-Type": "application/json"
                }
            });
            const response = await (0, _route.POST)(mockRequest);
            const data = await response.json();
            expect(response.status).toBe(400);
            expect(data.success).toBe(false);
            expect(data.error).toContain("Email and password are required");
        });
        it("should sanitize email input", async ()=>{
            // Mock successful authentication
            mockSupabaseClient.auth.signInWithPassword.mockResolvedValue({
                data: {
                    user: {
                        id: "user-123",
                        email: "test@example.com",
                        email_confirmed_at: new Date().toISOString()
                    },
                    session: {
                        access_token: "access-token",
                        refresh_token: "refresh-token"
                    }
                },
                error: null
            });
            // Mock user profile lookup
            mockSupabaseClient.from().select().eq().single.mockResolvedValue({
                data: {
                    id: "user-123",
                    email: "test@example.com",
                    display_name: "Test User",
                    is_active: true
                },
                error: null
            });
            mockRequest = new _server.NextRequest("http://localhost:3000/api/auth/login", {
                method: "POST",
                body: JSON.stringify({
                    email: "  TEST@EXAMPLE.COM  ",
                    password: "password123"
                }),
                headers: {
                    "Content-Type": "application/json"
                }
            });
            const response = await (0, _route.POST)(mockRequest);
            const data = await response.json();
            console.log("Response status:", response.status);
            console.log("Response data:", data);
            expect(response.status).toBe(200);
            expect(data.success).toBe(true);
            // Should normalize email to lowercase
            expect(mockSupabaseClient.auth.signInWithPassword).toHaveBeenCalledWith({
                email: "test@example.com",
                password: "password123"
            });
        });
    });
    describe("Rate Limiting", ()=>{
        it("should implement rate limiting for failed attempts", async ()=>{
            // Mock authentication failure
            mockSupabaseClient.auth.signInWithPassword.mockResolvedValue({
                data: {
                    user: null,
                    session: null
                },
                error: {
                    message: "Invalid login credentials"
                }
            });
            // Make multiple failed attempts
            for(let i = 0; i < 5; i++){
                mockRequest = new _server.NextRequest("http://localhost:3000/api/auth/login", {
                    method: "POST",
                    body: JSON.stringify({
                        email: "test@example.com",
                        password: "wrongpassword"
                    }),
                    headers: {
                        "Content-Type": "application/json"
                    }
                });
                const response = await (0, _route.POST)(mockRequest);
                if (i < 4) {
                    expect(response.status).toBe(401);
                } else {
                    // Should be rate limited after 5 attempts
                    expect(response.status).toBe(429);
                }
            }
        });
        it("should reset rate limit after successful login", async ()=>{
            // Mock successful authentication
            mockSupabaseClient.auth.signInWithPassword.mockResolvedValue({
                data: {
                    user: {
                        id: "user-123",
                        email: "test@example.com",
                        email_confirmed_at: new Date().toISOString()
                    },
                    session: {
                        access_token: "access-token",
                        refresh_token: "refresh-token"
                    }
                },
                error: null
            });
            // Mock user profile lookup
            mockSupabaseClient.from().select().eq().single.mockResolvedValue({
                data: {
                    id: "user-123",
                    email: "test@example.com",
                    display_name: "Test User",
                    is_active: true
                },
                error: null
            });
            mockRequest = new _server.NextRequest("http://localhost:3000/api/auth/login", {
                method: "POST",
                body: JSON.stringify({
                    email: "test@example.com",
                    password: "password123"
                }),
                headers: {
                    "Content-Type": "application/json"
                }
            });
            const response = await (0, _route.POST)(mockRequest);
            const data = await response.json();
            console.log("Response status:", response.status);
            console.log("Response data:", data);
            expect(response.status).toBe(200);
            expect(data.success).toBe(true);
        });
    });
    describe("Security", ()=>{
        it("should prevent SQL injection in email field", async ()=>{
            mockRequest = new _server.NextRequest("http://localhost:3000/api/auth/login", {
                method: "POST",
                body: JSON.stringify({
                    email: "'; DROP TABLE users; --",
                    password: "password123"
                }),
                headers: {
                    "Content-Type": "application/json"
                }
            });
            const response = await (0, _route.POST)(mockRequest);
            const data = await response.json();
            expect(response.status).toBe(400);
            expect(data.success).toBe(false);
            expect(data.error).toContain("Invalid email format");
        });
        it("should prevent XSS in email field", async ()=>{
            mockRequest = new _server.NextRequest("http://localhost:3000/api/auth/login", {
                method: "POST",
                body: JSON.stringify({
                    email: '<script>alert("xss")</script>@example.com',
                    password: "password123"
                }),
                headers: {
                    "Content-Type": "application/json"
                }
            });
            const response = await (0, _route.POST)(mockRequest);
            const data = await response.json();
            expect(response.status).toBe(400);
            expect(data.success).toBe(false);
            expect(data.error).toContain("Invalid email format");
        });
        it("should log security events", async ()=>{
            const { logger } = require("@/lib/utils/logger");
            // Mock authentication failure
            mockSupabaseClient.auth.signInWithPassword.mockResolvedValue({
                data: {
                    user: null,
                    session: null
                },
                error: {
                    message: "Invalid login credentials"
                }
            });
            mockRequest = new _server.NextRequest("http://localhost:3000/api/auth/login", {
                method: "POST",
                body: JSON.stringify({
                    email: "test@example.com",
                    password: "wrongpassword"
                }),
                headers: {
                    "Content-Type": "application/json"
                }
            });
            await (0, _route.POST)(mockRequest);
            expect(logger.warn).toHaveBeenCalledWith("Failed login attempt", expect.objectContaining({
                email: "test@example.com",
                ip: expect.any(String)
            }));
        });
    });
    describe("Error Handling", ()=>{
        it("should handle Supabase connection errors", async ()=>{
            // Mock Supabase connection error
            _server1.getSupabaseServerClient.mockRejectedValue(new Error("Supabase connection failed"));
            mockRequest = new _server.NextRequest("http://localhost:3000/api/auth/login", {
                method: "POST",
                body: JSON.stringify({
                    email: "test@example.com",
                    password: "password123"
                }),
                headers: {
                    "Content-Type": "application/json"
                }
            });
            const response = await (0, _route.POST)(mockRequest);
            const data = await response.json();
            expect(response.status).toBe(500);
            expect(data.success).toBe(false);
            expect(data.error).toContain("Internal server error");
        });
        it("should handle malformed JSON", async ()=>{
            mockRequest = new _server.NextRequest("http://localhost:3000/api/auth/login", {
                method: "POST",
                body: "invalid json",
                headers: {
                    "Content-Type": "application/json"
                }
            });
            const response = await (0, _route.POST)(mockRequest);
            const data = await response.json();
            expect(response.status).toBe(400);
            expect(data.success).toBe(false);
            expect(data.error).toContain("Invalid JSON");
        });
        it("should handle missing request body", async ()=>{
            mockRequest = new _server.NextRequest("http://localhost:3000/api/auth/login", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                }
            });
            const response = await (0, _route.POST)(mockRequest);
            const data = await response.json();
            expect(response.status).toBe(400);
            expect(data.success).toBe(false);
            expect(data.error).toContain("Request body is required");
        });
    });
    describe("Performance", ()=>{
        it("should respond within performance budget", async ()=>{
            // Mock successful authentication
            mockSupabaseClient.auth.signInWithPassword.mockResolvedValue({
                data: {
                    user: {
                        id: "user-123",
                        email: "test@example.com",
                        email_confirmed_at: new Date().toISOString()
                    },
                    session: {
                        access_token: "access-token",
                        refresh_token: "refresh-token"
                    }
                },
                error: null
            });
            // Mock user profile lookup
            mockSupabaseClient.from().select().eq().single.mockResolvedValue({
                data: {
                    id: "user-123",
                    email: "test@example.com",
                    display_name: "Test User",
                    is_active: true
                },
                error: null
            });
            mockRequest = new _server.NextRequest("http://localhost:3000/api/auth/login", {
                method: "POST",
                body: JSON.stringify({
                    email: "test@example.com",
                    password: "password123"
                }),
                headers: {
                    "Content-Type": "application/json"
                }
            });
            const startTime = performance.now();
            const response = await (0, _route.POST)(mockRequest);
            const endTime = performance.now();
            expect(response.status).toBe(200);
            expect(endTime - startTime).toBeLessThan(1000); // Should respond within 1 second
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hbGF1Z2hpbmdraXRzdW5lL3NyYy9DaG9pY2VzL3dlYi90ZXN0cy9qZXN0L3VuaXQvYXBpL2F1dGgvbG9naW4tcm91dGUtY29tcHJlaGVuc2l2ZS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQGplc3QtZW52aXJvbm1lbnQgbm9kZVxuICovXG5cbi8vIE1vY2sgcmF0ZSBsaW1pdGluZyBmaXJzdCAtIGJlZm9yZSBhbnkgaW1wb3J0c1xuamVzdC5tb2NrKCdAL2xpYi9jb3JlL3NlY3VyaXR5L3JhdGUtbGltaXQnLCAoKSA9PiAoe1xuICByYXRlTGltaXRlcnM6IHtcbiAgICBhdXRoOiB7XG4gICAgICBjaGVjazogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgYWxsb3dlZDogdHJ1ZSxcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgcmVtYWluaW5nOiAxMCxcbiAgICAgICAgcmVzZXRUaW1lOiBuZXcgRGF0ZSgpLFxuICAgICAgICByZXRyeUFmdGVyOiBudWxsXG4gICAgICB9KVxuICAgIH1cbiAgfVxufSkpO1xuXG5pbXBvcnQgeyBOZXh0UmVxdWVzdCB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB7IFBPU1QgfSBmcm9tICdAL2FwcC9hcGkvYXV0aC9sb2dpbi9yb3V0ZSc7XG5pbXBvcnQgeyBnZXRTdXBhYmFzZVNlcnZlckNsaWVudCB9IGZyb20gJ0AvdXRpbHMvc3VwYWJhc2Uvc2VydmVyJztcblxuLy8gTW9jayBTdXBhYmFzZSBjbGllbnRcbmplc3QubW9jaygnQC91dGlscy9zdXBhYmFzZS9zZXJ2ZXInLCAoKSA9PiAoe1xuICBnZXRTdXBhYmFzZVNlcnZlckNsaWVudDogamVzdC5mbigpLFxufSkpO1xuXG4vLyBNb2NrIE5leHQuanMgaGVhZGVyc1xuamVzdC5tb2NrKCduZXh0L2hlYWRlcnMnLCAoKSA9PiAoe1xuICBjb29raWVzOiAoKSA9PiAoe1xuICAgIGdldDogamVzdC5mbigpLFxuICAgIHNldDogamVzdC5mbigpLFxuICB9KSxcbn0pKTtcblxuLy8gTW9jayBsb2dnZXIgdG8gY2FwdHVyZSBlcnJvciBtZXNzYWdlc1xuamVzdC5tb2NrKCdAL2xpYi91dGlscy9sb2dnZXInLCAoKSA9PiAoe1xuICBsb2dnZXI6IHtcbiAgICBpbmZvOiBqZXN0LmZuKCksXG4gICAgZXJyb3I6IGplc3QuZm4oKSxcbiAgICB3YXJuOiBqZXN0LmZuKCksXG4gIH0sXG59KSk7XG5cbi8vIENTUkYgcHJvdGVjdGlvbiBpcyBoYW5kbGVkIGJ5IE5leHQuanMgbWlkZGxld2FyZSwgbm8gbW9ja2luZyBuZWVkZWRcblxuZGVzY3JpYmUoJ0F1dGggTG9naW4gUm91dGUgLSBDb21wcmVoZW5zaXZlIFRlc3RpbmcnLCAoKSA9PiB7XG4gIGxldCBtb2NrU3VwYWJhc2VDbGllbnQ6IGFueTtcbiAgbGV0IG1vY2tSZXF1ZXN0OiBOZXh0UmVxdWVzdDtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAvLyBTZXQgcmVxdWlyZWQgZW52aXJvbm1lbnQgdmFyaWFibGVzXG4gICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMID0gJ2h0dHBzOi8vdGVzdC5zdXBhYmFzZS5jbyc7XG4gICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkgPSAndGVzdC1hbm9uLWtleSc7XG4gICAgcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VDUkVUX0tFWSA9ICd0ZXN0LXNlY3JldC1rZXknO1xuICB9KTtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgICBcbiAgICAvLyBNb2NrIFN1cGFiYXNlIGNsaWVudFxuICAgIG1vY2tTdXBhYmFzZUNsaWVudCA9IHtcbiAgICAgIGF1dGg6IHtcbiAgICAgICAgc2lnbkluV2l0aFBhc3N3b3JkOiBqZXN0LmZuKCksXG4gICAgICAgIGdldFVzZXI6IGplc3QuZm4oKSxcbiAgICAgIH0sXG4gICAgICBmcm9tOiBqZXN0LmZuKCgpID0+ICh7XG4gICAgICAgIHNlbGVjdDogamVzdC5mbigoKSA9PiAoe1xuICAgICAgICAgIGVxOiBqZXN0LmZuKCgpID0+ICh7XG4gICAgICAgICAgICBzaW5nbGU6IGplc3QuZm4oKSxcbiAgICAgICAgICB9KSksXG4gICAgICAgIH0pKSxcbiAgICAgIH0pKSxcbiAgICB9O1xuXG4gICAgKGdldFN1cGFiYXNlU2VydmVyQ2xpZW50IGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1N1cGFiYXNlQ2xpZW50KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1N1Y2Nlc3NmdWwgQXV0aGVudGljYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBhdXRoZW50aWNhdGUgdXNlciB3aXRoIHZhbGlkIGNyZWRlbnRpYWxzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBzdWNjZXNzZnVsIGF1dGhlbnRpY2F0aW9uXG4gICAgICBtb2NrU3VwYWJhc2VDbGllbnQuYXV0aC5zaWduSW5XaXRoUGFzc3dvcmQubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgaWQ6ICd1c2VyLTEyMycsXG4gICAgICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICAgICAgZW1haWxfY29uZmlybWVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgfSxcbiAgICAgICAgICBzZXNzaW9uOiB7XG4gICAgICAgICAgICBhY2Nlc3NfdG9rZW46ICdhY2Nlc3MtdG9rZW4nLFxuICAgICAgICAgICAgcmVmcmVzaF90b2tlbjogJ3JlZnJlc2gtdG9rZW4nLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIE1vY2sgdXNlciBwcm9maWxlIGxvb2t1cFxuICAgICAgbW9ja1N1cGFiYXNlQ2xpZW50LmZyb20oKS5zZWxlY3QoKS5lcSgpLnNpbmdsZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBpZDogJ3VzZXItMTIzJyxcbiAgICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICAgIGRpc3BsYXlfbmFtZTogJ1Rlc3QgVXNlcicsXG4gICAgICAgICAgaXNfYWN0aXZlOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDcmVhdGUgcmVxdWVzdCB3aXRoIHZhbGlkIGNyZWRlbnRpYWxzIGFuZCBoZWFkZXJzIG5lZWRlZCBmb3IgcmF0ZSBsaW1pdGluZ1xuICAgICAgbW9ja1JlcXVlc3QgPSBuZXcgTmV4dFJlcXVlc3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvYXV0aC9sb2dpbicsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICAgIHBhc3N3b3JkOiAncGFzc3dvcmQxMjMnLFxuICAgICAgICB9KSxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgJ3gtZm9yd2FyZGVkLWZvcic6ICcxMjcuMC4wLjEnLFxuICAgICAgICAgICd1c2VyLWFnZW50JzogJ3Rlc3QtYWdlbnQnLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgUE9TVChtb2NrUmVxdWVzdCk7XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnUmVzcG9uc2Ugc3RhdHVzOicsIHJlc3BvbnNlLnN0YXR1cyk7XG4gICAgICBjb25zb2xlLmxvZygnUmVzcG9uc2UgZGF0YTonLCBkYXRhKTtcbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgd2hhdCBlcnJvciB3YXMgbG9nZ2VkXG4gICAgICBjb25zdCB7IGxvZ2dlciB9ID0gcmVxdWlyZSgnQC9saWIvdXRpbHMvbG9nZ2VyJyk7XG4gICAgICBpZiAobG9nZ2VyLmVycm9yLm1vY2suY2FsbHMubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zb2xlLmxvZygnTG9nZ2VkIGVycm9yOicsIGxvZ2dlci5lcnJvci5tb2NrLmNhbGxzWzBdKTtcbiAgICAgIH1cblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgZXhwZWN0KGRhdGEuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChkYXRhLnVzZXIpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoZGF0YS51c2VyLmVtYWlsKS50b0JlKCd0ZXN0QGV4YW1wbGUuY29tJyk7XG4gICAgICBleHBlY3QoZGF0YS5zZXNzaW9uKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgdXNlciB3aXRoIGNvbmZpcm1lZCBlbWFpbCcsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBhdXRoZW50aWNhdGlvbiB3aXRoIGNvbmZpcm1lZCBlbWFpbFxuICAgICAgbW9ja1N1cGFiYXNlQ2xpZW50LmF1dGguc2lnbkluV2l0aFBhc3N3b3JkLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgIGlkOiAndXNlci0xMjMnLFxuICAgICAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgICAgIGVtYWlsX2NvbmZpcm1lZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgc2Vzc2lvbjoge1xuICAgICAgICAgICAgYWNjZXNzX3Rva2VuOiAnYWNjZXNzLXRva2VuJyxcbiAgICAgICAgICAgIHJlZnJlc2hfdG9rZW46ICdyZWZyZXNoLXRva2VuJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBNb2NrIGFjdGl2ZSB1c2VyIHByb2ZpbGVcbiAgICAgIG1vY2tTdXBhYmFzZUNsaWVudC5mcm9tKCkuc2VsZWN0KCkuZXEoKS5zaW5nbGUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgaWQ6ICd1c2VyLTEyMycsXG4gICAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgICBkaXNwbGF5X25hbWU6ICdUZXN0IFVzZXInLFxuICAgICAgICAgIGlzX2FjdGl2ZTogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICB9KTtcblxuICAgICAgbW9ja1JlcXVlc3QgPSBuZXcgTmV4dFJlcXVlc3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvYXV0aC9sb2dpbicsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICAgIHBhc3N3b3JkOiAncGFzc3dvcmQxMjMnLFxuICAgICAgICB9KSxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBQT1NUKG1vY2tSZXF1ZXN0KTtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKCdSZXNwb25zZSBzdGF0dXM6JywgcmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgIGNvbnNvbGUubG9nKCdSZXNwb25zZSBkYXRhOicsIGRhdGEpO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgICBleHBlY3QoZGF0YS5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KGRhdGEudXNlci5lbWFpbF9jb25maXJtZWQpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdBdXRoZW50aWNhdGlvbiBGYWlsdXJlcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJlamVjdCBpbnZhbGlkIGNyZWRlbnRpYWxzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBhdXRoZW50aWNhdGlvbiBmYWlsdXJlXG4gICAgICBtb2NrU3VwYWJhc2VDbGllbnQuYXV0aC5zaWduSW5XaXRoUGFzc3dvcmQubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgdXNlcjogbnVsbCxcbiAgICAgICAgICBzZXNzaW9uOiBudWxsLFxuICAgICAgICB9LFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIG1lc3NhZ2U6ICdJbnZhbGlkIGxvZ2luIGNyZWRlbnRpYWxzJyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBtb2NrUmVxdWVzdCA9IG5ldyBOZXh0UmVxdWVzdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9hdXRoL2xvZ2luJywge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgICAgcGFzc3dvcmQ6ICd3cm9uZ3Bhc3N3b3JkJyxcbiAgICAgICAgfSksXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgUE9TVChtb2NrUmVxdWVzdCk7XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDQwMSk7XG4gICAgICBleHBlY3QoZGF0YS5zdWNjZXNzKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChkYXRhLmVycm9yKS50b0JlKCdJbnZhbGlkIGxvZ2luIGNyZWRlbnRpYWxzJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCBpbmFjdGl2ZSB1c2VyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBzdWNjZXNzZnVsIGF1dGhlbnRpY2F0aW9uIGJ1dCBpbmFjdGl2ZSB1c2VyXG4gICAgICBtb2NrU3VwYWJhc2VDbGllbnQuYXV0aC5zaWduSW5XaXRoUGFzc3dvcmQubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgaWQ6ICd1c2VyLTEyMycsXG4gICAgICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICAgICAgZW1haWxfY29uZmlybWVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgfSxcbiAgICAgICAgICBzZXNzaW9uOiB7XG4gICAgICAgICAgICBhY2Nlc3NfdG9rZW46ICdhY2Nlc3MtdG9rZW4nLFxuICAgICAgICAgICAgcmVmcmVzaF90b2tlbjogJ3JlZnJlc2gtdG9rZW4nLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIE1vY2sgaW5hY3RpdmUgdXNlciBwcm9maWxlXG4gICAgICBtb2NrU3VwYWJhc2VDbGllbnQuZnJvbSgpLnNlbGVjdCgpLmVxKCkuc2luZ2xlLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIGlkOiAndXNlci0xMjMnLFxuICAgICAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgICAgZGlzcGxheV9uYW1lOiAnVGVzdCBVc2VyJyxcbiAgICAgICAgICBpc19hY3RpdmU6IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgIH0pO1xuXG4gICAgICBtb2NrUmVxdWVzdCA9IG5ldyBOZXh0UmVxdWVzdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9hdXRoL2xvZ2luJywge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgICAgcGFzc3dvcmQ6ICdwYXNzd29yZDEyMycsXG4gICAgICAgIH0pLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IFBPU1QobW9ja1JlcXVlc3QpO1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg0MDMpO1xuICAgICAgZXhwZWN0KGRhdGEuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QoZGF0YS5lcnJvcikudG9CZSgnQWNjb3VudCBpcyBpbmFjdGl2ZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgdW5jb25maXJtZWQgZW1haWwnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIHN1Y2Nlc3NmdWwgYXV0aGVudGljYXRpb24gYnV0IHVuY29uZmlybWVkIGVtYWlsXG4gICAgICBtb2NrU3VwYWJhc2VDbGllbnQuYXV0aC5zaWduSW5XaXRoUGFzc3dvcmQubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgaWQ6ICd1c2VyLTEyMycsXG4gICAgICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICAgICAgZW1haWxfY29uZmlybWVkX2F0OiBudWxsLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgc2Vzc2lvbjoge1xuICAgICAgICAgICAgYWNjZXNzX3Rva2VuOiAnYWNjZXNzLXRva2VuJyxcbiAgICAgICAgICAgIHJlZnJlc2hfdG9rZW46ICdyZWZyZXNoLXRva2VuJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBNb2NrIGFjdGl2ZSB1c2VyIHByb2ZpbGVcbiAgICAgIG1vY2tTdXBhYmFzZUNsaWVudC5mcm9tKCkuc2VsZWN0KCkuZXEoKS5zaW5nbGUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgaWQ6ICd1c2VyLTEyMycsXG4gICAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgICBkaXNwbGF5X25hbWU6ICdUZXN0IFVzZXInLFxuICAgICAgICAgIGlzX2FjdGl2ZTogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICB9KTtcblxuICAgICAgbW9ja1JlcXVlc3QgPSBuZXcgTmV4dFJlcXVlc3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvYXV0aC9sb2dpbicsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICAgIHBhc3N3b3JkOiAncGFzc3dvcmQxMjMnLFxuICAgICAgICB9KSxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBQT1NUKG1vY2tSZXF1ZXN0KTtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNDAzKTtcbiAgICAgIGV4cGVjdChkYXRhLnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGRhdGEuZXJyb3IpLnRvQmUoJ0VtYWlsIG5vdCBjb25maXJtZWQnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0lucHV0IFZhbGlkYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBlbWFpbCBmb3JtYXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrUmVxdWVzdCA9IG5ldyBOZXh0UmVxdWVzdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9hdXRoL2xvZ2luJywge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGVtYWlsOiAnaW52YWxpZC1lbWFpbCcsXG4gICAgICAgICAgcGFzc3dvcmQ6ICdwYXNzd29yZDEyMycsXG4gICAgICAgIH0pLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IFBPU1QobW9ja1JlcXVlc3QpO1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg0MDApO1xuICAgICAgZXhwZWN0KGRhdGEuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QoZGF0YS5lcnJvcikudG9Db250YWluKCdJbnZhbGlkIGVtYWlsIGZvcm1hdCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBwYXNzd29yZCBzdHJlbmd0aCcsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tSZXF1ZXN0ID0gbmV3IE5leHRSZXF1ZXN0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL2F1dGgvbG9naW4nLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgICBwYXNzd29yZDogJzEyMycsXG4gICAgICAgIH0pLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IFBPU1QobW9ja1JlcXVlc3QpO1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg0MDApO1xuICAgICAgZXhwZWN0KGRhdGEuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QoZGF0YS5lcnJvcikudG9Db250YWluKCdQYXNzd29yZCB0b28gd2VhaycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXF1aXJlIGJvdGggZW1haWwgYW5kIHBhc3N3b3JkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1JlcXVlc3QgPSBuZXcgTmV4dFJlcXVlc3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvYXV0aC9sb2dpbicsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICB9KSxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBQT1NUKG1vY2tSZXF1ZXN0KTtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNDAwKTtcbiAgICAgIGV4cGVjdChkYXRhLnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGRhdGEuZXJyb3IpLnRvQ29udGFpbignRW1haWwgYW5kIHBhc3N3b3JkIGFyZSByZXF1aXJlZCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzYW5pdGl6ZSBlbWFpbCBpbnB1dCcsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBhdXRoZW50aWNhdGlvblxuICAgICAgbW9ja1N1cGFiYXNlQ2xpZW50LmF1dGguc2lnbkluV2l0aFBhc3N3b3JkLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgIGlkOiAndXNlci0xMjMnLFxuICAgICAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgICAgIGVtYWlsX2NvbmZpcm1lZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgc2Vzc2lvbjoge1xuICAgICAgICAgICAgYWNjZXNzX3Rva2VuOiAnYWNjZXNzLXRva2VuJyxcbiAgICAgICAgICAgIHJlZnJlc2hfdG9rZW46ICdyZWZyZXNoLXRva2VuJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBNb2NrIHVzZXIgcHJvZmlsZSBsb29rdXBcbiAgICAgIG1vY2tTdXBhYmFzZUNsaWVudC5mcm9tKCkuc2VsZWN0KCkuZXEoKS5zaW5nbGUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgaWQ6ICd1c2VyLTEyMycsXG4gICAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgICBkaXNwbGF5X25hbWU6ICdUZXN0IFVzZXInLFxuICAgICAgICAgIGlzX2FjdGl2ZTogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICB9KTtcblxuICAgICAgbW9ja1JlcXVlc3QgPSBuZXcgTmV4dFJlcXVlc3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvYXV0aC9sb2dpbicsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBlbWFpbDogJyAgVEVTVEBFWEFNUExFLkNPTSAgJyxcbiAgICAgICAgICBwYXNzd29yZDogJ3Bhc3N3b3JkMTIzJyxcbiAgICAgICAgfSksXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgUE9TVChtb2NrUmVxdWVzdCk7XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnUmVzcG9uc2Ugc3RhdHVzOicsIHJlc3BvbnNlLnN0YXR1cyk7XG4gICAgICBjb25zb2xlLmxvZygnUmVzcG9uc2UgZGF0YTonLCBkYXRhKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgZXhwZWN0KGRhdGEuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIC8vIFNob3VsZCBub3JtYWxpemUgZW1haWwgdG8gbG93ZXJjYXNlXG4gICAgICBleHBlY3QobW9ja1N1cGFiYXNlQ2xpZW50LmF1dGguc2lnbkluV2l0aFBhc3N3b3JkKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgIHBhc3N3b3JkOiAncGFzc3dvcmQxMjMnLFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdSYXRlIExpbWl0aW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaW1wbGVtZW50IHJhdGUgbGltaXRpbmcgZm9yIGZhaWxlZCBhdHRlbXB0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgYXV0aGVudGljYXRpb24gZmFpbHVyZVxuICAgICAgbW9ja1N1cGFiYXNlQ2xpZW50LmF1dGguc2lnbkluV2l0aFBhc3N3b3JkLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHVzZXI6IG51bGwsXG4gICAgICAgICAgc2Vzc2lvbjogbnVsbCxcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBtZXNzYWdlOiAnSW52YWxpZCBsb2dpbiBjcmVkZW50aWFscycsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgLy8gTWFrZSBtdWx0aXBsZSBmYWlsZWQgYXR0ZW1wdHNcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNTsgaSsrKSB7XG4gICAgICAgIG1vY2tSZXF1ZXN0ID0gbmV3IE5leHRSZXF1ZXN0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL2F1dGgvbG9naW4nLCB7XG4gICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgICAgIHBhc3N3b3JkOiAnd3JvbmdwYXNzd29yZCcsXG4gICAgICAgICAgfSksXG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IFBPU1QobW9ja1JlcXVlc3QpO1xuICAgICAgICBcbiAgICAgICAgaWYgKGkgPCA0KSB7XG4gICAgICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg0MDEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIFNob3VsZCBiZSByYXRlIGxpbWl0ZWQgYWZ0ZXIgNSBhdHRlbXB0c1xuICAgICAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNDI5KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXNldCByYXRlIGxpbWl0IGFmdGVyIHN1Y2Nlc3NmdWwgbG9naW4nLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIHN1Y2Nlc3NmdWwgYXV0aGVudGljYXRpb25cbiAgICAgIG1vY2tTdXBhYmFzZUNsaWVudC5hdXRoLnNpZ25JbldpdGhQYXNzd29yZC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICBpZDogJ3VzZXItMTIzJyxcbiAgICAgICAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgICAgICBlbWFpbF9jb25maXJtZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHNlc3Npb246IHtcbiAgICAgICAgICAgIGFjY2Vzc190b2tlbjogJ2FjY2Vzcy10b2tlbicsXG4gICAgICAgICAgICByZWZyZXNoX3Rva2VuOiAncmVmcmVzaC10b2tlbicsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICB9KTtcblxuICAgICAgLy8gTW9jayB1c2VyIHByb2ZpbGUgbG9va3VwXG4gICAgICBtb2NrU3VwYWJhc2VDbGllbnQuZnJvbSgpLnNlbGVjdCgpLmVxKCkuc2luZ2xlLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIGlkOiAndXNlci0xMjMnLFxuICAgICAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgICAgZGlzcGxheV9uYW1lOiAnVGVzdCBVc2VyJyxcbiAgICAgICAgICBpc19hY3RpdmU6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgfSk7XG5cbiAgICAgIG1vY2tSZXF1ZXN0ID0gbmV3IE5leHRSZXF1ZXN0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL2F1dGgvbG9naW4nLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgICBwYXNzd29yZDogJ3Bhc3N3b3JkMTIzJyxcbiAgICAgICAgfSksXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgUE9TVChtb2NrUmVxdWVzdCk7XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnUmVzcG9uc2Ugc3RhdHVzOicsIHJlc3BvbnNlLnN0YXR1cyk7XG4gICAgICBjb25zb2xlLmxvZygnUmVzcG9uc2UgZGF0YTonLCBkYXRhKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgZXhwZWN0KGRhdGEuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1NlY3VyaXR5JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcHJldmVudCBTUUwgaW5qZWN0aW9uIGluIGVtYWlsIGZpZWxkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1JlcXVlc3QgPSBuZXcgTmV4dFJlcXVlc3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvYXV0aC9sb2dpbicsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBlbWFpbDogXCInOyBEUk9QIFRBQkxFIHVzZXJzOyAtLVwiLFxuICAgICAgICAgIHBhc3N3b3JkOiAncGFzc3dvcmQxMjMnLFxuICAgICAgICB9KSxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBQT1NUKG1vY2tSZXF1ZXN0KTtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNDAwKTtcbiAgICAgIGV4cGVjdChkYXRhLnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGRhdGEuZXJyb3IpLnRvQ29udGFpbignSW52YWxpZCBlbWFpbCBmb3JtYXQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcHJldmVudCBYU1MgaW4gZW1haWwgZmllbGQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrUmVxdWVzdCA9IG5ldyBOZXh0UmVxdWVzdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9hdXRoL2xvZ2luJywge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGVtYWlsOiAnPHNjcmlwdD5hbGVydChcInhzc1wiKTwvc2NyaXB0PkBleGFtcGxlLmNvbScsXG4gICAgICAgICAgcGFzc3dvcmQ6ICdwYXNzd29yZDEyMycsXG4gICAgICAgIH0pLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IFBPU1QobW9ja1JlcXVlc3QpO1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg0MDApO1xuICAgICAgZXhwZWN0KGRhdGEuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QoZGF0YS5lcnJvcikudG9Db250YWluKCdJbnZhbGlkIGVtYWlsIGZvcm1hdCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBsb2cgc2VjdXJpdHkgZXZlbnRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgeyBsb2dnZXIgfSA9IHJlcXVpcmUoJ0AvbGliL3V0aWxzL2xvZ2dlcicpO1xuICAgICAgXG4gICAgICAvLyBNb2NrIGF1dGhlbnRpY2F0aW9uIGZhaWx1cmVcbiAgICAgIG1vY2tTdXBhYmFzZUNsaWVudC5hdXRoLnNpZ25JbldpdGhQYXNzd29yZC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICB1c2VyOiBudWxsLFxuICAgICAgICAgIHNlc3Npb246IG51bGwsXG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgbWVzc2FnZTogJ0ludmFsaWQgbG9naW4gY3JlZGVudGlhbHMnLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIG1vY2tSZXF1ZXN0ID0gbmV3IE5leHRSZXF1ZXN0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL2F1dGgvbG9naW4nLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgICBwYXNzd29yZDogJ3dyb25ncGFzc3dvcmQnLFxuICAgICAgICB9KSxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgUE9TVChtb2NrUmVxdWVzdCk7XG5cbiAgICAgIGV4cGVjdChsb2dnZXIud2FybikudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICdGYWlsZWQgbG9naW4gYXR0ZW1wdCcsXG4gICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICAgIGlwOiBleHBlY3QuYW55KFN0cmluZyksXG4gICAgICAgIH0pXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRXJyb3IgSGFuZGxpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgU3VwYWJhc2UgY29ubmVjdGlvbiBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIFN1cGFiYXNlIGNvbm5lY3Rpb24gZXJyb3JcbiAgICAgIChnZXRTdXBhYmFzZVNlcnZlckNsaWVudCBhcyBqZXN0Lk1vY2spLm1vY2tSZWplY3RlZFZhbHVlKFxuICAgICAgICBuZXcgRXJyb3IoJ1N1cGFiYXNlIGNvbm5lY3Rpb24gZmFpbGVkJylcbiAgICAgICk7XG5cbiAgICAgIG1vY2tSZXF1ZXN0ID0gbmV3IE5leHRSZXF1ZXN0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL2F1dGgvbG9naW4nLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgICBwYXNzd29yZDogJ3Bhc3N3b3JkMTIzJyxcbiAgICAgICAgfSksXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgUE9TVChtb2NrUmVxdWVzdCk7XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDUwMCk7XG4gICAgICBleHBlY3QoZGF0YS5zdWNjZXNzKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChkYXRhLmVycm9yKS50b0NvbnRhaW4oJ0ludGVybmFsIHNlcnZlciBlcnJvcicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWFsZm9ybWVkIEpTT04nLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrUmVxdWVzdCA9IG5ldyBOZXh0UmVxdWVzdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9hdXRoL2xvZ2luJywge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgYm9keTogJ2ludmFsaWQganNvbicsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgUE9TVChtb2NrUmVxdWVzdCk7XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDQwMCk7XG4gICAgICBleHBlY3QoZGF0YS5zdWNjZXNzKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChkYXRhLmVycm9yKS50b0NvbnRhaW4oJ0ludmFsaWQgSlNPTicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWlzc2luZyByZXF1ZXN0IGJvZHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrUmVxdWVzdCA9IG5ldyBOZXh0UmVxdWVzdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9hdXRoL2xvZ2luJywge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBQT1NUKG1vY2tSZXF1ZXN0KTtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNDAwKTtcbiAgICAgIGV4cGVjdChkYXRhLnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGRhdGEuZXJyb3IpLnRvQ29udGFpbignUmVxdWVzdCBib2R5IGlzIHJlcXVpcmVkJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQZXJmb3JtYW5jZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJlc3BvbmQgd2l0aGluIHBlcmZvcm1hbmNlIGJ1ZGdldCcsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBhdXRoZW50aWNhdGlvblxuICAgICAgbW9ja1N1cGFiYXNlQ2xpZW50LmF1dGguc2lnbkluV2l0aFBhc3N3b3JkLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgIGlkOiAndXNlci0xMjMnLFxuICAgICAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgICAgIGVtYWlsX2NvbmZpcm1lZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgc2Vzc2lvbjoge1xuICAgICAgICAgICAgYWNjZXNzX3Rva2VuOiAnYWNjZXNzLXRva2VuJyxcbiAgICAgICAgICAgIHJlZnJlc2hfdG9rZW46ICdyZWZyZXNoLXRva2VuJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBNb2NrIHVzZXIgcHJvZmlsZSBsb29rdXBcbiAgICAgIG1vY2tTdXBhYmFzZUNsaWVudC5mcm9tKCkuc2VsZWN0KCkuZXEoKS5zaW5nbGUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgaWQ6ICd1c2VyLTEyMycsXG4gICAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgICBkaXNwbGF5X25hbWU6ICdUZXN0IFVzZXInLFxuICAgICAgICAgIGlzX2FjdGl2ZTogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICB9KTtcblxuICAgICAgbW9ja1JlcXVlc3QgPSBuZXcgTmV4dFJlcXVlc3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvYXV0aC9sb2dpbicsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICAgIHBhc3N3b3JkOiAncGFzc3dvcmQxMjMnLFxuICAgICAgICB9KSxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IFBPU1QobW9ja1JlcXVlc3QpO1xuICAgICAgY29uc3QgZW5kVGltZSA9IHBlcmZvcm1hbmNlLm5vdygpO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgICBleHBlY3QoZW5kVGltZSAtIHN0YXJ0VGltZSkudG9CZUxlc3NUaGFuKDEwMDApOyAvLyBTaG91bGQgcmVzcG9uZCB3aXRoaW4gMSBzZWNvbmRcbiAgICB9KTtcbiAgfSk7XG59KTtcblxuXG5cblxuIl0sIm5hbWVzIjpbImplc3QiLCJtb2NrIiwicmF0ZUxpbWl0ZXJzIiwiYXV0aCIsImNoZWNrIiwiZm4iLCJtb2NrUmVzb2x2ZWRWYWx1ZSIsImFsbG93ZWQiLCJzdWNjZXNzIiwicmVtYWluaW5nIiwicmVzZXRUaW1lIiwiRGF0ZSIsInJldHJ5QWZ0ZXIiLCJnZXRTdXBhYmFzZVNlcnZlckNsaWVudCIsImNvb2tpZXMiLCJnZXQiLCJzZXQiLCJsb2dnZXIiLCJpbmZvIiwiZXJyb3IiLCJ3YXJuIiwiZGVzY3JpYmUiLCJtb2NrU3VwYWJhc2VDbGllbnQiLCJtb2NrUmVxdWVzdCIsImJlZm9yZUVhY2giLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJTVVBBQkFTRV9TRUNSRVRfS0VZIiwiY2xlYXJBbGxNb2NrcyIsInNpZ25JbldpdGhQYXNzd29yZCIsImdldFVzZXIiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJzaW5nbGUiLCJpdCIsImRhdGEiLCJ1c2VyIiwiaWQiLCJlbWFpbCIsImVtYWlsX2NvbmZpcm1lZF9hdCIsInRvSVNPU3RyaW5nIiwic2Vzc2lvbiIsImFjY2Vzc190b2tlbiIsInJlZnJlc2hfdG9rZW4iLCJkaXNwbGF5X25hbWUiLCJpc19hY3RpdmUiLCJOZXh0UmVxdWVzdCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwicGFzc3dvcmQiLCJoZWFkZXJzIiwicmVzcG9uc2UiLCJQT1NUIiwianNvbiIsImNvbnNvbGUiLCJsb2ciLCJzdGF0dXMiLCJyZXF1aXJlIiwiY2FsbHMiLCJsZW5ndGgiLCJleHBlY3QiLCJ0b0JlIiwidG9CZURlZmluZWQiLCJlbWFpbF9jb25maXJtZWQiLCJtZXNzYWdlIiwidG9Db250YWluIiwidG9IYXZlQmVlbkNhbGxlZFdpdGgiLCJpIiwib2JqZWN0Q29udGFpbmluZyIsImlwIiwiYW55IiwiU3RyaW5nIiwibW9ja1JlamVjdGVkVmFsdWUiLCJFcnJvciIsInN0YXJ0VGltZSIsInBlcmZvcm1hbmNlIiwibm93IiwiZW5kVGltZSIsInRvQmVMZXNzVGhhbiJdLCJtYXBwaW5ncyI6IkFBQUE7O0NBRUMsR0FFRCxnREFBZ0Q7O0FBQ2hEQSxLQUFLQyxJQUFJLENBQUMsa0NBQWtDLElBQU8sQ0FBQTtRQUNqREMsY0FBYztZQUNaQyxNQUFNO2dCQUNKQyxPQUFPSixLQUFLSyxFQUFFLEdBQUdDLGlCQUFpQixDQUFDO29CQUNqQ0MsU0FBUztvQkFDVEMsU0FBUztvQkFDVEMsV0FBVztvQkFDWEMsV0FBVyxJQUFJQztvQkFDZkMsWUFBWTtnQkFDZDtZQUNGO1FBQ0Y7SUFDRixDQUFBO0FBTUEsdUJBQXVCO0FBQ3ZCWixLQUFLQyxJQUFJLENBQUMsMkJBQTJCLElBQU8sQ0FBQTtRQUMxQ1kseUJBQXlCYixLQUFLSyxFQUFFO0lBQ2xDLENBQUE7QUFFQSx1QkFBdUI7QUFDdkJMLEtBQUtDLElBQUksQ0FBQyxnQkFBZ0IsSUFBTyxDQUFBO1FBQy9CYSxTQUFTLElBQU8sQ0FBQTtnQkFDZEMsS0FBS2YsS0FBS0ssRUFBRTtnQkFDWlcsS0FBS2hCLEtBQUtLLEVBQUU7WUFDZCxDQUFBO0lBQ0YsQ0FBQTtBQUVB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