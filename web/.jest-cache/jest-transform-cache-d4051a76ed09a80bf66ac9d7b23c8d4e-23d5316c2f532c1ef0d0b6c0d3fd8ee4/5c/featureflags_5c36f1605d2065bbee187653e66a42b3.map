{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/lib/core/feature-flags.ts"],"sourcesContent":["/**\n * Core Feature Flags System\n * \n * Centralized feature flag management with type safety and runtime control.\n * Provides the foundation for feature rollout, A/B testing, and safe deployments.\n */\n\nimport { logger } from '@/lib/utils/logger';\n\n// Feature Flag Types\nexport interface FeatureFlag {\n  id: string;\n  name: string;\n  enabled: boolean;\n  description: string;\n  category?: string;\n  dependencies?: string[];\n  metadata?: Record<string, unknown>;\n}\n\nexport interface FeatureFlagConfig {\n  flags: Record<string, boolean>;\n  categories: Record<string, string[]>;\n  environment: string;\n  version: string;\n}\n\nexport interface FeatureFlagManager {\n  isEnabled(flagId: string): boolean;\n  isDisabled(flagId: string): boolean;\n  enable(flagId: string): boolean;\n  disable(flagId: string): boolean;\n  toggle(flagId: string): boolean;\n  getFlag(flagId: string): FeatureFlag | undefined;\n  getAllFlags(): Map<string, FeatureFlag>;\n  getEnabledFlags(): FeatureFlag[];\n  getDisabledFlags(): FeatureFlag[];\n  getFlagsByCategory(category: 'core' | 'optional' | 'experimental'): FeatureFlag[];\n  getSystemInfo(): {\n    totalFlags: number;\n    enabledFlags: number;\n    disabledFlags: number;\n    environment: string;\n    categories: Record<string, number>;\n  };\n  subscribe(callback: (flags: Record<string, boolean>) => void): { unsubscribe: () => void };\n  updateFlagMetadata(flagId: string, metadata: Record<string, unknown>): boolean;\n  reset(): void;\n  exportConfig(): FeatureFlagConfig;\n  importConfig(config: FeatureFlagConfig): void;\n  areDependenciesEnabled(flagId: string): boolean;\n}\n\n// Feature Flag Definitions\nexport const FEATURE_FLAGS = {\n  // ===== CORE MVP FEATURES (Always Enabled) =====\n  WEBAUTHN: true,\n  PWA: true,\n  ADMIN: true,\n  FEEDBACK_WIDGET: true,        // CRITICAL: User feedback collection widget\n  \n  // ===== ADMIN FEATURES (Nice-to-have for MVP) =====\n  USER_SUGGESTIONS_MANAGER: false, // Admin can access from laptop for now\n  \n  // ===== ENHANCED MVP FEATURES (FULLY IMPLEMENTED) =====\n  ENHANCED_PROFILE: true,            // Advanced profile management with privacy controls\n  ENHANCED_POLLS: true,              // Advanced poll creation and management system (164 polls active)\n  ENHANCED_VOTING: true,             // Advanced voting methods and analytics (3 votes active)\n  CIVICS_ADDRESS_LOOKUP: true,       // Address-based representative lookup system (IMPLEMENTED)\n  CIVICS_REPRESENTATIVE_DATABASE: true, // Federal, state, and local representative database (IMPLEMENTED - 1,273 representatives)\n  CIVICS_CAMPAIGN_FINANCE: true,     // FEC campaign finance data integration (IMPLEMENTED - 92 FEC records)\n  CIVICS_VOTING_RECORDS: true,       // Congressional voting records and analysis (IMPLEMENTED - 2,185 voting records)\n  CANDIDATE_ACCOUNTABILITY: true,    // Promise tracking and performance metrics (IMPLEMENTED)\n  CANDIDATE_CARDS: true,             // Comprehensive candidate information cards (2 candidates)\n  ALTERNATIVE_CANDIDATES: true,      // Platform for non-duopoly candidates (IMPLEMENTED)\n  \n  // ===== FUTURE FEATURES (Development Required) =====\n  AUTOMATED_POLLS: false,            // AI-powered poll generation from trending topics\n  DEMOGRAPHIC_FILTERING: false,      // Personalize content based on user demographics (NOT IMPLEMENTED)\n  TRENDING_POLLS: false,             // Identify and surface trending polls and topics (NOT IMPLEMENTED)\n  ADVANCED_PRIVACY: false,           // Zero-knowledge proofs and differential privacy (PARTIALLY IMPLEMENTED - 30%)\n  MEDIA_BIAS_ANALYSIS: false,        // Media bias detection and analysis (not MVP ready)\n  POLL_NARRATIVE_SYSTEM: false,      // AI-powered poll narrative generation (PARTIALLY IMPLEMENTED - 70%)\n  SOCIAL_SHARING: true,              // Master switch for all social features (IMPLEMENTED - 100%)\n  SOCIAL_SHARING_POLLS: false,       // Poll sharing (Twitter, Facebook, LinkedIn) (PARTIALLY IMPLEMENTED - 60%)\n  SOCIAL_SHARING_CIVICS: false,      // Representative sharing (PARTIALLY IMPLEMENTED - 60%)\n  SOCIAL_SHARING_VISUAL: false,      // Visual content generation (IG, TikTok) (NOT IMPLEMENTED)\n  SOCIAL_SHARING_OG: false,          // Dynamic Open Graph image generation (NOT IMPLEMENTED)\n  SOCIAL_SIGNUP: false,              // Social OAuth signup (NOT IMPLEMENTED)\n  CONTACT_INFORMATION_SYSTEM: false, // Contact information system (PARTIALLY IMPLEMENTED - 50%)\n  CIVICS_TESTING_STRATEGY: false,    // Civics testing strategy (NOT IMPLEMENTED)\n  DEVICE_FLOW_AUTH: false,           // OAuth 2.0 Device Authorization Grant flow (PARTIALLY IMPLEMENTED - 80%)\n  \n  // ===== PERFORMANCE & OPTIMIZATION =====\n  PERFORMANCE_OPTIMIZATION: true,   // Image optimization, virtual scrolling, lazy loading (enabled for mobile)\n  FEATURE_DB_OPTIMIZATION_SUITE: true, // Database optimization suite - enabled for performance\n  ANALYTICS: true,                   // Advanced analytics and user insights\n  \n  // ===== SYSTEM FEATURES =====\n  PUSH_NOTIFICATIONS: true,          // Push notifications and alerts (enabled for mobile PWA)\n  THEMES: true,                      // Dark mode and theme customization (enabled for mobile UX)\n  ACCESSIBILITY: true,               // Advanced accessibility features (enabled for mobile accessibility)\n  INTERNATIONALIZATION: false,       // Multi-language support\n  \n  // Legacy flags for backward compatibility\n  CORE_AUTH: true,\n  CORE_POLLS: true,\n  CORE_USERS: true,\n  EXPERIMENTAL_UIFeature: false,\n  AIFeaturesFeature: false,\n  AdvancedPrivacyFeature: false,\n  AnalyticsFeature: false,\n  PWAFeature: true,\n  AdminFeature: true,\n  AuditFeature: false,\n  ExperimentalUIFeature: false,\n  VotingFeature: true,\n  DatabaseFeature: true,\n  APIFeature: true,\n  UIFeature: true,\n  AuthFeature: true\n} as const;\n\n// Feature Flag Categories\nexport const FEATURE_FLAG_CATEGORIES: Record<string, string[]> = {\n  core: ['WEBAUTHN', 'PWA', 'ADMIN', 'FEEDBACK_WIDGET', 'CORE_AUTH', 'CORE_POLLS', 'CORE_USERS'],\n  enhanced: ['ENHANCED_PROFILE', 'ENHANCED_POLLS', 'ENHANCED_VOTING'],\n  civics: ['CIVICS_ADDRESS_LOOKUP', 'CIVICS_REPRESENTATIVE_DATABASE', 'CIVICS_CAMPAIGN_FINANCE', 'CIVICS_VOTING_RECORDS', 'CANDIDATE_ACCOUNTABILITY', 'CANDIDATE_CARDS', 'ALTERNATIVE_CANDIDATES'],\n  future: ['AUTOMATED_POLLS', 'DEMOGRAPHIC_FILTERING', 'TRENDING_POLLS', 'ADVANCED_PRIVACY', 'MEDIA_BIAS_ANALYSIS', 'POLL_NARRATIVE_SYSTEM'],\n  performance: ['PERFORMANCE_OPTIMIZATION', 'FEATURE_DB_OPTIMIZATION_SUITE'],\n  social: ['SOCIAL_SHARING', 'SOCIAL_SHARING_POLLS', 'SOCIAL_SHARING_CIVICS', 'SOCIAL_SHARING_VISUAL', 'SOCIAL_SHARING_OG', 'SOCIAL_SIGNUP'],\n  system: ['PUSH_NOTIFICATIONS', 'THEMES', 'ACCESSIBILITY', 'INTERNATIONALIZATION'],\n  analytics: ['ANALYTICS'],\n  admin: ['USER_SUGGESTIONS_MANAGER'],\n  contact: ['CONTACT_INFORMATION_SYSTEM'],\n  testing: ['CIVICS_TESTING_STRATEGY'],\n  auth: ['DEVICE_FLOW_AUTH'],\n  legacy: ['EXPERIMENTAL_UIFeature', 'AIFeaturesFeature', 'AdvancedPrivacyFeature', 'AnalyticsFeature', 'PWAFeature', 'AdminFeature', 'AuditFeature', 'ExperimentalUIFeature', 'VotingFeature', 'DatabaseFeature', 'APIFeature', 'UIFeature', 'AuthFeature']\n};\n\n// Feature Flag Dependencies\nexport const FEATURE_FLAG_DEPENDENCIES: Record<string, string[]> = {\n  ENHANCED_PROFILE: ['CORE_AUTH'],\n  ENHANCED_POLLS: ['CORE_POLLS'],\n  ENHANCED_VOTING: ['CORE_POLLS'],\n  CIVICS_ADDRESS_LOOKUP: ['CORE_AUTH'],\n  CIVICS_REPRESENTATIVE_DATABASE: ['CIVICS_ADDRESS_LOOKUP'],\n  CIVICS_CAMPAIGN_FINANCE: ['CIVICS_REPRESENTATIVE_DATABASE'],\n  CIVICS_VOTING_RECORDS: ['CIVICS_REPRESENTATIVE_DATABASE'],\n  CANDIDATE_ACCOUNTABILITY: ['CIVICS_REPRESENTATIVE_DATABASE'],\n  CANDIDATE_CARDS: ['CIVICS_REPRESENTATIVE_DATABASE'],\n  ALTERNATIVE_CANDIDATES: ['CIVICS_REPRESENTATIVE_DATABASE'],\n  AUTOMATED_POLLS: ['ANALYTICS'],\n  DEMOGRAPHIC_FILTERING: ['ANALYTICS'],\n  TRENDING_POLLS: ['ANALYTICS'],\n  SOCIAL_SHARING_POLLS: ['SOCIAL_SHARING'],\n  SOCIAL_SHARING_CIVICS: ['SOCIAL_SHARING'],\n  SOCIAL_SHARING_VISUAL: ['SOCIAL_SHARING'],\n  SOCIAL_SHARING_OG: ['SOCIAL_SHARING'],\n  SOCIAL_SIGNUP: ['SOCIAL_SHARING'],\n  CONTACT_INFORMATION_SYSTEM: ['CIVICS_REPRESENTATIVE_DATABASE'],\n  DEVICE_FLOW_AUTH: ['CORE_AUTH'],\n  // Legacy dependencies\n  AIFeaturesFeature: ['ANALYTICS'],\n  AdvancedPrivacyFeature: ['ADVANCED_PRIVACY'],\n  AnalyticsFeature: ['ANALYTICS'],\n  PWAFeature: ['PWA'],\n  AdminFeature: ['ADMIN'],\n  AuditFeature: ['ADMIN'],\n  ExperimentalUIFeature: ['ANALYTICS'],\n  VotingFeature: ['CORE_POLLS'],\n  DatabaseFeature: ['CORE_AUTH'],\n  APIFeature: ['CORE_AUTH'],\n  UIFeature: ['CORE_AUTH'],\n  AuthFeature: ['CORE_AUTH']\n};\n\n// Feature Flag Manager Implementation\nclass FeatureFlagManagerImpl implements FeatureFlagManager {\n  private flags: Record<string, boolean>;\n  private subscribers: Set<(flags: Record<string, boolean>) => void>;\n  private metadata: Map<string, Record<string, unknown>>;\n\n  constructor() {\n    this.flags = { ...FEATURE_FLAGS };\n    this.subscribers = new Set();\n    this.metadata = new Map();\n    \n    // Initialize metadata\n    this.initializeMetadata();\n    \n    logger.info('Feature flag manager initialized', {\n      totalFlags: Object.keys(this.flags).length,\n      enabledFlags: Object.values(this.flags).filter(Boolean).length\n    });\n  }\n\n  private initializeMetadata(): void {\n    Object.keys(this.flags).forEach(flagId => {\n      this.metadata.set(flagId, {\n        category: this.getCategoryForFlag(flagId),\n        dependencies: FEATURE_FLAG_DEPENDENCIES[flagId] || [],\n        description: `Feature flag for ${flagId.toLowerCase().replace(/_/g, ' ')}`,\n        lastModified: new Date().toISOString()\n      });\n    });\n  }\n\n  private getCategoryForFlag(flagId: string): string {\n    for (const [category, flags] of Object.entries(FEATURE_FLAG_CATEGORIES)) {\n      if (flags.includes(flagId)) {\n        return category;\n      }\n    }\n    return 'general';\n  }\n\n  isEnabled(flagId: string): boolean {\n    const normalizedId = this.normalizeFlagId(flagId);\n    return this.flags[normalizedId] === true;\n  }\n\n  isDisabled(flagId: string): boolean {\n    return !this.isEnabled(flagId);\n  }\n\n  enable(flagId: string): boolean {\n    const normalizedId = this.normalizeFlagId(flagId);\n    \n    if (!(normalizedId in this.flags)) {\n      logger.warn('Attempted to enable unknown feature flag', { flagId: normalizedId });\n      return false;\n    }\n\n    if (this.flags[normalizedId] === true) {\n      return true; // Already enabled\n    }\n\n    // Check dependencies\n    if (!this.areDependenciesEnabled(normalizedId)) {\n      logger.warn('Cannot enable feature flag - dependencies not met', { \n        flagId: normalizedId, \n        dependencies: FEATURE_FLAG_DEPENDENCIES[normalizedId] \n      });\n      return false;\n    }\n\n    this.flags[normalizedId] = true;\n    this.notifySubscribers();\n    \n    logger.info('Feature flag enabled', { flagId: normalizedId });\n    return true;\n  }\n\n  disable(flagId: string): boolean {\n    const normalizedId = this.normalizeFlagId(flagId);\n    \n    if (!(normalizedId in this.flags)) {\n      logger.warn('Attempted to disable unknown feature flag', { flagId: normalizedId });\n      return false;\n    }\n\n    if (this.flags[normalizedId] === false) {\n      return true; // Already disabled\n    }\n\n    this.flags[normalizedId] = false;\n    this.notifySubscribers();\n    \n    logger.info('Feature flag disabled', { flagId: normalizedId });\n    return true;\n  }\n\n  toggle(flagId: string): boolean {\n    const normalizedId = this.normalizeFlagId(flagId);\n    \n    if (this.isEnabled(normalizedId)) {\n      return this.disable(normalizedId);\n    } else {\n      return this.enable(normalizedId);\n    }\n  }\n\n  getFlag(flagId: string): FeatureFlag | undefined {\n    const normalizedId = this.normalizeFlagId(flagId);\n    \n    if (!(normalizedId in this.flags)) {\n      return undefined;\n    }\n\n    const metadata = this.metadata.get(normalizedId) || {};\n    \n    return {\n      id: normalizedId,\n      name: normalizedId.replace(/_/g, ' ').toLowerCase().replace(/\\b\\w/g, l => l.toUpperCase()),\n      enabled: this.flags[normalizedId] ?? false,\n      description: metadata.description as string || `Feature flag for ${normalizedId.toLowerCase().replace(/_/g, ' ')}`,\n      category: metadata.category as string,\n      dependencies: metadata.dependencies as string[],\n      metadata\n    };\n  }\n\n  getAllFlags(): Map<string, FeatureFlag> {\n    const flags = new Map<string, FeatureFlag>();\n    \n    Object.keys(this.flags).forEach(flagId => {\n      const flag = this.getFlag(flagId);\n      if (flag) {\n        flags.set(flagId, flag);\n      }\n    });\n    \n    return flags;\n  }\n\n  getEnabledFlags(): FeatureFlag[] {\n    return Array.from(this.getAllFlags().values()).filter(flag => flag.enabled);\n  }\n\n  getDisabledFlags(): FeatureFlag[] {\n    return Array.from(this.getAllFlags().values()).filter(flag => !flag.enabled);\n  }\n\n  getFlagsByCategory(category: keyof typeof FEATURE_FLAG_CATEGORIES): FeatureFlag[] {\n    const categoryFlags = FEATURE_FLAG_CATEGORIES[category] || [];\n    return Array.from(this.getAllFlags().values()).filter(flag => \n      categoryFlags.includes(flag.id)\n    );\n  }\n\n  getSystemInfo(): {\n    totalFlags: number;\n    enabledFlags: number;\n    disabledFlags: number;\n    environment: string;\n    categories: Record<string, number>;\n  } {\n    const allFlags = this.getAllFlags();\n    const enabledFlags = this.getEnabledFlags();\n    const disabledFlags = this.getDisabledFlags();\n    \n    const categories: Record<string, number> = {};\n    Object.keys(FEATURE_FLAG_CATEGORIES).forEach(category => {\n      categories[category] = this.getFlagsByCategory(category as any).length;\n    });\n\n    return {\n      totalFlags: allFlags.size,\n      enabledFlags: enabledFlags.length,\n      disabledFlags: disabledFlags.length,\n      environment: process.env.NODE_ENV || 'development',\n      categories\n    };\n  }\n\n  subscribe(callback: (flags: Record<string, boolean>) => void): { unsubscribe: () => void } {\n    this.subscribers.add(callback);\n    \n    return {\n      unsubscribe: () => {\n        this.subscribers.delete(callback);\n      }\n    };\n  }\n\n  updateFlagMetadata(flagId: string, metadata: Record<string, unknown>): boolean {\n    const normalizedId = this.normalizeFlagId(flagId);\n    \n    if (!(normalizedId in this.flags)) {\n      logger.warn('Attempted to update metadata for unknown feature flag', { flagId: normalizedId });\n      return false;\n    }\n\n    const existingMetadata = this.metadata.get(normalizedId) || {};\n    this.metadata.set(normalizedId, { ...existingMetadata, ...metadata });\n    \n    logger.info('Feature flag metadata updated', { flagId: normalizedId, metadata });\n    return true;\n  }\n\n  reset(): void {\n    this.flags = { ...FEATURE_FLAGS };\n    this.initializeMetadata();\n    this.notifySubscribers();\n    \n    logger.info('Feature flags reset to defaults');\n  }\n\n  exportConfig(): FeatureFlagConfig {\n    return {\n      flags: { ...this.flags },\n      categories: { ...FEATURE_FLAG_CATEGORIES },\n      environment: process.env.NODE_ENV || 'development',\n      version: '1.0.0'\n    };\n  }\n\n  importConfig(config: FeatureFlagConfig): void {\n    if (config.flags) {\n      this.flags = { ...config.flags };\n    }\n    \n    this.notifySubscribers();\n    \n    logger.info('Feature flag configuration imported', { \n      totalFlags: Object.keys(this.flags).length \n    });\n  }\n\n  areDependenciesEnabled(flagId: string): boolean {\n    const dependencies = FEATURE_FLAG_DEPENDENCIES[flagId] || [];\n    return dependencies.every(dep => this.isEnabled(dep));\n  }\n\n  private normalizeFlagId(flagId: string): string {\n    // Handle case-insensitive lookups and legacy naming\n    const normalized = flagId.toUpperCase();\n    \n    // Check for exact match first\n    if (normalized in this.flags) {\n      return normalized;\n    }\n    \n    // Check for legacy naming patterns\n    const legacyMappings: Record<string, string> = {\n      'AUTHENTICATION': 'CORE_AUTH',\n      'POLLS': 'CORE_POLLS',\n      'USERS': 'CORE_USERS',\n      'ANALYTICS': 'ANALYTICS',\n      'PWA': 'PWA',\n      'ADMIN': 'ADMIN',\n      'WEBAUTHN': 'WEBAUTHN',\n      'FEEDBACK_WIDGET': 'FEEDBACK_WIDGET',\n      'ENHANCED_PROFILE': 'ENHANCED_PROFILE',\n      'ENHANCED_POLLS': 'ENHANCED_POLLS',\n      'ENHANCED_VOTING': 'ENHANCED_VOTING',\n      'CIVICS_ADDRESS_LOOKUP': 'CIVICS_ADDRESS_LOOKUP',\n      'CIVICS_REPRESENTATIVE_DATABASE': 'CIVICS_REPRESENTATIVE_DATABASE',\n      'CIVICS_CAMPAIGN_FINANCE': 'CIVICS_CAMPAIGN_FINANCE',\n      'CIVICS_VOTING_RECORDS': 'CIVICS_VOTING_RECORDS',\n      'CANDIDATE_ACCOUNTABILITY': 'CANDIDATE_ACCOUNTABILITY',\n      'CANDIDATE_CARDS': 'CANDIDATE_CARDS',\n      'ALTERNATIVE_CANDIDATES': 'ALTERNATIVE_CANDIDATES',\n      'AUTOMATED_POLLS': 'AUTOMATED_POLLS',\n      'DEMOGRAPHIC_FILTERING': 'DEMOGRAPHIC_FILTERING',\n      'TRENDING_POLLS': 'TRENDING_POLLS',\n      'PERFORMANCE_OPTIMIZATION': 'PERFORMANCE_OPTIMIZATION',\n      'FEATURE_DB_OPTIMIZATION_SUITE': 'FEATURE_DB_OPTIMIZATION_SUITE',\n      'EXPERIMENTAL_UI': 'EXPERIMENTAL_UI',\n      'EXPERIMENTAL_ANALYTICS': 'EXPERIMENTAL_ANALYTICS',\n      'EXPERIMENTAL_COMPONENTS': 'EXPERIMENTAL_COMPONENTS',\n      'ADVANCED_PRIVACY': 'ADVANCED_PRIVACY',\n      'SOCIAL_SHARING': 'SOCIAL_SHARING',\n      'AI_FEATURES': 'AI_FEATURES'\n    };\n    \n    if (normalized in legacyMappings) {\n      return legacyMappings[normalized] || normalized;\n    }\n    \n    return normalized;\n  }\n\n  private notifySubscribers(): void {\n    this.subscribers.forEach(callback => {\n      try {\n        callback({ ...this.flags });\n      } catch (error) {\n        logger.error('Error in feature flag subscriber', error instanceof Error ? error : new Error(String(error)));\n      }\n    });\n  }\n}\n\n// Create and export the feature flag manager instance\nexport const featureFlagManager = new FeatureFlagManagerImpl();\n\n// Export convenience functions\nexport const isFeatureEnabled = (flagId: string): boolean => featureFlagManager.isEnabled(flagId);\nexport const enableFeature = (flagId: string): boolean => featureFlagManager.enable(flagId);\nexport const disableFeature = (flagId: string): boolean => featureFlagManager.disable(flagId);\nexport const toggleFeature = (flagId: string): boolean => featureFlagManager.toggle(flagId);\nexport const getFeatureFlag = (flagId: string): FeatureFlag | undefined => featureFlagManager.getFlag(flagId);\nexport const getAllFeatureFlags = (): Map<string, FeatureFlag> => featureFlagManager.getAllFlags();\n\n// Types are already exported at the top of the file"],"names":["FEATURE_FLAGS","FEATURE_FLAG_CATEGORIES","FEATURE_FLAG_DEPENDENCIES","disableFeature","enableFeature","featureFlagManager","getAllFeatureFlags","getFeatureFlag","isFeatureEnabled","toggleFeature","WEBAUTHN","PWA","ADMIN","FEEDBACK_WIDGET","USER_SUGGESTIONS_MANAGER","ENHANCED_PROFILE","ENHANCED_POLLS","ENHANCED_VOTING","CIVICS_ADDRESS_LOOKUP","CIVICS_REPRESENTATIVE_DATABASE","CIVICS_CAMPAIGN_FINANCE","CIVICS_VOTING_RECORDS","CANDIDATE_ACCOUNTABILITY","CANDIDATE_CARDS","ALTERNATIVE_CANDIDATES","AUTOMATED_POLLS","DEMOGRAPHIC_FILTERING","TRENDING_POLLS","ADVANCED_PRIVACY","MEDIA_BIAS_ANALYSIS","POLL_NARRATIVE_SYSTEM","SOCIAL_SHARING","SOCIAL_SHARING_POLLS","SOCIAL_SHARING_CIVICS","SOCIAL_SHARING_VISUAL","SOCIAL_SHARING_OG","SOCIAL_SIGNUP","CONTACT_INFORMATION_SYSTEM","CIVICS_TESTING_STRATEGY","DEVICE_FLOW_AUTH","PERFORMANCE_OPTIMIZATION","FEATURE_DB_OPTIMIZATION_SUITE","ANALYTICS","PUSH_NOTIFICATIONS","THEMES","ACCESSIBILITY","INTERNATIONALIZATION","CORE_AUTH","CORE_POLLS","CORE_USERS","EXPERIMENTAL_UIFeature","AIFeaturesFeature","AdvancedPrivacyFeature","AnalyticsFeature","PWAFeature","AdminFeature","AuditFeature","ExperimentalUIFeature","VotingFeature","DatabaseFeature","APIFeature","UIFeature","AuthFeature","core","enhanced","civics","future","performance","social","system","analytics","admin","contact","testing","auth","legacy","FeatureFlagManagerImpl","constructor","flags","subscribers","Set","metadata","Map","initializeMetadata","logger","info","totalFlags","Object","keys","length","enabledFlags","values","filter","Boolean","forEach","flagId","set","category","getCategoryForFlag","dependencies","description","toLowerCase","replace","lastModified","Date","toISOString","entries","includes","isEnabled","normalizedId","normalizeFlagId","isDisabled","enable","warn","areDependenciesEnabled","notifySubscribers","disable","toggle","getFlag","undefined","get","id","name","l","toUpperCase","enabled","getAllFlags","flag","getEnabledFlags","Array","from","getDisabledFlags","getFlagsByCategory","categoryFlags","getSystemInfo","allFlags","disabledFlags","categories","size","environment","process","env","NODE_ENV","subscribe","callback","add","unsubscribe","delete","updateFlagMetadata","existingMetadata","reset","exportConfig","version","importConfig","config","every","dep","normalized","legacyMappings","error","Error","String"],"mappings":"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"}