2b4e33e1c22bc0426ad533630ddeed0e
/**
 * Debug API Route Test
 * 
 * This test helps debug what's causing the 500 error in the API route
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _globals = require("@jest/globals");
const _server = require("next/server");
const _route = require("../../../../app/api/polls/route");
// Set real Supabase credentials for integration testing
process.env.NEXT_PUBLIC_SUPABASE_URL = "https://muqwrehywjrbaeerjgfb.supabase.co";
process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY = "sb_publishable_tJOpGO2IPjujJDQou44P_g_BgbTFBfc";
process.env.SUPABASE_SECRET_KEY = "sb_publishable_tJOpGO2IPjujJDQou44P_g_BgbTFBfc";
(0, _globals.describe)("Debug API Route", ()=>{
    (0, _globals.it)("should debug the API route step by step", async ()=>{
        console.log("=== DEBUGGING API ROUTE ===");
        try {
            console.log("1. Creating NextRequest...");
            const request = new _server.NextRequest("http://localhost:3000/api/polls");
            console.log("✅ NextRequest created successfully");
            console.log("2. Calling GET function...");
            const response = await (0, _route.GET)(request);
            console.log("✅ GET function completed");
            console.log("3. Getting response status...");
            console.log("Response status:", response.status);
            console.log("4. Getting response data...");
            const responseData = await response.json();
            console.log("Response data:", JSON.stringify(responseData, null, 2));
            console.log("5. Checking response structure...");
            console.log("Has success property:", responseData.hasOwnProperty("success"));
            console.log("Has error property:", responseData.hasOwnProperty("error"));
            // For now, just check that we get some response
            (0, _globals.expect)(response).toBeDefined();
            (0, _globals.expect)(responseData).toBeDefined();
        } catch (error) {
            console.error("❌ Error in API route:", error);
            console.error("Error stack:", error.stack);
            throw error;
        }
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hbGF1Z2hpbmdraXRzdW5lL3NyYy9DaG9pY2VzL3dlYi90ZXN0cy9qZXN0L3VuaXQvYXBpL2RlYnVnLWFwaS1yb3V0ZS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogRGVidWcgQVBJIFJvdXRlIFRlc3RcbiAqIFxuICogVGhpcyB0ZXN0IGhlbHBzIGRlYnVnIHdoYXQncyBjYXVzaW5nIHRoZSA1MDAgZXJyb3IgaW4gdGhlIEFQSSByb3V0ZVxuICovXG5cbmltcG9ydCB7IGRlc2NyaWJlLCBpdCwgZXhwZWN0IH0gZnJvbSAnQGplc3QvZ2xvYmFscyc7XG5pbXBvcnQgeyBOZXh0UmVxdWVzdCB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB7IEdFVCB9IGZyb20gJ0AvYXBwL2FwaS9wb2xscy9yb3V0ZSc7XG5cbi8vIFNldCByZWFsIFN1cGFiYXNlIGNyZWRlbnRpYWxzIGZvciBpbnRlZ3JhdGlvbiB0ZXN0aW5nXG5wcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwgPSAnaHR0cHM6Ly9tdXF3cmVoeXdqcmJhZWVyamdmYi5zdXBhYmFzZS5jbyc7XG5wcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSA9ICdzYl9wdWJsaXNoYWJsZV90Sk9wR08ySVBqdWpKRFFvdTQ0UF9nX0JnYlRGQmZjJztcbnByb2Nlc3MuZW52LlNVUEFCQVNFX1NFQ1JFVF9LRVkgPSAnc2JfcHVibGlzaGFibGVfdEpPcEdPMklQanVqSkRRb3U0NFBfZ19CZ2JURkJmYyc7XG5cbmRlc2NyaWJlKCdEZWJ1ZyBBUEkgUm91dGUnLCAoKSA9PiB7XG4gIGl0KCdzaG91bGQgZGVidWcgdGhlIEFQSSByb3V0ZSBzdGVwIGJ5IHN0ZXAnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc29sZS5sb2coJz09PSBERUJVR0dJTkcgQVBJIFJPVVRFID09PScpO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICBjb25zb2xlLmxvZygnMS4gQ3JlYXRpbmcgTmV4dFJlcXVlc3QuLi4nKTtcbiAgICAgIGNvbnN0IHJlcXVlc3QgPSBuZXcgTmV4dFJlcXVlc3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvcG9sbHMnKTtcbiAgICAgIGNvbnNvbGUubG9nKCfinIUgTmV4dFJlcXVlc3QgY3JlYXRlZCBzdWNjZXNzZnVsbHknKTtcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJzIuIENhbGxpbmcgR0VUIGZ1bmN0aW9uLi4uJyk7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IEdFVChyZXF1ZXN0KTtcbiAgICAgIGNvbnNvbGUubG9nKCfinIUgR0VUIGZ1bmN0aW9uIGNvbXBsZXRlZCcpO1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnMy4gR2V0dGluZyByZXNwb25zZSBzdGF0dXMuLi4nKTtcbiAgICAgIGNvbnNvbGUubG9nKCdSZXNwb25zZSBzdGF0dXM6JywgcmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJzQuIEdldHRpbmcgcmVzcG9uc2UgZGF0YS4uLicpO1xuICAgICAgY29uc3QgcmVzcG9uc2VEYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgY29uc29sZS5sb2coJ1Jlc3BvbnNlIGRhdGE6JywgSlNPTi5zdHJpbmdpZnkocmVzcG9uc2VEYXRhLCBudWxsLCAyKSk7XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKCc1LiBDaGVja2luZyByZXNwb25zZSBzdHJ1Y3R1cmUuLi4nKTtcbiAgICAgIGNvbnNvbGUubG9nKCdIYXMgc3VjY2VzcyBwcm9wZXJ0eTonLCByZXNwb25zZURhdGEuaGFzT3duUHJvcGVydHkoJ3N1Y2Nlc3MnKSk7XG4gICAgICBjb25zb2xlLmxvZygnSGFzIGVycm9yIHByb3BlcnR5OicsIHJlc3BvbnNlRGF0YS5oYXNPd25Qcm9wZXJ0eSgnZXJyb3InKSk7XG4gICAgICBcbiAgICAgIC8vIEZvciBub3csIGp1c3QgY2hlY2sgdGhhdCB3ZSBnZXQgc29tZSByZXNwb25zZVxuICAgICAgZXhwZWN0KHJlc3BvbnNlKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlRGF0YSkudG9CZURlZmluZWQoKTtcbiAgICAgIFxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgRXJyb3IgaW4gQVBJIHJvdXRlOicsIGVycm9yKTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHN0YWNrOicsIGVycm9yLnN0YWNrKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfSk7XG59KTtcbiJdLCJuYW1lcyI6WyJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJTVVBBQkFTRV9TRUNSRVRfS0VZIiwiZGVzY3JpYmUiLCJpdCIsImNvbnNvbGUiLCJsb2ciLCJyZXF1ZXN0IiwiTmV4dFJlcXVlc3QiLCJyZXNwb25zZSIsIkdFVCIsInN0YXR1cyIsInJlc3BvbnNlRGF0YSIsImpzb24iLCJKU09OIiwic3RyaW5naWZ5IiwiaGFzT3duUHJvcGVydHkiLCJleHBlY3QiLCJ0b0JlRGVmaW5lZCIsImVycm9yIiwic3RhY2siXSwibWFwcGluZ3MiOiJBQUFBOzs7O0NBSUM7Ozs7eUJBRW9DO3dCQUNUO3VCQUNSO0FBRXBCLHdEQUF3RDtBQUN4REEsUUFBUUMsR0FBRyxDQUFDQyx3QkFBd0IsR0FBRztBQUN2Q0YsUUFBUUMsR0FBRyxDQUFDRSw2QkFBNkIsR0FBRztBQUM1Q0gsUUFBUUMsR0FBRyxDQUFDRyxtQkFBbUIsR0FBRztBQUVsQ0MsSUFBQUEsaUJBQVEsRUFBQyxtQkFBbUI7SUFDMUJDLElBQUFBLFdBQUUsRUFBQywyQ0FBMkM7UUFDNUNDLFFBQVFDLEdBQUcsQ0FBQztRQUVaLElBQUk7WUFDRkQsUUFBUUMsR0FBRyxDQUFDO1lBQ1osTUFBTUMsVUFBVSxJQUFJQyxtQkFBVyxDQUFDO1lBQ2hDSCxRQUFRQyxHQUFHLENBQUM7WUFFWkQsUUFBUUMsR0FBRyxDQUFDO1lBQ1osTUFBTUcsV0FBVyxNQUFNQyxJQUFBQSxVQUFHLEVBQUNIO1lBQzNCRixRQUFRQyxHQUFHLENBQUM7WUFFWkQsUUFBUUMsR0FBRyxDQUFDO1lBQ1pELFFBQVFDLEdBQUcsQ0FBQyxvQkFBb0JHLFNBQVNFLE1BQU07WUFFL0NOLFFBQVFDLEdBQUcsQ0FBQztZQUNaLE1BQU1NLGVBQWUsTUFBTUgsU0FBU0ksSUFBSTtZQUN4Q1IsUUFBUUMsR0FBRyxDQUFDLGtCQUFrQlEsS0FBS0MsU0FBUyxDQUFDSCxjQUFjLE1BQU07WUFFakVQLFFBQVFDLEdBQUcsQ0FBQztZQUNaRCxRQUFRQyxHQUFHLENBQUMseUJBQXlCTSxhQUFhSSxjQUFjLENBQUM7WUFDakVYLFFBQVFDLEdBQUcsQ0FBQyx1QkFBdUJNLGFBQWFJLGNBQWMsQ0FBQztZQUUvRCxnREFBZ0Q7WUFDaERDLElBQUFBLGVBQU0sRUFBQ1IsVUFBVVMsV0FBVztZQUM1QkQsSUFBQUEsZUFBTSxFQUFDTCxjQUFjTSxXQUFXO1FBRWxDLEVBQUUsT0FBT0MsT0FBTztZQUNkZCxRQUFRYyxLQUFLLENBQUMseUJBQXlCQTtZQUN2Q2QsUUFBUWMsS0FBSyxDQUFDLGdCQUFnQkEsTUFBTUMsS0FBSztZQUN6QyxNQUFNRDtRQUNSO0lBQ0Y7QUFDRiJ9