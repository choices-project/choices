{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/lib/vote/strategies/approval.ts"],"sourcesContent":["/**\n * Approval Voting Strategy\n * \n * Implements approval voting where voters can approve (vote for) multiple options.\n * Results show approval scores for each option, with the highest scoring option winning.\n * \n * Created: September 15, 2025\n * Updated: September 15, 2025\n */\n\nimport { devLog } from '@/lib/utils/logger';\nimport { withOptional } from '@/lib/utils/objects';\n\nimport type { \n  VotingStrategy, \n  VoteRequest, \n  VoteResponse, \n  VoteValidation, \n  PollData, \n  VoteData, \n  ResultsData,\n  VotingMethod,\n  PollResults\n} from '../types';\n\nexport class ApprovalStrategy implements VotingStrategy {\n  \n  getVotingMethod(): VotingMethod {\n    return 'approval';\n  }\n\n  async validateVote(request: VoteRequest, poll: PollData): Promise<VoteValidation> {\n    try {\n      const { voteData } = request;\n      \n      // Check if approvals array is provided\n      if (!voteData.approvals || !Array.isArray(voteData.approvals)) {\n        return {\n          valid: false,\n          errors: ['Approvals array is required for approval voting'],\n          requiresAuthentication: true,\n          requiresTokens: false\n        };\n      }\n\n      // Validate approvals array is not empty\n      if (voteData.approvals.length === 0) {\n        return {\n          valid: false,\n          errors: ['At least one option must be approved'],\n          requiresAuthentication: true,\n          requiresTokens: false\n        };\n      }\n\n      // Validate all approvals are valid integers\n      for (const approval of voteData.approvals) {\n        if (typeof approval !== 'number' || !Number.isInteger(approval)) {\n          return {\n            valid: false,\n            errors: ['All approvals must be valid integers'],\n            requiresAuthentication: true,\n            requiresTokens: false\n          };\n        }\n\n        if (approval < 0 || approval >= poll.options.length) {\n          return {\n            valid: false,\n            errors: ['Invalid option selected'],\n            requiresAuthentication: true,\n            requiresTokens: false\n          };\n        }\n      }\n\n      // Check for duplicate approvals\n      const uniqueApprovals = new Set(voteData.approvals);\n      if (uniqueApprovals.size !== voteData.approvals.length) {\n        return {\n          valid: false,\n          errors: ['Duplicate approvals are not allowed'],\n          requiresAuthentication: true,\n          requiresTokens: false\n        };\n      }\n\n      // Check maximum approvals limit\n      const maxApprovals = poll.maxChoices || poll.options.length;\n      if (voteData.approvals.length > maxApprovals) {\n        return {\n          valid: false,\n          errors: [`Maximum ${maxApprovals} approvals allowed`],\n          requiresAuthentication: true,\n          requiresTokens: false\n        };\n      }\n\n      devLog('Approval vote validated successfully', {\n        pollId: request.pollId,\n        approvals: voteData.approvals,\n        userId: request.userId\n      });\n\n      return {\n        valid: true,\n        requiresAuthentication: true,\n        requiresTokens: false\n      };\n\n    } catch (error) {\n      devLog('Approval vote validation error:', error);\n      return {\n        valid: false,\n        errors: [error instanceof Error ? error.message : 'Validation failed'],\n        requiresAuthentication: true,\n        requiresTokens: false\n      };\n    }\n  }\n\n  async processVote(request: VoteRequest, poll: PollData): Promise<VoteResponse> {\n    try {\n      const { voteData, userId, pollId, privacyLevel } = request;\n      \n      // Generate vote ID\n      const voteId = `vote_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n      \n      // Create audit receipt\n      const auditReceipt = `receipt_${voteId}_${Date.now()}`;\n\n      // Store the vote in the database\n      await this.saveVoteToDatabase({\n        pollId,\n        voteId,\n        userId,\n        voteData,\n        auditReceipt,\n        privacyLevel\n      });\n\n      devLog('Approval vote processed successfully', {\n        pollId,\n        voteId,\n        approvals: voteData.approvals,\n        userId,\n        auditReceipt\n      });\n\n      return {\n        success: true,\n        message: 'Vote submitted successfully',\n        pollId,\n        voteId,\n        auditReceipt,\n        responseTime: 0, // Will be set by the engine\n        metadata: {\n          votingMethod: 'approval',\n          approvals: voteData.approvals,\n          approvedOptions: voteData.approvals?.map(index => poll.options[index]?.text) || []\n        },\n        privacyLevel\n      };\n\n    } catch (error) {\n      devLog('Approval vote processing error:', error);\n      return {\n        success: false,\n        message: error instanceof Error ? error.message : 'Vote processing failed',\n        pollId: request.pollId,\n        responseTime: 0,\n        metadata: {\n          votingMethod: 'approval',\n          error: error instanceof Error ? error.message : 'Unknown error'\n        },\n        privacyLevel: request.privacyLevel\n      };\n    }\n  }\n\n  async calculateResults(poll: PollData, votes: VoteData[]): Promise<ResultsData> {\n    try {\n      const startTime = Date.now();\n      \n      // Count approval votes for each option\n      const approvalScores: Record<string, number> = {};\n      const approvalPercentages: Record<string, number> = {};\n      const optionVotes: Record<string, number> = {};\n      const optionPercentages: Record<string, number> = {};\n      \n      // Initialize scores\n      poll.options.forEach((_, index) => {\n        approvalScores[index.toString()] = 0;\n        approvalPercentages[index.toString()] = 0;\n        optionVotes[index.toString()] = 0;\n        optionPercentages[index.toString()] = 0;\n      });\n\n      // Count approvals\n      let totalVotes = 0;\n      votes.forEach(vote => {\n        if (vote.approvals && Array.isArray(vote.approvals)) {\n          totalVotes++;\n          vote.approvals.forEach(approval => {\n            if (approval !== undefined && approval >= 0 && approval < poll.options.length) {\n              const key = approval.toString();\n              approvalScores[key] = (approvalScores[key] ?? 0) + 1;\n              optionVotes[key] = (optionVotes[key] ?? 0) + 1;\n            }\n          });\n        }\n      });\n\n      // Calculate percentages\n      if (totalVotes > 0) {\n        Object.keys(approvalScores).forEach(optionIndex => {\n          const approvalScore = approvalScores[optionIndex];\n          const optionVote = optionVotes[optionIndex];\n          if (approvalScore !== undefined) {\n            approvalPercentages[optionIndex] = (approvalScore / totalVotes) * 100;\n          }\n          if (optionVote !== undefined) {\n            optionPercentages[optionIndex] = (optionVote / totalVotes) * 100;\n          }\n        });\n      }\n\n      // Find winner (highest approval score)\n      let winner: string | undefined;\n      let winnerVotes = 0;\n      let winnerPercentage = 0;\n\n      if (totalVotes > 0) {\n        Object.entries(approvalScores).forEach(([optionIndex, score]) => {\n          if (score > winnerVotes) {\n            winner = optionIndex;\n            winnerVotes = score;\n            const percentage = approvalPercentages[optionIndex];\n            winnerPercentage = percentage ?? 0;\n          }\n        });\n      }\n\n      const results: PollResults = {\n        winner,\n        winnerVotes,\n        winnerPercentage,\n        approvalScores,\n        approvalPercentages,\n        optionVotes,\n        optionPercentages,\n        abstentions: 0,\n        abstentionPercentage: 0\n      };\n\n      const resultsData: ResultsData = {\n        pollId: poll.id,\n        votingMethod: 'approval',\n        totalVotes,\n        participationRate: totalVotes > 0 ? 100 : 0, // This would be calculated based on eligible voters\n        results,\n        calculatedAt: new Date().toISOString(),\n        metadata: {\n          calculationTime: Date.now() - startTime,\n          hasWinner: winner !== undefined,\n          isTie: winnerVotes > 0 && Object.values(approvalScores).filter(s => s === winnerVotes).length > 1,\n          averageApprovals: totalVotes > 0 ? votes.reduce((sum, vote) => sum + (vote.approvals?.length || 0), 0) / totalVotes : 0\n        }\n      };\n\n      devLog('Approval results calculated', {\n        pollId: poll.id,\n        totalVotes,\n        winner,\n        winnerVotes,\n        winnerPercentage,\n        calculationTime: Date.now() - startTime\n      });\n\n      return resultsData;\n\n    } catch (error) {\n      devLog('Approval results calculation error:', error);\n      throw new Error(`Failed to calculate approval results: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n\n  getConfiguration(): Record<string, unknown> {\n    return {\n      name: 'Approval Voting',\n      description: 'Voters can approve (vote for) multiple options. The option with the most approvals wins.',\n      minOptions: 2,\n      maxOptions: 100,\n      allowAbstention: true,\n      requiresRanking: false,\n      allowsMultipleSelections: true,\n      resultType: 'highest_score',\n      features: [\n        'Allows multiple selections',\n        'Simple to understand',\n        'Reduces vote splitting',\n        'Good for consensus building'\n      ],\n      limitations: [\n        'No intensity of preference',\n        'May not reflect true preferences',\n        'Can lead to strategic voting'\n      ]\n    };\n  }\n\n  private async saveVoteToDatabase(voteData: {\n    pollId: string;\n    voteId: string;\n    userId?: string;\n    voteData: any;\n    auditReceipt: string;\n    privacyLevel?: string;\n  }): Promise<void> {\n    try {\n      // Import the VoteEngine to use its saveVote method\n      const { VoteEngine } = await import('../engine');\n      const engine = new VoteEngine();\n      \n      // Use the engine's saveVote method to persist the vote\n      await engine.saveVote(voteData.voteData, {\n        pollId: voteData.pollId,\n        voteId: voteData.voteId,\n        userId: voteData.userId,\n        auditReceipt: voteData.auditReceipt,\n        privacyLevel: voteData.privacyLevel\n      });\n      \n      devLog('Vote saved to database successfully', {\n        pollId: voteData.pollId,\n        voteId: voteData.voteId,\n        userId: voteData.userId\n      });\n    } catch (error) {\n      devLog('Failed to save vote to database:', error);\n      throw new Error(`Database save failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n}"],"names":["ApprovalStrategy","getVotingMethod","validateVote","request","poll","voteData","approvals","Array","isArray","valid","errors","requiresAuthentication","requiresTokens","length","approval","Number","isInteger","options","uniqueApprovals","Set","size","maxApprovals","maxChoices","devLog","pollId","userId","error","Error","message","processVote","privacyLevel","voteId","Date","now","Math","random","toString","substr","auditReceipt","saveVoteToDatabase","success","responseTime","metadata","votingMethod","approvedOptions","map","index","text","calculateResults","votes","startTime","approvalScores","approvalPercentages","optionVotes","optionPercentages","forEach","_","totalVotes","vote","undefined","key","Object","keys","optionIndex","approvalScore","optionVote","winner","winnerVotes","winnerPercentage","entries","score","percentage","results","abstentions","abstentionPercentage","resultsData","id","participationRate","calculatedAt","toISOString","calculationTime","hasWinner","isTie","values","filter","s","averageApprovals","reduce","sum","getConfiguration","name","description","minOptions","maxOptions","allowAbstention","requiresRanking","allowsMultipleSelections","resultType","features","limitations","VoteEngine","engine","saveVote"],"mappings":"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"}