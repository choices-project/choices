{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/tests/jest/unit/components/features/pwa/pwa-features-simple.test.tsx"],"sourcesContent":["/**\n * @jest-environment jsdom\n */\n\n// Mock window.matchMedia before any imports\nObject.defineProperty(window, 'matchMedia', {\n  value: jest.fn().mockImplementation(query => ({\n    matches: false,\n    media: query,\n    onchange: null,\n    addListener: jest.fn(),\n    removeListener: jest.fn(),\n    addEventListener: jest.fn(),\n    removeEventListener: jest.fn(),\n    dispatchEvent: jest.fn(),\n  })),\n  writable: true,\n});\n\n// Mock browser APIs\nObject.defineProperty(navigator, 'serviceWorker', {\n  value: {\n    register: jest.fn(),\n    ready: Promise.resolve(),\n  },\n  writable: true,\n});\n\n// Mock online/offline events\nObject.defineProperty(navigator, 'onLine', {\n  value: true,\n  writable: true,\n});\n\n// Mock PWA store\njest.mock('@/lib/stores', () => ({\n  usePWAInstallation: jest.fn(() => ({\n    isInstalled: false,\n    canInstall: true,\n    install: jest.fn(),\n    checkInstallationStatus: jest.fn(),\n  })),\n  usePWAOffline: jest.fn(() => ({\n    isOnline: true,\n    offlineData: {},\n    syncOfflineData: jest.fn(),\n    clearOfflineData: jest.fn(),\n  })),\n  usePWANotifications: jest.fn(() => ({\n    permission: 'default',\n    requestPermission: jest.fn(),\n    showNotification: jest.fn(),\n  })),\n  usePWALoading: jest.fn(() => false),\n  usePWAError: jest.fn(() => null),\n}));\n\nimport React from 'react';\nimport { render, screen } from '@testing-library/react';\nimport { BrowserRouter } from 'react-router-dom';\nimport PWAFeatures from '@/features/pwa/components/PWAFeatures';\nimport { T } from '@/lib/testing/testIds';\n\ndescribe('PWA Features - Simple Testing', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('Component Rendering', () => {\n    it('should render PWA features when installation is available', () => {\n      render(\n        <BrowserRouter>\n          <PWAFeatures />\n        </BrowserRouter>\n      );\n\n      // Check for basic PWA elements\n      expect(screen.getByTestId(T.pwa.status)).toBeInTheDocument();\n      expect(screen.getByTestId(T.pwa.installButton)).toBeInTheDocument();\n    });\n\n    it('should render with custom className', () => {\n      render(\n        <BrowserRouter>\n          <PWAFeatures className=\"custom-class\" />\n        </BrowserRouter>\n      );\n\n      const container = screen.getByTestId(T.pwa.status);\n      expect(container).toHaveClass('custom-class');\n    });\n  });\n\n  describe('Offline Features', () => {\n    it('should display offline indicator when offline', () => {\n      // Mock offline state\n      const { usePWAOffline } = require('@/lib/stores');\n      usePWAOffline.mockReturnValue({\n        isOnline: false,\n        offlineData: {},\n        syncOfflineData: jest.fn(),\n        clearOfflineData: jest.fn(),\n      });\n\n      render(\n        <BrowserRouter>\n          <PWAFeatures />\n        </BrowserRouter>\n      );\n\n      expect(screen.getByTestId(T.pwa.offlineIndicator)).toBeInTheDocument();\n    });\n  });\n\n  describe('Performance', () => {\n    it('should render within performance budget', async () => {\n      const startTime = performance.now();\n      \n      render(\n        <BrowserRouter>\n          <PWAFeatures />\n        </BrowserRouter>\n      );\n      \n      const endTime = performance.now();\n      const renderTime = endTime - startTime;\n      \n      // Should render within 100ms\n      expect(renderTime).toBeLessThan(100);\n    });\n\n    it('should not cause memory leaks', () => {\n      const { unmount } = render(\n        <BrowserRouter>\n          <PWAFeatures />\n        </BrowserRouter>\n      );\n\n      // Unmount component\n      unmount();\n\n      // Should not leave any event listeners or timers\n      expect(jest.getTimerCount()).toBe(0);\n    });\n  });\n});\n"],"names":["jest","mock","usePWAInstallation","fn","isInstalled","canInstall","install","checkInstallationStatus","usePWAOffline","isOnline","offlineData","syncOfflineData","clearOfflineData","usePWANotifications","permission","requestPermission","showNotification","usePWALoading","usePWAError","Object","defineProperty","window","value","mockImplementation","query","matches","media","onchange","addListener","removeListener","addEventListener","removeEventListener","dispatchEvent","writable","navigator","register","ready","Promise","resolve","describe","beforeEach","clearAllMocks","it","render","BrowserRouter","PWAFeatures","expect","screen","getByTestId","T","pwa","status","toBeInTheDocument","installButton","className","container","toHaveClass","require","mockReturnValue","offlineIndicator","startTime","performance","now","endTime","renderTime","toBeLessThan","unmount","getTimerCount","toBe"],"mappings":"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"}