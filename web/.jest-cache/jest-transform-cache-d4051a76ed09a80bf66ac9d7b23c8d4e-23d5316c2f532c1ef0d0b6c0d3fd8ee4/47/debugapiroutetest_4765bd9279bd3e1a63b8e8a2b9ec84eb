371389b6cd668b16776d39cdb744f8ef
/**
 * Debug API Route Test
 * 
 * This test helps debug what's causing the 500 error in the API route
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _globals = require("@jest/globals");
const _server = require("next/server");
const _route = require("../../../../app/api/polls/route");
// Set real Supabase credentials for integration testing
process.env.NEXT_PUBLIC_SUPABASE_URL = "https://muqwrehywjrbaeerjgfb.supabase.co";
process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY = "sb_publishable_tJOpGO2IPjujJDQou44P_g_BgbTFBfc";
(0, _globals.describe)("Debug API Route", ()=>{
    (0, _globals.it)("should debug the API route step by step", async ()=>{
        console.log("=== DEBUGGING API ROUTE ===");
        try {
            console.log("1. Creating NextRequest...");
            const request = new _server.NextRequest("http://localhost:3000/api/polls");
            console.log("✅ NextRequest created successfully");
            console.log("2. Calling GET function...");
            const response = await (0, _route.GET)(request);
            console.log("✅ GET function completed");
            console.log("3. Getting response status...");
            console.log("Response status:", response.status);
            console.log("4. Getting response data...");
            const responseData = await response.json();
            console.log("Response data:", JSON.stringify(responseData, null, 2));
            console.log("5. Checking response structure...");
            console.log("Has success property:", responseData.hasOwnProperty("success"));
            console.log("Has error property:", responseData.hasOwnProperty("error"));
            // For now, just check that we get some response
            (0, _globals.expect)(response).toBeDefined();
            (0, _globals.expect)(responseData).toBeDefined();
        } catch (error) {
            console.error("❌ Error in API route:", error);
            console.error("Error stack:", error.stack);
            throw error;
        }
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hbGF1Z2hpbmdraXRzdW5lL3NyYy9DaG9pY2VzL3dlYi90ZXN0cy9qZXN0L3VuaXQvYXBpL2RlYnVnLWFwaS1yb3V0ZS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogRGVidWcgQVBJIFJvdXRlIFRlc3RcbiAqIFxuICogVGhpcyB0ZXN0IGhlbHBzIGRlYnVnIHdoYXQncyBjYXVzaW5nIHRoZSA1MDAgZXJyb3IgaW4gdGhlIEFQSSByb3V0ZVxuICovXG5cbmltcG9ydCB7IGRlc2NyaWJlLCBpdCwgZXhwZWN0IH0gZnJvbSAnQGplc3QvZ2xvYmFscyc7XG5pbXBvcnQgeyBOZXh0UmVxdWVzdCB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB7IEdFVCB9IGZyb20gJ0AvYXBwL2FwaS9wb2xscy9yb3V0ZSc7XG5cbi8vIFNldCByZWFsIFN1cGFiYXNlIGNyZWRlbnRpYWxzIGZvciBpbnRlZ3JhdGlvbiB0ZXN0aW5nXG5wcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwgPSAnaHR0cHM6Ly9tdXF3cmVoeXdqcmJhZWVyamdmYi5zdXBhYmFzZS5jbyc7XG5wcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSA9ICdzYl9wdWJsaXNoYWJsZV90Sk9wR08ySVBqdWpKRFFvdTQ0UF9nX0JnYlRGQmZjJztcblxuZGVzY3JpYmUoJ0RlYnVnIEFQSSBSb3V0ZScsICgpID0+IHtcbiAgaXQoJ3Nob3VsZCBkZWJ1ZyB0aGUgQVBJIHJvdXRlIHN0ZXAgYnkgc3RlcCcsIGFzeW5jICgpID0+IHtcbiAgICBjb25zb2xlLmxvZygnPT09IERFQlVHR0lORyBBUEkgUk9VVEUgPT09Jyk7XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKCcxLiBDcmVhdGluZyBOZXh0UmVxdWVzdC4uLicpO1xuICAgICAgY29uc3QgcmVxdWVzdCA9IG5ldyBOZXh0UmVxdWVzdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9wb2xscycpO1xuICAgICAgY29uc29sZS5sb2coJ+KchSBOZXh0UmVxdWVzdCBjcmVhdGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnMi4gQ2FsbGluZyBHRVQgZnVuY3Rpb24uLi4nKTtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgR0VUKHJlcXVlc3QpO1xuICAgICAgY29uc29sZS5sb2coJ+KchSBHRVQgZnVuY3Rpb24gY29tcGxldGVkJyk7XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKCczLiBHZXR0aW5nIHJlc3BvbnNlIHN0YXR1cy4uLicpO1xuICAgICAgY29uc29sZS5sb2coJ1Jlc3BvbnNlIHN0YXR1czonLCByZXNwb25zZS5zdGF0dXMpO1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnNC4gR2V0dGluZyByZXNwb25zZSBkYXRhLi4uJyk7XG4gICAgICBjb25zdCByZXNwb25zZURhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICBjb25zb2xlLmxvZygnUmVzcG9uc2UgZGF0YTonLCBKU09OLnN0cmluZ2lmeShyZXNwb25zZURhdGEsIG51bGwsIDIpKTtcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJzUuIENoZWNraW5nIHJlc3BvbnNlIHN0cnVjdHVyZS4uLicpO1xuICAgICAgY29uc29sZS5sb2coJ0hhcyBzdWNjZXNzIHByb3BlcnR5OicsIHJlc3BvbnNlRGF0YS5oYXNPd25Qcm9wZXJ0eSgnc3VjY2VzcycpKTtcbiAgICAgIGNvbnNvbGUubG9nKCdIYXMgZXJyb3IgcHJvcGVydHk6JywgcmVzcG9uc2VEYXRhLmhhc093blByb3BlcnR5KCdlcnJvcicpKTtcbiAgICAgIFxuICAgICAgLy8gRm9yIG5vdywganVzdCBjaGVjayB0aGF0IHdlIGdldCBzb21lIHJlc3BvbnNlXG4gICAgICBleHBlY3QocmVzcG9uc2UpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocmVzcG9uc2VEYXRhKS50b0JlRGVmaW5lZCgpO1xuICAgICAgXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciBpbiBBUEkgcm91dGU6JywgZXJyb3IpO1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3Igc3RhY2s6JywgZXJyb3Iuc3RhY2spO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9KTtcbn0pO1xuIl0sIm5hbWVzIjpbInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsImRlc2NyaWJlIiwiaXQiLCJjb25zb2xlIiwibG9nIiwicmVxdWVzdCIsIk5leHRSZXF1ZXN0IiwicmVzcG9uc2UiLCJHRVQiLCJzdGF0dXMiLCJyZXNwb25zZURhdGEiLCJqc29uIiwiSlNPTiIsInN0cmluZ2lmeSIsImhhc093blByb3BlcnR5IiwiZXhwZWN0IiwidG9CZURlZmluZWQiLCJlcnJvciIsInN0YWNrIl0sIm1hcHBpbmdzIjoiQUFBQTs7OztDQUlDOzs7O3lCQUVvQzt3QkFDVDt1QkFDUjtBQUVwQix3REFBd0Q7QUFDeERBLFFBQVFDLEdBQUcsQ0FBQ0Msd0JBQXdCLEdBQUc7QUFDdkNGLFFBQVFDLEdBQUcsQ0FBQ0UsNkJBQTZCLEdBQUc7QUFFNUNDLElBQUFBLGlCQUFRLEVBQUMsbUJBQW1CO0lBQzFCQyxJQUFBQSxXQUFFLEVBQUMsMkNBQTJDO1FBQzVDQyxRQUFRQyxHQUFHLENBQUM7UUFFWixJQUFJO1lBQ0ZELFFBQVFDLEdBQUcsQ0FBQztZQUNaLE1BQU1DLFVBQVUsSUFBSUMsbUJBQVcsQ0FBQztZQUNoQ0gsUUFBUUMsR0FBRyxDQUFDO1lBRVpELFFBQVFDLEdBQUcsQ0FBQztZQUNaLE1BQU1HLFdBQVcsTUFBTUMsSUFBQUEsVUFBRyxFQUFDSDtZQUMzQkYsUUFBUUMsR0FBRyxDQUFDO1lBRVpELFFBQVFDLEdBQUcsQ0FBQztZQUNaRCxRQUFRQyxHQUFHLENBQUMsb0JBQW9CRyxTQUFTRSxNQUFNO1lBRS9DTixRQUFRQyxHQUFHLENBQUM7WUFDWixNQUFNTSxlQUFlLE1BQU1ILFNBQVNJLElBQUk7WUFDeENSLFFBQVFDLEdBQUcsQ0FBQyxrQkFBa0JRLEtBQUtDLFNBQVMsQ0FBQ0gsY0FBYyxNQUFNO1lBRWpFUCxRQUFRQyxHQUFHLENBQUM7WUFDWkQsUUFBUUMsR0FBRyxDQUFDLHlCQUF5Qk0sYUFBYUksY0FBYyxDQUFDO1lBQ2pFWCxRQUFRQyxHQUFHLENBQUMsdUJBQXVCTSxhQUFhSSxjQUFjLENBQUM7WUFFL0QsZ0RBQWdEO1lBQ2hEQyxJQUFBQSxlQUFNLEVBQUNSLFVBQVVTLFdBQVc7WUFDNUJELElBQUFBLGVBQU0sRUFBQ0wsY0FBY00sV0FBVztRQUVsQyxFQUFFLE9BQU9DLE9BQU87WUFDZGQsUUFBUWMsS0FBSyxDQUFDLHlCQUF5QkE7WUFDdkNkLFFBQVFjLEtBQUssQ0FBQyxnQkFBZ0JBLE1BQU1DLEtBQUs7WUFDekMsTUFBTUQ7UUFDUjtJQUNGO0FBQ0YifQ==