{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/tests/jest/helpers/seed-test-data-working.ts"],"sourcesContent":["/**\n * Test Data Seeding Helper - Working Version\n * \n * This version uses the correct data format that works with the database\n * \n * Created: January 27, 2025\n * Status: ‚úÖ PRODUCTION READY\n */\n\nexport interface TestPoll {\n  id?: string;\n  title: string;\n  description: string;\n  options: string[];\n  voting_method: 'single' | 'multiple'; // Correct values from database\n  status: 'draft' | 'active' | 'closed';\n  created_by: string; // Must be a valid user ID from the database\n  end_date?: string;\n  settings: Record<string, any>;\n  hashtags: string[];\n  poll_settings: Record<string, any>;\n  privacy_level: string;\n  category?: string;\n  tags?: string[];\n  primary_hashtag?: string;\n  total_votes?: number;\n  participation_rate?: number;\n}\n\nexport const TEST_POLLS: TestPoll[] = [\n  {\n    title: \"What's your favorite programming language?\",\n    description: \"Help us understand the community's preferences for programming languages in 2025.\",\n    options: [\"JavaScript/TypeScript\", \"Python\", \"Rust\", \"Go\", \"Java\", \"C++\"],\n    voting_method: \"single\", // Correct value\n    status: \"active\",\n    created_by: \"6f12e40c-fd46-4ace-9470-2016dc0e2e8b\", // Valid user ID from database\n    end_date: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString(), // 7 days from now\n    settings: {\n      allow_anonymous: true,\n      show_results_before_close: true,\n      allow_multiple_votes: false\n    },\n    hashtags: [\"programming\", \"technology\", \"development\"],\n    poll_settings: {\n      voting_method: \"single\",\n      result_display: \"percentage\"\n    },\n    privacy_level: \"public\",\n    category: \"technology\",\n    tags: [\"programming\", \"development\"],\n    primary_hashtag: \"programming\",\n    total_votes: 0,\n    participation_rate: 0\n  },\n  {\n    title: \"Which features should we prioritize for the next release?\",\n    description: \"Vote for multiple features you'd like to see in the upcoming release.\",\n    options: [\n      \"Dark mode theme\",\n      \"Mobile app improvements\", \n      \"Real-time notifications\",\n      \"Advanced analytics\",\n      \"API rate limiting\",\n      \"User dashboard redesign\"\n    ],\n    voting_method: \"multiple\", // Correct value\n    status: \"active\",\n    created_by: \"6f12e40c-fd46-4ace-9470-2016dc0e2e8b\", // Valid user ID from database\n    end_date: new Date(Date.now() + 14 * 24 * 60 * 60 * 1000).toISOString(), // 14 days from now\n    settings: {\n      allow_anonymous: false,\n      show_results_before_close: false,\n      allow_multiple_votes: true,\n      max_selections: 3\n    },\n    hashtags: [\"features\", \"roadmap\", \"product\"],\n    poll_settings: {\n      voting_method: \"multiple\",\n      result_display: \"count\"\n    },\n    privacy_level: \"public\",\n    category: \"product\",\n    tags: [\"features\", \"roadmap\"],\n    primary_hashtag: \"features\",\n    total_votes: 0,\n    participation_rate: 0\n  },\n  {\n    title: \"Rank your preferred meeting times\",\n    description: \"Help us schedule the best time for our weekly team meetings.\",\n    options: [\n      \"Monday 9:00 AM\",\n      \"Tuesday 2:00 PM\", \n      \"Wednesday 10:00 AM\",\n      \"Thursday 3:00 PM\",\n      \"Friday 11:00 AM\"\n    ],\n    voting_method: \"single\", // Correct value\n    status: \"active\",\n    created_by: \"6f12e40c-fd46-4ace-9470-2016dc0e2e8b\", // Valid user ID from database\n    end_date: new Date(Date.now() + 3 * 24 * 60 * 60 * 1000).toISOString(), // 3 days from now\n    settings: {\n      allow_anonymous: true,\n      show_results_before_close: true,\n      allow_multiple_votes: false\n    },\n    hashtags: [\"scheduling\", \"meetings\", \"team\"],\n    poll_settings: {\n      voting_method: \"single\",\n      result_display: \"ranked\"\n    },\n    privacy_level: \"public\",\n    category: \"scheduling\",\n    tags: [\"meetings\", \"team\"],\n    primary_hashtag: \"scheduling\",\n    total_votes: 0,\n    participation_rate: 0\n  },\n  {\n    title: \"Which projects should receive funding?\",\n    description: \"Approve or disapprove each project for the next funding cycle.\",\n    options: [\n      \"Community Garden Initiative\",\n      \"Local Food Bank Support\",\n      \"Youth Sports Program\",\n      \"Senior Center Renovation\",\n      \"Environmental Cleanup Project\"\n    ],\n    voting_method: \"multiple\", // Correct value\n    status: \"active\",\n    created_by: \"6f12e40c-fd46-4ace-9470-2016dc0e2e8b\", // Valid user ID from database\n    end_date: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString(), // 30 days from now\n    settings: {\n      allow_anonymous: false,\n      show_results_before_close: true,\n      allow_multiple_votes: true\n    },\n    hashtags: [\"funding\", \"community\", \"civic\"],\n    poll_settings: {\n      voting_method: \"multiple\",\n      result_display: \"approval_percentage\"\n    },\n    privacy_level: \"public\",\n    category: \"civic\",\n    tags: [\"funding\", \"community\"],\n    primary_hashtag: \"funding\",\n    total_votes: 0,\n    participation_rate: 0\n  },\n  {\n    title: \"Draft: What should we name our new product?\",\n    description: \"This is a draft poll that hasn't been published yet.\",\n    options: [\"Choices Pro\", \"CivicHub\", \"DemocracyNow\", \"VoteRight\", \"CommunityVoice\"],\n    voting_method: \"single\", // Correct value\n    status: \"draft\",\n    created_by: \"6f12e40c-fd46-4ace-9470-2016dc0e2e8b\", // Valid user ID from database\n    settings: {\n      allow_anonymous: true,\n      show_results_before_close: false,\n      allow_multiple_votes: false\n    },\n    hashtags: [\"naming\", \"product\", \"draft\"],\n    poll_settings: {\n      voting_method: \"single\",\n      result_display: \"percentage\"\n    },\n    privacy_level: \"private\",\n    category: \"product\",\n    tags: [\"naming\", \"draft\"],\n    primary_hashtag: \"naming\",\n    total_votes: 0,\n    participation_rate: 0\n  },\n  {\n    title: \"Closed: Best coffee shop in town\",\n    description: \"This poll has already closed and shows final results.\",\n    options: [\"Starbucks\", \"Local Brew\", \"Dunkin'\", \"Peet's Coffee\", \"Independent Cafe\"],\n    voting_method: \"single\", // Correct value\n    status: \"closed\",\n    created_by: \"6f12e40c-fd46-4ace-9470-2016dc0e2e8b\", // Valid user ID from database\n    end_date: new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString(), // 1 day ago\n    settings: {\n      allow_anonymous: true,\n      show_results_before_close: true,\n      allow_multiple_votes: false\n    },\n    hashtags: [\"coffee\", \"local\", \"business\"],\n    poll_settings: {\n      voting_method: \"single\",\n      result_display: \"percentage\"\n    },\n    privacy_level: \"public\",\n    category: \"local\",\n    tags: [\"coffee\", \"business\"],\n    primary_hashtag: \"coffee\",\n    total_votes: 0,\n    participation_rate: 0\n  }\n];\n\n// REST API helper function\nasync function restApiRequest(endpoint: string, method = 'GET', body?: any) {\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\n  const supabaseKey = process.env.SUPABASE_SECRET_KEY;\n  \n  if (!supabaseUrl || !supabaseKey) {\n    throw new Error('Supabase credentials not found. Please check your environment variables.');\n  }\n  \n  const url = `${supabaseUrl}/rest/v1/${endpoint}`;\n  const headers = {\n    'apikey': supabaseKey,\n    'Authorization': `Bearer ${supabaseKey}`,\n    'Content-Type': 'application/json'\n  };\n  \n  const options: RequestInit = {\n    method,\n    headers\n  };\n  \n  if (body && method !== 'GET') {\n    options.body = JSON.stringify(body);\n  }\n  \n  const response = await fetch(url, options);\n  const data = await response.json();\n  \n  return { data, status: response.status, response };\n}\n\nexport async function seedTestPolls(): Promise<string[]> {\n  console.log('üå± Seeding test polls data using working approach...');\n  \n  try {\n    // Check if polls table exists using REST API\n    const { data: tableCheck, status: tableStatus } = await restApiRequest('polls?select=id&limit=1');\n    \n    if (tableStatus !== 200) {\n      throw new Error(`Polls table not accessible: HTTP ${tableStatus}`);\n    }\n    \n    console.log('‚úÖ Polls table exists, proceeding with seeding...');\n    \n    // Clear existing test data using REST API\n    const { status: deleteStatus } = await restApiRequest('polls?title=like.Test*', 'DELETE');\n    \n    if (deleteStatus !== 200 && deleteStatus !== 204) {\n      console.warn('‚ö†Ô∏è Could not clear existing test data:', `HTTP ${deleteStatus}`);\n    } else {\n      console.log('üßπ Cleared existing test data');\n    }\n    \n    const seededPollIds: string[] = [];\n    \n    for (const poll of TEST_POLLS) {\n      console.log(`üîÑ Attempting to insert poll: \"${poll.title}\"`);\n      console.log('Poll data:', poll);\n      \n      const { data: insertedPoll, status: insertStatus } = await restApiRequest('polls', 'POST', poll);\n      \n      console.log('Insert result:', { insertedPoll, insertStatus });\n      \n      if (insertStatus !== 201) {\n        console.error(`‚ùå Failed to insert poll \"${poll.title}\": HTTP ${insertStatus}`);\n        if (insertedPoll && insertedPoll.message) {\n          console.error('Error message:', insertedPoll.message);\n        }\n        continue;\n      }\n      \n      if (insertedPoll && insertedPoll.length > 0) {\n        seededPollIds.push(insertedPoll[0].id);\n        console.log(`‚úÖ Successfully inserted poll: \"${poll.title}\" with ID: ${insertedPoll[0].id}`);\n      } else {\n        console.warn(`‚ö†Ô∏è No data returned for poll: ${poll.title}`);\n      }\n    }\n    \n    console.log(`‚úÖ Successfully seeded ${seededPollIds.length} test polls`);\n    console.log(`üìä Seeded poll IDs: ${JSON.stringify(seededPollIds)}`);\n    \n    return seededPollIds;\n    \n  } catch (error) {\n    console.error('‚ùå Error seeding test polls:', error);\n    throw error;\n  }\n}\n\nexport async function cleanupTestPolls(pollIds: string[]): Promise<void> {\n  console.log('üßπ Cleaning up test data...');\n  \n  try {\n    for (const pollId of pollIds) {\n      const { status: deleteStatus } = await restApiRequest(`polls?id=eq.${pollId}`, 'DELETE');\n      \n      if (deleteStatus !== 200 && deleteStatus !== 204) {\n        console.warn(`‚ö†Ô∏è Could not delete poll ${pollId}: HTTP ${deleteStatus}`);\n      } else {\n        console.log(`‚úÖ Deleted poll ${pollId}`);\n      }\n    }\n    \n    console.log('‚úÖ Test data cleanup completed');\n    \n  } catch (error) {\n    console.error('‚ùå Error cleaning up test polls:', error);\n    throw error;\n  }\n}\n"],"names":["TEST_POLLS","cleanupTestPolls","seedTestPolls","title","description","options","voting_method","status","created_by","end_date","Date","now","toISOString","settings","allow_anonymous","show_results_before_close","allow_multiple_votes","hashtags","poll_settings","result_display","privacy_level","category","tags","primary_hashtag","total_votes","participation_rate","max_selections","restApiRequest","endpoint","method","body","supabaseUrl","process","env","NEXT_PUBLIC_SUPABASE_URL","supabaseKey","SUPABASE_SECRET_KEY","Error","url","headers","JSON","stringify","response","fetch","data","json","console","log","tableCheck","tableStatus","deleteStatus","warn","seededPollIds","poll","insertedPoll","insertStatus","error","message","length","push","id","pollIds","pollId"],"mappings":"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"}