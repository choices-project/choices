{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/tests/jest/integration/test-exact-civics.test.ts"],"sourcesContent":["import { describe, it, expect } from '@jest/globals';\n\n/**\n * Test Exact Civics Approach\n * \n * Tests database access using the exact same code as civics pipeline\n * \n * Created: January 27, 2025\n * Status: ‚úÖ PRODUCTION READY\n */\n\ndescribe('Test Exact Civics Approach', () => {\n  it('should test database access using exact civics pipeline code', async () => {\n    // Use exact same code as civics pipeline\n    const { createClient } = await import('@supabase/supabase-js');\n    const supabase = createClient(\n      process.env.NEXT_PUBLIC_SUPABASE_URL!,\n      process.env.SUPABASE_SECRET_KEY!\n    );\n    \n    console.log('üîç Testing database access using exact civics pipeline code...');\n    console.log('Supabase URL:', process.env.NEXT_PUBLIC_SUPABASE_URL);\n    console.log('Supabase Key (first 10 chars):', process.env.SUPABASE_SECRET_KEY?.substring(0, 10));\n    \n    // Test 1: Query representatives_core table (exact same as civics pipeline)\n    console.log('üîç Test 1: Query representatives_core table (exact civics approach)');\n    let query = supabase.from('representatives_core').select('*');\n    const { data: representatives, error: dbError } = await query;\n    \n    console.log('Representatives result:', { representatives, dbError });\n    \n    // Test 2: Query polls table\n    console.log('üîç Test 2: Query polls table');\n    const { data: polls, error: pollsError } = await supabase\n      .from('polls')\n      .select('*')\n      .limit(5);\n    \n    console.log('Polls result:', { polls, pollsError });\n    \n    // Test 3: Insert a test poll\n    console.log('üîç Test 3: Insert test poll');\n    const testPoll = {\n      title: 'Test Poll from Exact Civics Approach',\n      description: 'Testing database access using exact civics pipeline code',\n      options: ['Option 1', 'Option 2', 'Option 3'],\n      voting_method: 'single_choice',\n      status: 'active',\n      created_by: '00000000-0000-0000-0000-000000000001',\n      privacy_level: 'public',\n      category: 'test',\n      tags: ['test', 'civics-exact'],\n      hashtags: ['test', 'civics-exact'],\n      primary_hashtag: 'test'\n    };\n    \n    const { data: insertedPoll, error: insertError } = await supabase\n      .from('polls')\n      .insert(testPoll)\n      .select();\n    \n    console.log('Insert poll result:', { insertedPoll, insertError });\n    \n    // Test 4: Query the inserted poll\n    if (insertedPoll && insertedPoll.length > 0) {\n      console.log('üîç Test 4: Query inserted poll');\n      const { data: queriedPoll, error: queryError } = await supabase\n        .from('polls')\n        .select('*')\n        .eq('id', insertedPoll[0].id);\n      \n      console.log('Query inserted poll result:', { queriedPoll, queryError });\n      \n      // Clean up - delete the test poll\n      console.log('üîç Cleanup: Delete test poll');\n      const { error: deleteError } = await supabase\n        .from('polls')\n        .delete()\n        .eq('id', insertedPoll[0].id);\n      \n      console.log('Delete poll result:', { deleteError });\n    }\n    \n    // Test 5: Test with different privacy levels\n    console.log('üîç Test 5: Test different privacy levels');\n    const { data: publicPolls, error: publicPollsError } = await supabase\n      .from('polls')\n      .select('id, title, privacy_level')\n      .eq('privacy_level', 'public')\n      .limit(3);\n    \n    console.log('Public polls result:', { publicPolls, publicPollsError });\n    \n    // Test 6: Test with different statuses\n    console.log('üîç Test 6: Test different statuses');\n    const { data: activePolls, error: activePollsError } = await supabase\n      .from('polls')\n      .select('id, title, status')\n      .eq('status', 'active')\n      .limit(3);\n    \n    console.log('Active polls result:', { activePolls, activePollsError });\n    \n    // Test 7: Test with different created_by values\n    console.log('üîç Test 7: Test different created_by values');\n    const { data: userPolls, error: userPollsError } = await supabase\n      .from('polls')\n      .select('id, title, created_by')\n      .eq('created_by', '00000000-0000-0000-0000-000000000001')\n      .limit(3);\n    \n    console.log('User polls result:', { userPolls, userPollsError });\n    \n    // Test 8: Test with different categories\n    console.log('üîç Test 8: Test different categories');\n    const { data: categoryPolls, error: categoryPollsError } = await supabase\n      .from('polls')\n      .select('id, title, category')\n      .eq('category', 'technology')\n      .limit(3);\n    \n    console.log('Category polls result:', { categoryPolls, categoryPollsError });\n    \n    // Test 9: Test with different voting methods\n    console.log('üîç Test 9: Test different voting methods');\n    const { data: votingMethodPolls, error: votingMethodPollsError } = await supabase\n      .from('polls')\n      .select('id, title, voting_method')\n      .eq('voting_method', 'single_choice')\n      .limit(3);\n    \n    console.log('Voting method polls result:', { votingMethodPolls, votingMethodPollsError });\n    \n    // Test 10: Test with different statuses\n    console.log('üîç Test 10: Test different statuses');\n    const { data: statusPolls, error: statusPollsError } = await supabase\n      .from('polls')\n      .select('id, title, status')\n      .eq('status', 'active')\n      .limit(3);\n    \n    console.log('Status polls result:', { statusPolls, statusPollsError });\n    \n    // The test should pass if we can access the database\n    expect(dbError).toBeNull();\n    expect(pollsError).toBeNull();\n    expect(insertError).toBeNull();\n    expect(publicPollsError).toBeNull();\n    expect(activePollsError).toBeNull();\n    expect(userPollsError).toBeNull();\n    expect(categoryPollsError).toBeNull();\n    expect(votingMethodPollsError).toBeNull();\n    expect(statusPollsError).toBeNull();\n  });\n});\n"],"names":["describe","it","createClient","supabase","process","env","NEXT_PUBLIC_SUPABASE_URL","SUPABASE_SECRET_KEY","console","log","substring","query","from","select","data","representatives","error","dbError","polls","pollsError","limit","testPoll","title","description","options","voting_method","status","created_by","privacy_level","category","tags","hashtags","primary_hashtag","insertedPoll","insertError","insert","length","queriedPoll","queryError","eq","id","deleteError","delete","publicPolls","publicPollsError","activePolls","activePollsError","userPolls","userPollsError","categoryPolls","categoryPollsError","votingMethodPolls","votingMethodPollsError","statusPolls","statusPollsError","expect","toBeNull"],"mappings":"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"}