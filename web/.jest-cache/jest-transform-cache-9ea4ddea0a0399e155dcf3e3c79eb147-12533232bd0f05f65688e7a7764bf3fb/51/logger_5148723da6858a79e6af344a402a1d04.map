{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/lib/utils/logger.ts"],"sourcesContent":["/**\n * Logger utility for development and production environments\n * Provides structured logging with environment-aware output\n */\n/**\n * Logger utility for development and production environments\n * Provides structured logging with environment-aware output\n */\n\nexport enum LogLevel {\n  DEBUG = 0,\n  INFO = 1,\n  WARN = 2,\n  ERROR = 3,\n  NONE = 4\n}\n\ninterface LogContext {\n  [key: string]: unknown;\n}\n\nclass Logger {\n  private level: LogLevel;\n  private isDevelopment: boolean;\n  private seen: Set<object>;\n\n  constructor() {\n    this.isDevelopment = process.env.NODE_ENV === 'development';\n    this.level = this.isDevelopment ? LogLevel.DEBUG : LogLevel.ERROR;\n    this.seen = new Set();\n  }\n\n  private shouldLog(level: LogLevel): boolean {\n    return level >= this.level;\n  }\n\n  private formatMessage(level: string, message: string, context?: LogContext): string {\n    const timestamp = new Date().toISOString();\n    let contextStr = '';\n    \n    if (context) {\n      try {\n        contextStr = ` ${JSON.stringify(context)}`;\n      } catch (error) {\n        // Handle circular references and other JSON.stringify errors\n        contextStr = ` ${JSON.stringify(context, (key, value) => {\n          if (typeof value === 'object' && value !== null) {\n            if (this.seen.has(value)) {\n              return '[Circular]';\n            }\n            this.seen.add(value);\n          }\n          return value;\n        })}`;\n        this.seen.clear();\n        console.warn('JSON.stringify failed:', error);\n      }\n    }\n    \n    return `[${timestamp}] ${level}: ${message}${contextStr}`;\n  }\n\n  debug(message: string, context?: LogContext): void {\n    if (this.shouldLog(LogLevel.DEBUG)) {\n      // eslint-disable-next-line no-console\n      console.debug(this.formatMessage('DEBUG', message, context));\n    }\n  }\n\n  info(message: string, context?: LogContext): void {\n    if (this.shouldLog(LogLevel.INFO)) {\n      // eslint-disable-next-line no-console\n      console.info(this.formatMessage('INFO', message, context));\n    }\n  }\n\n  warn(message: string, context?: LogContext): void {\n    if (this.shouldLog(LogLevel.WARN)) {\n       \n      console.warn(this.formatMessage('WARN', message, context));\n    }\n  }\n\n  error(message: string, error?: Error, context?: LogContext): void {\n    if (this.shouldLog(LogLevel.ERROR)) {\n      const errorContext = Object.assign({}, context, {\n        error: error?.message,\n        stack: error?.stack\n      });\n       \n      console.error(this.formatMessage('ERROR', message, errorContext));\n    }\n  }\n\n  // API-specific logging\n  apiCall(endpoint: string, method: string, status?: number, duration?: number): void {\n    this.info('API Call', {\n      endpoint,\n      method,\n      status,\n      duration: duration ? `${duration}ms` : undefined\n    });\n  }\n\n  // Database-specific logging\n  dbQuery(operation: string, table: string, duration?: number): void {\n    this.debug('Database Query', {\n      operation,\n      table,\n      duration: duration ? `${duration}ms` : undefined\n    });\n  }\n\n  // User action logging\n  userAction(action: string, userId?: string, context?: LogContext): void {\n    this.info('User Action', Object.assign({\n      action,\n      userId,\n    }, context));\n  }\n\n  // Performance logging\n  performance(operation: string, duration: number, context?: LogContext): void {\n    this.info('Performance', Object.assign({\n      operation,\n      duration: `${duration}ms`,\n    }, context));\n  }\n}\n\n// Export singleton instance\nexport const logger = new Logger();\n\n// Convenience functions for common use cases\nexport const logApiCall = (endpoint: string, method: string, status?: number, duration?: number) => {\n  logger.apiCall(endpoint, method, status, duration);\n};\n\nexport const logDbQuery = (operation: string, table: string, duration?: number) => {\n  logger.dbQuery(operation, table, duration);\n};\n\nexport const logUserAction = (action: string, userId?: string, context?: LogContext) => {\n  logger.userAction(action, userId, context);\n};\n\nexport const logPerformance = (operation: string, duration: number, context?: LogContext) => {\n  logger.performance(operation, duration, context);\n};\n\n// Development-only logging (replaces logger.info)\nexport const devLog = (message: string, context?: LogContext) => {\n  if (process.env.NODE_ENV === 'development') {\n     \n    logger.info(`[DEV] ${message}`, context);\n  }\n};\n\n// Standard logging functions\nexport const logInfo = (message: string, context?: LogContext) => {\n  logger.info(message, context);\n};\n\nexport const logWarn = (message: string, context?: LogContext) => {\n  logger.warn(message, context);\n};\n\nexport const logError = (message: string, error?: Error, context?: LogContext) => {\n  logger.error(message, error, context);\n};\n"],"names":["LogLevel","devLog","logApiCall","logDbQuery","logError","logInfo","logPerformance","logUserAction","logWarn","logger","Logger","isDevelopment","process","env","NODE_ENV","level","seen","Set","shouldLog","formatMessage","message","context","timestamp","Date","toISOString","contextStr","JSON","stringify","error","key","value","has","add","clear","console","warn","debug","info","errorContext","Object","assign","stack","apiCall","endpoint","method","status","duration","undefined","dbQuery","operation","table","userAction","action","userId","performance"],"mappings":"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"}