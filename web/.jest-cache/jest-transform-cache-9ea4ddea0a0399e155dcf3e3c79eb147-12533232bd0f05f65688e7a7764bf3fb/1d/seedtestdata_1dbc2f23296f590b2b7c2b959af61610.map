{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/tests/jest/helpers/seed-test-data.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\n\n/**\n * Test Data Seeding Utility\n * \n * Populates the database with realistic test data for integration testing\n * \n * Created: January 27, 2025\n * Status: ‚úÖ PRODUCTION READY\n */\n\nfunction getSupabaseClient() {\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\n  // Use same approach as civics pipeline\n  const supabaseKey = process.env.SUPABASE_SECRET_KEY;\n  \n  if (!supabaseUrl || !supabaseKey) {\n    throw new Error('Supabase credentials not found. Please check your environment variables.');\n  }\n  \n  console.log('Using Supabase key type:', supabaseKey.startsWith('sb_secret_') ? 'SERVICE_ROLE' : 'ANON');\n  console.log('Using same approach as civics pipeline');\n  \n  return createClient(supabaseUrl, supabaseKey);\n}\n\n// REST API helper function\nasync function restApiRequest(endpoint: string, method: string = 'GET', body?: any) {\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\n  const supabaseKey = process.env.SUPABASE_SECRET_KEY;\n  \n  if (!supabaseUrl || !supabaseKey) {\n    throw new Error('Supabase credentials not found. Please check your environment variables.');\n  }\n  \n  const url = `${supabaseUrl}/rest/v1/${endpoint}`;\n  const headers = {\n    'apikey': supabaseKey,\n    'Authorization': `Bearer ${supabaseKey}`,\n    'Content-Type': 'application/json'\n  };\n  \n  const options: RequestInit = {\n    method,\n    headers\n  };\n  \n  if (body && method !== 'GET') {\n    options.body = JSON.stringify(body);\n  }\n  \n  const response = await fetch(url, options);\n  const data = await response.json();\n  \n  return { data, status: response.status, response };\n}\n\nexport interface TestPoll {\n  id?: string;\n  title: string;\n  description: string;\n  options: string[];\n  voting_method: 'single_choice' | 'multiple_choice' | 'ranked_choice' | 'approval_voting';\n  status: 'draft' | 'active' | 'closed';\n  created_by: string; // UUID reference to auth.users\n  end_date?: string;\n  settings: Record<string, any>;\n  hashtags: string[];\n  poll_settings: Record<string, any>;\n  privacy_level: string; // This is the key field for RLS!\n  category?: string;\n  tags?: string[];\n  primary_hashtag?: string;\n  total_votes?: number;\n  participation_rate?: number;\n}\n\nexport const TEST_POLLS: TestPoll[] = [\n  {\n    title: \"What's your favorite programming language?\",\n    description: \"Help us understand the community's preferences for programming languages in 2025.\",\n    options: [\"JavaScript/TypeScript\", \"Python\", \"Rust\", \"Go\", \"Java\", \"C++\"],\n    voting_method: \"single_choice\",\n    status: \"active\",\n    created_by: \"00000000-0000-0000-0000-000000000001\", // UUID for test user\n    end_date: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString(), // 7 days from now\n    settings: {\n      allow_anonymous: true,\n      show_results_before_close: true,\n      allow_multiple_votes: false\n    },\n    hashtags: [\"programming\", \"technology\", \"development\"],\n    poll_settings: {\n      voting_method: \"single_choice\",\n      result_display: \"percentage\"\n    },\n    privacy_level: \"public\", // This is the key field for RLS!\n    category: \"technology\",\n    tags: [\"programming\", \"development\"],\n    primary_hashtag: \"programming\",\n    total_votes: 0,\n    participation_rate: 0\n  },\n  {\n    title: \"Which features should we prioritize for the next release?\",\n    description: \"Vote for multiple features you'd like to see in the upcoming release.\",\n    options: [\n      \"Dark mode theme\",\n      \"Mobile app improvements\", \n      \"Real-time notifications\",\n      \"Advanced analytics\",\n      \"API rate limiting\",\n      \"User dashboard redesign\"\n    ],\n    voting_method: \"multiple_choice\",\n    status: \"active\",\n    created_by: \"00000000-0000-0000-0000-000000000001\",\n    end_date: new Date(Date.now() + 14 * 24 * 60 * 60 * 1000).toISOString(), // 14 days from now\n    settings: {\n      allow_anonymous: false,\n      show_results_before_close: false,\n      allow_multiple_votes: true,\n      max_selections: 3\n    },\n    hashtags: [\"features\", \"roadmap\", \"product\"],\n    poll_settings: {\n      voting_method: \"multiple_choice\",\n      result_display: \"count\"\n    },\n    privacy_level: \"public\",\n    category: \"product\",\n    tags: [\"features\", \"roadmap\"],\n    primary_hashtag: \"features\",\n    total_votes: 0,\n    participation_rate: 0\n  },\n  {\n    title: \"Rank your preferred meeting times\",\n    description: \"Help us schedule the best time for our weekly team meetings.\",\n    options: [\n      \"Monday 9:00 AM\",\n      \"Tuesday 2:00 PM\", \n      \"Wednesday 10:00 AM\",\n      \"Thursday 3:00 PM\",\n      \"Friday 11:00 AM\"\n    ],\n    voting_method: \"ranked_choice\",\n    status: \"active\",\n    created_by: \"00000000-0000-0000-0000-000000000001\",\n    end_date: new Date(Date.now() + 3 * 24 * 60 * 60 * 1000).toISOString(), // 3 days from now\n    settings: {\n      allow_anonymous: true,\n      show_results_before_close: true,\n      allow_multiple_votes: false\n    },\n    hashtags: [\"scheduling\", \"meetings\", \"team\"],\n    poll_settings: {\n      voting_method: \"ranked_choice\",\n      result_display: \"ranked\"\n    },\n    privacy_level: \"public\",\n    is_public: true,\n    allow_anonymous: true,\n    max_votes_per_user: 1,\n    category: \"scheduling\",\n    tags: [\"meetings\", \"team\"],\n    primary_hashtag: \"scheduling\",\n    total_votes: 0,\n    participation_rate: 0\n  },\n  {\n    title: \"Which projects should receive funding?\",\n    description: \"Approve or disapprove each project for the next funding cycle.\",\n    options: [\n      \"Community Garden Initiative\",\n      \"Local Food Bank Support\",\n      \"Youth Sports Program\",\n      \"Senior Center Renovation\",\n      \"Environmental Cleanup Project\"\n    ],\n    voting_method: \"approval_voting\",\n    status: \"active\",\n    created_by: \"00000000-0000-0000-0000-000000000001\",\n    end_date: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString(), // 30 days from now\n    settings: {\n      allow_anonymous: false,\n      show_results_before_close: true,\n      allow_multiple_votes: true\n    },\n    hashtags: [\"funding\", \"community\", \"civic\"],\n    poll_settings: {\n      voting_method: \"approval_voting\",\n      result_display: \"approval_percentage\"\n    },\n    privacy_level: \"public\",\n    is_public: true,\n    allow_anonymous: false,\n    max_votes_per_user: 5,\n    category: \"civic\",\n    tags: [\"funding\", \"community\"],\n    primary_hashtag: \"funding\",\n    total_votes: 0,\n    participation_rate: 0\n  },\n  {\n    title: \"Draft: What should we name our new product?\",\n    description: \"This is a draft poll that hasn't been published yet.\",\n    options: [\"Choices Pro\", \"CivicHub\", \"DemocracyNow\", \"VoteRight\", \"CommunityVoice\"],\n    voting_method: \"single_choice\",\n    status: \"draft\",\n    created_by: \"00000000-0000-0000-0000-000000000001\",\n    settings: {\n      allow_anonymous: true,\n      show_results_before_close: false,\n      allow_multiple_votes: false\n    },\n    hashtags: [\"naming\", \"product\", \"draft\"],\n    poll_settings: {\n      voting_method: \"single_choice\",\n      result_display: \"percentage\"\n    },\n    privacy_level: \"private\",\n    is_public: false,\n    allow_anonymous: true,\n    max_votes_per_user: 1,\n    category: \"product\",\n    tags: [\"naming\", \"draft\"],\n    primary_hashtag: \"naming\",\n    total_votes: 0,\n    participation_rate: 0\n  },\n  {\n    title: \"Closed: Best coffee shop in town\",\n    description: \"This poll has already closed and shows final results.\",\n    options: [\"Starbucks\", \"Local Brew\", \"Dunkin'\", \"Peet's Coffee\", \"Independent Cafe\"],\n    voting_method: \"single_choice\",\n    status: \"closed\",\n    created_by: \"00000000-0000-0000-0000-000000000001\",\n    end_date: new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString(), // 1 day ago\n    settings: {\n      allow_anonymous: true,\n      show_results_before_close: true,\n      allow_multiple_votes: false\n    },\n    hashtags: [\"coffee\", \"local\", \"business\"],\n    poll_settings: {\n      voting_method: \"single_choice\",\n      result_display: \"percentage\"\n    },\n    privacy_level: \"public\",\n    is_public: true,\n    allow_anonymous: true,\n    max_votes_per_user: 1,\n    category: \"local\",\n    tags: [\"coffee\", \"business\"],\n    primary_hashtag: \"coffee\",\n    total_votes: 0,\n    participation_rate: 0\n  }\n];\n\nexport async function seedTestPolls(): Promise<string[]> {\n  console.log('üå± Seeding test polls data...');\n  \n  try {\n    const supabase = getSupabaseClient();\n    \n    // First, let's check if polls table exists and get its structure\n    const { data: tableInfo, error: tableError } = await supabase\n      .from('information_schema.tables')\n      .select('table_name')\n      .eq('table_schema', 'public')\n      .eq('table_name', 'polls');\n\n    if (tableError) {\n      console.log('‚ùå Error checking polls table:', tableError);\n      throw tableError;\n    }\n\n    if (!tableInfo || tableInfo.length === 0) {\n      console.log('‚ùå Polls table does not exist in the database');\n      throw new Error('Polls table does not exist');\n    }\n\n    console.log('‚úÖ Polls table exists, proceeding with seeding...');\n\n    // Clear existing test data\n    const { error: deleteError } = await supabase\n      .from('polls')\n      .delete()\n      .like('title', '%test%');\n\n    if (deleteError) {\n      console.log('‚ö†Ô∏è Warning: Could not clear existing test data:', deleteError);\n    } else {\n      console.log('üßπ Cleared existing test data');\n    }\n\n    // Insert test polls one by one to avoid batch insert issues\n    const pollIds: string[] = [];\n    \n    for (const poll of TEST_POLLS) {\n      console.log(`üîÑ Attempting to insert poll: \"${poll.title}\"`);\n      console.log('Poll data:', JSON.stringify(poll, null, 2));\n      \n      const { data: insertedPoll, error: insertError } = await supabase\n        .from('polls')\n        .insert(poll)\n        .select('id, title')\n        .single();\n\n      console.log('Insert result:', { insertedPoll, insertError });\n\n      if (insertError) {\n        console.log(`‚ùå Error inserting poll \"${poll.title}\":`, insertError);\n        console.log('Error details:', {\n          message: insertError.message,\n          details: insertError.details,\n          hint: insertError.hint,\n          code: insertError.code\n        });\n        // Continue with other polls instead of failing completely\n        continue;\n      }\n\n      if (insertedPoll && insertedPoll.id) {\n        pollIds.push(insertedPoll.id);\n        console.log(`‚úÖ Inserted poll: ${insertedPoll.title} (ID: ${insertedPoll.id})`);\n      } else {\n        console.log(`‚ö†Ô∏è No data returned for poll: ${poll.title}`);\n      }\n    }\n    \n    console.log(`‚úÖ Successfully seeded ${pollIds.length} test polls`);\n    console.log('üìä Seeded poll IDs:', pollIds);\n\n    return pollIds;\n\n  } catch (error) {\n    console.log('‚ùå Error seeding test polls:', error);\n    throw error;\n  }\n}\n\nexport async function seedTestVotes(pollIds: string[]): Promise<void> {\n  console.log('üó≥Ô∏è Seeding test votes...');\n  \n  try {\n    const supabase = getSupabaseClient();\n    const testVotes = [];\n    \n    // Create realistic vote data for each poll\n    for (const pollId of pollIds) {\n      const poll = TEST_POLLS.find(p => pollIds.includes(pollId));\n      if (!poll) continue;\n\n      // Generate 10-50 votes per poll with realistic distribution\n      const voteCount = Math.floor(Math.random() * 40) + 10;\n      \n      for (let i = 0; i < voteCount; i++) {\n        const vote = {\n          poll_id: pollId,\n          user_id: `test-voter-${i + 1}`,\n          choice: Math.floor(Math.random() * poll.options.length),\n          created_at: new Date(Date.now() - Math.random() * 7 * 24 * 60 * 60 * 1000).toISOString(), // Random time in last 7 days\n          ip_address: `192.168.1.${Math.floor(Math.random() * 255)}`,\n          user_agent: 'Mozilla/5.0 (Test Browser)'\n        };\n        \n        testVotes.push(vote);\n      }\n    }\n\n    // Insert votes in batches\n    const batchSize = 50;\n    for (let i = 0; i < testVotes.length; i += batchSize) {\n      const batch = testVotes.slice(i, i + batchSize);\n      const { error: voteError } = await supabase\n        .from('votes')\n        .insert(batch);\n\n      if (voteError) {\n        console.log('‚ö†Ô∏è Warning: Could not insert some votes:', voteError);\n      }\n    }\n\n    console.log(`‚úÖ Successfully seeded ${testVotes.length} test votes`);\n\n  } catch (error) {\n    console.log('‚ùå Error seeding test votes:', error);\n    throw error;\n  }\n}\n\nexport async function cleanupTestData(): Promise<void> {\n  console.log('üßπ Cleaning up test data...');\n  \n  try {\n    const supabase = getSupabaseClient();\n    // Delete test votes\n    const { error: votesError } = await supabase\n      .from('votes')\n      .delete()\n      .like('user_id', 'test-voter-%');\n\n    if (votesError) {\n      console.log('‚ö†Ô∏è Warning: Could not clean up test votes:', votesError);\n    }\n\n    // Delete test polls\n    const { error: pollsError } = await supabase\n      .from('polls')\n      .delete()\n      .like('title', '%test%')\n      .or('title.like.%draft%')\n      .or('title.like.%closed%');\n\n    if (pollsError) {\n      console.log('‚ö†Ô∏è Warning: Could not clean up test polls:', pollsError);\n    }\n\n    console.log('‚úÖ Test data cleanup completed');\n\n  } catch (error) {\n    console.log('‚ùå Error cleaning up test data:', error);\n    throw error;\n  }\n}\n\nexport async function getDatabaseStats(): Promise<{\n  pollsCount: number;\n  votesCount: number;\n  activePolls: number;\n  closedPolls: number;\n}> {\n  try {\n    const supabase = getSupabaseClient();\n    const { data: pollsData, error: pollsError } = await supabase\n      .from('polls')\n      .select('id, status');\n\n    const { data: votesData, error: votesError } = await supabase\n      .from('votes')\n      .select('id');\n\n    if (pollsError || votesError) {\n      throw new Error(`Database query errors: ${pollsError?.message || votesError?.message}`);\n    }\n\n    // Handle different response formats\n    const polls = Array.isArray(pollsData) ? pollsData : (pollsData ? [pollsData] : []);\n    const votes = Array.isArray(votesData) ? votesData : (votesData ? [votesData] : []);\n    \n    const activePolls = polls.filter(p => p.status === 'active').length;\n    const closedPolls = polls.filter(p => p.status === 'closed').length;\n\n    return {\n      pollsCount: polls.length,\n      votesCount: votes.length,\n      activePolls,\n      closedPolls\n    };\n\n  } catch (error) {\n    console.log('‚ùå Error getting database stats:', error);\n    throw error;\n  }\n}\n"],"names":["TEST_POLLS","cleanupTestData","getDatabaseStats","seedTestPolls","seedTestVotes","getSupabaseClient","supabaseUrl","process","env","NEXT_PUBLIC_SUPABASE_URL","supabaseKey","SUPABASE_SECRET_KEY","Error","console","log","startsWith","createClient","restApiRequest","endpoint","method","body","url","headers","options","JSON","stringify","response","fetch","data","json","status","title","description","voting_method","created_by","end_date","Date","now","toISOString","settings","allow_anonymous","show_results_before_close","allow_multiple_votes","hashtags","poll_settings","result_display","privacy_level","category","tags","primary_hashtag","total_votes","participation_rate","max_selections","is_public","max_votes_per_user","supabase","tableInfo","error","tableError","from","select","eq","length","deleteError","delete","like","pollIds","poll","insertedPoll","insertError","insert","single","message","details","hint","code","id","push","testVotes","pollId","find","p","includes","voteCount","Math","floor","random","i","vote","poll_id","user_id","choice","created_at","ip_address","user_agent","batchSize","batch","slice","voteError","votesError","pollsError","or","pollsData","votesData","polls","Array","isArray","votes","activePolls","filter","closedPolls","pollsCount","votesCount"],"mappings":"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"}