{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/tests/jest/unit/hooks/useSocialSharing.test.ts"],"sourcesContent":["/**\n * useSocialSharing Hook Tests\n * \n * Comprehensive tests for the social sharing hook functionality\n * including platform-specific sharing, native sharing, and analytics tracking.\n * \n * Created: January 23, 2025\n * Status: âœ… ACTIVE\n */\n\nimport { renderHook, act } from '@testing-library/react';\nimport { useSocialSharing } from '@/hooks/useSocialSharing';\n\n// Mock the feature flags module\njest.mock('@/lib/core/feature-flags', () => ({\n  isFeatureEnabled: jest.fn(() => true)\n}));\n\n// Mock fetch for API calls\nglobal.fetch = jest.fn();\n\n// Mock navigator.share\nObject.defineProperty(navigator, 'share', {\n  value: jest.fn(),\n  writable: true,\n});\n\n// Mock window.open\nObject.defineProperty(window, 'open', {\n  value: jest.fn(),\n  writable: true,\n});\n\ndescribe('useSocialSharing', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n    (global.fetch as jest.Mock).mockResolvedValue({\n      ok: true,\n      json: () => Promise.resolve({ success: true })\n    });\n  });\n\n  describe('Platform-specific sharing', () => {\n    it('should share to Twitter', async () => {\n      const { result } = renderHook(() => useSocialSharing());\n      \n      const sharingOptions = {\n        title: 'Test Poll',\n        description: 'Check out this poll!',\n        url: 'https://choices.app/polls/123',\n        pollId: '123',\n        contentType: 'poll' as const,\n        placement: 'feed'\n      };\n\n      await act(async () => {\n        const response = await result.current.shareToPlatform('twitter', sharingOptions);\n        expect(response.success).toBe(true);\n        expect(response.platform).toBe('twitter');\n      });\n\n      expect(window.open).toHaveBeenCalledWith(\n        expect.stringContaining('twitter.com/intent/tweet'),\n        '_blank',\n        'width=600,height=400'\n      );\n    });\n\n    it('should share to Facebook', async () => {\n      const { result } = renderHook(() => useSocialSharing());\n      \n      const sharingOptions = {\n        title: 'Test Poll',\n        url: 'https://choices.app/polls/123',\n        pollId: '123',\n        contentType: 'poll' as const\n      };\n\n      await act(async () => {\n        const response = await result.current.shareToPlatform('facebook', sharingOptions);\n        expect(response.success).toBe(true);\n        expect(response.platform).toBe('facebook');\n      });\n\n      expect(window.open).toHaveBeenCalledWith(\n        expect.stringContaining('facebook.com/sharer'),\n        '_blank',\n        'width=600,height=400'\n      );\n    });\n\n    it('should share to LinkedIn', async () => {\n      const { result } = renderHook(() => useSocialSharing());\n      \n      const sharingOptions = {\n        title: 'Test Poll',\n        url: 'https://choices.app/polls/123',\n        pollId: '123',\n        contentType: 'poll' as const\n      };\n\n      await act(async () => {\n        const response = await result.current.shareToPlatform('linkedin', sharingOptions);\n        expect(response.success).toBe(true);\n        expect(response.platform).toBe('linkedin');\n      });\n\n      expect(window.open).toHaveBeenCalledWith(\n        expect.stringContaining('linkedin.com/sharing'),\n        '_blank',\n        'width=600,height=400'\n      );\n    });\n\n    it('should share via email', async () => {\n      const { result } = renderHook(() => useSocialSharing());\n      \n      const sharingOptions = {\n        title: 'Test Poll',\n        description: 'Check out this poll!',\n        url: 'https://choices.app/polls/123',\n        pollId: '123',\n        contentType: 'poll' as const\n      };\n\n      await act(async () => {\n        const response = await result.current.shareToPlatform('email', sharingOptions);\n        expect(response.success).toBe(true);\n        expect(response.platform).toBe('email');\n      });\n\n      expect(window.open).toHaveBeenCalledWith(\n        expect.stringContaining('mailto:'),\n        '_blank',\n        'width=600,height=400'\n      );\n    });\n\n    it('should handle unsupported platform', async () => {\n      const { result } = renderHook(() => useSocialSharing());\n      \n      const sharingOptions = {\n        title: 'Test Poll',\n        url: 'https://choices.app/polls/123',\n        pollId: '123',\n        contentType: 'poll' as const\n      };\n\n      await act(async () => {\n        const response = await result.current.shareToPlatform('unsupported' as any, sharingOptions);\n        expect(response.success).toBe(false);\n        expect(response.error).toContain('Unsupported platform');\n      });\n    });\n  });\n\n  describe('Native sharing', () => {\n    it('should use native sharing when available', async () => {\n      const mockShare = jest.fn().mockResolvedValue(undefined);\n      Object.defineProperty(navigator, 'share', {\n        value: mockShare,\n        writable: true,\n      });\n\n      const { result } = renderHook(() => useSocialSharing());\n      \n      const sharingOptions = {\n        title: 'Test Poll',\n        description: 'Check out this poll!',\n        url: 'https://choices.app/polls/123',\n        pollId: '123',\n        contentType: 'poll' as const\n      };\n\n      await act(async () => {\n        const response = await result.current.shareNative(sharingOptions);\n        expect(response.success).toBe(true);\n        expect(response.platform).toBe('native');\n      });\n\n      expect(mockShare).toHaveBeenCalledWith({\n        title: 'Test Poll',\n        text: 'Check out this poll!',\n        url: 'https://choices.app/polls/123'\n      });\n    });\n\n    it('should handle native sharing rejection', async () => {\n      const mockShare = jest.fn().mockRejectedValue(new Error('User cancelled'));\n      Object.defineProperty(navigator, 'share', {\n        value: mockShare,\n        writable: true,\n      });\n\n      const { result } = renderHook(() => useSocialSharing());\n      \n      const sharingOptions = {\n        title: 'Test Poll',\n        url: 'https://choices.app/polls/123',\n        pollId: '123',\n        contentType: 'poll' as const\n      };\n\n      await act(async () => {\n        const response = await result.current.shareNative(sharingOptions);\n        expect(response.success).toBe(false);\n        expect(response.error).toContain('User cancelled');\n      });\n    });\n\n    it('should handle missing native sharing', async () => {\n      Object.defineProperty(navigator, 'share', {\n        value: undefined,\n        writable: true,\n      });\n\n      const { result } = renderHook(() => useSocialSharing());\n      \n      const sharingOptions = {\n        title: 'Test Poll',\n        url: 'https://choices.app/polls/123',\n        pollId: '123',\n        contentType: 'poll' as const\n      };\n\n      await act(async () => {\n        const response = await result.current.shareNative(sharingOptions);\n        expect(response.success).toBe(false);\n        expect(response.error).toContain('Native sharing not supported');\n      });\n    });\n  });\n\n  describe('Clipboard sharing', () => {\n    it('should copy to clipboard', async () => {\n      const mockWriteText = jest.fn().mockResolvedValue(undefined);\n      Object.defineProperty(navigator, 'clipboard', {\n        value: { writeText: mockWriteText },\n        writable: true,\n      });\n\n      const { result } = renderHook(() => useSocialSharing());\n      \n      const sharingOptions = {\n        title: 'Test Poll',\n        url: 'https://choices.app/polls/123',\n        pollId: '123',\n        contentType: 'poll' as const\n      };\n\n      await act(async () => {\n        const response = await result.current.copyToClipboard(sharingOptions);\n        expect(response.success).toBe(true);\n        expect(response.platform).toBe('clipboard');\n      });\n\n      expect(mockWriteText).toHaveBeenCalledWith('https://choices.app/polls/123');\n    });\n\n    it('should handle clipboard errors', async () => {\n      const mockWriteText = jest.fn().mockRejectedValue(new Error('Clipboard access denied'));\n      Object.defineProperty(navigator, 'clipboard', {\n        value: { writeText: mockWriteText },\n        writable: true,\n      });\n\n      const { result } = renderHook(() => useSocialSharing());\n      \n      const sharingOptions = {\n        title: 'Test Poll',\n        url: 'https://choices.app/polls/123',\n        pollId: '123',\n        contentType: 'poll' as const\n      };\n\n      await act(async () => {\n        const response = await result.current.copyToClipboard(sharingOptions);\n        expect(response.success).toBe(false);\n        expect(response.error).toContain('Clipboard access denied');\n      });\n    });\n  });\n\n  describe('Analytics tracking', () => {\n    it('should track share events', async () => {\n      const { result } = renderHook(() => useSocialSharing());\n      \n      const sharingOptions = {\n        title: 'Test Poll',\n        url: 'https://choices.app/polls/123',\n        pollId: '123',\n        contentType: 'poll' as const,\n        placement: 'feed'\n      };\n\n      await act(async () => {\n        await result.current.shareToPlatform('twitter', sharingOptions);\n      });\n\n      expect(global.fetch).toHaveBeenCalledWith('/api/share', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          platform: 'twitter',\n          poll_id: '123',\n          placement: 'feed',\n          content_type: 'poll',\n        }),\n      });\n    });\n\n    it('should handle analytics errors gracefully', async () => {\n      (global.fetch as jest.Mock).mockRejectedValue(new Error('Network error'));\n\n      const { result } = renderHook(() => useSocialSharing());\n      \n      const sharingOptions = {\n        title: 'Test Poll',\n        url: 'https://choices.app/polls/123',\n        pollId: '123',\n        contentType: 'poll' as const\n      };\n\n      await act(async () => {\n        const response = await result.current.shareToPlatform('twitter', sharingOptions);\n        // Should still succeed even if analytics fails\n        expect(response.success).toBe(true);\n      });\n    });\n  });\n\n  describe('Error handling', () => {\n    it('should clear errors', () => {\n      const { result } = renderHook(() => useSocialSharing());\n      \n      act(() => {\n        result.current.clearError();\n      });\n\n      expect(result.current.shareError).toBe(null);\n    });\n\n    it('should handle sharing when disabled', async () => {\n      // Mock feature flag as disabled for this test\n      const { isFeatureEnabled } = require('@/lib/core/feature-flags');\n      isFeatureEnabled.mockReturnValue(false);\n\n      const { result } = renderHook(() => useSocialSharing());\n      \n      const sharingOptions = {\n        title: 'Test Poll',\n        url: 'https://choices.app/polls/123',\n        pollId: '123',\n        contentType: 'poll' as const\n      };\n\n      await act(async () => {\n        const response = await result.current.shareToPlatform('twitter', sharingOptions);\n        expect(response.success).toBe(false);\n        expect(response.error).toContain('Social sharing is disabled');\n      });\n\n      // Reset mock\n      isFeatureEnabled.mockReturnValue(true);\n    });\n  });\n\n  describe('Loading states', () => {\n    it('should track loading state during sharing', async () => {\n      const { result } = renderHook(() => useSocialSharing());\n      \n      expect(result.current.isSharing).toBe(false);\n\n      const sharingOptions = {\n        title: 'Test Poll',\n        url: 'https://choices.app/polls/123',\n        pollId: '123',\n        contentType: 'poll' as const\n      };\n\n      // Mock fetch to return a resolved promise\n      (global.fetch as jest.Mock).mockResolvedValue({\n        ok: true,\n        json: () => Promise.resolve({ success: true })\n      });\n\n      // Start sharing and check loading state\n      await act(async () => {\n        const sharePromise = result.current.shareToPlatform('twitter', sharingOptions);\n        \n        // Check loading state during sharing\n        expect(result.current.isSharing).toBe(true);\n        \n        await sharePromise;\n      });\n\n      // Check loading state after sharing\n      expect(result.current.isSharing).toBe(false);\n    });\n  });\n});\n"],"names":["jest","mock","isFeatureEnabled","fn","global","fetch","Object","defineProperty","navigator","value","writable","window","describe","beforeEach","clearAllMocks","mockResolvedValue","ok","json","Promise","resolve","success","it","result","renderHook","useSocialSharing","sharingOptions","title","description","url","pollId","contentType","placement","act","response","current","shareToPlatform","expect","toBe","platform","open","toHaveBeenCalledWith","stringContaining","error","toContain","mockShare","undefined","shareNative","text","mockRejectedValue","Error","mockWriteText","writeText","copyToClipboard","method","headers","body","JSON","stringify","poll_id","content_type","clearError","shareError","require","mockReturnValue","isSharing","sharePromise"],"mappings":"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"}