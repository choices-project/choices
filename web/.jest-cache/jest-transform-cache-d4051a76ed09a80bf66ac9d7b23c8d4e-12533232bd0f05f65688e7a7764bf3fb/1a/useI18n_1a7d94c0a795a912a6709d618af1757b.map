{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/hooks/useI18n.ts"],"sourcesContent":["/**\n * useI18n Hook\n * \n * React hook for internationalization functionality\n * Provides translation functions and language management\n * \n * Created: January 23, 2025\n * Status: âœ… ACTIVE\n */\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { \n  t as i18nT, \n  setLanguage, \n  getCurrentLanguage, \n  getTranslations,\n  isLanguageSupported,\n  getLanguageDisplayName,\n  formatNumber,\n  formatDate,\n  formatCurrency,\n  type SupportedLanguage \n} from '@/lib/i18n';\n\nexport interface UseI18nReturn {\n  // Translation function\n  t: (key: string, params?: Record<string, string | number>) => string;\n  \n  // Language management\n  currentLanguage: SupportedLanguage;\n  setLanguage: (language: SupportedLanguage) => Promise<void>;\n  isLanguageSupported: (language: string) => language is SupportedLanguage;\n  getLanguageDisplayName: (language: SupportedLanguage) => string;\n  \n  // Formatting functions\n  formatNumber: (value: number, options?: Intl.NumberFormatOptions) => string;\n  formatDate: (date: Date, options?: Intl.DateTimeFormatOptions) => string;\n  formatCurrency: (value: number, currency?: string, options?: Intl.NumberFormatOptions) => string;\n  \n  // State\n  isLoading: boolean;\n  error: string | null;\n  translations: Record<SupportedLanguage, any>;\n}\n\nexport function useI18n(): UseI18nReturn {\n  const [currentLanguage, setCurrentLanguageState] = useState<SupportedLanguage>(getCurrentLanguage());\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [translations, setTranslations] = useState<Record<SupportedLanguage, any>>(getTranslations());\n\n  // Translation function with error handling\n  const t = useCallback((key: string, params?: Record<string, string | number>): string => {\n    try {\n      return i18nT(key, params);\n    } catch (err) {\n      console.warn(`Translation error for key \"${key}\":`, err);\n      return key;\n    }\n  }, []);\n\n  // Language change handler\n  const handleSetLanguage = useCallback(async (language: SupportedLanguage) => {\n    if (!isLanguageSupported(language)) {\n      setError(`Unsupported language: ${language}`);\n      return;\n    }\n\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      await setLanguage(language);\n      setCurrentLanguageState(language);\n      setTranslations(getTranslations());\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to change language';\n      setError(errorMessage);\n      console.error('Language change failed:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Initialize i18n on mount\n  useEffect(() => {\n    const initializeI18n = async () => {\n      setIsLoading(true);\n      try {\n        // Get language from localStorage or browser preference\n        const savedLanguage = localStorage.getItem('choices-language');\n        const browserLanguage = navigator.language.split('-')[0] as SupportedLanguage;\n        const targetLanguage = savedLanguage && isLanguageSupported(savedLanguage) \n          ? savedLanguage\n          : isLanguageSupported(browserLanguage) \n            ? browserLanguage \n            : 'en';\n\n        await handleSetLanguage(targetLanguage);\n      } catch (err) {\n        console.error('Failed to initialize i18n:', err);\n        setError('Failed to initialize internationalization');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    initializeI18n();\n  }, [handleSetLanguage]);\n\n  // Save language preference\n  useEffect(() => {\n    if (currentLanguage) {\n      localStorage.setItem('choices-language', currentLanguage);\n    }\n  }, [currentLanguage]);\n\n  return {\n    t,\n    currentLanguage,\n    setLanguage: handleSetLanguage,\n    isLanguageSupported,\n    getLanguageDisplayName,\n    formatNumber: (value: number, options?: Intl.NumberFormatOptions) => {\n      try {\n        return formatNumber(value, options);\n      } catch (err) {\n        console.warn('Number formatting failed:', err);\n        return String(value);\n      }\n    },\n    formatDate: (date: Date, options?: Intl.DateTimeFormatOptions) => {\n      try {\n        return formatDate(date, options);\n      } catch (err) {\n        console.warn('Date formatting failed:', err);\n        return date.toLocaleDateString();\n      }\n    },\n    formatCurrency: (value: number, currency = 'USD', options?: Intl.NumberFormatOptions) => {\n      try {\n        return formatCurrency(value, currency, options);\n      } catch (err) {\n        console.warn('Currency formatting failed:', err);\n        return `${currency} ${value}`;\n      }\n    },\n    isLoading,\n    error,\n    translations\n  };\n}\n\n// Export individual functions for direct use\nexport { \n  t, \n  setLanguage, \n  getCurrentLanguage, \n  getTranslations,\n  isLanguageSupported,\n  getLanguageDisplayName,\n  formatNumber,\n  formatDate,\n  formatCurrency \n} from '@/lib/i18n';\n"],"names":["formatCurrency","formatDate","formatNumber","getCurrentLanguage","getLanguageDisplayName","getTranslations","isLanguageSupported","setLanguage","t","useI18n","currentLanguage","setCurrentLanguageState","useState","isLoading","setIsLoading","error","setError","translations","setTranslations","useCallback","key","params","i18nT","err","console","warn","handleSetLanguage","language","errorMessage","Error","message","useEffect","initializeI18n","savedLanguage","localStorage","getItem","browserLanguage","navigator","split","targetLanguage","setItem","value","options","String","date","toLocaleDateString","currency"],"mappings":"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"}