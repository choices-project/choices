{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/features/feeds/components/UnifiedFeed.tsx"],"sourcesContent":["'use client';\n\n/**\n * Unified Feed Component\n * \n * Consolidated feed component that combines all feed functionality:\n * - Social feed with Instagram-like features\n * - Hashtag-polls integration for personalized content\n * - Mobile-optimized with PWA features\n * - Real-time updates and analytics\n * - Comprehensive hashtag integration\n * \n * This replaces: SocialFeed, EnhancedSocialFeed, FeedHashtagIntegration\n * \n * Created: January 19, 2025\n * Status: âœ… ACTIVE\n */\n\nimport React, { useState, useEffect, useCallback, useMemo, useRef } from 'react';\n// Temporarily removed Zustand imports to fix SSR issues\n// import { useAppStore, useAppActions } from '@/lib/stores/appStore';\n// import { useFeedsStore } from '@/lib/stores/feedsStore';\nimport {\n  HashtagIcon,\n  ArrowTrendingUpIcon,\n  ClockIcon,\n  UserGroupIcon,\n  ChartBarIcon,\n  ArrowPathIcon\n} from '@heroicons/react/24/outline';\n\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Input } from '@/components/ui/input';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { FeatureWrapper } from '@/components/shared/FeatureWrapper';\n// import { PollCard } from '@/features/polls/components';\n\n\nimport { cn } from '@/lib/utils';\nimport { logger } from '@/lib/utils/logger';\n\nimport type { \n  UserPreferences\n} from '@/features/civics/lib/types/civics-types';\nimport FeedItem from './FeedItem';\nimport { useSocialSharing } from '@/hooks/useSocialSharing';\n\ninterface UnifiedFeedProps {\n  userId?: string;\n  preferences?: UserPreferences;\n  onLike?: (itemId: string) => void;\n  onShare?: (itemId: string) => void;\n  onBookmark?: (itemId: string) => void;\n  onComment?: (itemId: string) => void;\n  onViewDetails?: (itemId: string) => void;\n  onPollSelect?: (pollId: string) => void;\n  onHashtagSelect?: (hashtag: string) => void;\n  className?: string;\n  enablePersonalization?: boolean;\n  enableRealTimeUpdates?: boolean;\n  enableAnalytics?: boolean;\n  enableHaptics?: boolean;\n  enableHashtagPolls?: boolean;\n  enableMobileOptimization?: boolean;\n  showTrending?: boolean;\n  maxItems?: number;\n}\n\nfunction UnifiedFeed({\n  userId,\n  preferences,\n  onLike,\n  onShare,\n  onBookmark,\n  onComment,\n  onViewDetails,\n  onPollSelect,\n  onHashtagSelect,\n  className = '',\n  enablePersonalization = true,\n  enableRealTimeUpdates = true,\n  enableAnalytics = false,\n  enableHaptics = true,\n  enableHashtagPolls = true,\n  enableMobileOptimization = true,\n  showTrending = true,\n  maxItems = 50\n}: UnifiedFeedProps) {\n  console.log('[UnifiedFeed] Component rendering', { userId });\n  \n  // Store hooks - temporarily disabled to test rendering\n  // const feeds = useFeeds();\n  // const { loadFeeds, likeFeed, bookmarkFeed, refreshFeeds } = useFeedsActions();\n  // const isLoading = useFeedsLoading();\n  // const pwaStore = usePWAStore();\n  // const { user } = useUserStore();\n  // const addNotification = useNotificationStore(state => state.addNotification);\n  // Hashtag hooks - temporarily disabled to test rendering\n  // const { hashtags, trendingHashtags } = useHashtagStore();\n  // const { getTrendingHashtags } = useHashtagActions();\n  // const { trendingCount } = useHashtagStats();\n  \n  // Simplified state management to prevent timeout\n  const [feeds, setFeeds] = useState<any[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [loadError, setLoadError] = useState<string | null>(null);\n  \n  const loadFeeds = async () => {\n    try {\n      setIsLoading(true);\n      const response = await fetch('/api/feeds');\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      const data = await response.json();\n      console.log('[UnifiedFeed] API response:', data);\n      setFeeds(data.feeds || []);\n      setLoadError(null);\n    } catch (error) {\n      console.error('[UnifiedFeed] API error:', error);\n      setLoadError('Failed to load feeds');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  \n  const likeFeed = () => Promise.resolve();\n  const bookmarkFeed = () => Promise.resolve();\n  const refreshFeeds = () => loadFeeds();\n  const pwaStore = { isOnline: true };\n  const user = { id: 'test-user' };\n  const addNotification = () => {};\n  const hashtags = [];\n  const trendingHashtags: string[] = [];\n  const getTrendingHashtags = () => Promise.resolve();\n  const trendingCount = 0;\n\n  // Local state\n  const [activeTab, setActiveTab] = useState('feed');\n  const [hashtagPollsFeed, setHashtagPollsFeed] = useState<any | null>(null);\n  const [selectedHashtags, setSelectedHashtags] = useState<string[]>([]);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  const [personalizationScore, setPersonalizationScore] = useState(0);\n  const [lastUpdate, setLastUpdate] = useState<Date>(new Date());\n  const [isDarkMode, setIsDarkMode] = useState(false);\n  const [isClient, setIsClient] = useState(false);\n  const [notificationPermission, setNotificationPermission] = useState<NotificationPermission>('default');\n  const [swRegistration, setSwRegistration] = useState<ServiceWorkerRegistration | null>(null);\n  const [lastSync, setLastSync] = useState<Date | null>(null);\n  const [syncStatus, setSyncStatus] = useState<'idle' | 'syncing' | 'error'>('idle');\n  const [showAdvancedFilters, setShowAdvancedFilters] = useState(false);\n  const [accessibilityAnnouncements, setAccessibilityAnnouncements] = useState<string[]>([]);\n  const [errorMessage, setErrorMessage] = useState<string>('');\n  const [showError, setShowError] = useState<boolean>(false);\n  const [pullDistance, setPullDistance] = useState(0);\n  const [hasMore, setHasMore] = useState(true);\n  const [page, setPage] = useState(1);\n  const [expandedItems, setExpandedItems] = useState<Set<string>>(new Set());\n  const [loadingImages, setLoadingImages] = useState<Set<string>>(new Set());\n  const [refreshThreshold] = useState(80);\n  // Refs\n  const wsRef = useRef<WebSocket | null>(null);\n  const refreshIntervalRef = useRef<NodeJS.Timeout | null>(null);\n  const touchStartRef = useRef<{ x: number; y: number; time: number } | null>(null);\n  const longPressTimerRef = useRef<NodeJS.Timeout | null>(null);\n  const feedRef = useRef<HTMLDivElement>(null);\n  const observerRef = useRef<IntersectionObserver | null>(null);\n  const lastItemRef = useRef<HTMLDivElement>(null);\n  const scrollToTopRef = useRef<HTMLButtonElement>(null);\n\n  // Touch gesture handling (from FeedItem.tsx) - moved to pull-to-refresh section\n\n  // PWA Features\n  const initializeSuperiorPWAFeatures = useCallback(async () => {\n    if ('serviceWorker' in navigator) {\n      try {\n        const registration = await navigator.serviceWorker.ready;\n        setSwRegistration(registration);\n        \n        // Request notification permission\n        if ('Notification' in window) {\n          const permission = await Notification.requestPermission();\n          setNotificationPermission(permission);\n          \n          if (permission === 'granted' && registration) {\n            await subscribeToNotifications(registration);\n          }\n        }\n      } catch (error) {\n        console.error('Service Worker registration failed:', error);\n      }\n    }\n  }, []);\n\n  // Push notification subscription\n  const subscribeToNotifications = useCallback(async (registration: ServiceWorkerRegistration) => {\n    try {\n      const subscription = await registration.pushManager.subscribe({\n        userVisibleOnly: true,\n        applicationServerKey: process.env.NEXT_PUBLIC_VAPID_PUBLIC_KEY ?? null\n      });\n      \n      // Send subscription to server\n      await fetch('/api/pwa?action=subscribe', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(subscription)\n      });\n      \n      logger.info('Push subscription successful');\n    } catch (error) {\n      console.error('Push subscription failed:', error);\n    }\n  }, []);\n\n  const checkOnlineStatus = useCallback(() => {\n    const handleOnline = () => {\n      if (swRegistration) {\n        syncOfflineData();\n      }\n    };\n    \n    const handleOffline = () => {\n      // Handle offline state\n    };\n    \n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n    \n    return () => {\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n    };\n  }, [swRegistration]);\n\n  const syncOfflineData = useCallback(async () => {\n    setSyncStatus('syncing');\n    try {\n      const response = await fetch('/api/pwa?action=sync', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ userId, lastSync: lastSync?.toISOString() })\n      });\n      \n      if (response.ok) {\n        setLastSync(new Date());\n        setSyncStatus('idle');\n      }\n    } catch (error) {\n      console.error('Sync failed:', error);\n      setSyncStatus('error');\n    }\n  }, [userId, lastSync]);\n\n  // Accessibility helper functions\n  const announceToScreenReader = useCallback((message: string) => {\n    setAccessibilityAnnouncements(prev => [...prev, message]);\n    if (typeof window !== 'undefined') {\n    const liveRegion = document.getElementById('live-region-content');\n    if (liveRegion) {\n      liveRegion.textContent = message;\n    }\n    setTimeout(() => {\n      setAccessibilityAnnouncements(prev => prev.slice(1));\n      if (liveRegion) {\n        liveRegion.textContent = '';\n      }\n    }, 5000);\n    }\n  }, []);\n\n  const setError = useCallback((message: string) => {\n    setErrorMessage(message);\n    announceToScreenReader(`Error: ${message}`);\n  }, [announceToScreenReader]);\n\n  const clearError = useCallback(() => {\n    setErrorMessage('');\n  }, []);\n\n  // Load hashtag-polls feed if enabled\n  const loadHashtagPollsFeed = useCallback(async () => {\n    if (!enableHashtagPolls || !userId) return;\n\n    try {\n      // Use the existing /api/feeds endpoint instead of the non-existent interest-based endpoint\n      const response = await fetch(`/api/feeds?userId=${userId}&limit=20`);\n      if (!response.ok) return;\n\n      const data = await response.json();\n      if (data.success && data.feeds) {\n        setHashtagPollsFeed({\n          user_id: userId,\n          hashtag_interests: [],\n          recommended_polls: data.feeds || [],\n          trending_hashtags: [],\n          hashtag_analytics: [],\n          feed_score: 0,\n          last_updated: new Date()\n        });\n      }\n    } catch (error) {\n      logger.warn('Failed to load hashtag-polls feed:', { error: error as Error });\n    }\n  }, [userId, enableHashtagPolls]);\n\n  // Load feed data\n  const loadFeedData = useCallback(async () => {\n    console.log('[UnifiedFeed] loadFeedData called');\n    try {\n      console.log('[UnifiedFeed] Calling loadFeeds...');\n      await loadFeeds();\n      console.log('[UnifiedFeed] Calling loadHashtagPollsFeed...');\n      await loadHashtagPollsFeed();\n      setLastUpdate(new Date());\n      console.log('[UnifiedFeed] Feed data loaded successfully');\n    } catch (error) {\n      console.error('[UnifiedFeed] Failed to load feed data:', error);\n      logger.error('Failed to load feed data:', error as Error);\n      setError('Failed to load feed data');\n      console.log('[UnifiedFeed] Error state set:', error);\n    }\n  }, [loadFeeds, loadHashtagPollsFeed, setError]);\n\n  // Initialize feed data with cleanup - simplified to prevent timeout\n  useEffect(() => {\n    console.log('[UnifiedFeed] useEffect triggered', { userId });\n    if (userId) {\n      console.log('[UnifiedFeed] Loading feeds for userId:', userId);\n      // Simplified feed loading to prevent timeout\n      loadFeeds().catch(error => {\n        console.error('[UnifiedFeed] Error loading feeds:', error);\n        setLoadError('Failed to load feeds');\n      });\n    } else {\n      console.log('[UnifiedFeed] No userId provided');\n    }\n    \n    // Cleanup function to prevent memory leaks\n    return () => {\n      // Clear any pending timeouts\n      if (refreshIntervalRef.current) {\n        clearInterval(refreshIntervalRef.current);\n      }\n      if (longPressTimerRef.current) {\n        clearTimeout(longPressTimerRef.current);\n      }\n      // Close WebSocket connection\n      if (wsRef.current) {\n        wsRef.current.close();\n      }\n      // Disconnect intersection observer\n      if (observerRef.current) {\n        observerRef.current.disconnect();\n      }\n    };\n  }, [userId]); // Only depend on userId to prevent infinite loop\n\n  // Load trending hashtags - temporarily disabled to fix infinite loop\n  // useEffect(() => {\n  //   if (showTrending) {\n  //     getTrendingHashtags();\n  //   }\n  // }, [showTrending, getTrendingHashtags]);\n\n  // Optimized filtered feed items with better memoization\n  const filteredFeedItems = useMemo(() => {\n    let filtered = feeds || [];\n\n    // Filter by selected hashtags\n    if (selectedHashtags.length > 0) {\n      filtered = filtered.filter(item => \n        selectedHashtags.some(hashtag => \n          (item).hashtags?.includes(hashtag)\n        )\n      );\n    }\n\n    // Filter by search query\n    if (searchQuery) {\n      filtered = filtered.filter(item => \n        item.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        (item).description?.toLowerCase().includes(searchQuery.toLowerCase())\n      );\n    }\n\n    return filtered.slice(0, maxItems);\n  }, [feeds, selectedHashtags, searchQuery, maxItems]);\n\n  // Handle hashtag selection\n  const handleHashtagSelect = useCallback((hashtag: string) => {\n    setSelectedHashtags(prev => {\n      if (prev.includes(hashtag)) {\n        return prev.filter(h => h !== hashtag);\n      } else {\n        return [...prev, hashtag];\n      }\n    });\n    onHashtagSelect?.(hashtag);\n  }, [onHashtagSelect]);\n\n  // Handle poll selection\n  const handlePollSelect = useCallback((pollId: string) => {\n    onPollSelect?.(pollId);\n  }, [onPollSelect]);\n\n  // Analytics tracking (from EnhancedSocialFeed.tsx)\n  const trackEvent = useCallback((event: string, data?: any) => {\n    if (enableAnalytics) {\n      logger.info('Analytics:', { event, data });\n      \n      try {\n        // Track social media click event\n        if (typeof window !== 'undefined' && window.gtag) {\n          window.gtag('event', 'social_media_click', {\n            event_category: 'civics',\n            event_label: data?.platform ?? 'unknown',\n            value: 1\n          });\n        }\n        \n        // Track in local analytics if available\n        if (typeof window !== 'undefined' && (window as any).analytics) {\n          (window as any).analytics.track('Social Media Clicked', {\n            platform: data?.platform ?? 'unknown',\n            handle: data?.handle ?? 'unknown',\n            url: data?.url ?? 'unknown',\n            representative: data?.representative ?? 'unknown'\n          });\n        }\n      } catch (error) {\n        console.warn('Analytics tracking failed:', error);\n      }\n    }\n  }, [enableAnalytics]);\n\n  // Enhanced engagement tracking\n  const trackEngagement = useCallback((action: string, itemId: string, metadata?: any) => {\n    trackEvent(`feed_item_${action}`, { itemId, ...metadata });\n    \n    // Update personalization score based on engagement\n    if (action === 'liked' || action === 'bookmarked') {\n      setPersonalizationScore(prev => Math.min(prev + 0.1, 1.0));\n    }\n  }, [trackEvent]);\n\n  // Handle feed item interactions\n  const handleLike = useCallback(async (itemId: string) => {\n    try {\n      await likeFeed();\n      onLike?.(itemId);\n      \n      if (enableHaptics && 'vibrate' in navigator) {\n        navigator.vibrate(50);\n      }\n      \n      trackEngagement('liked', itemId);\n      announceToScreenReader(`Liked item ${itemId}`);\n    } catch (error) {\n      logger.error('Failed to like item:', error as Error);\n      setError('Failed to like item');\n    }\n  }, [likeFeed, onLike, enableHaptics, trackEngagement, announceToScreenReader, setError]);\n\n  const handleBookmark = useCallback(async (itemId: string) => {\n    try {\n      await bookmarkFeed();\n      onBookmark?.(itemId);\n      \n      if (enableHaptics && 'vibrate' in navigator) {\n        navigator.vibrate(50);\n      }\n      \n      trackEngagement('bookmarked', itemId);\n      announceToScreenReader(`Bookmarked item ${itemId}`);\n    } catch (error) {\n      logger.error('Failed to bookmark item:', error as Error);\n      setError('Failed to bookmark item');\n    }\n  }, [bookmarkFeed, onBookmark, enableHaptics, trackEngagement, announceToScreenReader, setError]);\n\n  // Social sharing hook\n  const { shareToPlatform, shareNative, socialSharingEnabled } = useSocialSharing();\n\n  const handleShare = useCallback(async (itemId: string) => {\n    console.log('[UnifiedFeed] handleShare called with itemId:', itemId);\n    if (enableHaptics && 'vibrate' in navigator) {\n      navigator.vibrate(25);\n    }\n    onShare?.(itemId);\n    \n    const item = feeds.find((item: any) => item.id === itemId);\n    if (!item) {\n      console.warn('Item not found for sharing:', itemId);\n      return;\n    }\n\n    // Determine content type and URL\n    const contentType = item.type === 'poll' ? 'poll' : 'feed';\n    const shareUrl = item.url || `${window.location.origin}/polls/${itemId}`;\n    \n    const sharingOptions = {\n      title: item.title,\n      description: item.description || item.summary || '',\n      url: shareUrl,\n      pollId: item.type === 'poll' ? itemId : undefined,\n      contentType: contentType as 'poll' | 'representative' | 'feed',\n      placement: 'feed'\n    };\n\n    // Try native sharing first, then fall back to platform-specific sharing\n    if (typeof navigator !== 'undefined' && 'share' in navigator) {\n      const result = await shareNative(sharingOptions);\n      if (result.success) {\n        trackEngagement('shared', itemId);\n        announceToScreenReader(`Shared item ${itemId}`);\n        return;\n      }\n    }\n\n    // If native sharing fails or isn't available, show platform options\n    if (socialSharingEnabled) {\n      // For now, default to Twitter sharing\n      // In a full implementation, this would show a modal with platform options\n      const result = await shareToPlatform('twitter', sharingOptions);\n      if (result.success) {\n        trackEngagement('shared', itemId);\n        announceToScreenReader(`Shared item ${itemId} to Twitter`);\n      }\n    }\n    \n    console.log('[UnifiedFeed] Calling announceToScreenReader with:', `Shared item ${itemId}`);\n  }, [onShare, enableHaptics, feeds, trackEngagement, announceToScreenReader, shareToPlatform, shareNative, socialSharingEnabled]);\n\n  const handleComment = useCallback((itemId: string) => {\n    if (enableHaptics && 'vibrate' in navigator) {\n      navigator.vibrate(25);\n    }\n    onComment?.(itemId);\n    \n    trackEngagement('commented', itemId);\n    announceToScreenReader(`Opened comments for item ${itemId}`);\n  }, [onComment, enableHaptics, trackEngagement, announceToScreenReader]);\n\n  const handleViewDetails = useCallback((itemId: string) => {\n    onViewDetails?.(itemId);\n    \n    trackEngagement('viewed_details', itemId);\n    announceToScreenReader(`Viewing details for item ${itemId}`);\n  }, [onViewDetails, trackEngagement, announceToScreenReader]);\n\n  // Infinite scroll setup - temporarily disabled to fix infinite loop\n  // useEffect(() => {\n  //   if (process.env.NODE_ENV === 'test') {\n  //     return;\n  //   }\n\n  //   if (observerRef.current) {\n  //     observerRef.current.disconnect();\n  //   }\n\n  //   observerRef.current = new IntersectionObserver(\n  //     (entries) => {\n  //       if (entries[0]?.isIntersecting && hasMore && !isLoading) {\n  //         handleLoadMore();\n  //       }\n  //     },\n  //     { threshold: 0.1 }\n  //   );\n\n  //   if (lastItemRef.current) {\n  //     observerRef.current.observe(lastItemRef.current);\n  //   }\n\n  //   return () => {\n  //     if (observerRef.current) {\n  //       observerRef.current.disconnect();\n  //     }\n  //   };\n  // }, [hasMore, isLoading]);\n\n  // Load more functionality\n  const handleLoadMore = useCallback(async () => {\n    if (hasMore && !isLoading) {\n      setPage(prev => prev + 1);\n      await loadFeeds();\n      setHasMore(feeds.length === 20); // Adjust based on your pagination\n    }\n  }, [hasMore, isLoading, loadFeeds, feeds.length]);\n\n  // Scroll to top functionality\n  const scrollToTop = useCallback(() => {\n    if (typeof window !== 'undefined') {\n    window.scrollTo({ top: 0, behavior: 'smooth' });\n    announceToScreenReader('Scrolled to top');\n    }\n  }, [announceToScreenReader]);\n\n  // Dark mode toggle - moved to later in file\n\n  // Refresh functionality\n  const handleRefresh = useCallback(async () => {\n    setIsRefreshing(true);\n    try {\n      await refreshFeeds();\n      await loadHashtagPollsFeed();\n      setLastUpdate(new Date());\n      announceToScreenReader('Feed refreshed');\n    } catch (error) {\n      logger.error('Failed to refresh feeds:', error as Error);\n      setError('Failed to refresh feed');\n    } finally {\n      setIsRefreshing(false);\n    }\n  }, [refreshFeeds, loadHashtagPollsFeed, announceToScreenReader, setError]);\n\n  // Real-time updates with WebSocket (from EnhancedSocialFeed.tsx) - temporarily disabled to fix infinite loop\n  // useEffect(() => {\n  //   if (process.env.NODE_ENV === 'test') {\n  //     return;\n  //   }\n  //   if (enableRealTimeUpdates && userId) {\n  //     // WebSocket connection for real-time updates\n  //     const ws = new WebSocket(`wss://your-websocket-endpoint/feed/${userId}`);\n  //     wsRef.current = ws;\n\n  //     ws.onmessage = (event) => {\n  //       const data = JSON.parse(event.data);\n  //       if (data.label === 'new_item') {\n  //         logger.info('New item received:', data.item);\n  //         announceToScreenReader('New content available');\n  //       } else if (data.label === 'engagement_update') {\n  //         logger.info('Engagement update received:', data);\n  //         announceToScreenReader('Engagement updated');\n  //       }\n  //     };\n\n  //     // Fallback polling for updates\n  //     refreshIntervalRef.current = setInterval(() => {\n  //       handleRefresh();\n  //     }, 30000); // Refresh every 30 seconds\n\n  //     return () => {\n  //       ws.close();\n  //       if (refreshIntervalRef.current) {\n  //         clearInterval(refreshIntervalRef.current);\n  //       }\n  //     };\n  //   }\n  // }, [enableRealTimeUpdates, userId, handleRefresh, announceToScreenReader]);\n\n  // Initialize PWA features on mount - temporarily disabled to fix infinite loop\n  // useEffect(() => {\n  //   const initializeApp = async () => {\n  //     try {\n  //       if (typeof window !== 'undefined' && process.env.NODE_ENV !== 'test') {\n  //         await initializeSuperiorPWAFeatures();\n  //         checkOnlineStatus();\n  //       }\n  //     } catch (error) {\n  //       console.error('Error initializing app:', error);\n  //       setError('Failed to initialize app features');\n  //     }\n  //   };\n  //   \n  //   const timeoutId = setTimeout(initializeApp, 0);\n  //   return () => clearTimeout(timeoutId);\n  // }, [initializeSuperiorPWAFeatures, checkOnlineStatus, setError]);\n\n  // Content type icons (from FeedItem.tsx)\n  const getContentTypeIcon = useCallback((type: string) => {\n    const iconClass = \"w-5 h-5\";\n    \n    switch (type) {\n      case 'vote':\n        return <div className={`${iconClass} bg-green-100 rounded-full flex items-center justify-center`}>\n          <span className=\"text-green-600 text-xs font-bold\">V</span>\n        </div>;\n      case 'bill':\n        return <div className={`${iconClass} bg-blue-100 rounded-full flex items-center justify-center`}>\n          <span className=\"text-blue-600 text-xs font-bold\">B</span>\n        </div>;\n      case 'statement':\n        return <div className={`${iconClass} bg-purple-100 rounded-full flex items-center justify-center`}>\n          <span className=\"text-purple-600 text-xs font-bold\">S</span>\n        </div>;\n      case 'social_media':\n        return <div className={`${iconClass} bg-pink-100 rounded-full flex items-center justify-center`}>\n          <span className=\"text-pink-600 text-xs font-bold\">@</span>\n        </div>;\n      case 'photo':\n        return <div className={`${iconClass} bg-gray-100 rounded-full flex items-center justify-center`}>\n          <span className=\"text-gray-600 text-xs font-bold\">ðŸ“·</span>\n        </div>;\n      default:\n        return <div className={`${iconClass} bg-gray-100 rounded-full flex items-center justify-center`}>\n          <span className=\"text-gray-600 text-xs font-bold\">?</span>\n        </div>;\n    }\n  }, []);\n\n  // Party colors (from FeedItem.tsx)\n  const getPartyColor = useCallback((party: string) => {\n    const partyColors: Record<string, string> = {\n      'Republican': 'text-red-600 bg-red-50 border-red-200',\n      'Democrat': 'text-blue-600 bg-blue-50 border-blue-200',\n      'Independent': 'text-gray-600 bg-gray-50 border-gray-200',\n      'Green': 'text-green-600 bg-green-50 border-green-200',\n      'Libertarian': 'text-yellow-600 bg-yellow-50 border-yellow-200'\n    };\n    \n    return partyColors[party] ?? 'text-gray-600 bg-gray-50 border-gray-200';\n  }, []);\n\n  // Format date (from FeedItem.tsx)\n  const formatDate = useCallback((date: Date | string | null | undefined) => {\n    if (!date) return 'Unknown date';\n    \n    const now = new Date();\n    const dateObj = typeof date === 'string' ? new Date(date) : date;\n    \n    if (!dateObj || isNaN(dateObj.getTime())) {\n      return 'Invalid date';\n    }\n    \n    const diffInHours = Math.floor((now.getTime() - dateObj.getTime()) / (1000 * 60 * 60));\n    \n    if (diffInHours < 1) return 'Just now';\n    if (diffInHours < 24) return `${diffInHours}h ago`;\n    if (diffInHours < 48) return 'Yesterday';\n    return new Date(date).toLocaleDateString();\n  }, []);\n\n  // Personalization algorithms (from EnhancedSocialFeed.tsx)\n  const calculatePersonalizationScore = useCallback((userInterests: string[], contentTags: string[]) => {\n    if (!userInterests.length || !contentTags.length) return 0;\n    \n    const matchingTags = contentTags.filter(tag => \n      userInterests.some(interest => \n        interest.toLowerCase().includes(tag.toLowerCase()) ||\n        tag.toLowerCase().includes(interest.toLowerCase())\n      )\n    );\n    \n    return matchingTags.length / Math.max(userInterests.length, contentTags.length);\n  }, []);\n\n  // Progressive disclosure functionality\n  const toggleItemExpansion = useCallback((itemId: string) => {\n    setExpandedItems(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(itemId)) {\n        newSet.delete(itemId);\n        announceToScreenReader(`Collapsed item ${itemId}`);\n      } else {\n        newSet.add(itemId);\n        announceToScreenReader(`Expanded item ${itemId}`);\n      }\n      return newSet;\n    });\n  }, [announceToScreenReader]);\n\n  // Image loading with progressive enhancement\n  const handleImageLoad = useCallback((itemId: string) => {\n    setLoadingImages(prev => {\n      const newSet = new Set(prev);\n      newSet.delete(itemId);\n      return newSet;\n    });\n  }, []);\n\n  const handleImageError = useCallback((itemId: string) => {\n    setLoadingImages(prev => {\n      const newSet = new Set(prev);\n      newSet.delete(itemId);\n      return newSet;\n    });\n    setError(`Failed to load image for item ${itemId}`);\n  }, [setError]);\n\n  // Lazy loading for images\n  const loadImage = useCallback((itemId: string, imageUrl: string) => {\n    setLoadingImages(prev => new Set(prev).add(itemId));\n    \n    const img = new (typeof window !== 'undefined' ? window.Image : Image)();\n    img.onload = () => handleImageLoad(itemId);\n    img.onerror = () => handleImageError(itemId);\n    img.src = imageUrl;\n  }, [handleImageLoad, handleImageError]);\n\n  // Pull-to-refresh functionality\n  const handlePullToRefresh = useCallback(async () => {\n    if (isRefreshing) return;\n    \n    setIsRefreshing(true);\n    announceToScreenReader('Refreshing feed...');\n    \n    try {\n      // Refresh feed data\n      await refreshFeeds();\n      \n      // Reset pagination\n      setPage(1);\n      setHasMore(true);\n      \n      // Clear expanded items\n      setExpandedItems(new Set());\n      \n      // Announce success\n      announceToScreenReader('Feed refreshed successfully');\n      \n      // Haptic feedback\n      if (enableHaptics && 'vibrate' in navigator) {\n        navigator.vibrate([50, 100, 50]);\n      }\n    } catch (error) {\n      console.error('Pull to refresh failed:', error);\n      announceToScreenReader('Failed to refresh feed');\n      setError('Failed to refresh feed');\n    } finally {\n      setIsRefreshing(false);\n    }\n  }, [isRefreshing, refreshFeeds, announceToScreenReader, enableHaptics, setError]);\n\n  // Enhanced touch handling for pull-to-refresh\n  const handleTouchStart = useCallback((e: React.TouchEvent) => {\n    if (typeof window !== 'undefined' && window.scrollY === 0 && e.touches[0]) {\n      touchStartRef.current = {\n        x: e.touches[0].clientX,\n        y: e.touches[0].clientY,\n        time: Date.now()\n      };\n    }\n  }, []);\n\n  const handleTouchMove = useCallback((e: React.TouchEvent) => {\n    if (!touchStartRef.current || (typeof window !== 'undefined' && window.scrollY > 0) || !e.touches[0]) return;\n    \n    const touch = e.touches[0];\n    const deltaY = touch.clientY - touchStartRef.current.y;\n    \n    if (deltaY > 0) {\n      const distance = Math.min(deltaY * 0.5, refreshThreshold);\n      setPullDistance(distance);\n      \n      if (distance >= refreshThreshold && !isRefreshing) {\n        announceToScreenReader('Release to refresh');\n      }\n    }\n  }, [refreshThreshold, isRefreshing, announceToScreenReader]);\n\n  const handleTouchEnd = useCallback((e: React.TouchEvent) => {\n    if (!touchStartRef.current || !e.changedTouches[0]) return;\n    \n    const touch = e.changedTouches[0];\n    const deltaY = touch.clientY - touchStartRef.current.y;\n    const deltaTime = Date.now() - touchStartRef.current.time;\n    \n    if (deltaY >= refreshThreshold && deltaTime < 1000 && (typeof window !== 'undefined' && window.scrollY === 0)) {\n      handlePullToRefresh();\n    }\n    \n    setPullDistance(0);\n    touchStartRef.current = null;\n  }, [refreshThreshold, handlePullToRefresh]);\n\n  // Dark mode functionality\n  const toggleDarkMode = useCallback(() => {\n    console.log('[UnifiedFeed] toggleDarkMode called');\n    if (typeof window === 'undefined') return; // Client-side check\n    setIsDarkMode(prev => {\n      const newMode = !prev;\n      console.log('[UnifiedFeed] Setting dark mode to:', newMode);\n      \n      // Update document class for global dark mode\n      if (newMode) {\n        document.documentElement.classList.add('dark');\n        document.body.classList.add('dark');\n      } else {\n        document.documentElement.classList.remove('dark');\n        document.body.classList.remove('dark');\n      }\n      \n      // Store preference in localStorage\n      localStorage.setItem('darkMode', newMode.toString());\n      \n      // Announce to screen reader\n      announceToScreenReader(`Switched to ${newMode ? 'dark' : 'light'} mode`);\n      \n      // Haptic feedback\n      if (enableHaptics && 'vibrate' in navigator) {\n        navigator.vibrate(25);\n      }\n      \n      return newMode;\n    });\n  }, [announceToScreenReader, enableHaptics]);\n\n  // Ref for dark mode button\n  const darkModeButtonRef = useRef<HTMLButtonElement>(null);\n\n  // Mark as client-side component after hydration\n  useEffect(() => {\n    setIsClient(true);\n    console.log('[UnifiedFeed] isClient set to true');\n  }, []);\n\n  // Initialize dark mode from localStorage and system preference\n  useEffect(() => {\n    // Only run on client side after hydration\n    if (!isClient) return;\n    \n    const stored = localStorage.getItem('darkMode');\n    const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;\n    const shouldBeDark = stored ? stored === 'true' : systemPrefersDark;\n    \n    setIsDarkMode(shouldBeDark);\n    \n    if (shouldBeDark) {\n      document.documentElement.classList.add('dark');\n      document.body.classList.add('dark');\n    } else {\n      document.documentElement.classList.remove('dark');\n      document.body.classList.remove('dark');\n    }\n  }, [isClient]);\n\n  // Show loading state to prevent timeout\n  if (isLoading) {\n    return (\n      <div className={cn('unified-feed', className)} data-testid=\"unified-feed\">\n        <div className=\"flex items-center justify-center min-h-[400px]\">\n          <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  // Show error state\n  if (loadError) {\n    return (\n      <div className={cn('unified-feed', className)} data-testid=\"unified-feed\">\n        <div className=\"flex items-center justify-center min-h-[400px]\">\n          <div className=\"text-center\">\n            <h3 className=\"text-lg font-semibold text-red-600\">Error Loading Feed</h3>\n            <p className=\"text-gray-600\">{loadError}</p>\n            <Button onClick={loadFeeds} className=\"mt-4\">\n              Try Again\n            </Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div \n      ref={feedRef}\n      className={cn(\n        \"space-y-6 transition-colors duration-300\",\n        isDarkMode ? \"bg-gray-900 text-white\" : \"bg-white text-gray-900\",\n        className\n      )} \n      role=\"main\" \n      aria-label=\"Unified Feed\"\n      onTouchStart={handleTouchStart}\n      onTouchMove={handleTouchMove}\n      onTouchEnd={handleTouchEnd}\n    >\n      {/* Pull-to-refresh indicator */}\n      {pullDistance > 0 && (\n        <div \n          className=\"fixed top-0 left-0 right-0 z-50 bg-blue-500 text-white text-center py-2 transition-transform duration-200\"\n          style={{ transform: `translateY(${Math.max(0, pullDistance - 50)}px)` }}\n          role=\"status\"\n          aria-live=\"polite\"\n        >\n          {pullDistance >= refreshThreshold ? 'Release to refresh' : 'Pull to refresh'}\n        </div>\n      )}\n\n      {/* Status Bar with PWA indicators */}\n      <div className=\"bg-blue-50 dark:bg-blue-900 border-b border-gray-200 dark:border-gray-700 p-2\">\n        <div className=\"flex items-center justify-between text-sm\">\n          <div className=\"flex items-center space-x-4\">\n            <div className=\"flex items-center space-x-1\" role=\"status\" aria-live=\"polite\">\n              <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\" aria-hidden=\"true\"></div>\n              <span className=\"text-green-600\">Online</span>\n            </div>\n            {syncStatus === 'syncing' && (\n              <div className=\"flex items-center space-x-1\" role=\"status\" aria-live=\"polite\">\n                <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500\" aria-hidden=\"true\"></div>\n                <span className=\"text-blue-600\">Syncing...</span>\n              </div>\n            )}\n            {isRefreshing && (\n              <div className=\"flex items-center space-x-1\" role=\"status\" aria-live=\"polite\">\n                <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500\" aria-hidden=\"true\"></div>\n                <span className=\"text-blue-600\">Refreshing...</span>\n              </div>\n            )}\n          </div>\n          {lastSync && (\n            <span className=\"text-gray-500\">\n              Last sync: {lastSync.toLocaleTimeString()}\n            </span>\n          )}\n        </div>\n      </div>\n\n      {/* Header with feed controls */}\n      <header className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white\">Unified Feed</h1>\n          <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n            Personalized content with hashtag-polls integration\n            {personalizationScore > 0 && (\n              <span className=\"flex items-center space-x-1 ml-2\">\n                <span className=\"w-2 h-2 bg-blue-500 rounded-full animate-pulse\" aria-hidden=\"true\"></span>\n                <span>Personalized ({Math.round(personalizationScore * 100)}% match)</span>\n              </span>\n            )}\n          </p>\n        </div>\n        <div className=\"flex items-center space-x-4\">\n          {/* Dark mode toggle */}\n          <button\n            ref={darkModeButtonRef}\n            type=\"button\"\n            onClick={toggleDarkMode}\n            className=\"p-2 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors\"\n            aria-label={`Switch to ${isDarkMode ? 'light' : 'dark'} mode`}\n          >\n            {isDarkMode ? (\n              <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z\" />\n              </svg>\n            ) : (\n              <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z\" />\n              </svg>\n            )}\n          </button>\n\n          {/* Advanced filters toggle */}\n          <button\n            onClick={() => setShowAdvancedFilters(!showAdvancedFilters)}\n            className=\"p-2 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors\"\n            aria-label=\"Toggle advanced filters\"\n          >\n            <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4\" />\n            </svg>\n          </button>\n\n          {enableAnalytics && (\n            <div className=\"text-right\">\n              <p className=\"text-sm text-gray-600 dark:text-gray-400\">Personalization</p>\n              <p className=\"text-lg font-semibold text-blue-600\">\n                {Math.round(personalizationScore * 100)}%\n              </p>\n            </div>\n          )}\n          <Button\n            onClick={handleRefresh}\n            disabled={isRefreshing}\n            variant=\"outline\"\n            size=\"sm\"\n            aria-label={isRefreshing ? \"Refreshing feed\" : \"Refresh feed\"}\n            aria-describedby=\"refresh-status\"\n          >\n            <ArrowPathIcon className={cn(\"h-4 w-4\", isRefreshing && \"animate-spin\")} />\n            {isRefreshing ? \"Refreshing...\" : \"Refresh\"}\n          </Button>\n          <div id=\"refresh-status\" className=\"sr-only\">\n            {isRefreshing ? \"Feed is being refreshed\" : \"Click to refresh the feed\"}\n          </div>\n        </div>\n      </header>\n\n      {/* Advanced Filters Section */}\n      {showAdvancedFilters && (\n        <div \n          data-testid=\"advanced-filters\"\n          className=\"mb-4 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg\"\n          role=\"complementary\"\n          aria-label=\"Advanced filter options\"\n        >\n          <h4 className=\"text-sm font-medium text-gray-900 dark:text-white mb-2\">Advanced Filters</h4>\n          <div className=\"space-y-2\">\n            <label className=\"block text-sm text-gray-600 dark:text-gray-400\">\n              <input type=\"checkbox\" className=\"mr-2\" /> Federal Representatives\n            </label>\n            <label className=\"block text-sm text-gray-600 dark:text-gray-400\">\n              <input type=\"checkbox\" className=\"mr-2\" /> State Representatives\n            </label>\n            <label className=\"block text-sm text-gray-600 dark:text-gray-400\">\n              <input type=\"checkbox\" className=\"mr-2\" /> Local Representatives\n            </label>\n            <label className=\"block text-sm text-gray-600 dark:text-gray-400\">\n              <input type=\"checkbox\" className=\"mr-2\" /> Trending Content\n            </label>\n            <label className=\"block text-sm text-gray-600 dark:text-gray-400\">\n              <input type=\"checkbox\" className=\"mr-2\" /> Hashtag-Polls Integration\n            </label>\n          </div>\n        </div>\n      )}\n\n      {/* Pull-to-refresh indicator */}\n      {pullDistance > 0 && (\n        <div className=\"flex items-center justify-center py-4 text-gray-500\">\n          <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500\"></div>\n          <span className=\"ml-2\">Pull to refresh...</span>\n        </div>\n      )}\n\n      {/* Hashtag filters and search */}\n      <Card role=\"region\" aria-label=\"Content filters\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <HashtagIcon className=\"h-5 w-5\" aria-hidden=\"true\" />\n            Content Filters\n            {selectedHashtags.length > 0 && (\n              <Badge variant=\"secondary\" aria-label={`${selectedHashtags.length} hashtags selected`}>\n                {selectedHashtags.length}\n              </Badge>\n            )}\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <FeatureWrapper feature=\"HASHTAG_FILTERING\">\n            <div className=\"space-y-4\">\n              {/* Search */}\n              <div className=\"relative\">\n                <label htmlFor=\"content-search\" className=\"sr-only\">\n                  Search content\n                </label>\n                <Input\n                  id=\"content-search\"\n                  placeholder=\"Search content...\"\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  className=\"pl-10\"\n                  aria-describedby=\"search-help\"\n                />\n                <HashtagIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400\" aria-hidden=\"true\" />\n                <div id=\"search-help\" className=\"sr-only\">\n                  Search through feed content by title or description\n                </div>\n              </div>\n\n              {/* Selected hashtags */}\n              {selectedHashtags.length > 0 && (\n                <div className=\"flex flex-wrap gap-2\" role=\"list\" aria-label=\"Selected hashtags\">\n                  {selectedHashtags.map(hashtag => (\n                    <Badge\n                      key={hashtag}\n                      variant=\"default\"\n                      className=\"cursor-pointer hover:bg-red-100\"\n                      onClick={() => handleHashtagSelect(hashtag)}\n                      role=\"listitem\"\n                      tabIndex={0}\n                      onKeyDown={(e) => {\n                        if (e.key === 'Enter' || e.key === ' ') {\n                          e.preventDefault();\n                          handleHashtagSelect(hashtag);\n                        }\n                      }}\n                      aria-label={`Remove hashtag ${hashtag} from filters`}\n                    >\n                      #{hashtag} Ã—\n                    </Badge>\n                  ))}\n                </div>\n              )}\n\n              {/* Trending hashtags - Always enabled through hashtag system */}\n              {showTrending && trendingHashtags.length > 0 && (\n                <div>\n                  <p className=\"text-sm font-medium text-gray-700 mb-2\">Trending:</p>\n                  <div className=\"flex flex-wrap gap-2\" role=\"list\" aria-label=\"Trending hashtags\">\n                    {trendingHashtags.slice(0, 10).map((hashtag: string) => (\n                      <Badge\n                        key={hashtag}\n                        variant={selectedHashtags.includes(hashtag) ? \"default\" : \"outline\"}\n                        className=\"cursor-pointer hover:bg-blue-100\"\n                        onClick={() => handleHashtagSelect(hashtag)}\n                        role=\"listitem\"\n                        tabIndex={0}\n                        onKeyDown={(e) => {\n                          if (e.key === 'Enter' || e.key === ' ') {\n                            e.preventDefault();\n                            handleHashtagSelect(hashtag);\n                          }\n                        }}\n                        aria-label={`${selectedHashtags.includes(hashtag) ? 'Remove' : 'Add'} hashtag ${hashtag} ${selectedHashtags.includes(hashtag) ? 'from' : 'to'} filters`}\n                      >\n                        <ArrowTrendingUpIcon className=\"h-3 w-3 mr-1\" aria-hidden=\"true\" />\n                        #{hashtag}\n                      </Badge>\n                    ))}\n                  </div>\n                </div>\n              )}\n            </div>\n          </FeatureWrapper>\n        </CardContent>\n      </Card>\n\n    {/* Main content tabs */}\n    <div className=\"mt-6\">\n      <Tabs value={activeTab} onValueChange={setActiveTab} role=\"tablist\" aria-label=\"Feed content sections\">\n        <TabsList className=\"grid w-full grid-cols-3\" role=\"tablist\">\n          <TabsTrigger value=\"feed\" role=\"tab\" aria-selected={activeTab === 'feed'} aria-controls=\"feed-panel\" data-testid=\"feed-tab\">\n            Feed\n          </TabsTrigger>\n          <TabsTrigger value=\"polls\" role=\"tab\" aria-selected={activeTab === 'polls'} aria-controls=\"polls-panel\" data-testid=\"polls-tab\">\n            Polls\n          </TabsTrigger>\n          <TabsTrigger value=\"analytics\" role=\"tab\" aria-selected={activeTab === 'analytics'} aria-controls=\"analytics-panel\" data-testid=\"analytics-tab\">\n            Analytics\n          </TabsTrigger>\n        </TabsList>\n\n        {/* Main feed */}\n        <TabsContent value=\"feed\" className=\"space-y-4\" id=\"feed-panel\" role=\"tabpanel\" aria-labelledby=\"feed-tab\">\n          {isLoading ? (\n            <div className=\"flex items-center justify-center py-12\" role=\"status\" aria-live=\"polite\">\n              <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\" aria-hidden=\"true\"></div>\n              <span className=\"sr-only\">Loading feed content...</span>\n            </div>\n          ) : filteredFeedItems.length === 0 ? (\n            <Card role=\"status\" aria-live=\"polite\">\n              <CardContent className=\"p-6 text-center\">\n                <HashtagIcon className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" aria-hidden=\"true\" />\n                <p className=\"text-gray-600\">No content matches your filters</p>\n                <Button \n                  variant=\"outline\" \n                  onClick={() => {\n                    setSelectedHashtags([]);\n                    setSearchQuery('');\n                  }}\n                  className=\"mt-4\"\n                  aria-label=\"Clear all filters to show all content\"\n                >\n                  Clear Filters\n                </Button>\n              </CardContent>\n            </Card>\n          ) : (\n            <div className=\"space-y-4\" role=\"feed\" aria-label=\"Feed content\">\n              {filteredFeedItems.map((item, index) => (\n                <article key={item.id} role=\"article\" aria-posinset={index + 1} aria-setsize={filteredFeedItems.length}>\n                  <FeedItem\n                    item={item}\n                    onLike={() => handleLike(item.id)}\n                    onBookmark={() => handleBookmark(item.id)}\n                    onShare={() => handleShare(item.id)}\n                    onComment={() => handleComment(item.id)}\n                    onViewDetails={() => onViewDetails?.(item.id)}\n                  />\n                </article>\n              ))}\n            </div>\n          )}\n        </TabsContent>\n\n        {/* Hashtag-polls integration - Feature Flag Controlled */}\n        <TabsContent value=\"polls\" className=\"space-y-4\" id=\"polls-panel\" role=\"tabpanel\" aria-labelledby=\"polls-tab\">\n          <FeatureWrapper feature=\"DEMOGRAPHIC_FILTERING\">\n            {hashtagPollsFeed ? (\n              <div className=\"space-y-4\">\n                <h3 className=\"text-lg font-semibold\">Personalized Polls</h3>\n                {hashtagPollsFeed.recommended_polls.map((poll: any) => (\n                <Card key={poll.poll_id} className=\"hover:shadow-md transition-shadow\" data-testid=\"poll-card\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-start justify-between mb-4\">\n                      <div className=\"flex-1\">\n                        <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">\n                          {poll.title}\n                        </h3>\n                        <p className=\"text-gray-600 mb-4\">{poll.description}</p>\n                        \n                        {/* Poll hashtags */}\n                        {poll.hashtags && poll.hashtags.length > 0 && (\n                          <div className=\"flex flex-wrap gap-2 mb-4\">\n                            {poll.hashtags.map((hashtag: any) => (\n                              <Badge\n                                key={hashtag}\n                                variant=\"outline\"\n                                className=\"cursor-pointer hover:bg-blue-100\"\n                                onClick={() => handleHashtagSelect(hashtag)}\n                              >\n                                #{hashtag}\n                              </Badge>\n                            ))}\n                          </div>\n                        )}\n\n                        {/* Poll metadata */}\n                        <div className=\"flex items-center space-x-4 text-sm text-gray-500\">\n                          <div className=\"flex items-center\">\n                            <UserGroupIcon className=\"h-4 w-4 mr-1\" />\n                            {poll.total_votes} votes\n                          </div>\n                          <div className=\"flex items-center\">\n                            <ClockIcon className=\"h-4 w-4 mr-1\" />\n                            {new Date(poll.created_at).toLocaleDateString()}\n                          </div>\n                          <div className=\"flex items-center\">\n                            <ChartBarIcon className=\"h-4 w-4 mr-1\" />\n                            {Math.round(poll.relevance_score * 100)}% match\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"text-sm text-gray-600\">\n                        {poll.reason}\n                      </div>\n                      <Button\n                        onClick={() => handlePollSelect(poll.poll_id)}\n                        className=\"ml-4\"\n                      >\n                        View Poll\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          ) : (\n            <Card>\n              <CardContent className=\"p-6 text-center\">\n                <HashtagIcon className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n                <p className=\"text-gray-600\">No personalized polls available</p>\n                <p className=\"text-sm text-gray-500\">Follow some hashtags to get personalized recommendations</p>\n              </CardContent>\n            </Card>\n          )}\n          </FeatureWrapper>\n        </TabsContent>\n\n        {/* Analytics */}\n        <TabsContent value=\"analytics\" className=\"space-y-4\">\n          {enableAnalytics && hashtagPollsFeed?.hashtag_analytics ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n              {hashtagPollsFeed.hashtag_analytics.map((analytic: any) => (\n                <Card key={analytic.hashtag}>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2\">\n                      <HashtagIcon className=\"h-4 w-4\" />\n                      #{analytic.hashtag}\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"space-y-2\">\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-sm text-gray-600\">Polls:</span>\n                        <span className=\"font-medium\">{analytic.poll_count}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-sm text-gray-600\">Engagement:</span>\n                        <span className=\"font-medium\">\n                          {Math.round(analytic.engagement_rate * 100)}%\n                        </span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-sm text-gray-600\">Interest:</span>\n                        <span className=\"font-medium\">\n                          {Math.round(analytic.user_interest_level * 100)}%\n                        </span>\n                      </div>\n                      {analytic.trending_position > 0 && (\n                        <div className=\"flex justify-between\">\n                          <span className=\"text-sm text-gray-600\">Trending:</span>\n                          <span className=\"font-medium text-green-600\">\n                            #{analytic.trending_position}\n                          </span>\n                        </div>\n                      )}\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          ) : (\n            <Card>\n              <CardContent className=\"p-6 text-center\">\n                <ChartBarIcon className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n                <p className=\"text-gray-600\">Analytics not available</p>\n              </CardContent>\n            </Card>\n          )}\n        </TabsContent>\n      </Tabs>\n    </div>\n\n    {/* Scroll to top button */}\n      {feeds.length > 5 && (\n        <button\n          ref={scrollToTopRef}\n          onClick={scrollToTop}\n          className=\"fixed bottom-20 right-4 bg-blue-600 text-white p-3 rounded-full shadow-lg hover:bg-blue-700 transition-colors z-30 min-w-[44px] min-h-[44px]\"\n          aria-label=\"Scroll to top\"\n        >\n          <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 10l7-7m0 0l7 7m-7-7v18\" />\n          </svg>\n        </button>\n      )}\n\n      {/* Loading indicator for infinite scroll */}\n      {isLoading && (\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500\"></div>\n          <span className=\"ml-3 text-gray-500\">Loading more...</span>\n        </div>\n      )}\n\n      {/* End of feed indicator */}\n      {!hasMore && feeds.length > 0 && (\n        <div className=\"text-center py-8 text-gray-500\">\n          <p>You&apos;ve reached the end of the feed</p>\n          <p className=\"text-sm mt-1\">Check back later for more updates</p>\n        </div>\n      )}\n\n      {/* Last item ref for infinite scroll */}\n      <div ref={lastItemRef} className=\"h-1\" />\n\n      {/* Accessibility Announcements */}\n      <div \n        className=\"sr-only\" \n        aria-live=\"polite\" \n        aria-atomic=\"true\"\n      >\n        {accessibilityAnnouncements.map((announcement, index) => (\n          <div key={`announcement-${index}-${announcement.slice(0, 20)}`}>{announcement}</div>\n        ))}\n      </div>\n\n      {/* Dedicated Live Region for Dynamic Content */}\n      <div \n        className=\"sr-only\" \n        aria-live=\"polite\" \n        aria-atomic=\"true\"\n        id=\"live-region\"\n      >\n        <span id=\"live-region-content\"></span>\n      </div>\n\n      {/* Error Messages */}\n      {errorMessage && (\n        <div \n          role=\"alert\" \n          className=\"fixed top-4 right-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded z-50\"\n        >\n          {errorMessage}\n          <div className=\"mt-2 flex gap-2\">\n            <button \n              onClick={loadFeedData}\n              className=\"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 min-w-[44px] min-h-[44px]\"\n              aria-label=\"Retry loading feed\"\n            >\n              Retry\n            </button>\n          <button \n            onClick={clearError}\n              className=\"px-3 py-1 text-red-700 hover:text-red-900 min-w-[44px] min-h-[44px]\"\n            aria-label=\"Close error message\"\n          >\n            Ã—\n          </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default UnifiedFeed;\n"],"names":["UnifiedFeed","userId","preferences","onLike","onShare","onBookmark","onComment","onViewDetails","onPollSelect","onHashtagSelect","className","enablePersonalization","enableRealTimeUpdates","enableAnalytics","enableHaptics","enableHashtagPolls","enableMobileOptimization","showTrending","maxItems","console","log","feeds","setFeeds","useState","isLoading","setIsLoading","loadError","setLoadError","loadFeeds","response","fetch","ok","Error","status","data","json","error","likeFeed","Promise","resolve","bookmarkFeed","refreshFeeds","pwaStore","isOnline","user","id","addNotification","hashtags","trendingHashtags","getTrendingHashtags","trendingCount","activeTab","setActiveTab","hashtagPollsFeed","setHashtagPollsFeed","selectedHashtags","setSelectedHashtags","searchQuery","setSearchQuery","isRefreshing","setIsRefreshing","personalizationScore","setPersonalizationScore","lastUpdate","setLastUpdate","Date","isDarkMode","setIsDarkMode","isClient","setIsClient","notificationPermission","setNotificationPermission","swRegistration","setSwRegistration","lastSync","setLastSync","syncStatus","setSyncStatus","showAdvancedFilters","setShowAdvancedFilters","accessibilityAnnouncements","setAccessibilityAnnouncements","errorMessage","setErrorMessage","showError","setShowError","pullDistance","setPullDistance","hasMore","setHasMore","page","setPage","expandedItems","setExpandedItems","Set","loadingImages","setLoadingImages","refreshThreshold","wsRef","useRef","refreshIntervalRef","touchStartRef","longPressTimerRef","feedRef","observerRef","lastItemRef","scrollToTopRef","initializeSuperiorPWAFeatures","useCallback","navigator","registration","serviceWorker","ready","window","permission","Notification","requestPermission","subscribeToNotifications","subscription","pushManager","subscribe","userVisibleOnly","applicationServerKey","process","env","NEXT_PUBLIC_VAPID_PUBLIC_KEY","method","headers","body","JSON","stringify","logger","info","checkOnlineStatus","handleOnline","syncOfflineData","handleOffline","addEventListener","removeEventListener","toISOString","announceToScreenReader","message","prev","liveRegion","document","getElementById","textContent","setTimeout","slice","setError","clearError","loadHashtagPollsFeed","success","user_id","hashtag_interests","recommended_polls","trending_hashtags","hashtag_analytics","feed_score","last_updated","warn","loadFeedData","useEffect","catch","current","clearInterval","clearTimeout","close","disconnect","filteredFeedItems","useMemo","filtered","length","filter","item","some","hashtag","includes","title","toLowerCase","description","handleHashtagSelect","h","handlePollSelect","pollId","trackEvent","event","gtag","event_category","event_label","platform","value","analytics","track","handle","url","representative","trackEngagement","action","itemId","metadata","Math","min","handleLike","vibrate","handleBookmark","shareToPlatform","shareNative","socialSharingEnabled","useSocialSharing","handleShare","find","contentType","type","shareUrl","location","origin","sharingOptions","summary","undefined","placement","result","handleComment","handleViewDetails","handleLoadMore","scrollToTop","scrollTo","top","behavior","handleRefresh","getContentTypeIcon","iconClass","div","span","getPartyColor","party","partyColors","formatDate","date","now","dateObj","isNaN","getTime","diffInHours","floor","toLocaleDateString","calculatePersonalizationScore","userInterests","contentTags","matchingTags","tag","interest","max","toggleItemExpansion","newSet","has","delete","add","handleImageLoad","handleImageError","loadImage","imageUrl","img","Image","onload","onerror","src","handlePullToRefresh","handleTouchStart","e","scrollY","touches","x","clientX","y","clientY","time","handleTouchMove","touch","deltaY","distance","handleTouchEnd","changedTouches","deltaTime","toggleDarkMode","newMode","documentElement","classList","remove","localStorage","setItem","toString","darkModeButtonRef","stored","getItem","systemPrefersDark","matchMedia","matches","shouldBeDark","cn","data-testid","h3","p","Button","onClick","ref","role","aria-label","onTouchStart","onTouchMove","onTouchEnd","style","transform","aria-live","aria-hidden","toLocaleTimeString","header","h1","round","button","svg","fill","stroke","viewBox","path","strokeLinecap","strokeLinejoin","strokeWidth","d","disabled","variant","size","aria-describedby","ArrowPathIcon","h4","label","input","Card","CardHeader","CardTitle","HashtagIcon","Badge","CardContent","FeatureWrapper","feature","htmlFor","Input","placeholder","onChange","target","map","tabIndex","onKeyDown","key","preventDefault","ArrowTrendingUpIcon","Tabs","onValueChange","TabsList","TabsTrigger","aria-selected","aria-controls","TabsContent","aria-labelledby","index","article","aria-posinset","aria-setsize","FeedItem","poll","UserGroupIcon","total_votes","ClockIcon","created_at","ChartBarIcon","relevance_score","reason","poll_id","analytic","poll_count","engagement_rate","user_interest_level","trending_position","aria-atomic","announcement"],"mappings":"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"}