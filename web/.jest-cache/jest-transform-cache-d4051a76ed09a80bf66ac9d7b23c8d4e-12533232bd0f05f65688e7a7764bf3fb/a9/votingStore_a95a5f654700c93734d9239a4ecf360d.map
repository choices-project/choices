{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/lib/stores/votingStore.ts"],"sourcesContent":["/**\n * Voting Store - Zustand Implementation\n * \n * Comprehensive voting state management including voting records,\n * ballot information, voting preferences, and election data.\n * Consolidates voting state management and voting history.\n * \n * Created: October 10, 2025\n * Status: âœ… ACTIVE\n */\n\nimport { create } from 'zustand';\nimport { devtools } from 'zustand/middleware';\nimport { persist } from 'zustand/middleware';\n\nimport { logger } from '@/lib/utils/logger';\n\n// Voting data types\nexport interface Ballot {\n  id: string;\n  electionId: string;\n  title: string;\n  description: string;\n  type: 'primary' | 'general' | 'special' | 'runoff' | 'recall';\n  date: string;\n  deadline: string;\n  status: 'upcoming' | 'active' | 'closed' | 'cancelled';\n  contests: BallotContest[];\n  metadata: {\n    jurisdiction: string;\n    district: string;\n    pollingPlace?: string;\n    earlyVoting?: {\n      start: string;\n      end: string;\n      locations: string[];\n    };\n    mailVoting?: {\n      available: boolean;\n      deadline: string;\n      instructions: string;\n    };\n  };\n}\n\ninterface BallotContest {\n  id: string;\n  title: string;\n  description: string;\n  type: 'candidate' | 'measure' | 'proposition' | 'referendum';\n  district?: string;\n  candidates?: BallotCandidate[];\n  measures?: BallotMeasure[];\n  instructions: string;\n  maxSelections: number;\n  minSelections: number;\n}\n\ninterface BallotCandidate {\n  id: string;\n  name: string;\n  party?: string;\n  incumbent: boolean;\n  photo?: string;\n  bio?: string;\n  website?: string;\n  endorsements: string[];\n  positions: Array<{\n    issue: string;\n    stance: string;\n    details: string;\n  }>;\n}\n\ninterface BallotMeasure {\n  id: string;\n  title: string;\n  description: string;\n  summary: string;\n  fullText: string;\n  fiscalImpact?: string;\n  arguments: {\n    for: string[];\n    against: string[];\n  };\n  endorsements: {\n    for: string[];\n    against: string[];\n  };\n}\n\n\nexport interface Election {\n  id: string;\n  name: string;\n  date: string;\n  type: 'primary' | 'general' | 'special' | 'runoff' | 'recall';\n  status: 'upcoming' | 'active' | 'closed' | 'results_available';\n  description: string;\n  ballots: string[]; // Ballot IDs\n  results?: ElectionResults;\n  metadata: {\n    jurisdiction: string;\n    district: string;\n    turnout: number;\n    totalVoters: number;\n  };\n}\n\nexport interface VotingRecord {\n  id: string;\n  ballotId: string;\n  contestId: string;\n  selections: string[]; // Candidate or measure IDs\n  votedAt: string;\n  method: 'in_person' | 'mail' | 'early' | 'absentee';\n  location?: string;\n  verified: boolean;\n  receipt?: string;\n}\n\ninterface ElectionResults {\n  contests: Array<{\n    contestId: string;\n    results: Array<{\n      candidateId?: string;\n      measureId?: string;\n      votes: number;\n      percentage: number;\n      winner: boolean;\n    }>;\n    totalVotes: number;\n    turnout: number;\n  }>;\n  summary: {\n    totalVotes: number;\n    turnout: number;\n    winners: string[];\n  };\n}\n\ninterface VotingPreferences {\n  notifications: {\n    electionReminders: boolean;\n    ballotDeadlines: boolean;\n    earlyVoting: boolean;\n    results: boolean;\n  };\n  voting: {\n    preferredMethod: 'in_person' | 'mail' | 'early';\n    pollingPlace?: string;\n    earlyVotingLocation?: string;\n    mailVotingAddress?: string;\n  };\n  privacy: {\n    shareVotingHistory: boolean;\n    sharePoliticalAffiliation: boolean;\n    shareEndorsements: boolean;\n  };\n  reminders: {\n    electionDay: number; // days before\n    registrationDeadline: number; // days before\n    ballotDeadline: number; // days before\n  };\n}\n\ninterface VotingSearch {\n  query: string;\n  results: Array<Ballot | Election>;\n  totalResults: number;\n  currentPage: number;\n  totalPages: number;\n  filters: {\n    type?: string[];\n    status?: string[];\n    dateRange?: {\n      start: string;\n      end: string;\n    };\n    jurisdiction?: string[];\n  };\n  suggestions: string[];\n  recentSearches: string[];\n}\n\n// Voting store state interface\ninterface VotingStore {\n  // Voting data\n  ballots: Ballot[];\n  elections: Election[];\n  votingRecords: VotingRecord[];\n  search: VotingSearch;\n  \n  // UI state\n  selectedBallot: Ballot | null;\n  selectedElection: Election | null;\n  currentBallot: Ballot | null;\n  \n  // Preferences\n  preferences: VotingPreferences;\n  \n  // Loading states\n  isLoading: boolean;\n  isSearching: boolean;\n  isVoting: boolean;\n  isUpdating: boolean;\n  error: string | null;\n  \n  // Actions - Ballot management\n  setBallots: (ballots: Ballot[]) => void;\n  addBallot: (ballot: Ballot) => void;\n  updateBallot: (id: string, updates: Partial<Ballot>) => void;\n  removeBallot: (id: string) => void;\n  setSelectedBallot: (ballot: Ballot | null) => void;\n  setCurrentBallot: (ballot: Ballot | null) => void;\n  \n  // Actions - Election management\n  setElections: (elections: Election[]) => void;\n  addElection: (election: Election) => void;\n  updateElection: (id: string, updates: Partial<Election>) => void;\n  removeElection: (id: string) => void;\n  setSelectedElection: (election: Election | null) => void;\n  \n  // Actions - Voting records\n  setVotingRecords: (records: VotingRecord[]) => void;\n  addVotingRecord: (record: VotingRecord) => void;\n  updateVotingRecord: (id: string, updates: Partial<VotingRecord>) => void;\n  removeVotingRecord: (id: string) => void;\n  \n  // Actions - Voting\n  castVote: (ballotId: string, contestId: string, selections: string[]) => Promise<void>;\n  updateVote: (recordId: string, selections: string[]) => Promise<void>;\n  cancelVote: (recordId: string) => Promise<void>;\n  \n  // Actions - Search and filtering\n  searchVoting: (query: string) => Promise<void>;\n  setSearchQuery: (query: string) => void;\n  clearSearch: () => void;\n  setFilters: (filters: Partial<VotingSearch['filters']>) => void;\n  clearFilters: () => void;\n  \n  // Actions - Preferences\n  updatePreferences: (preferences: Partial<VotingPreferences>) => void;\n  resetPreferences: () => void;\n  \n  // Actions - Data operations\n  loadBallots: (electionId?: string) => Promise<void>;\n  loadElections: () => Promise<void>;\n  loadVotingRecords: () => Promise<void>;\n  loadBallot: (id: string) => Promise<void>;\n  loadElection: (id: string) => Promise<void>;\n  submitBallot: (ballotId: string, votes: Record<string, string[]>) => Promise<void>;\n  clearUserVotingSession: () => void;\n  reset: () => void;\n  \n  // Actions - Loading states\n  setLoading: (loading: boolean) => void;\n  setSearching: (searching: boolean) => void;\n  setVoting: (voting: boolean) => void;\n  setUpdating: (updating: boolean) => void;\n  setError: (error: string | null) => void;\n  clearError: () => void;\n}\n\n// Default voting preferences\nconst defaultPreferences: VotingPreferences = {\n  notifications: {\n    electionReminders: true,\n    ballotDeadlines: true,\n    earlyVoting: true,\n    results: true,\n  },\n  voting: {\n    preferredMethod: 'in_person',\n  },\n  privacy: {\n    shareVotingHistory: false,\n    sharePoliticalAffiliation: false,\n    shareEndorsements: false,\n  },\n  reminders: {\n    electionDay: 7,\n    registrationDeadline: 14,\n    ballotDeadline: 3,\n  },\n};\n\n// Default search filters\nconst defaultFilters: VotingSearch['filters'] = {\n  type: [],\n  status: [],\n  dateRange: {\n    start: '',\n    end: '',\n  },\n  jurisdiction: [],\n};\n\n// Create voting store with middleware\nexport const useVotingStore = create<VotingStore>()(\n  devtools(\n    persist(\n      (set, get) => ({\n        // Initial state\n        ballots: [],\n        elections: [],\n        votingRecords: [],\n        search: {\n          query: '',\n          results: [],\n          totalResults: 0,\n          currentPage: 1,\n          totalPages: 1,\n          filters: defaultFilters,\n          suggestions: [],\n          recentSearches: [],\n        },\n        selectedBallot: null,\n        selectedElection: null,\n        currentBallot: null,\n        preferences: defaultPreferences,\n        isLoading: false,\n        isSearching: false,\n        isVoting: false,\n        isUpdating: false,\n        error: null,\n        \n        // Ballot management actions\n        setBallots: (ballots) => set({ ballots }),\n        \n        addBallot: (ballot) => set((state) => ({\n          ballots: [ballot, ...state.ballots]\n        })),\n        \n        updateBallot: (id, updates) => set((state) => ({\n          ballots: state.ballots.map(ballot =>\n            ballot.id === id ? { ...ballot, ...updates } : ballot\n          )\n        })),\n        \n        removeBallot: (id) => set((state) => ({\n          ballots: state.ballots.filter(ballot => ballot.id !== id)\n        })),\n        \n        setSelectedBallot: (ballot) => set({ selectedBallot: ballot }),\n        \n        setCurrentBallot: (ballot) => set({ currentBallot: ballot }),\n        \n        // Election management actions\n        setElections: (elections) => set({ elections }),\n        \n        addElection: (election) => set((state) => ({\n          elections: [election, ...state.elections]\n        })),\n        \n        updateElection: (id, updates) => set((state) => ({\n          elections: state.elections.map(election =>\n            election.id === id ? { ...election, ...updates } : election\n          )\n        })),\n        \n        removeElection: (id) => set((state) => ({\n          elections: state.elections.filter(election => election.id !== id)\n        })),\n        \n        setSelectedElection: (election) => set({ selectedElection: election }),\n        \n        // Voting records actions\n        setVotingRecords: (records) => set({ votingRecords: records }),\n        \n        addVotingRecord: (record) => set((state) => ({\n          votingRecords: [record, ...state.votingRecords]\n        })),\n        \n        updateVotingRecord: (id, updates) => set((state) => ({\n          votingRecords: state.votingRecords.map(record =>\n            record.id === id ? { ...record, ...updates } : record\n          )\n        })),\n        \n        removeVotingRecord: (id) => set((state) => ({\n          votingRecords: state.votingRecords.filter(record => record.id !== id)\n        })),\n        \n        // Voting actions\n        castVote: async (ballotId, contestId, selections) => {\n          const { setVoting, setError } = get();\n          \n          try {\n            setVoting(true);\n            setError(null);\n            \n            const response = await fetch('/api/voting/vote', {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({ ballotId, contestId, selections }),\n            });\n            \n            if (!response.ok) {\n              throw new Error('Failed to cast vote');\n            }\n            \n            const votingRecord = await response.json();\n            \n            set((state) => ({\n              votingRecords: [votingRecord, ...state.votingRecords]\n            }));\n            \n            logger.info('Vote cast successfully', {\n              ballotId,\n              contestId,\n              selections\n            });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to cast vote:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setVoting(false);\n          }\n        },\n        \n        updateVote: async (recordId, selections) => {\n          const { setVoting, setError } = get();\n          \n          try {\n            setVoting(true);\n            setError(null);\n            \n            const response = await fetch(`/api/voting/records/${recordId}`, {\n              method: 'PUT',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({ selections }),\n            });\n            \n            if (!response.ok) {\n              throw new Error('Failed to update vote');\n            }\n            \n            set((state) => ({\n              votingRecords: state.votingRecords.map(record =>\n                record.id === recordId \n                  ? { ...record, selections }\n                  : record\n              )\n            }));\n            \n            logger.info('Vote updated successfully', {\n              recordId,\n              selections\n            });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to update vote:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setVoting(false);\n          }\n        },\n        \n        cancelVote: async (recordId) => {\n          const { setVoting, setError } = get();\n          \n          try {\n            setVoting(true);\n            setError(null);\n            \n            const response = await fetch(`/api/voting/records/${recordId}`, {\n              method: 'DELETE',\n            });\n            \n            if (!response.ok) {\n              throw new Error('Failed to cancel vote');\n            }\n            \n            set((state) => ({\n              votingRecords: state.votingRecords.filter(record => record.id !== recordId)\n            }));\n            \n            logger.info('Vote cancelled successfully', { recordId });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to cancel vote:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setVoting(false);\n          }\n        },\n        \n        // Search and filtering actions\n        searchVoting: async (query) => {\n          const { setSearching, setError } = get();\n          \n          try {\n            setSearching(true);\n            setError(null);\n            \n            const response = await fetch('/api/voting/search', {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({ query }),\n            });\n            \n            if (!response.ok) {\n              throw new Error('Failed to search voting data');\n            }\n            \n            const results = await response.json() as {\n              items: Array<Ballot | Election>;\n              total: number;\n            };\n            \n            set((state) => ({\n              search: {\n                ...state.search,\n                query,\n                results: results.items,\n                totalResults: results.total,\n                currentPage: 1,\n                totalPages: Math.ceil(results.total / 20),\n              },\n            }));\n            \n            logger.info('Voting data searched', {\n              query,\n              results: results.items.length,\n              total: results.total\n            });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to search voting data:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setSearching(false);\n          }\n        },\n        \n        setSearchQuery: (query) => set((state) => ({\n          search: { ...state.search, query }\n        })),\n        \n        clearSearch: () => set((state) => ({\n          search: {\n            ...state.search,\n            query: '',\n            results: [],\n            totalResults: 0,\n            currentPage: 1,\n            totalPages: 1,\n          }\n        })),\n        \n        setFilters: (filters) => set((state) => ({\n          search: {\n            ...state.search,\n            filters: { ...state.search.filters, ...filters }\n          }\n        })),\n        \n        clearFilters: () => set((state) => ({\n          search: {\n            ...state.search,\n            filters: defaultFilters\n          }\n        })),\n        \n        clearUserVotingSession: () => set((state) => ({\n          ballots: [],\n          selectedBallot: null,\n          currentBallot: null,\n          search: {\n            ...state.search,\n            filters: defaultFilters\n          }\n        })),\n        \n        reset: () => {\n          useVotingStore.getState().clearFilters();\n          useVotingStore.getState().resetPreferences();\n          useVotingStore.setState({\n            ballots: [],\n            selectedBallot: null,\n            currentBallot: null,\n            votingRecords: [],\n            selectedElection: null,\n            elections: []\n          });\n          logger.info('Voting store reset');\n        },\n        \n        // Preferences actions\n        updatePreferences: (preferences) => set((state) => ({\n          preferences: { ...state.preferences, ...preferences }\n        })),\n        \n        resetPreferences: () => set({ preferences: defaultPreferences }),\n        \n        // Data operations\n        loadBallots: async (electionId) => {\n          const { setLoading, setError } = get();\n          \n          try {\n            setLoading(true);\n            setError(null);\n            \n            const response = await fetch('/api/voting/ballots', {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({ electionId }),\n            });\n            \n            if (!response.ok) {\n              throw new Error('Failed to load ballots');\n            }\n            \n            const ballots = await response.json() as Ballot[];\n            set({ ballots });\n            \n            logger.info('Ballots loaded', {\n              electionId,\n              count: ballots.length\n            });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to load ballots:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setLoading(false);\n          }\n        },\n        \n        loadElections: async () => {\n          const { setLoading, setError } = get();\n          \n          try {\n            setLoading(true);\n            setError(null);\n            \n            const response = await fetch('/api/voting/elections');\n            \n            if (!response.ok) {\n              throw new Error('Failed to load elections');\n            }\n            \n            const elections = await response.json() as Election[];\n            set({ elections });\n            \n            logger.info('Elections loaded', {\n              count: elections.length\n            });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to load elections:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setLoading(false);\n          }\n        },\n        \n        loadVotingRecords: async () => {\n          const { setLoading, setError } = get();\n          \n          try {\n            setLoading(true);\n            setError(null);\n            \n            const response = await fetch('/api/voting/records');\n            \n            if (!response.ok) {\n              throw new Error('Failed to load voting records');\n            }\n            \n            const records = await response.json() as VotingRecord[];\n            set({ votingRecords: records });\n            \n            logger.info('Voting records loaded', {\n              count: records.length\n            });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to load voting records:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setLoading(false);\n          }\n        },\n        \n        loadBallot: async (id) => {\n          const { setLoading, setError } = get();\n          \n          try {\n            setLoading(true);\n            setError(null);\n            \n            const response = await fetch(`/api/voting/ballots/${id}`);\n            \n            if (!response.ok) {\n              throw new Error('Failed to load ballot');\n            }\n            \n            const ballot = await response.json();\n            set({ selectedBallot: ballot });\n            \n            logger.info('Ballot loaded', { id });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to load ballot:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setLoading(false);\n          }\n        },\n        \n        loadElection: async (id) => {\n          const { setLoading, setError } = get();\n          \n          try {\n            setLoading(true);\n            setError(null);\n            \n            const response = await fetch(`/api/voting/elections/${id}`);\n            \n            if (!response.ok) {\n              throw new Error('Failed to load election');\n            }\n            \n            const election = await response.json() as Election;\n            set({ selectedElection: election });\n            \n            logger.info('Election loaded', { id });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to load election:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setLoading(false);\n          }\n        },\n        \n        submitBallot: async (ballotId, votes) => {\n          const { setVoting, setError } = get();\n          \n          try {\n            setVoting(true);\n            setError(null);\n            \n            const response = await fetch('/api/voting/submit', {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({ ballotId, votes }),\n            });\n            \n            if (!response.ok) {\n              throw new Error('Failed to submit ballot');\n            }\n            \n            const votingRecord = await response.json() as VotingRecord;\n            \n            set((state) => ({\n              votingRecords: [votingRecord, ...state.votingRecords]\n            }));\n            \n            logger.info('Ballot submitted successfully', {\n              ballotId,\n              votes: Object.keys(votes).length\n            });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to submit ballot:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setVoting(false);\n          }\n        },\n        \n        // Loading state actions\n        setLoading: (loading) => set({ isLoading: loading }),\n        setSearching: (searching) => set({ isSearching: searching }),\n        setVoting: (voting) => set({ isVoting: voting }),\n        setUpdating: (updating) => set({ isUpdating: updating }),\n        setError: (error) => set({ error }),\n        clearError: () => set({ error: null }),\n      }),\n      {\n        name: 'voting-store',\n        partialize: (state) => ({\n          ballots: state.ballots,\n          elections: state.elections,\n          votingRecords: state.votingRecords,\n          preferences: state.preferences,\n        }),\n      }\n    ),\n    { name: 'voting-store' }\n  )\n);\n\n// Store selectors for optimized re-renders\nexport const useBallots = () => useVotingStore(state => state.ballots);\nexport const useElections = () => useVotingStore(state => state.elections);\nexport const useVotingRecords = () => useVotingStore(state => state.votingRecords);\nexport const useVotingSearch = () => useVotingStore(state => state.search);\nexport const useSelectedBallot = () => useVotingStore(state => state.selectedBallot);\nexport const useSelectedElection = () => useVotingStore(state => state.selectedElection);\nexport const useCurrentBallot = () => useVotingStore(state => state.currentBallot);\nexport const useVotingPreferences = () => useVotingStore(state => state.preferences);\nexport const useVotingLoading = () => useVotingStore(state => state.isLoading);\nexport const useVotingError = () => useVotingStore(state => state.error);\n\n// Action selectors\nexport const useVotingActions = () => useVotingStore(state => ({\n  setBallots: state.setBallots,\n  addBallot: state.addBallot,\n  updateBallot: state.updateBallot,\n  removeBallot: state.removeBallot,\n  setSelectedBallot: state.setSelectedBallot,\n  setCurrentBallot: state.setCurrentBallot,\n  setElections: state.setElections,\n  addElection: state.addElection,\n  updateElection: state.updateElection,\n  removeElection: state.removeElection,\n  setSelectedElection: state.setSelectedElection,\n  setVotingRecords: state.setVotingRecords,\n  addVotingRecord: state.addVotingRecord,\n  updateVotingRecord: state.updateVotingRecord,\n  removeVotingRecord: state.removeVotingRecord,\n  castVote: state.castVote,\n  updateVote: state.updateVote,\n  cancelVote: state.cancelVote,\n  searchVoting: state.searchVoting,\n  setSearchQuery: state.setSearchQuery,\n  clearSearch: state.clearSearch,\n  setFilters: state.setFilters,\n  clearFilters: state.clearFilters,\n  updatePreferences: state.updatePreferences,\n  resetPreferences: state.resetPreferences,\n  loadBallots: state.loadBallots,\n  loadElections: state.loadElections,\n  loadVotingRecords: state.loadVotingRecords,\n  loadBallot: state.loadBallot,\n  loadElection: state.loadElection,\n  submitBallot: state.submitBallot,\n  setLoading: state.setLoading,\n  setSearching: state.setSearching,\n  setVoting: state.setVoting,\n  setUpdating: state.setUpdating,\n  setError: state.setError,\n  clearError: state.clearError,\n}));\n\n// Computed selectors\nexport const useVotingStats = () => useVotingStore(state => ({\n  totalBallots: state.ballots.length,\n  totalElections: state.elections.length,\n  totalVotingRecords: state.votingRecords.length,\n  upcomingElections: state.elections.filter(election => election.status === 'upcoming').length,\n  activeElections: state.elections.filter(election => election.status === 'active').length,\n  searchResults: state.search.results.length,\n  isLoading: state.isLoading,\n  isVoting: state.isVoting,\n  error: state.error,\n}));\n\nexport const useUpcomingElections = () => useVotingStore(state => \n  state.elections.filter(election => election.status === 'upcoming')\n);\n\nexport const useActiveElections = () => useVotingStore(state => \n  state.elections.filter(election => election.status === 'active')\n);\n\nexport const useUserVotingHistory = () => useVotingStore(state => \n  state.votingRecords.sort((a, b) => new Date(b.votedAt).getTime() - new Date(a.votedAt).getTime())\n);\n\n// Store utilities\nexport const votingStoreUtils = {\n  /**\n   * Get voting summary\n   */\n  getVotingSummary: () => {\n    const state = useVotingStore.getState();\n    return {\n      totalBallots: state.ballots.length,\n      totalElections: state.elections.length,\n      totalVotingRecords: state.votingRecords.length,\n      searchResults: state.search.results.length,\n      preferences: state.preferences,\n    };\n  },\n  \n  /**\n   * Get elections by type\n   */\n  getElectionsByType: (type: string) => {\n    const state = useVotingStore.getState();\n    return state.elections.filter(election => election.type === type);\n  },\n  \n  /**\n   * Get ballots by election\n   */\n  getBallotsByElection: (electionId: string) => {\n    const state = useVotingStore.getState();\n    return state.ballots.filter(ballot => ballot.electionId === electionId);\n  },\n  \n  /**\n   * Get voting records by election\n   */\n  getVotingRecordsByElection: (electionId: string) => {\n    const state = useVotingStore.getState();\n    return state.votingRecords.filter(record => \n      state.ballots.find(ballot => ballot.id === record.ballotId)?.electionId === electionId\n    );\n  },\n  \n  /**\n   * Get upcoming elections\n   */\n  getUpcomingElections: () => {\n    const state = useVotingStore.getState();\n    const now = new Date();\n    return state.elections\n      .filter(election => new Date(election.date) > now)\n      .sort((a, b) => new Date(a.date).getTime() - new Date(b.date).getTime());\n  }\n};\n\n// Store subscriptions for external integrations\nexport const votingStoreSubscriptions = {\n  /**\n   * Subscribe to ballots changes\n   */\n  onBallotsChange: (callback: (ballots: Ballot[]) => void) => {\n    return useVotingStore.subscribe(\n      (state) => {\n        callback(state.ballots);\n      }\n    );\n  },\n  \n  /**\n   * Subscribe to elections changes\n   */\n  onElectionsChange: (callback: (elections: Election[]) => void) => {\n    return useVotingStore.subscribe(\n      (state) => {\n        callback(state.elections);\n      }\n    );\n  },\n  \n  /**\n   * Subscribe to voting records changes\n   */\n  onVotingRecordsChange: (callback: (records: VotingRecord[]) => void) => {\n    return useVotingStore.subscribe(\n      (state) => {\n        callback(state.votingRecords);\n      }\n    );\n  }\n};\n\n// Store debugging utilities\nexport const votingStoreDebug = {\n  /**\n   * Log current voting state\n   */\n  logState: () => {\n    const state = useVotingStore.getState();\n    logger.debug('Voting Store State', {\n      totalBallots: state.ballots.length,\n      totalElections: state.elections.length,\n      totalVotingRecords: state.votingRecords.length,\n      searchResults: state.search.results.length,\n      selectedBallot: state.selectedBallot?.title || 'none',\n      selectedElection: state.selectedElection?.name || 'none',\n      isLoading: state.isLoading,\n      isVoting: state.isVoting,\n      error: state.error\n    });\n  },\n  \n  /**\n   * Log voting summary\n   */\n  logSummary: () => {\n    const summary = votingStoreUtils.getVotingSummary();\n    logger.debug('Voting Summary', summary);\n  },\n  \n  /**\n   * Log elections by type\n   */\n  logElectionsByType: () => {\n    const state = useVotingStore.getState();\n    const byType = state.elections.reduce((acc, election) => {\n      acc[election.type] = (acc[election.type] || 0) + 1;\n      return acc;\n    }, {} as Record<string, number>);\n    logger.debug('Elections by Type', byType);\n  },\n  \n  /**\n   * Reset voting store\n   */\n  reset: () => {\n    useVotingStore.getState().clearFilters();\n    useVotingStore.getState().resetPreferences();\n    useVotingStore.setState({\n      ballots: [],\n      selectedBallot: null,\n      currentBallot: null,\n      votingRecords: [],\n      selectedElection: null,\n      elections: []\n    });\n    logger.info('Voting store reset');\n  }\n};\n"],"names":["useActiveElections","useBallots","useCurrentBallot","useElections","useSelectedBallot","useSelectedElection","useUpcomingElections","useUserVotingHistory","useVotingActions","useVotingError","useVotingLoading","useVotingPreferences","useVotingRecords","useVotingSearch","useVotingStats","useVotingStore","votingStoreDebug","votingStoreSubscriptions","votingStoreUtils","defaultPreferences","notifications","electionReminders","ballotDeadlines","earlyVoting","results","voting","preferredMethod","privacy","shareVotingHistory","sharePoliticalAffiliation","shareEndorsements","reminders","electionDay","registrationDeadline","ballotDeadline","defaultFilters","type","status","dateRange","start","end","jurisdiction","create","devtools","persist","set","get","ballots","elections","votingRecords","search","query","totalResults","currentPage","totalPages","filters","suggestions","recentSearches","selectedBallot","selectedElection","currentBallot","preferences","isLoading","isSearching","isVoting","isUpdating","error","setBallots","addBallot","ballot","state","updateBallot","id","updates","map","removeBallot","filter","setSelectedBallot","setCurrentBallot","setElections","addElection","election","updateElection","removeElection","setSelectedElection","setVotingRecords","records","addVotingRecord","record","updateVotingRecord","removeVotingRecord","castVote","ballotId","contestId","selections","setVoting","setError","response","fetch","method","headers","body","JSON","stringify","ok","Error","votingRecord","json","logger","info","errorMessage","message","updateVote","recordId","cancelVote","searchVoting","setSearching","items","total","Math","ceil","length","setSearchQuery","clearSearch","setFilters","clearFilters","clearUserVotingSession","reset","getState","resetPreferences","setState","updatePreferences","loadBallots","electionId","setLoading","count","loadElections","loadVotingRecords","loadBallot","loadElection","submitBallot","votes","Object","keys","loading","searching","setUpdating","updating","clearError","name","partialize","totalBallots","totalElections","totalVotingRecords","upcomingElections","activeElections","searchResults","sort","a","b","Date","votedAt","getTime","getVotingSummary","getElectionsByType","getBallotsByElection","getVotingRecordsByElection","find","getUpcomingElections","now","date","onBallotsChange","callback","subscribe","onElectionsChange","onVotingRecordsChange","logState","debug","title","logSummary","summary","logElectionsByType","byType","reduce","acc"],"mappings":"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"}