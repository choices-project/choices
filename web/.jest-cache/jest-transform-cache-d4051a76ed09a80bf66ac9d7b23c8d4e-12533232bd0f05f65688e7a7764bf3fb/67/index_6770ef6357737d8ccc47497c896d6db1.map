{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/features/polls/utils/index.ts"],"sourcesContent":["/**\n * Poll Utilities\n * \n * Utility functions for poll operations\n * \n * Created: October 10, 2025\n * Updated: October 11, 2025\n */\n\nimport type { Poll, PollOption, PollSettings, VotingMethod } from '../types';\n\n/**\n * Format a poll date for display\n */\nexport function formatPollDate(date: string | Date): string {\n  return new Date(date).toLocaleDateString();\n}\n\n/**\n * Calculate the duration of a poll in milliseconds\n */\nexport function calculatePollDuration(startDate: string | Date, endDate: string | Date): number {\n  const start = new Date(startDate);\n  const end = new Date(endDate);\n  return end.getTime() - start.getTime();\n}\n\n/**\n * Check if a poll is currently active\n */\nexport function isPollActive(startDate: string | Date, endDate: string | Date): boolean {\n  const now = new Date();\n  const start = new Date(startDate);\n  const end = new Date(endDate);\n  return now >= start && now <= end;\n}\n\n/**\n * Validate poll title\n */\nexport function validatePollTitle(title: string): { isValid: boolean; error?: string } {\n  if (!title.trim()) {\n    return { isValid: false, error: 'Title is required' };\n  }\n  if (title.length > 200) {\n    return { isValid: false, error: 'Title must be 200 characters or less' };\n  }\n  return { isValid: true };\n}\n\n/**\n * Validate poll description\n */\nexport function validatePollDescription(description: string): { isValid: boolean; error?: string } {\n  if (!description.trim()) {\n    return { isValid: false, error: 'Description is required' };\n  }\n  if (description.length > 1000) {\n    return { isValid: false, error: 'Description must be 1000 characters or less' };\n  }\n  return { isValid: true };\n}\n\n/**\n * Validate poll options\n */\nexport function validatePollOptions(options: string[]): { isValid: boolean; error?: string } {\n  const validOptions = options.filter(option => option.trim().length > 0);\n  if (validOptions.length < 2) {\n    return { isValid: false, error: 'At least 2 options are required' };\n  }\n  if (validOptions.length > 10) {\n    return { isValid: false, error: 'Maximum 10 options allowed' };\n  }\n  return { isValid: true };\n}\n\n/**\n * Validate poll settings\n */\nexport function validatePollSettings(settings: Partial<PollSettings>): { isValid: boolean; error?: string } {\n  if (settings.maxSelections !== undefined && settings.maxSelections < 1) {\n    return { isValid: false, error: 'Max selections must be at least 1' };\n  }\n  if (settings.maxVotes !== undefined && settings.maxVotes < 1) {\n    return { isValid: false, error: 'Max votes must be at least 1' };\n  }\n  return { isValid: true };\n}\n\n/**\n * Format poll duration for display\n */\nexport function formatPollDuration(durationMs: number): string {\n  const days = Math.floor(durationMs / (1000 * 60 * 60 * 24));\n  const hours = Math.floor((durationMs % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n  const minutes = Math.floor((durationMs % (1000 * 60 * 60)) / (1000 * 60));\n  \n  if (days > 0) {\n    return `${days}d ${hours}h ${minutes}m`;\n  } else if (hours > 0) {\n    return `${hours}h ${minutes}m`;\n  } else {\n    return `${minutes}m`;\n  }\n}\n\n/**\n * Calculate poll participation rate\n */\nexport function calculateParticipationRate(totalVotes: number, totalUsers: number): number {\n  if (totalUsers === 0) return 0;\n  return Math.round((totalVotes / totalUsers) * 100);\n}\n\n/**\n * Get poll status display text\n */\nexport function getPollStatusText(status: Poll['status']): string {\n  switch (status) {\n    case 'draft':\n      return 'Draft';\n    case 'active':\n      return 'Active';\n    case 'closed':\n      return 'Closed';\n    case 'archived':\n      return 'Archived';\n    case 'locked':\n      return 'Locked';\n    case 'post-close':\n      return 'Post-Close';\n    default:\n      return 'Unknown';\n  }\n}\n\n/**\n * Get voting method display text\n */\nexport function getVotingMethodText(method: VotingMethod): string {\n  switch (method) {\n    case 'single':\n      return 'Single Choice';\n    case 'approval':\n      return 'Approval Voting';\n    case 'ranked':\n      return 'Ranked Choice';\n    case 'range':\n      return 'Range Voting';\n    case 'quadratic':\n      return 'Quadratic Voting';\n    case 'multiple':\n      return 'Multiple Choice';\n    default:\n      return 'Unknown';\n  }\n}\n\n/**\n * Check if poll allows multiple votes\n */\nexport function allowsMultipleVotes(votingMethod: VotingMethod): boolean {\n  return ['approval', 'multiple'].includes(votingMethod);\n}\n\n/**\n * Get poll option percentage\n */\nexport function calculateOptionPercentage(votes: number, totalVotes: number): number {\n  if (totalVotes === 0) return 0;\n  return Math.round((votes / totalVotes) * 100);\n}\n\n/**\n * Sort poll options by vote count\n */\nexport function sortOptionsByVotes(options: PollOption[]): PollOption[] {\n  return [...options].sort((a, b) => (b.votes || 0) - (a.votes || 0));\n}\n\n/**\n * Check if poll is expired\n */\nexport function isPollExpired(endDate: string | Date): boolean {\n  const end = new Date(endDate);\n  const now = new Date();\n  return now > end;\n}\n\n/**\n * Get time remaining until poll ends\n */\nexport function getTimeRemaining(endDate: string | Date): number {\n  const end = new Date(endDate);\n  const now = new Date();\n  return Math.max(0, end.getTime() - now.getTime());\n}\n\n/**\n * Format time remaining for display\n */\nexport function formatTimeRemaining(timeRemainingMs: number): string {\n  if (timeRemainingMs <= 0) return 'Expired';\n  \n  const days = Math.floor(timeRemainingMs / (1000 * 60 * 60 * 24));\n  const hours = Math.floor((timeRemainingMs % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n  const minutes = Math.floor((timeRemainingMs % (1000 * 60 * 60)) / (1000 * 60));\n  \n  if (days > 0) {\n    return `${days}d ${hours}h ${minutes}m remaining`;\n  } else if (hours > 0) {\n    return `${hours}h ${minutes}m remaining`;\n  } else {\n    return `${minutes}m remaining`;\n  }\n}\n\n/**\n * Sanitize poll title for URL\n */\nexport function sanitizePollTitleForUrl(title: string): string {\n  return title\n    .toLowerCase()\n    .replace(/[^a-z0-9\\s-]/g, '')\n    .replace(/\\s+/g, '-')\n    .replace(/-+/g, '-')\n    .trim();\n}\n\n/**\n * Generate poll summary\n */\nexport function generatePollSummary(poll: Poll): string {\n  const status = getPollStatusText(poll.status);\n  const method = getVotingMethodText(poll.votingMethod);\n  const participation = `${poll.participationRate}% participation`;\n  \n  return `${status} • ${method} • ${participation}`;\n}\n"],"names":["allowsMultipleVotes","calculateOptionPercentage","calculateParticipationRate","calculatePollDuration","formatPollDate","formatPollDuration","formatTimeRemaining","generatePollSummary","getPollStatusText","getTimeRemaining","getVotingMethodText","isPollActive","isPollExpired","sanitizePollTitleForUrl","sortOptionsByVotes","validatePollDescription","validatePollOptions","validatePollSettings","validatePollTitle","date","Date","toLocaleDateString","startDate","endDate","start","end","getTime","now","title","trim","isValid","error","length","description","options","validOptions","filter","option","settings","maxSelections","undefined","maxVotes","durationMs","days","Math","floor","hours","minutes","totalVotes","totalUsers","round","status","method","votingMethod","includes","votes","sort","a","b","max","timeRemainingMs","toLowerCase","replace","poll","participation","participationRate"],"mappings":"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"}