{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/tests/jest/unit/performance/performance-profiler.ts"],"sourcesContent":["/**\n * @jest-environment jsdom\n */\n\nimport { logger } from '@/lib/utils/logger';\n\nexport interface ProfilerMetrics {\n  componentName: string;\n  renderCount: number;\n  totalRenderTime: number;\n  averageRenderTime: number;\n  maxRenderTime: number;\n  minRenderTime: number;\n  memoryPeak: number;\n  memoryAverage: number;\n  reRenderTriggers: string[];\n  performanceBottlenecks: string[];\n  optimizationScore: number;\n  recommendations: string[];\n  timestamp: Date;\n  testSuite?: string;\n  duration?: number;\n  memoryUsage?: number;\n  renderTime?: number;\n  networkTime?: number;\n  apiTime?: number;\n  accessibilityTime?: number;\n  performanceGrade?: 'A+' | 'A' | 'B' | 'C' | 'D' | 'F';\n  status?: 'PASS' | 'FAIL';\n  errorMessage?: string;\n}\n\nexport interface ComponentProfile {\n  name: string;\n  metrics: ProfilerMetrics;\n  children: ComponentProfile[];\n  parent?: ComponentProfile;\n  depth: number;\n  isOptimized: boolean;\n  optimizationPotential: 'HIGH' | 'MEDIUM' | 'LOW';\n}\n\nexport interface PerformanceAnalysis {\n  overallScore: number;\n  criticalIssues: string[];\n  optimizationOpportunities: string[];\n  memoryLeaks: string[];\n  renderOptimizations: string[];\n  networkOptimizations: string[];\n  accessibilityOptimizations: string[];\n  recommendations: string[];\n  estimatedImprovement: number; // percentage\n}\n\nexport class PerformanceProfiler {\n  private profiles: Map<string, ComponentProfile> = new Map();\n  private metrics: ProfilerMetrics[] = [];\n  private alerts: string[] = [];\n  private isProfiling: boolean = false;\n  private startTime: number = 0;\n  private startMemory: number = 0;\n\n  /**\n   * Start profiling a component\n   */\n  startProfiling(componentName: string): void {\n    this.isProfiling = true;\n    this.startTime = performance.now();\n    this.startMemory = (performance as any).memory?.usedJSHeapSize || 0;\n    \n    logger.info(`üîç Starting performance profiling for: ${componentName}`);\n  }\n\n  /**\n   * Stop profiling and record metrics\n   */\n  stopProfiling(componentName: string, renderCount: number = 1): ProfilerMetrics {\n    if (!this.isProfiling) {\n      throw new Error('Profiling not started. Call startProfiling() first.');\n    }\n\n    const endTime = performance.now();\n    const endMemory = (performance as any).memory?.usedJSHeapSize || 0;\n    \n    const totalRenderTime = endTime - this.startTime;\n    const averageRenderTime = totalRenderTime / renderCount;\n    const memoryUsed = (endMemory - this.startMemory) / (1024 * 1024);\n    \n    const metrics: ProfilerMetrics = {\n      componentName,\n      renderCount,\n      totalRenderTime,\n      averageRenderTime,\n      maxRenderTime: totalRenderTime,\n      minRenderTime: totalRenderTime,\n      memoryPeak: memoryUsed,\n      memoryAverage: memoryUsed,\n      reRenderTriggers: this.analyzeReRenderTriggers(componentName),\n      performanceBottlenecks: this.analyzeBottlenecks(totalRenderTime, memoryUsed),\n      optimizationScore: this.calculateOptimizationScore(totalRenderTime, memoryUsed, renderCount),\n      recommendations: this.generateRecommendations(totalRenderTime, memoryUsed, renderCount),\n      timestamp: new Date(),\n    };\n\n    this.metrics.push(metrics);\n    this.isProfiling = false;\n    \n    logger.info(`‚úÖ Performance profiling completed for: ${componentName}`);\n    logger.info(`- Render Time: ${totalRenderTime.toFixed(2)}ms`);\n    logger.info(`- Memory Used: ${memoryUsed.toFixed(2)}MB`);\n    logger.info(`- Optimization Score: ${metrics.optimizationScore}/100`);\n    \n    return metrics;\n  }\n\n  /**\n   * Analyze re-render triggers\n   */\n  private analyzeReRenderTriggers(componentName: string): string[] {\n    const triggers: string[] = [];\n    \n    // Analyze actual re-render triggers based on component behavior\n    const renderCount = this.metrics.filter(m => m.componentName === componentName).length;\n    const recentMetrics = this.metrics.filter(m => m.componentName === componentName).slice(-3);\n    \n    // Check for excessive re-renders\n    if (renderCount > 5) {\n      triggers.push('Excessive re-renders detected');\n    }\n    \n    // Check for render time patterns\n    if (recentMetrics.length > 1) {\n      const avgRenderTime = recentMetrics.reduce((sum, m) => sum + m.averageRenderTime, 0) / recentMetrics.length;\n      if (avgRenderTime > 100) {\n        triggers.push('Slow render times');\n      }\n    }\n    \n    // Check for memory patterns\n    if (recentMetrics.length > 1) {\n      const memoryTrend = recentMetrics.map(m => m.memoryPeak);\n      const isIncreasing = memoryTrend.every((val, i) => i === 0 || val >= (memoryTrend[i - 1] || 0));\n      if (isIncreasing && (memoryTrend[memoryTrend.length - 1] || 0) > 5) {\n        triggers.push('Increasing memory usage pattern');\n      }\n    }\n    \n    // Check for performance degradation\n    if (recentMetrics.length > 2) {\n      const scores = recentMetrics.map(m => m.optimizationScore);\n      const isDegrading = scores.every((score, i) => i === 0 || score <= (scores[i - 1] || 0));\n      if (isDegrading && (scores[scores.length - 1] || 0) < 70) {\n        triggers.push('Performance degradation detected');\n      }\n    }\n    \n    // Component-specific triggers\n    if (componentName.includes('Feed') || componentName.includes('Mobile')) {\n      triggers.push('Large component with complex state management');\n    }\n    \n    if (componentName.includes('Store') || componentName.includes('Zustand')) {\n      triggers.push('State management updates');\n    }\n    \n    return triggers;\n  }\n\n  /**\n   * Analyze performance bottlenecks\n   */\n  private analyzeBottlenecks(renderTime: number, memoryUsage: number): string[] {\n    const bottlenecks: string[] = [];\n    \n    if (renderTime > 200) {\n      bottlenecks.push('Slow render time (>200ms)');\n    }\n    \n    if (memoryUsage > 10) {\n      bottlenecks.push('High memory usage (>10MB)');\n    }\n    \n    if (renderTime > 100 && memoryUsage > 5) {\n      bottlenecks.push('Combined performance issues');\n    }\n    \n    return bottlenecks;\n  }\n\n  /**\n   * Calculate optimization score (0-100)\n   */\n  private calculateOptimizationScore(renderTime: number, memoryUsage: number, renderCount: number): number {\n    let score = 100;\n    \n    // Deduct points for slow render times\n    if (renderTime > 300) score -= 40;\n    else if (renderTime > 200) score -= 30;\n    else if (renderTime > 100) score -= 20;\n    else if (renderTime > 50) score -= 10;\n    \n    // Deduct points for high memory usage\n    if (memoryUsage > 20) score -= 40;\n    else if (memoryUsage > 10) score -= 30;\n    else if (memoryUsage > 5) score -= 20;\n    else if (memoryUsage > 2) score -= 10;\n    \n    // Deduct points for excessive re-renders\n    if (renderCount > 10) score -= 20;\n    else if (renderCount > 5) score -= 10;\n    \n    return Math.max(0, score);\n  }\n\n  /**\n   * Generate optimization recommendations\n   */\n  private generateRecommendations(renderTime: number, memoryUsage: number, renderCount: number): string[] {\n    const recommendations: string[] = [];\n    \n    if (renderTime > 200) {\n      recommendations.push('‚ö° Implement React.memo for expensive components');\n      recommendations.push('‚ö° Use useMemo/useCallback for expensive calculations');\n      recommendations.push('‚ö° Consider lazy loading for heavy components');\n    }\n    \n    if (memoryUsage > 10) {\n      recommendations.push('üß† Implement proper cleanup in useEffect hooks');\n      recommendations.push('üß† Review memory leaks in event listeners');\n      recommendations.push('üß† Consider component unmounting strategies');\n    }\n    \n    if (renderCount > 5) {\n      recommendations.push('üîÑ Optimize useEffect dependencies');\n      recommendations.push('üîÑ Consider state management optimization');\n      recommendations.push('üîÑ Review component re-render patterns');\n    }\n    \n    if (recommendations.length === 0) {\n      recommendations.push('‚úÖ Component is well optimized!');\n    }\n    \n    return recommendations;\n  }\n\n  /**\n   * Create component profile\n   */\n  createComponentProfile(name: string, metrics: ProfilerMetrics): ComponentProfile {\n    const profile: ComponentProfile = {\n      name,\n      metrics,\n      children: [],\n      depth: 0,\n      isOptimized: metrics.optimizationScore > 80,\n      optimizationPotential: this.calculateOptimizationPotential(metrics.optimizationScore),\n    };\n    \n    this.profiles.set(name, profile);\n    return profile;\n  }\n\n  /**\n   * Calculate optimization potential\n   */\n  private calculateOptimizationPotential(score: number): 'HIGH' | 'MEDIUM' | 'LOW' {\n    if (score < 50) return 'HIGH';\n    if (score < 80) return 'MEDIUM';\n    return 'LOW';\n  }\n\n  /**\n   * Generate comprehensive performance analysis\n   */\n  generatePerformanceAnalysis(): PerformanceAnalysis {\n    const allMetrics = this.metrics;\n    const totalTests = allMetrics.length;\n    \n    if (totalTests === 0) {\n      return {\n        overallScore: 0,\n        criticalIssues: ['No performance data available'],\n        optimizationOpportunities: [],\n        memoryLeaks: [],\n        renderOptimizations: [],\n        networkOptimizations: [],\n        accessibilityOptimizations: [],\n        recommendations: ['Run performance tests to generate analysis'],\n        estimatedImprovement: 0,\n      };\n    }\n    \n    const averageScore = allMetrics.reduce((sum, m) => sum + m.optimizationScore, 0) / totalTests;\n    const criticalIssues = this.identifyCriticalIssues(allMetrics);\n    const optimizationOpportunities = this.identifyOptimizationOpportunities(allMetrics);\n    const memoryLeaks = this.identifyMemoryLeaks(allMetrics);\n    const renderOptimizations = this.identifyRenderOptimizations(allMetrics);\n    const networkOptimizations = this.identifyNetworkOptimizations(allMetrics);\n    const accessibilityOptimizations = this.identifyAccessibilityOptimizations(allMetrics);\n    \n    const recommendations = this.generateComprehensiveRecommendations(\n      criticalIssues,\n      optimizationOpportunities,\n      memoryLeaks,\n      renderOptimizations,\n      networkOptimizations,\n      accessibilityOptimizations\n    );\n    \n    const estimatedImprovement = this.calculateEstimatedImprovement(allMetrics);\n    \n    return {\n      overallScore: averageScore,\n      criticalIssues,\n      optimizationOpportunities,\n      memoryLeaks,\n      renderOptimizations,\n      networkOptimizations,\n      accessibilityOptimizations,\n      recommendations,\n      estimatedImprovement,\n    };\n  }\n\n  /**\n   * Identify critical performance issues\n   */\n  private identifyCriticalIssues(metrics: ProfilerMetrics[]): string[] {\n    const issues: string[] = [];\n    \n    const slowComponents = metrics.filter(m => m.averageRenderTime > 200);\n    const highMemoryComponents = metrics.filter(m => m.memoryPeak > 10);\n    const lowScoreComponents = metrics.filter(m => m.optimizationScore < 50);\n    \n    if (slowComponents.length > 0) {\n      issues.push(`üêå ${slowComponents.length} components with slow render times (>200ms)`);\n    }\n    \n    if (highMemoryComponents.length > 0) {\n      issues.push(`üß† ${highMemoryComponents.length} components with high memory usage (>10MB)`);\n    }\n    \n    if (lowScoreComponents.length > 0) {\n      issues.push(`‚ö†Ô∏è ${lowScoreComponents.length} components with poor optimization scores (<50)`);\n    }\n    \n    return issues;\n  }\n\n  /**\n   * Identify optimization opportunities\n   */\n  private identifyOptimizationOpportunities(metrics: ProfilerMetrics[]): string[] {\n    const opportunities: string[] = [];\n    \n    const mediumScoreComponents = metrics.filter(m => m.optimizationScore >= 50 && m.optimizationScore < 80);\n    const highRenderCountComponents = metrics.filter(m => m.renderCount > 5);\n    \n    if (mediumScoreComponents.length > 0) {\n      opportunities.push(`üìà ${mediumScoreComponents.length} components with medium optimization potential`);\n    }\n    \n    if (highRenderCountComponents.length > 0) {\n      opportunities.push(`üîÑ ${highRenderCountComponents.length} components with excessive re-renders`);\n    }\n    \n    return opportunities;\n  }\n\n  /**\n   * Identify memory leaks\n   */\n  private identifyMemoryLeaks(metrics: ProfilerMetrics[]): string[] {\n    const leaks: string[] = [];\n    \n    const highMemoryComponents = metrics.filter(m => m.memoryPeak > 10);\n    const increasingMemoryComponents = metrics.filter(m => m.memoryPeak > m.memoryAverage * 2);\n    \n    if (highMemoryComponents.length > 0) {\n      leaks.push(`üß† ${highMemoryComponents.length} components with high memory usage`);\n    }\n    \n    if (increasingMemoryComponents.length > 0) {\n      leaks.push(`üìà ${increasingMemoryComponents.length} components with increasing memory usage`);\n    }\n    \n    return leaks;\n  }\n\n  /**\n   * Identify render optimizations\n   */\n  private identifyRenderOptimizations(metrics: ProfilerMetrics[]): string[] {\n    const optimizations: string[] = [];\n    \n    const slowRenderComponents = metrics.filter(m => m.averageRenderTime > 100);\n    const highRenderCountComponents = metrics.filter(m => m.renderCount > 3);\n    \n    if (slowRenderComponents.length > 0) {\n      optimizations.push(`‚ö° ${slowRenderComponents.length} components need render optimization`);\n    }\n    \n    if (highRenderCountComponents.length > 0) {\n      optimizations.push(`‚ö° ${highRenderCountComponents.length} components need re-render optimization`);\n    }\n    \n    return optimizations;\n  }\n\n  /**\n   * Identify network optimizations\n   */\n  private identifyNetworkOptimizations(metrics: ProfilerMetrics[]): string[] {\n    const optimizations: string[] = [];\n    \n    // Analyze network-related performance metrics\n    const networkMetrics = metrics.filter(m => m.networkTime && m.networkTime > 0);\n    const highNetworkTime = metrics.filter(m => m.networkTime && m.networkTime > 300);\n    const apiMetrics = metrics.filter(m => m.apiTime && m.apiTime > 0);\n    const highApiTime = metrics.filter(m => m.apiTime && m.apiTime > 200);\n    \n    // Network performance analysis\n    if (networkMetrics.length > 0) {\n      const avgNetworkTime = networkMetrics.reduce((sum, m) => sum + (m.networkTime || 0), 0) / networkMetrics.length;\n      if (avgNetworkTime > 200) {\n        optimizations.push('üåê High network latency detected - consider CDN implementation');\n      }\n      if (avgNetworkTime > 500) {\n        optimizations.push('üåê Critical network performance issues - optimize API endpoints');\n      }\n    }\n    \n    // API performance analysis\n    if (apiMetrics.length > 0) {\n      const avgApiTime = apiMetrics.reduce((sum, m) => sum + (m.apiTime || 0), 0) / apiMetrics.length;\n      if (avgApiTime > 150) {\n        optimizations.push('üîå API response times are slow - implement caching strategies');\n      }\n      if (avgApiTime > 300) {\n        optimizations.push('üîå Critical API performance issues - optimize database queries');\n      }\n    }\n    \n    // Network optimization recommendations based on patterns\n    if (highNetworkTime.length > 0) {\n      optimizations.push('üåê Implement request batching for multiple API calls');\n      optimizations.push('üåê Add request deduplication to prevent duplicate calls');\n    }\n    \n    if (highApiTime.length > 0) {\n      optimizations.push('üîå Implement API response caching with TTL');\n      optimizations.push('üîå Add database query optimization');\n    }\n    \n    // General network optimizations\n    if (networkMetrics.length > 2) {\n      optimizations.push('üåê Consider implementing service worker for offline caching');\n      optimizations.push('üåê Add request compression for large payloads');\n    }\n    \n    return optimizations;\n  }\n\n  /**\n   * Identify accessibility optimizations\n   */\n  private identifyAccessibilityOptimizations(metrics: ProfilerMetrics[]): string[] {\n    const optimizations: string[] = [];\n    \n    // Analyze accessibility-related performance metrics\n    const accessibilityMetrics = metrics.filter(m => m.accessibilityTime && m.accessibilityTime > 0);\n    const highAccessibilityTime = metrics.filter(m => m.accessibilityTime && m.accessibilityTime > 50);\n    const slowComponents = metrics.filter(m => m.averageRenderTime > 100);\n    const memoryIntensiveComponents = metrics.filter(m => m.memoryPeak > 5);\n    \n    // Accessibility performance analysis\n    if (accessibilityMetrics.length > 0) {\n      const avgAccessibilityTime = accessibilityMetrics.reduce((sum, m) => sum + (m.accessibilityTime || 0), 0) / accessibilityMetrics.length;\n      if (avgAccessibilityTime > 30) {\n        optimizations.push('‚ôø Screen reader performance is slow - optimize ARIA announcements');\n      }\n      if (avgAccessibilityTime > 75) {\n        optimizations.push('‚ôø Critical accessibility performance issues - review screen reader implementation');\n      }\n    }\n    \n    // Screen reader optimization recommendations\n    if (highAccessibilityTime.length > 0) {\n      optimizations.push('‚ôø Implement efficient live region management for screen readers');\n      optimizations.push('‚ôø Optimize ARIA attribute rendering performance');\n      optimizations.push('‚ôø Add debouncing for screen reader announcements');\n    }\n    \n    // Keyboard navigation optimization\n    if (slowComponents.length > 0) {\n      optimizations.push('‚ôø Optimize keyboard navigation for slow-rendering components');\n      optimizations.push('‚ôø Implement focus management optimization');\n      optimizations.push('‚ôø Add keyboard shortcut performance improvements');\n    }\n    \n    // Memory optimization for accessibility\n    if (memoryIntensiveComponents.length > 0) {\n      optimizations.push('‚ôø Optimize accessibility features for memory-intensive components');\n      optimizations.push('‚ôø Implement efficient accessibility state management');\n    }\n    \n    // General accessibility optimizations\n    if (metrics.length > 2) {\n      optimizations.push('‚ôø Consider implementing accessibility performance monitoring');\n      optimizations.push('‚ôø Add accessibility feature lazy loading');\n      optimizations.push('‚ôø Optimize accessibility testing performance');\n    }\n    \n    return optimizations;\n  }\n\n  /**\n   * Generate comprehensive recommendations\n   */\n  private generateComprehensiveRecommendations(\n    criticalIssues: string[],\n    optimizationOpportunities: string[],\n    memoryLeaks: string[],\n    renderOptimizations: string[],\n    networkOptimizations: string[],\n    accessibilityOptimizations: string[]\n  ): string[] {\n    const recommendations: string[] = [];\n    \n    if (criticalIssues.length > 0) {\n      recommendations.push('üö® PRIORITY: Address critical performance issues');\n      recommendations.push(...criticalIssues);\n    }\n    \n    if (memoryLeaks.length > 0) {\n      recommendations.push('üß† PRIORITY: Fix memory leaks');\n      recommendations.push(...memoryLeaks);\n    }\n    \n    if (renderOptimizations.length > 0) {\n      recommendations.push('‚ö° HIGH: Optimize render performance');\n      recommendations.push(...renderOptimizations);\n    }\n    \n    if (optimizationOpportunities.length > 0) {\n      recommendations.push('üìà MEDIUM: Implement optimization opportunities');\n      recommendations.push(...optimizationOpportunities);\n    }\n    \n    if (networkOptimizations.length > 0) {\n      recommendations.push('üåê MEDIUM: Optimize network performance');\n      recommendations.push(...networkOptimizations);\n    }\n    \n    if (accessibilityOptimizations.length > 0) {\n      recommendations.push('‚ôø LOW: Optimize accessibility performance');\n      recommendations.push(...accessibilityOptimizations);\n    }\n    \n    if (recommendations.length === 0) {\n      recommendations.push('üéâ Excellent performance! No optimizations needed.');\n    }\n    \n    return recommendations;\n  }\n\n  /**\n   * Calculate estimated improvement percentage\n   */\n  private calculateEstimatedImprovement(metrics: ProfilerMetrics[]): number {\n    const averageScore = metrics.reduce((sum, m) => sum + m.optimizationScore, 0) / metrics.length;\n    const maxPossibleScore = 100;\n    const improvement = maxPossibleScore - averageScore;\n    return Math.max(0, improvement);\n  }\n\n  /**\n   * Get all component profiles\n   */\n  getComponentProfiles(): ComponentProfile[] {\n    return Array.from(this.profiles.values());\n  }\n\n  /**\n   * Get metrics for a specific component\n   */\n  getComponentMetrics(componentName: string): ProfilerMetrics | undefined {\n    return this.metrics.find(m => m.componentName === componentName);\n  }\n\n  /**\n   * Get all alerts\n   */\n  getAlerts(): string[] {\n    return this.alerts;\n  }\n\n  /**\n   * Clear all profiling data\n   */\n  clear(): void {\n    this.profiles.clear();\n    this.metrics = [];\n    this.alerts = [];\n    this.isProfiling = false;\n  }\n\n  /**\n   * Record test metrics\n   */\n  recordMetrics(metrics: Omit<ProfilerMetrics, 'timestamp'>): void {\n    const fullMetrics: ProfilerMetrics = {\n      ...metrics,\n      timestamp: new Date(),\n    };\n    \n    this.metrics.push(fullMetrics);\n    \n    // Check for performance alerts\n    this.checkPerformanceAlerts(fullMetrics);\n  }\n\n  /**\n   * Check for performance alerts\n   */\n  private checkPerformanceAlerts(metrics: ProfilerMetrics): void {\n    const alerts: string[] = [];\n\n    // Render time alerts\n    if (metrics.renderTime && metrics.renderTime > 200) {\n      alerts.push(`‚ö†Ô∏è SLOW RENDER: ${metrics.componentName} took ${metrics.renderTime.toFixed(2)}ms (budget: 200ms)`);\n    }\n\n    // Memory usage alerts\n    if (metrics.memoryPeak > 10) {\n      alerts.push(`‚ö†Ô∏è HIGH MEMORY: ${metrics.componentName} used ${metrics.memoryPeak.toFixed(2)}MB (budget: 10MB)`);\n    }\n\n    // Performance grade alerts\n    if (metrics.performanceGrade === 'D' || metrics.performanceGrade === 'F') {\n      alerts.push(`üö® POOR PERFORMANCE: ${metrics.componentName} received grade ${metrics.performanceGrade}`);\n    }\n\n    // Network time alerts\n    if (metrics.networkTime && metrics.networkTime > 500) {\n      alerts.push(`‚ö†Ô∏è SLOW NETWORK: ${metrics.componentName} network took ${metrics.networkTime.toFixed(2)}ms (budget: 500ms)`);\n    }\n\n    this.alerts.push(...alerts);\n  }\n\n  /**\n   * Export profiling data\n   */\n  exportProfilingData(): string {\n    return JSON.stringify({\n      profiles: Array.from(this.profiles.entries()),\n      metrics: this.metrics,\n      analysis: this.generatePerformanceAnalysis(),\n      insights: this.getPerformanceInsights(),\n      patterns: this.analyzePerformancePatterns(),\n    }, null, 2);\n  }\n\n  /**\n   * Get performance insights and recommendations\n   */\n  getPerformanceInsights(): {\n    topPerformers: string[];\n    needsAttention: string[];\n    optimizationOpportunities: string[];\n    criticalIssues: string[];\n  } {\n    const topPerformers: string[] = [];\n    const needsAttention: string[] = [];\n    const optimizationOpportunities: string[] = [];\n    const criticalIssues: string[] = [];\n    \n    this.metrics.forEach(metric => {\n      // Use optimizationScore if available, otherwise convert performanceGrade to score\n      const score = metric.optimizationScore || this.convertGradeToScore(metric.performanceGrade || 'C');\n      \n      if (score >= 90) {\n        topPerformers.push(`${metric.componentName}: ${score}/100 (EXCELLENT)`);\n      } else if (score >= 70) {\n        optimizationOpportunities.push(`${metric.componentName}: ${score}/100 (GOOD - room for improvement)`);\n      } else if (score >= 50) {\n        needsAttention.push(`${metric.componentName}: ${score}/100 (NEEDS ATTENTION)`);\n      } else {\n        criticalIssues.push(`${metric.componentName}: ${score}/100 (CRITICAL)`);\n      }\n    });\n    \n    return { topPerformers, needsAttention, optimizationOpportunities, criticalIssues };\n  }\n\n  /**\n   * Track component lifecycle events\n   */\n  trackComponentLifecycle(componentName: string, event: 'mount' | 'update' | 'unmount', duration: number): void {\n    logger.info(`üîÑ Component Lifecycle: ${componentName} ${event} took ${duration}ms`);\n    \n    // Record lifecycle metrics\n    this.recordMetrics({\n      componentName,\n      renderCount: 1,\n      totalRenderTime: duration,\n      averageRenderTime: duration,\n      maxRenderTime: duration,\n      minRenderTime: duration,\n      memoryPeak: 0,\n      memoryAverage: 0,\n      reRenderTriggers: [],\n      performanceBottlenecks: [],\n      optimizationScore: this.calculateOptimizationScore(duration, 0, 1),\n      recommendations: [],\n      renderTime: duration,\n      performanceGrade: this.calculatePerformanceGrade(duration)\n    });\n  }\n\n  /**\n   * Analyze performance patterns across multiple runs\n   */\n  analyzePerformancePatterns(): {\n    trendingUp: string[];\n    trendingDown: string[];\n    stable: string[];\n    volatile: string[];\n  } {\n    const trendingUp: string[] = [];\n    const trendingDown: string[] = [];\n    const stable: string[] = [];\n    const volatile: string[] = [];\n\n    // Group metrics by component\n    const componentMetrics = new Map<string, ProfilerMetrics[]>();\n    this.metrics.forEach(metric => {\n      if (!componentMetrics.has(metric.componentName)) {\n        componentMetrics.set(metric.componentName, []);\n      }\n      componentMetrics.get(metric.componentName)!.push(metric);\n    });\n\n    // Analyze patterns for each component\n    componentMetrics.forEach((metrics, componentName) => {\n      if (metrics.length < 3) {\n        stable.push(`${componentName}: insufficient data`);\n        return;\n      }\n\n      const renderTimes = metrics.map(m => m.averageRenderTime);\n      const trend = this.calculateTrend(renderTimes);\n      const volatility = this.calculateVolatility(renderTimes);\n\n      if (trend > 0.1) {\n        trendingUp.push(`${componentName}: +${(trend * 100).toFixed(1)}% trend`);\n      } else if (trend < -0.1) {\n        trendingDown.push(`${componentName}: ${(trend * 100).toFixed(1)}% trend`);\n      } else if (volatility > 0.3) {\n        volatile.push(`${componentName}: ${(volatility * 100).toFixed(1)}% volatility`);\n      } else {\n        stable.push(`${componentName}: stable performance`);\n      }\n    });\n\n    return { trendingUp, trendingDown, stable, volatile };\n  }\n\n  /**\n   * Calculate trend from array of values\n   */\n  private calculateTrend(values: number[]): number {\n    if (values.length < 2) return 0;\n    \n    const firstHalf = values.slice(0, Math.floor(values.length / 2));\n    const secondHalf = values.slice(Math.floor(values.length / 2));\n    \n    const firstAvg = firstHalf.reduce((sum, val) => sum + val, 0) / firstHalf.length;\n    const secondAvg = secondHalf.reduce((sum, val) => sum + val, 0) / secondHalf.length;\n    \n    return (secondAvg - firstAvg) / firstAvg;\n  }\n\n  /**\n   * Calculate volatility (standard deviation / mean)\n   */\n  private calculateVolatility(values: number[]): number {\n    if (values.length < 2) return 0;\n    \n    const mean = values.reduce((sum, val) => sum + val, 0) / values.length;\n    const variance = values.reduce((sum, val) => sum + Math.pow(val - mean, 2), 0) / values.length;\n    const stdDev = Math.sqrt(variance);\n    \n    return stdDev / mean;\n  }\n\n  /**\n   * Calculate performance grade based on render time\n   */\n  calculatePerformanceGrade(renderTime: number): 'A+' | 'A' | 'B' | 'C' | 'D' | 'F' {\n    if (renderTime <= 50) return 'A+';\n    if (renderTime <= 100) return 'A';\n    if (renderTime <= 150) return 'B';\n    if (renderTime <= 200) return 'C';\n    if (renderTime <= 300) return 'D';\n    return 'F';\n  }\n\n  /**\n   * Convert performance grade to numeric score\n   */\n  private convertGradeToScore(grade: string): number {\n    switch (grade) {\n      case 'A+': return 95;\n      case 'A': return 90;\n      case 'B': return 80;\n      case 'C': return 70;\n      case 'D': return 60;\n      case 'F': return 30;\n      default: return 50;\n    }\n  }\n}\n\n// Global performance profiler instance\nexport const performanceProfiler = new PerformanceProfiler();\n\n\n\n"],"names":["PerformanceProfiler","performanceProfiler","startProfiling","componentName","isProfiling","startTime","performance","now","startMemory","memory","usedJSHeapSize","logger","info","stopProfiling","renderCount","Error","endTime","endMemory","totalRenderTime","averageRenderTime","memoryUsed","metrics","maxRenderTime","minRenderTime","memoryPeak","memoryAverage","reRenderTriggers","analyzeReRenderTriggers","performanceBottlenecks","analyzeBottlenecks","optimizationScore","calculateOptimizationScore","recommendations","generateRecommendations","timestamp","Date","push","toFixed","triggers","filter","m","length","recentMetrics","slice","avgRenderTime","reduce","sum","memoryTrend","map","isIncreasing","every","val","i","scores","isDegrading","score","includes","renderTime","memoryUsage","bottlenecks","Math","max","createComponentProfile","name","profile","children","depth","isOptimized","optimizationPotential","calculateOptimizationPotential","profiles","set","generatePerformanceAnalysis","allMetrics","totalTests","overallScore","criticalIssues","optimizationOpportunities","memoryLeaks","renderOptimizations","networkOptimizations","accessibilityOptimizations","estimatedImprovement","averageScore","identifyCriticalIssues","identifyOptimizationOpportunities","identifyMemoryLeaks","identifyRenderOptimizations","identifyNetworkOptimizations","identifyAccessibilityOptimizations","generateComprehensiveRecommendations","calculateEstimatedImprovement","issues","slowComponents","highMemoryComponents","lowScoreComponents","opportunities","mediumScoreComponents","highRenderCountComponents","leaks","increasingMemoryComponents","optimizations","slowRenderComponents","networkMetrics","networkTime","highNetworkTime","apiMetrics","apiTime","highApiTime","avgNetworkTime","avgApiTime","accessibilityMetrics","accessibilityTime","highAccessibilityTime","memoryIntensiveComponents","avgAccessibilityTime","maxPossibleScore","improvement","getComponentProfiles","Array","from","values","getComponentMetrics","find","getAlerts","alerts","clear","recordMetrics","fullMetrics","checkPerformanceAlerts","performanceGrade","exportProfilingData","JSON","stringify","entries","analysis","insights","getPerformanceInsights","patterns","analyzePerformancePatterns","topPerformers","needsAttention","forEach","metric","convertGradeToScore","trackComponentLifecycle","event","duration","calculatePerformanceGrade","trendingUp","trendingDown","stable","volatile","componentMetrics","Map","has","get","renderTimes","trend","calculateTrend","volatility","calculateVolatility","firstHalf","floor","secondHalf","firstAvg","secondAvg","mean","variance","pow","stdDev","sqrt","grade"],"mappings":"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"}