{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/lib/stores/performanceStore.ts"],"sourcesContent":["/**\n * Performance Store\n * \n * Centralized Zustand store for performance monitoring, metrics collection,\n * and performance alert management.\n * \n * Created: October 10, 2025\n * Status: âœ… ACTIVE\n */\n\nimport { create } from 'zustand';\nimport { devtools, persist } from 'zustand/middleware';\nimport { immer } from 'zustand/middleware/immer';\n\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\nexport interface PerformanceMetric {\n  id: string;\n  type: 'navigation' | 'resource' | 'measure' | 'custom' | 'database';\n  name: string;\n  value: number;\n  unit: 'ms' | 'bytes' | 'count' | 'score' | 'percentage';\n  timestamp: Date;\n  url: string;\n  metadata?: Record<string, any>;\n}\n\nexport interface DatabasePerformanceMetric {\n  metricName: string;\n  avgValue: number;\n  minValue: number;\n  maxValue: number;\n  countMeasurements: number;\n  timestamp: Date;\n}\n\nexport interface CacheStats {\n  size: number;\n  keys: string[];\n  memoryUsage: number;\n  hitRate: number;\n}\n\nexport interface PerformanceAlert {\n  id: string;\n  type: 'threshold' | 'anomaly' | 'error';\n  severity: 'low' | 'medium' | 'high' | 'critical';\n  metric: string;\n  value: number;\n  threshold: number;\n  message: string;\n  timestamp: Date;\n  resolved: boolean;\n  metadata?: Record<string, any>;\n}\n\nexport interface PerformanceThresholds {\n  navigation: {\n    fcp: number; // First Contentful Paint\n    lcp: number; // Largest Contentful Paint\n    fid: number; // First Input Delay\n    cls: number; // Cumulative Layout Shift\n    ttfb: number; // Time to First Byte\n  };\n  resource: {\n    loadTime: number;\n    size: number;\n    count: number;\n  };\n  custom: {\n    [key: string]: number;\n  };\n}\n\nexport interface PerformanceReport {\n  id: string;\n  timestamp: Date;\n  url: string;\n  metrics: PerformanceMetric[];\n  alerts: PerformanceAlert[];\n  summary: {\n    score: number;\n    grade: 'A' | 'B' | 'C' | 'D' | 'F';\n    recommendations: string[];\n  };\n  generated_at: Date;\n}\n\nexport interface PerformanceStore {\n  // State\n  metrics: PerformanceMetric[];\n  alerts: PerformanceAlert[];\n  reports: PerformanceReport[];\n  thresholds: PerformanceThresholds;\n  isMonitoring: boolean;\n  isLoading: boolean;\n  error: string | null;\n  \n  // Database performance state\n  databaseMetrics: DatabasePerformanceMetric[];\n  cacheStats: CacheStats | null;\n  lastRefresh: Date | null;\n  autoRefresh: boolean;\n  refreshInterval: number;\n  \n  // Actions - Metrics\n  recordMetric: (metric: Omit<PerformanceMetric, 'id' | 'timestamp'>) => void;\n  recordNavigationMetric: (name: string, value: number, metadata?: Record<string, any>) => void;\n  recordResourceMetric: (name: string, value: number, metadata?: Record<string, any>) => void;\n  recordCustomMetric: (name: string, value: number, unit?: 'ms' | 'bytes' | 'count' | 'score', metadata?: Record<string, any>) => void;\n  clearMetrics: () => void;\n  \n  // Actions - Alerts\n  createAlert: (alert: Omit<PerformanceAlert, 'id' | 'timestamp' | 'resolved'>) => void;\n  resolveAlert: (id: string) => void;\n  clearAlerts: () => void;\n  clearResolvedAlerts: () => void;\n  \n  // Actions - Monitoring\n  startMonitoring: () => void;\n  stopMonitoring: () => void;\n  setThreshold: (type: string, metric: string, threshold: number) => void;\n  checkThresholds: () => void;\n  \n  // Actions - Reports\n  generateReport: () => PerformanceReport;\n  exportMetrics: (format?: 'json' | 'csv') => string;\n  exportReport: (reportId: string, format?: 'json' | 'csv') => string;\n  \n  // Actions - Database Performance\n  setDatabaseMetrics: (metrics: DatabasePerformanceMetric[]) => void;\n  setCacheStats: (stats: CacheStats) => void;\n  setLastRefresh: (date: Date) => void;\n  setAutoRefresh: (enabled: boolean) => void;\n  setRefreshInterval: (interval: number) => void;\n  loadDatabasePerformance: () => Promise<void>;\n  refreshMaterializedViews: () => Promise<void>;\n  performDatabaseMaintenance: () => Promise<void>;\n  \n  // Actions - Loading & Error\n  setLoading: (loading: boolean) => void;\n  setError: (error: string | null) => void;\n  clearError: () => void;\n  \n  // Initialization\n  initialize: () => void;\n}\n\n// ============================================================================\n// UTILITY FUNCTIONS\n// ============================================================================\n\nconst calculatePerformanceScore = (metrics: PerformanceMetric[]): { score: number; grade: 'A' | 'B' | 'C' | 'D' | 'F' } => {\n  const navigationMetrics = metrics.filter(m => m.type === 'navigation');\n  const fcp = navigationMetrics.find(m => m.name === 'FCP')?.value || 0;\n  const lcp = navigationMetrics.find(m => m.name === 'LCP')?.value || 0;\n  const fid = navigationMetrics.find(m => m.name === 'FID')?.value || 0;\n  const cls = navigationMetrics.find(m => m.name === 'CLS')?.value || 0;\n  const ttfb = navigationMetrics.find(m => m.name === 'TTFB')?.value || 0;\n\n  // Calculate score based on Core Web Vitals\n  let score = 100;\n  \n  // FCP scoring (0-3000ms)\n  if (fcp > 3000) score -= 20;\n  else if (fcp > 1800) score -= 10;\n  \n  // LCP scoring (0-4000ms)\n  if (lcp > 4000) score -= 25;\n  else if (lcp > 2500) score -= 15;\n  \n  // FID scoring (0-300ms)\n  if (fid > 300) score -= 20;\n  else if (fid > 100) score -= 10;\n  \n  // CLS scoring (0-0.25)\n  if (cls > 0.25) score -= 20;\n  else if (cls > 0.1) score -= 10;\n  \n  // TTFB scoring (0-800ms)\n  if (ttfb > 800) score -= 15;\n  else if (ttfb > 600) score -= 5;\n\n  const grade = score >= 90 ? 'A' : score >= 80 ? 'B' : score >= 70 ? 'C' : score >= 60 ? 'D' : 'F';\n  \n  return { score: Math.max(0, score), grade };\n};\n\nconst generateRecommendations = (metrics: PerformanceMetric[]): string[] => {\n  const recommendations: string[] = [];\n  const navigationMetrics = metrics.filter(m => m.type === 'navigation');\n  \n  const fcp = navigationMetrics.find(m => m.name === 'FCP')?.value || 0;\n  const lcp = navigationMetrics.find(m => m.name === 'LCP')?.value || 0;\n  const fid = navigationMetrics.find(m => m.name === 'FID')?.value || 0;\n  const cls = navigationMetrics.find(m => m.name === 'CLS')?.value || 0;\n  const ttfb = navigationMetrics.find(m => m.name === 'TTFB')?.value || 0;\n\n  if (fcp > 1800) recommendations.push('Optimize First Contentful Paint by reducing render-blocking resources');\n  if (lcp > 2500) recommendations.push('Improve Largest Contentful Paint by optimizing images and fonts');\n  if (fid > 100) recommendations.push('Reduce First Input Delay by minimizing JavaScript execution time');\n  if (cls > 0.1) recommendations.push('Minimize Cumulative Layout Shift by setting image dimensions');\n  if (ttfb > 600) recommendations.push('Improve Time to First Byte by optimizing server response time');\n\n  return recommendations;\n};\n\n// ============================================================================\n// STORE IMPLEMENTATION\n// ============================================================================\n\nexport const usePerformanceStore = create<PerformanceStore>()(\n  devtools(\n    persist(\n      immer((set, get) => ({\n        // Initial State\n        metrics: [],\n        alerts: [],\n        reports: [],\n        thresholds: {\n          navigation: {\n            fcp: 1800,\n            lcp: 2500,\n            fid: 100,\n            cls: 0.1,\n            ttfb: 600\n          },\n          resource: {\n            loadTime: 2000,\n            size: 1024 * 1024, // 1MB\n            count: 50\n          },\n          custom: {}\n        },\n        isMonitoring: false,\n        isLoading: false,\n        error: null,\n        \n        // Database performance state\n        databaseMetrics: [],\n        cacheStats: null,\n        lastRefresh: null,\n        autoRefresh: true,\n        refreshInterval: 30000,\n\n        // Actions - Metrics\n        recordMetric: (metric) => {\n          const id = `metric-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n          const newMetric: PerformanceMetric = {\n            ...metric,\n            id,\n            timestamp: new Date()\n          };\n\n          set((state) => {\n            state.metrics.push(newMetric);\n            \n            // Keep only last 1000 metrics to prevent memory issues\n            if (state.metrics.length > 1000) {\n              state.metrics = state.metrics.slice(-1000);\n            }\n          });\n\n          // Check thresholds (debounced to prevent excessive calls)\n          const { checkThresholds } = get();\n          if (checkThresholds) {\n            checkThresholds();\n          }\n        },\n\n        recordNavigationMetric: (name, value, metadata) => {\n          get().recordMetric({\n            type: 'navigation',\n            name,\n            value,\n            unit: 'ms',\n            url: typeof window !== 'undefined' ? window.location.href : '',\n            metadata\n          });\n        },\n\n        recordResourceMetric: (name, value, metadata) => {\n          get().recordMetric({\n            type: 'resource',\n            name,\n            value,\n            unit: 'ms',\n            url: typeof window !== 'undefined' ? window.location.href : '',\n            metadata\n          });\n        },\n\n        recordCustomMetric: (name, value, unit = 'ms', metadata) => {\n          get().recordMetric({\n            type: 'custom',\n            name,\n            value,\n            unit,\n            url: typeof window !== 'undefined' ? window.location.href : '',\n            metadata\n          });\n        },\n\n        clearMetrics: () => {\n          set((state) => {\n            state.metrics = [];\n          });\n        },\n\n        // Actions - Alerts\n        createAlert: (alert) => {\n          const id = `alert-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n          const newAlert: PerformanceAlert = {\n            ...alert,\n            id,\n            timestamp: new Date(),\n            resolved: false\n          };\n\n          set((state) => {\n            state.alerts.push(newAlert);\n            \n            // Keep only last 500 alerts\n            if (state.alerts.length > 500) {\n              state.alerts = state.alerts.slice(-500);\n            }\n          });\n        },\n\n        resolveAlert: (id) => {\n          set((state) => {\n            const alert = state.alerts.find(a => a.id === id);\n            if (alert) {\n              alert.resolved = true;\n            }\n          });\n        },\n\n        clearAlerts: () => {\n          set((state) => {\n            state.alerts = [];\n          });\n        },\n\n        clearResolvedAlerts: () => {\n          set((state) => {\n            state.alerts = state.alerts.filter(alert => !alert.resolved);\n          });\n        },\n\n        // Actions - Monitoring\n        startMonitoring: () => {\n          set((state) => {\n            state.isMonitoring = true;\n          });\n\n          if (typeof window !== 'undefined' && 'performance' in window) {\n            // Set up Performance Observer\n            try {\n              const observer = new PerformanceObserver((list) => {\n                const entries = list.getEntries();\n                entries.forEach((entry) => {\n                  if (entry.entryType === 'navigation') {\n                    const navEntry = entry as PerformanceNavigationTiming;\n                    get().recordNavigationMetric('TTFB', navEntry.responseStart - navEntry.requestStart);\n                    get().recordNavigationMetric('FCP', navEntry.domContentLoadedEventEnd - navEntry.fetchStart);\n                  } else if (entry.entryType === 'resource') {\n                    const resourceEntry = entry as PerformanceResourceTiming;\n                    get().recordResourceMetric(resourceEntry.name, resourceEntry.duration);\n                  }\n                });\n              });\n\n              observer.observe({ entryTypes: ['navigation', 'resource'] });\n            } catch (error) {\n              console.warn('Performance Observer not supported:', error);\n            }\n          }\n        },\n\n        stopMonitoring: () => {\n          set((state) => {\n            state.isMonitoring = false;\n          });\n        },\n\n        setThreshold: (type, metric, threshold) => {\n          set((state) => {\n            if (type === 'navigation' && metric in state.thresholds.navigation) {\n              (state.thresholds.navigation as any)[metric] = threshold;\n            } else if (type === 'resource' && metric in state.thresholds.resource) {\n              (state.thresholds.resource as any)[metric] = threshold;\n            } else if (type === 'custom') {\n              state.thresholds.custom[metric] = threshold;\n            }\n          });\n        },\n\n        checkThresholds: () => {\n          const { metrics, thresholds } = get();\n          const recentMetrics = metrics.slice(-100); // Check last 100 metrics\n\n          recentMetrics.forEach((metric) => {\n            let threshold = 0;\n            \n            if (metric.type === 'navigation' && metric.name in thresholds.navigation) {\n              threshold = (thresholds.navigation as any)[metric.name];\n            } else if (metric.type === 'resource' && metric.name in thresholds.resource) {\n              threshold = (thresholds.resource as any)[metric.name];\n            } else if (metric.type === 'custom' && metric.name in thresholds.custom) {\n              threshold = thresholds.custom[metric.name] || 0;\n            }\n\n            if (threshold > 0 && metric.value > threshold) {\n              const severity = metric.value > threshold * 2 ? 'high' : metric.value > threshold * 1.5 ? 'medium' : 'low';\n              \n              get().createAlert({\n                type: 'threshold',\n                severity,\n                metric: metric.name,\n                value: metric.value,\n                threshold,\n                message: `${metric.name} exceeded threshold: ${metric.value}${metric.unit} > ${threshold}${metric.unit}`\n              });\n            }\n          });\n        },\n\n        // Actions - Reports\n        generateReport: () => {\n          const { metrics, alerts } = get();\n          const id = `report-${Date.now()}`;\n          const { score, grade } = calculatePerformanceScore(metrics);\n          const recommendations = generateRecommendations(metrics);\n\n          const report: PerformanceReport = {\n            id,\n            timestamp: new Date(),\n            url: typeof window !== 'undefined' ? window.location.href : '',\n            metrics: [...metrics],\n            alerts: alerts.filter(alert => !alert.resolved),\n            summary: {\n              score,\n              grade,\n              recommendations\n            },\n            generated_at: new Date()\n          };\n\n          set((state) => {\n            state.reports.push(report);\n            \n            // Keep only last 50 reports\n            if (state.reports.length > 50) {\n              state.reports = state.reports.slice(-50);\n            }\n          });\n\n          return report;\n        },\n\n        exportMetrics: (format = 'json') => {\n          const { metrics } = get();\n          \n          if (format === 'csv') {\n            const headers = ['id', 'type', 'name', 'value', 'unit', 'timestamp', 'url'];\n            const rows = metrics.map(metric => [\n              metric.id,\n              metric.type,\n              metric.name,\n              metric.value,\n              metric.unit,\n              metric.timestamp.toISOString(),\n              metric.url\n            ]);\n            \n            return [headers, ...rows].map(row => row.join(',')).join('\\n');\n          }\n          \n          return JSON.stringify(metrics, null, 2);\n        },\n\n        exportReport: (reportId, format = 'json') => {\n          const { reports } = get();\n          const report = reports.find(r => r.id === reportId);\n          \n          if (!report) {\n            throw new Error(`Report ${reportId} not found`);\n          }\n          \n          if (format === 'csv') {\n            const headers = ['metric', 'value', 'unit', 'timestamp'];\n            const rows = report.metrics.map(metric => [\n              metric.name,\n              metric.value,\n              metric.unit,\n              metric.timestamp.toISOString()\n            ]);\n            \n            return [headers, ...rows].map(row => row.join(',')).join('\\n');\n          }\n          \n          return JSON.stringify(report, null, 2);\n        },\n\n        // Actions - Database Performance\n        setDatabaseMetrics: (metrics) => {\n          set((state) => {\n            state.databaseMetrics = metrics;\n          });\n        },\n\n        setCacheStats: (stats) => {\n          set((state) => {\n            state.cacheStats = stats;\n          });\n        },\n\n        setLastRefresh: (date) => {\n          set((state) => {\n            state.lastRefresh = date;\n          });\n        },\n\n        setAutoRefresh: (enabled) => {\n          set((state) => {\n            state.autoRefresh = enabled;\n          });\n        },\n\n        setRefreshInterval: (interval) => {\n          set((state) => {\n            state.refreshInterval = interval;\n          });\n        },\n\n        loadDatabasePerformance: async () => {\n          const { setLoading, setError, setLastRefresh, setDatabaseMetrics, setCacheStats } = get();\n          \n          try {\n            setLoading(true);\n            setError(null);\n            \n            // Fetch performance metrics directly from database\n            const supabase = await import('@/utils/supabase/client').then(m => m.getSupabaseClient());\n            if (!supabase) {\n              throw new Error('Database connection not available');\n            }\n\n            // Get database performance metrics from the last 24 hours\n            const { data: metricsData, error: metricsError } = await supabase\n              .from('performance_metrics')\n              .select('*')\n              .gte('timestamp', new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString())\n              .order('timestamp', { ascending: false });\n\n            if (metricsError) {\n              throw new Error(`Failed to fetch database metrics: ${metricsError.message}`);\n            }\n\n            // Transform metrics data to match DatabasePerformanceMetric interface\n            const databaseMetrics: DatabasePerformanceMetric[] = metricsData?.map(metric => ({\n              metricName: metric.metric_name,\n              avgValue: metric.avg_value,\n              minValue: metric.min_value,\n              maxValue: metric.max_value,\n              countMeasurements: metric.count_measurements,\n              timestamp: new Date(metric.timestamp)\n            })) || [];\n\n            // Get cache statistics\n            const { data: cacheData, error: cacheError } = await supabase\n              .from('cache_stats')\n              .select('*')\n              .order('timestamp', { ascending: false })\n              .limit(1)\n              .single();\n\n            if (cacheError && cacheError.code !== 'PGRST116') {\n              throw new Error(`Failed to fetch cache stats: ${cacheError.message}`);\n            }\n\n            // Transform cache data to match CacheStats interface\n            const cacheStats: CacheStats = cacheData ? {\n              size: cacheData.size || 0,\n              keys: cacheData.keys || [],\n              memoryUsage: cacheData.memory_usage || 0,\n              hitRate: cacheData.hit_rate || 0\n            } : {\n              size: 0,\n              keys: [],\n              memoryUsage: 0,\n              hitRate: 0\n            };\n            \n            setDatabaseMetrics(databaseMetrics);\n            setCacheStats(cacheStats);\n            setLastRefresh(new Date());\n            \n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Failed to load database performance';\n            setError(errorMessage);\n          } finally {\n            setLoading(false);\n          }\n        },\n\n        refreshMaterializedViews: async () => {\n          const { setLoading, setError, loadDatabasePerformance } = get();\n          \n          try {\n            setLoading(true);\n            setError(null);\n            \n            // Call optimized poll service to refresh materialized views\n            const response = await fetch('/api/admin/refresh-materialized-views', {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n            });\n            \n            if (!response.ok) {\n              throw new Error(`Failed to refresh materialized views: ${response.statusText}`);\n            }\n            \n            // Reload performance data after refresh\n            await loadDatabasePerformance();\n            \n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Failed to refresh materialized views';\n            setError(errorMessage);\n          } finally {\n            setLoading(false);\n          }\n        },\n\n        performDatabaseMaintenance: async () => {\n          const { setLoading, setError, loadDatabasePerformance } = get();\n          \n          try {\n            setLoading(true);\n            setError(null);\n            \n            // Call optimized poll service to perform database maintenance\n            const response = await fetch('/api/admin/perform-database-maintenance', {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n            });\n            \n            if (!response.ok) {\n              throw new Error(`Failed to perform database maintenance: ${response.statusText}`);\n            }\n            \n            // Reload performance data after maintenance\n            await loadDatabasePerformance();\n            \n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Failed to perform database maintenance';\n            setError(errorMessage);\n          } finally {\n            setLoading(false);\n          }\n        },\n\n        // Actions - Loading & Error\n        setLoading: (loading: boolean) => {\n          set((state) => {\n            state.isLoading = loading;\n          });\n        },\n\n        setError: (error: string | null) => {\n          set((state) => {\n            state.error = error;\n          });\n        },\n\n        clearError: () => {\n          set((state) => {\n            state.error = null;\n          });\n        },\n\n        // Initialization\n        initialize: () => {\n          set((state) => {\n            state.isLoading = true;\n            state.error = null;\n          });\n\n          try {\n            // Start monitoring if in browser\n            if (typeof window !== 'undefined') {\n              get().startMonitoring();\n            }\n\n            set((state) => {\n              state.isLoading = false;\n            });\n\n          } catch (error) {\n            set((state) => {\n              state.error = error instanceof Error ? error.message : 'Failed to initialize performance monitoring';\n              state.isLoading = false;\n            });\n          }\n        }\n      })),\n      {\n        name: 'performance-storage',\n        partialize: (state) => ({\n          thresholds: state.thresholds,\n          isMonitoring: state.isMonitoring\n        })\n      }\n    ),\n    { name: 'performance-store' }\n  )\n);\n\n// ============================================================================\n// SELECTORS\n// ============================================================================\n\nexport const usePerformance = () => usePerformanceStore();\n\n// Metrics Selectors\nexport const usePerformanceMetrics = () => usePerformanceStore(state => state.metrics);\nexport const useNavigationMetrics = () => usePerformanceStore(state => \n  state.metrics.filter(m => m.type === 'navigation')\n);\nexport const useResourceMetrics = () => usePerformanceStore(state => \n  state.metrics.filter(m => m.type === 'resource')\n);\nexport const useCustomMetrics = () => usePerformanceStore(state => \n  state.metrics.filter(m => m.type === 'custom')\n);\n\n// Alerts Selectors\nexport const usePerformanceAlerts = () => usePerformanceStore(state => state.alerts);\nexport const useActiveAlerts = () => usePerformanceStore(state => \n  state.alerts.filter(a => !a.resolved)\n);\nexport const useAlertsBySeverity = (severity: 'low' | 'medium' | 'high' | 'critical') => \n  usePerformanceStore(state => \n    state.alerts.filter(a => a.severity === severity && !a.resolved)\n  );\n\n// Reports Selectors\nexport const usePerformanceReports = () => usePerformanceStore(state => state.reports);\nexport const useLatestReport = () => usePerformanceStore(state => \n  state.reports[state.reports.length - 1]\n);\n\n// Thresholds Selectors\nexport const usePerformanceThresholds = () => usePerformanceStore(state => state.thresholds);\nexport const useNavigationThresholds = () => usePerformanceStore(state => state.thresholds.navigation);\nexport const useResourceThresholds = () => usePerformanceStore(state => state.thresholds.resource);\nexport const useCustomThresholds = () => usePerformanceStore(state => state.thresholds.custom);\n\n// Monitoring Selectors\nexport const useIsMonitoring = () => usePerformanceStore(state => state.isMonitoring);\nexport const usePerformanceLoading = () => usePerformanceStore(state => state.isLoading);\nexport const usePerformanceError = () => usePerformanceStore(state => state.error);\n\n// Database Performance Selectors\nexport const useDatabaseMetrics = () => usePerformanceStore(state => state.databaseMetrics);\nexport const useCacheStats = () => usePerformanceStore(state => state.cacheStats);\nexport const useLastRefresh = () => usePerformanceStore(state => state.lastRefresh);\nexport const useAutoRefresh = () => usePerformanceStore(state => state.autoRefresh);\nexport const useRefreshInterval = () => usePerformanceStore(state => state.refreshInterval);\n\n// ============================================================================\n// ACTIONS\n// ============================================================================\n\nexport const usePerformanceActions = () => usePerformanceStore(state => ({\n  recordMetric: state.recordMetric,\n  recordNavigationMetric: state.recordNavigationMetric,\n  recordResourceMetric: state.recordResourceMetric,\n  recordCustomMetric: state.recordCustomMetric,\n  clearMetrics: state.clearMetrics,\n  createAlert: state.createAlert,\n  resolveAlert: state.resolveAlert,\n  clearAlerts: state.clearAlerts,\n  clearResolvedAlerts: state.clearResolvedAlerts,\n  startMonitoring: state.startMonitoring,\n  stopMonitoring: state.stopMonitoring,\n  setThreshold: state.setThreshold,\n  checkThresholds: state.checkThresholds,\n  generateReport: state.generateReport,\n  exportMetrics: state.exportMetrics,\n  exportReport: state.exportReport,\n  setLoading: state.setLoading,\n  setError: state.setError,\n  clearError: state.clearError,\n  initialize: state.initialize,\n  // Database performance actions\n  setDatabaseMetrics: state.setDatabaseMetrics,\n  setCacheStats: state.setCacheStats,\n  setLastRefresh: state.setLastRefresh,\n  setAutoRefresh: state.setAutoRefresh,\n  setRefreshInterval: state.setRefreshInterval,\n  loadDatabasePerformance: state.loadDatabasePerformance,\n  refreshMaterializedViews: state.refreshMaterializedViews,\n  performDatabaseMaintenance: state.performDatabaseMaintenance\n}));\n\n// ============================================================================\n// UTILITIES\n// ============================================================================\n\nexport const usePerformanceScore = () => {\n  const metrics = useNavigationMetrics();\n  return calculatePerformanceScore(metrics);\n};\n\nexport const usePerformanceRecommendations = () => {\n  const metrics = usePerformanceMetrics();\n  return generateRecommendations(metrics);\n};\n"],"names":["useActiveAlerts","useAlertsBySeverity","useAutoRefresh","useCacheStats","useCustomMetrics","useCustomThresholds","useDatabaseMetrics","useIsMonitoring","useLastRefresh","useLatestReport","useNavigationMetrics","useNavigationThresholds","usePerformance","usePerformanceActions","usePerformanceAlerts","usePerformanceError","usePerformanceLoading","usePerformanceMetrics","usePerformanceRecommendations","usePerformanceReports","usePerformanceScore","usePerformanceStore","usePerformanceThresholds","useRefreshInterval","useResourceMetrics","useResourceThresholds","calculatePerformanceScore","metrics","navigationMetrics","filter","m","type","fcp","find","name","value","lcp","fid","cls","ttfb","score","grade","Math","max","generateRecommendations","recommendations","push","create","devtools","persist","immer","set","get","alerts","reports","thresholds","navigation","resource","loadTime","size","count","custom","isMonitoring","isLoading","error","databaseMetrics","cacheStats","lastRefresh","autoRefresh","refreshInterval","recordMetric","metric","id","Date","now","random","toString","substr","newMetric","timestamp","state","length","slice","checkThresholds","recordNavigationMetric","metadata","unit","url","window","location","href","recordResourceMetric","recordCustomMetric","clearMetrics","createAlert","alert","newAlert","resolved","resolveAlert","a","clearAlerts","clearResolvedAlerts","startMonitoring","observer","PerformanceObserver","list","entries","getEntries","forEach","entry","entryType","navEntry","responseStart","requestStart","domContentLoadedEventEnd","fetchStart","resourceEntry","duration","observe","entryTypes","console","warn","stopMonitoring","setThreshold","threshold","recentMetrics","severity","message","generateReport","report","summary","generated_at","exportMetrics","format","headers","rows","map","toISOString","row","join","JSON","stringify","exportReport","reportId","r","Error","setDatabaseMetrics","setCacheStats","stats","setLastRefresh","date","setAutoRefresh","enabled","setRefreshInterval","interval","loadDatabasePerformance","setLoading","setError","supabase","then","getSupabaseClient","data","metricsData","metricsError","from","select","gte","order","ascending","metricName","metric_name","avgValue","avg_value","minValue","min_value","maxValue","max_value","countMeasurements","count_measurements","cacheData","cacheError","limit","single","code","keys","memoryUsage","memory_usage","hitRate","hit_rate","errorMessage","refreshMaterializedViews","response","fetch","method","ok","statusText","performDatabaseMaintenance","loading","clearError","initialize","partialize"],"mappings":"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"}