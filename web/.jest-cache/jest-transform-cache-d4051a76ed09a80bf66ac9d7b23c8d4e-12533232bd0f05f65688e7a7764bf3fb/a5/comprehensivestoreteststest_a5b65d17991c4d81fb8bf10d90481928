9ea79c26eb963d339202bf2dca6a7461
/**
 * Comprehensive Zustand Store Tests
 * 
 * Tests all major Zustand stores with state management,
 * actions, persistence, and error handling
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _globals = require("@jest/globals");
const _react = require("@testing-library/react");
const _appStore = require("../../../../lib/stores/appStore");
const _userStore = require("../../../../lib/stores/userStore");
const _votingStore = require("../../../../lib/stores/votingStore");
const _notificationStore = require("../../../../lib/stores/notificationStore");
// FeatureFlagsStore removed - consolidated into admin store
// Mock external dependencies
_globals.jest.mock('@/lib/utils/logger', ()=>({
        devLog: _globals.jest.fn(),
        logger: {
            info: _globals.jest.fn(),
            error: _globals.jest.fn(),
            warn: _globals.jest.fn()
        }
    }));
_globals.jest.mock('@/lib/utils/objects', ()=>({
        withOptional: _globals.jest.fn((obj)=>obj)
    }));
(0, _globals.describe)('Zustand Store Tests', ()=>{
    (0, _globals.beforeEach)(()=>{
        // Clear all store state before each test
        _appStore.useAppStore.getState().reset?.();
        _userStore.useUserStore.getState().reset?.();
        _votingStore.useVotingStore.getState().reset?.();
        // Manually clear stores that don't have reset methods
        _notificationStore.useNotificationStore.setState({
            notifications: [],
            unreadCount: 0
        });
    // FeatureFlagsStore removed - consolidated into admin store
    });
    (0, _globals.describe)('AppStore', ()=>{
        (0, _globals.it)('should initialize with default values', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _appStore.useAppStore)());
            (0, _globals.expect)(result.current.theme).toBe('system');
            (0, _globals.expect)(result.current.sidebarCollapsed).toBe(false);
            (0, _globals.expect)(result.current.isMobile).toBe(false);
        });
        (0, _globals.it)('should update theme correctly', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _appStore.useAppStore)());
            (0, _react.act)(()=>{
                result.current.setTheme('dark');
            });
            (0, _globals.expect)(result.current.theme).toBe('dark');
        });
        (0, _globals.it)('should toggle sidebar correctly', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _appStore.useAppStore)());
            (0, _react.act)(()=>{
                result.current.toggleSidebar();
            });
            (0, _globals.expect)(result.current.sidebarCollapsed).toBe(true);
            (0, _react.act)(()=>{
                result.current.toggleSidebar();
            });
            (0, _globals.expect)(result.current.sidebarCollapsed).toBe(false);
        });
        (0, _globals.it)('should update system theme', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _appStore.useAppStore)());
            (0, _react.act)(()=>{
                result.current.updateSystemTheme('dark');
            });
            (0, _globals.expect)(result.current.systemTheme).toBe('dark');
        });
        (0, _globals.it)('should handle modal state correctly', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _appStore.useAppStore)());
            (0, _react.act)(()=>{
                result.current.openModal('test-modal', {
                    data: 'test'
                });
            });
            (0, _globals.expect)(result.current.activeModal).toBe('test-modal');
            (0, _globals.expect)(result.current.modalData).toEqual({
                data: 'test'
            });
            (0, _react.act)(()=>{
                result.current.closeModal();
            });
            (0, _globals.expect)(result.current.activeModal).toBeNull();
        });
        (0, _globals.it)('should update settings correctly', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _appStore.useAppStore)());
            (0, _react.act)(()=>{
                result.current.updateSettings({
                    animations: false,
                    language: 'es'
                });
            });
            (0, _globals.expect)(result.current.settings.animations).toBe(false);
            (0, _globals.expect)(result.current.settings.language).toBe('es');
        });
    });
    (0, _globals.describe)('UserStore', ()=>{
        (0, _globals.it)('should initialize with null user', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _userStore.useUserStore)());
            (0, _globals.expect)(result.current.user).toBeNull();
            (0, _globals.expect)(result.current.isAuthenticated).toBe(false);
        });
        (0, _globals.it)('should set user correctly', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _userStore.useUserStore)());
            const mockUser = {
                id: 'user-1',
                email: 'test@example.com',
                name: 'Test User',
                avatar: 'https://example.com/avatar.jpg',
                role: 'user',
                createdAt: new Date(),
                updatedAt: new Date()
            };
            (0, _react.act)(()=>{
                result.current.setUserAndAuth(mockUser, true);
            });
            (0, _globals.expect)(result.current.user).toEqual(mockUser);
            (0, _globals.expect)(result.current.isAuthenticated).toBe(true);
        });
        (0, _globals.it)('should clear user on logout', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _userStore.useUserStore)());
            const mockUser = {
                id: 'user-1',
                name: 'Test User',
                email: 'test@example.com'
            };
            (0, _react.act)(()=>{
                result.current.setUserAndAuth(mockUser, true);
            });
            (0, _globals.expect)(result.current.isAuthenticated).toBe(true);
            (0, _react.act)(()=>{
                result.current.clearUser();
            });
            (0, _globals.expect)(result.current.user).toBeNull();
            (0, _globals.expect)(result.current.isAuthenticated).toBe(false);
        });
        (0, _globals.it)('should update user profile', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _userStore.useUserStore)());
            const mockUser = {
                id: 'user-1',
                username: 'Test User',
                email: 'test@example.com',
                preferences: {
                    theme: 'light',
                    notifications: true,
                    language: 'en',
                    timezone: 'UTC'
                },
                settings: {
                    privacy: 'public',
                    location: 'US',
                    interests: [],
                    bio: 'Test bio'
                },
                metadata: {
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                }
            };
            (0, _react.act)(()=>{
                result.current.setProfile(mockUser);
            });
            (0, _react.act)(()=>{
                result.current.updateProfile({
                    username: 'Updated User',
                    settings: {
                        ...mockUser.settings,
                        bio: 'Updated bio'
                    }
                });
            });
            (0, _globals.expect)(result.current.profile?.username).toBe('Updated User');
            (0, _globals.expect)(result.current.profile?.settings.bio).toBe('Updated bio');
        });
        (0, _globals.it)('should handle authentication state changes', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _userStore.useUserStore)());
            (0, _react.act)(()=>{
                result.current.setAuthenticated(true);
            });
            (0, _globals.expect)(result.current.isAuthenticated).toBe(true);
            (0, _react.act)(()=>{
                result.current.setAuthenticated(false);
            });
            (0, _globals.expect)(result.current.isAuthenticated).toBe(false);
        });
    });
    (0, _globals.describe)('VotingStore', ()=>{
        (0, _globals.it)('should initialize with empty state', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _votingStore.useVotingStore)());
            (0, _globals.expect)(result.current.ballots).toEqual([]);
            (0, _globals.expect)(result.current.elections).toEqual([]);
            (0, _globals.expect)(result.current.votingRecords).toEqual([]);
        });
        (0, _globals.it)('should add ballot correctly', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _votingStore.useVotingStore)());
            const mockBallot = {
                id: 'ballot-1',
                pollId: 'poll-1',
                userId: 'user-1',
                selections: [
                    'option-1'
                ],
                timestamp: new Date()
            };
            (0, _react.act)(()=>{
                result.current.addBallot(mockBallot);
            });
            (0, _globals.expect)(result.current.ballots).toHaveLength(1);
            (0, _globals.expect)(result.current.ballots[0]).toEqual(mockBallot);
        });
        (0, _globals.it)('should remove ballot correctly', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _votingStore.useVotingStore)());
            const mockBallot = {
                id: 'ballot-1',
                pollId: 'poll-1',
                userId: 'user-1',
                selections: [
                    'option-1'
                ],
                timestamp: new Date()
            };
            (0, _react.act)(()=>{
                result.current.addBallot(mockBallot);
            });
            (0, _globals.expect)(result.current.ballots).toHaveLength(1);
            (0, _react.act)(()=>{
                result.current.removeBallot('ballot-1');
            });
            (0, _globals.expect)(result.current.ballots).toHaveLength(0);
        });
        (0, _globals.it)('should track voting records', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _votingStore.useVotingStore)());
            const mockRecord = {
                id: 'record-1',
                pollId: 'poll-1',
                userId: 'user-1',
                action: 'vote_cast',
                timestamp: new Date()
            };
            (0, _react.act)(()=>{
                result.current.addVotingRecord(mockRecord);
            });
            (0, _globals.expect)(result.current.votingRecords).toHaveLength(1);
            (0, _globals.expect)(result.current.votingRecords[0]).toEqual(mockRecord);
        });
        (0, _globals.it)('should clear user voting session', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _votingStore.useVotingStore)());
            (0, _react.act)(()=>{
                result.current.addBallot({
                    id: 'ballot-1',
                    pollId: 'poll-1',
                    userId: 'user-1',
                    selections: [
                        'option-1'
                    ],
                    timestamp: new Date()
                });
            });
            (0, _globals.expect)(result.current.ballots).toHaveLength(1);
            (0, _react.act)(()=>{
                result.current.clearUserVotingSession();
            });
            // Should clear UI state but preserve actual voting records
            (0, _globals.expect)(result.current.ballots).toHaveLength(0);
            (0, _globals.expect)(result.current.selectedBallot).toBeNull();
            (0, _globals.expect)(result.current.currentBallot).toBeNull();
        // Note: votingRecords should be preserved for audit trail
        });
    });
    // UIStore removed - deleted as unused
    (0, _globals.describe)('NotificationStore', ()=>{
        (0, _globals.it)('should initialize with empty notifications', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _notificationStore.useNotificationStore)());
            (0, _globals.expect)(result.current.notifications).toEqual([]);
            (0, _globals.expect)(result.current.unreadCount).toBe(0);
        });
        (0, _globals.it)('should add notifications', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _notificationStore.useNotificationStore)());
            (0, _react.act)(()=>{
                result.current.addNotification({
                    message: 'Test notification',
                    type: 'info'
                });
            });
            (0, _globals.expect)(result.current.notifications).toHaveLength(1);
            (0, _globals.expect)(result.current.unreadCount).toBe(1);
            (0, _globals.expect)(result.current.notifications[0].message).toBe('Test notification');
        });
        (0, _globals.it)('should mark notifications as read', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _notificationStore.useNotificationStore)());
            (0, _react.act)(()=>{
                result.current.addNotification({
                    message: 'Test notification',
                    type: 'info'
                });
            });
            const notificationId = result.current.notifications[0].id;
            (0, _react.act)(()=>{
                result.current.markAsRead(notificationId);
            });
            (0, _globals.expect)(result.current.notifications[0].read).toBe(true);
            (0, _globals.expect)(result.current.unreadCount).toBe(0);
        });
        (0, _globals.it)('should clear all notifications', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _notificationStore.useNotificationStore)());
            (0, _react.act)(()=>{
                result.current.addNotification({
                    message: 'Test notification 1',
                    type: 'info'
                });
                result.current.addNotification({
                    message: 'Test notification 2',
                    type: 'warning'
                });
            });
            (0, _globals.expect)(result.current.notifications).toHaveLength(2);
            (0, _react.act)(()=>{
                result.current.clearAll();
            });
            (0, _globals.expect)(result.current.notifications).toHaveLength(0);
            (0, _globals.expect)(result.current.unreadCount).toBe(0);
        });
        (0, _globals.it)('should clear notifications by type', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _notificationStore.useNotificationStore)());
            (0, _react.act)(()=>{
                result.current.addNotification({
                    message: 'Info notification',
                    type: 'info'
                });
                result.current.addNotification({
                    message: 'Warning notification',
                    type: 'warning'
                });
            });
            (0, _globals.expect)(result.current.notifications).toHaveLength(2);
            (0, _react.act)(()=>{
                result.current.clearByType('info');
            });
            (0, _globals.expect)(result.current.notifications).toHaveLength(1);
            (0, _globals.expect)(result.current.notifications[0].type).toBe('warning');
        });
    });
    // FeatureFlagsStore removed - consolidated into admin store
    (0, _globals.describe)('Store Integration', ()=>{
        (0, _globals.it)('should handle cross-store interactions', ()=>{
            const appResult = (0, _react.renderHook)(()=>(0, _appStore.useAppStore)());
            const userResult = (0, _react.renderHook)(()=>(0, _userStore.useUserStore)());
            // Set user
            (0, _react.act)(()=>{
                userResult.result.current.setUserAndAuth({
                    id: 'user-1',
                    name: 'Test User',
                    email: 'test@example.com'
                }, true);
            });
            // Update app settings
            (0, _react.act)(()=>{
                appResult.result.current.updateSettings({
                    theme: 'dark',
                    language: 'en'
                });
            });
            (0, _globals.expect)(userResult.result.current.isAuthenticated).toBe(true);
            (0, _globals.expect)(appResult.result.current.settings.theme).toBe('dark');
        });
        (0, _globals.it)('should handle store persistence', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _appStore.useAppStore)());
            (0, _react.act)(()=>{
                result.current.setTheme('dark');
                result.current.setSidebarCollapsed(true);
            });
            // Simulate page reload by re-initializing store
            const newResult = (0, _react.renderHook)(()=>(0, _appStore.useAppStore)());
            // In a real app with persistence, these values would be restored
            // For testing, we verify the actions work correctly
            (0, _globals.expect)(result.current.theme).toBe('dark');
            (0, _globals.expect)(result.current.sidebarCollapsed).toBe(true);
        });
    });
    (0, _globals.describe)('Error Handling', ()=>{
        (0, _globals.it)('should handle store errors gracefully', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _userStore.useUserStore)());
            // Test with invalid data
            (0, _react.act)(()=>{
                try {
                    result.current.setUser(null);
                } catch (error) {
                // Store should handle null user gracefully
                }
            });
            (0, _globals.expect)(result.current.user).toBeNull();
        });
        (0, _globals.it)('should handle concurrent updates', ()=>{
            const { result } = (0, _react.renderHook)(()=>(0, _votingStore.useVotingStore)());
            // Simulate concurrent ballot additions
            (0, _react.act)(()=>{
                for(let i = 0; i < 10; i++){
                    result.current.addBallot({
                        id: `ballot-${i}`,
                        pollId: 'poll-1',
                        userId: 'user-1',
                        selections: [
                            'option-1'
                        ],
                        timestamp: new Date()
                    });
                }
            });
            (0, _globals.expect)(result.current.ballots).toHaveLength(10);
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hbGF1Z2hpbmdraXRzdW5lL3NyYy9DaG9pY2VzL3dlYi90ZXN0cy9qZXN0L3VuaXQvc3RvcmVzL2NvbXByZWhlbnNpdmUtc3RvcmUtdGVzdHMudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvbXByZWhlbnNpdmUgWnVzdGFuZCBTdG9yZSBUZXN0c1xuICogXG4gKiBUZXN0cyBhbGwgbWFqb3IgWnVzdGFuZCBzdG9yZXMgd2l0aCBzdGF0ZSBtYW5hZ2VtZW50LFxuICogYWN0aW9ucywgcGVyc2lzdGVuY2UsIGFuZCBlcnJvciBoYW5kbGluZ1xuICovXG5cbmltcG9ydCB7IGRlc2NyaWJlLCBpdCwgZXhwZWN0LCBiZWZvcmVFYWNoLCBqZXN0IH0gZnJvbSAnQGplc3QvZ2xvYmFscydcbmltcG9ydCB7IHJlbmRlckhvb2ssIGFjdCB9IGZyb20gJ0B0ZXN0aW5nLWxpYnJhcnkvcmVhY3QnXG5cbi8vIEltcG9ydCBhbGwgc3RvcmVzXG5pbXBvcnQgeyB1c2VBcHBTdG9yZSB9IGZyb20gJ0AvbGliL3N0b3Jlcy9hcHBTdG9yZSdcbmltcG9ydCB7IHVzZVVzZXJTdG9yZSB9IGZyb20gJ0AvbGliL3N0b3Jlcy91c2VyU3RvcmUnXG5pbXBvcnQgeyB1c2VWb3RpbmdTdG9yZSB9IGZyb20gJ0AvbGliL3N0b3Jlcy92b3RpbmdTdG9yZSdcbi8vIFVJU3RvcmUgcmVtb3ZlZCAtIGRlbGV0ZWQgYXMgdW51c2VkXG5pbXBvcnQgeyB1c2VOb3RpZmljYXRpb25TdG9yZSB9IGZyb20gJ0AvbGliL3N0b3Jlcy9ub3RpZmljYXRpb25TdG9yZSdcbi8vIEZlYXR1cmVGbGFnc1N0b3JlIHJlbW92ZWQgLSBjb25zb2xpZGF0ZWQgaW50byBhZG1pbiBzdG9yZVxuXG4vLyBNb2NrIGV4dGVybmFsIGRlcGVuZGVuY2llc1xuamVzdC5tb2NrKCdAL2xpYi91dGlscy9sb2dnZXInLCAoKSA9PiAoe1xuICBkZXZMb2c6IGplc3QuZm4oKSxcbiAgbG9nZ2VyOiB7XG4gICAgaW5mbzogamVzdC5mbigpLFxuICAgIGVycm9yOiBqZXN0LmZuKCksXG4gICAgd2FybjogamVzdC5mbigpXG4gIH1cbn0pKVxuXG5qZXN0Lm1vY2soJ0AvbGliL3V0aWxzL29iamVjdHMnLCAoKSA9PiAoe1xuICB3aXRoT3B0aW9uYWw6IGplc3QuZm4oKG9iaikgPT4gb2JqKVxufSkpXG5cbmRlc2NyaWJlKCdadXN0YW5kIFN0b3JlIFRlc3RzJywgKCkgPT4ge1xuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAvLyBDbGVhciBhbGwgc3RvcmUgc3RhdGUgYmVmb3JlIGVhY2ggdGVzdFxuICAgIHVzZUFwcFN0b3JlLmdldFN0YXRlKCkucmVzZXQ/LigpXG4gICAgdXNlVXNlclN0b3JlLmdldFN0YXRlKCkucmVzZXQ/LigpXG4gICAgdXNlVm90aW5nU3RvcmUuZ2V0U3RhdGUoKS5yZXNldD8uKClcbiAgICBcbiAgICAvLyBNYW51YWxseSBjbGVhciBzdG9yZXMgdGhhdCBkb24ndCBoYXZlIHJlc2V0IG1ldGhvZHNcbiAgICB1c2VOb3RpZmljYXRpb25TdG9yZS5zZXRTdGF0ZSh7XG4gICAgICBub3RpZmljYXRpb25zOiBbXSxcbiAgICAgIHVucmVhZENvdW50OiAwXG4gICAgfSlcbiAgICBcbiAgICAvLyBGZWF0dXJlRmxhZ3NTdG9yZSByZW1vdmVkIC0gY29uc29saWRhdGVkIGludG8gYWRtaW4gc3RvcmVcbiAgfSlcblxuICBkZXNjcmliZSgnQXBwU3RvcmUnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIHdpdGggZGVmYXVsdCB2YWx1ZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCB7IHJlc3VsdCB9ID0gcmVuZGVySG9vaygoKSA9PiB1c2VBcHBTdG9yZSgpKVxuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQudGhlbWUpLnRvQmUoJ3N5c3RlbScpXG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQuc2lkZWJhckNvbGxhcHNlZCkudG9CZShmYWxzZSlcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5pc01vYmlsZSkudG9CZShmYWxzZSlcbiAgICB9KVxuXG4gICAgaXQoJ3Nob3VsZCB1cGRhdGUgdGhlbWUgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgY29uc3QgeyByZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT4gdXNlQXBwU3RvcmUoKSlcbiAgICAgIFxuICAgICAgYWN0KCgpID0+IHtcbiAgICAgICAgcmVzdWx0LmN1cnJlbnQuc2V0VGhlbWUoJ2RhcmsnKVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LnRoZW1lKS50b0JlKCdkYXJrJylcbiAgICB9KVxuXG4gICAgaXQoJ3Nob3VsZCB0b2dnbGUgc2lkZWJhciBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICBjb25zdCB7IHJlc3VsdCB9ID0gcmVuZGVySG9vaygoKSA9PiB1c2VBcHBTdG9yZSgpKVxuICAgICAgXG4gICAgICBhY3QoKCkgPT4ge1xuICAgICAgICByZXN1bHQuY3VycmVudC50b2dnbGVTaWRlYmFyKClcbiAgICAgIH0pXG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5zaWRlYmFyQ29sbGFwc2VkKS50b0JlKHRydWUpXG4gICAgICBcbiAgICAgIGFjdCgoKSA9PiB7XG4gICAgICAgIHJlc3VsdC5jdXJyZW50LnRvZ2dsZVNpZGViYXIoKVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LnNpZGViYXJDb2xsYXBzZWQpLnRvQmUoZmFsc2UpXG4gICAgfSlcblxuICAgIGl0KCdzaG91bGQgdXBkYXRlIHN5c3RlbSB0aGVtZScsICgpID0+IHtcbiAgICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZUFwcFN0b3JlKCkpXG4gICAgICBcbiAgICAgIGFjdCgoKSA9PiB7XG4gICAgICAgIHJlc3VsdC5jdXJyZW50LnVwZGF0ZVN5c3RlbVRoZW1lKCdkYXJrJylcbiAgICAgIH0pXG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5zeXN0ZW1UaGVtZSkudG9CZSgnZGFyaycpXG4gICAgfSlcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG1vZGFsIHN0YXRlIGNvcnJlY3RseScsICgpID0+IHtcbiAgICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZUFwcFN0b3JlKCkpXG4gICAgICBcbiAgICAgIGFjdCgoKSA9PiB7XG4gICAgICAgIHJlc3VsdC5jdXJyZW50Lm9wZW5Nb2RhbCgndGVzdC1tb2RhbCcsIHsgZGF0YTogJ3Rlc3QnIH0pXG4gICAgICB9KVxuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQuYWN0aXZlTW9kYWwpLnRvQmUoJ3Rlc3QtbW9kYWwnKVxuICAgICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50Lm1vZGFsRGF0YSkudG9FcXVhbCh7IGRhdGE6ICd0ZXN0JyB9KVxuICAgICAgXG4gICAgICBhY3QoKCkgPT4ge1xuICAgICAgICByZXN1bHQuY3VycmVudC5jbG9zZU1vZGFsKClcbiAgICAgIH0pXG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5hY3RpdmVNb2RhbCkudG9CZU51bGwoKVxuICAgIH0pXG5cbiAgICBpdCgnc2hvdWxkIHVwZGF0ZSBzZXR0aW5ncyBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICBjb25zdCB7IHJlc3VsdCB9ID0gcmVuZGVySG9vaygoKSA9PiB1c2VBcHBTdG9yZSgpKVxuICAgICAgXG4gICAgICBhY3QoKCkgPT4ge1xuICAgICAgICByZXN1bHQuY3VycmVudC51cGRhdGVTZXR0aW5ncyh7XG4gICAgICAgICAgYW5pbWF0aW9uczogZmFsc2UsXG4gICAgICAgICAgbGFuZ3VhZ2U6ICdlcydcbiAgICAgICAgfSlcbiAgICAgIH0pXG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5zZXR0aW5ncy5hbmltYXRpb25zKS50b0JlKGZhbHNlKVxuICAgICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LnNldHRpbmdzLmxhbmd1YWdlKS50b0JlKCdlcycpXG4gICAgfSlcbiAgfSlcblxuICBkZXNjcmliZSgnVXNlclN0b3JlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaW5pdGlhbGl6ZSB3aXRoIG51bGwgdXNlcicsICgpID0+IHtcbiAgICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZVVzZXJTdG9yZSgpKVxuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQudXNlcikudG9CZU51bGwoKVxuICAgICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LmlzQXV0aGVudGljYXRlZCkudG9CZShmYWxzZSlcbiAgICB9KVxuXG4gICAgaXQoJ3Nob3VsZCBzZXQgdXNlciBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICBjb25zdCB7IHJlc3VsdCB9ID0gcmVuZGVySG9vaygoKSA9PiB1c2VVc2VyU3RvcmUoKSlcbiAgICAgIGNvbnN0IG1vY2tVc2VyID0ge1xuICAgICAgICBpZDogJ3VzZXItMScsXG4gICAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgIG5hbWU6ICdUZXN0IFVzZXInLFxuICAgICAgICBhdmF0YXI6ICdodHRwczovL2V4YW1wbGUuY29tL2F2YXRhci5qcGcnLFxuICAgICAgICByb2xlOiAndXNlcicgYXMgY29uc3QsXG4gICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGFjdCgoKSA9PiB7XG4gICAgICAgIHJlc3VsdC5jdXJyZW50LnNldFVzZXJBbmRBdXRoKG1vY2tVc2VyLCB0cnVlKVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LnVzZXIpLnRvRXF1YWwobW9ja1VzZXIpXG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQuaXNBdXRoZW50aWNhdGVkKS50b0JlKHRydWUpXG4gICAgfSlcblxuICAgIGl0KCdzaG91bGQgY2xlYXIgdXNlciBvbiBsb2dvdXQnLCAoKSA9PiB7XG4gICAgICBjb25zdCB7IHJlc3VsdCB9ID0gcmVuZGVySG9vaygoKSA9PiB1c2VVc2VyU3RvcmUoKSlcbiAgICAgIGNvbnN0IG1vY2tVc2VyID0ge1xuICAgICAgICBpZDogJ3VzZXItMScsXG4gICAgICAgIG5hbWU6ICdUZXN0IFVzZXInLFxuICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nXG4gICAgICB9XG4gICAgICBcbiAgICAgIGFjdCgoKSA9PiB7XG4gICAgICAgIHJlc3VsdC5jdXJyZW50LnNldFVzZXJBbmRBdXRoKG1vY2tVc2VyLCB0cnVlKVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LmlzQXV0aGVudGljYXRlZCkudG9CZSh0cnVlKVxuICAgICAgXG4gICAgICBhY3QoKCkgPT4ge1xuICAgICAgICByZXN1bHQuY3VycmVudC5jbGVhclVzZXIoKVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LnVzZXIpLnRvQmVOdWxsKClcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5pc0F1dGhlbnRpY2F0ZWQpLnRvQmUoZmFsc2UpXG4gICAgfSlcblxuICAgIGl0KCdzaG91bGQgdXBkYXRlIHVzZXIgcHJvZmlsZScsICgpID0+IHtcbiAgICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZVVzZXJTdG9yZSgpKVxuICAgICAgY29uc3QgbW9ja1VzZXIgPSB7XG4gICAgICAgIGlkOiAndXNlci0xJyxcbiAgICAgICAgdXNlcm5hbWU6ICdUZXN0IFVzZXInLFxuICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICBwcmVmZXJlbmNlczoge1xuICAgICAgICAgIHRoZW1lOiAnbGlnaHQnIGFzIGNvbnN0LFxuICAgICAgICAgIG5vdGlmaWNhdGlvbnM6IHRydWUsXG4gICAgICAgICAgbGFuZ3VhZ2U6ICdlbicsXG4gICAgICAgICAgdGltZXpvbmU6ICdVVEMnXG4gICAgICAgIH0sXG4gICAgICAgIHNldHRpbmdzOiB7XG4gICAgICAgICAgcHJpdmFjeTogJ3B1YmxpYycgYXMgY29uc3QsXG4gICAgICAgICAgbG9jYXRpb246ICdVUycsXG4gICAgICAgICAgaW50ZXJlc3RzOiBbXSxcbiAgICAgICAgICBiaW86ICdUZXN0IGJpbydcbiAgICAgICAgfSxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIGFjdCgoKSA9PiB7XG4gICAgICAgIHJlc3VsdC5jdXJyZW50LnNldFByb2ZpbGUobW9ja1VzZXIpXG4gICAgICB9KVxuICAgICAgXG4gICAgICBhY3QoKCkgPT4ge1xuICAgICAgICByZXN1bHQuY3VycmVudC51cGRhdGVQcm9maWxlKHtcbiAgICAgICAgICB1c2VybmFtZTogJ1VwZGF0ZWQgVXNlcicsXG4gICAgICAgICAgc2V0dGluZ3M6IHtcbiAgICAgICAgICAgIC4uLm1vY2tVc2VyLnNldHRpbmdzLFxuICAgICAgICAgICAgYmlvOiAnVXBkYXRlZCBiaW8nXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LnByb2ZpbGU/LnVzZXJuYW1lKS50b0JlKCdVcGRhdGVkIFVzZXInKVxuICAgICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LnByb2ZpbGU/LnNldHRpbmdzLmJpbykudG9CZSgnVXBkYXRlZCBiaW8nKVxuICAgIH0pXG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBhdXRoZW50aWNhdGlvbiBzdGF0ZSBjaGFuZ2VzJywgKCkgPT4ge1xuICAgICAgY29uc3QgeyByZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT4gdXNlVXNlclN0b3JlKCkpXG4gICAgICBcbiAgICAgIGFjdCgoKSA9PiB7XG4gICAgICAgIHJlc3VsdC5jdXJyZW50LnNldEF1dGhlbnRpY2F0ZWQodHJ1ZSlcbiAgICAgIH0pXG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5pc0F1dGhlbnRpY2F0ZWQpLnRvQmUodHJ1ZSlcbiAgICAgIFxuICAgICAgYWN0KCgpID0+IHtcbiAgICAgICAgcmVzdWx0LmN1cnJlbnQuc2V0QXV0aGVudGljYXRlZChmYWxzZSlcbiAgICAgIH0pXG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5pc0F1dGhlbnRpY2F0ZWQpLnRvQmUoZmFsc2UpXG4gICAgfSlcbiAgfSlcblxuICBkZXNjcmliZSgnVm90aW5nU3RvcmUnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIHdpdGggZW1wdHkgc3RhdGUnLCAoKSA9PiB7XG4gICAgICBjb25zdCB7IHJlc3VsdCB9ID0gcmVuZGVySG9vaygoKSA9PiB1c2VWb3RpbmdTdG9yZSgpKVxuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQuYmFsbG90cykudG9FcXVhbChbXSlcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5lbGVjdGlvbnMpLnRvRXF1YWwoW10pXG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQudm90aW5nUmVjb3JkcykudG9FcXVhbChbXSlcbiAgICB9KVxuXG4gICAgaXQoJ3Nob3VsZCBhZGQgYmFsbG90IGNvcnJlY3RseScsICgpID0+IHtcbiAgICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZVZvdGluZ1N0b3JlKCkpXG4gICAgICBjb25zdCBtb2NrQmFsbG90ID0ge1xuICAgICAgICBpZDogJ2JhbGxvdC0xJyxcbiAgICAgICAgcG9sbElkOiAncG9sbC0xJyxcbiAgICAgICAgdXNlcklkOiAndXNlci0xJyxcbiAgICAgICAgc2VsZWN0aW9uczogWydvcHRpb24tMSddLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgIH1cbiAgICAgIFxuICAgICAgYWN0KCgpID0+IHtcbiAgICAgICAgcmVzdWx0LmN1cnJlbnQuYWRkQmFsbG90KG1vY2tCYWxsb3QpXG4gICAgICB9KVxuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQuYmFsbG90cykudG9IYXZlTGVuZ3RoKDEpXG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQuYmFsbG90c1swXSkudG9FcXVhbChtb2NrQmFsbG90KVxuICAgIH0pXG5cbiAgICBpdCgnc2hvdWxkIHJlbW92ZSBiYWxsb3QgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgY29uc3QgeyByZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT4gdXNlVm90aW5nU3RvcmUoKSlcbiAgICAgIGNvbnN0IG1vY2tCYWxsb3QgPSB7XG4gICAgICAgIGlkOiAnYmFsbG90LTEnLFxuICAgICAgICBwb2xsSWQ6ICdwb2xsLTEnLFxuICAgICAgICB1c2VySWQ6ICd1c2VyLTEnLFxuICAgICAgICBzZWxlY3Rpb25zOiBbJ29wdGlvbi0xJ10sXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICAgICAgfVxuICAgICAgXG4gICAgICBhY3QoKCkgPT4ge1xuICAgICAgICByZXN1bHQuY3VycmVudC5hZGRCYWxsb3QobW9ja0JhbGxvdClcbiAgICAgIH0pXG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5iYWxsb3RzKS50b0hhdmVMZW5ndGgoMSlcbiAgICAgIFxuICAgICAgYWN0KCgpID0+IHtcbiAgICAgICAgcmVzdWx0LmN1cnJlbnQucmVtb3ZlQmFsbG90KCdiYWxsb3QtMScpXG4gICAgICB9KVxuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQuYmFsbG90cykudG9IYXZlTGVuZ3RoKDApXG4gICAgfSlcblxuICAgIGl0KCdzaG91bGQgdHJhY2sgdm90aW5nIHJlY29yZHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCB7IHJlc3VsdCB9ID0gcmVuZGVySG9vaygoKSA9PiB1c2VWb3RpbmdTdG9yZSgpKVxuICAgICAgY29uc3QgbW9ja1JlY29yZCA9IHtcbiAgICAgICAgaWQ6ICdyZWNvcmQtMScsXG4gICAgICAgIHBvbGxJZDogJ3BvbGwtMScsXG4gICAgICAgIHVzZXJJZDogJ3VzZXItMScsXG4gICAgICAgIGFjdGlvbjogJ3ZvdGVfY2FzdCcsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxuICAgICAgfVxuICAgICAgXG4gICAgICBhY3QoKCkgPT4ge1xuICAgICAgICByZXN1bHQuY3VycmVudC5hZGRWb3RpbmdSZWNvcmQobW9ja1JlY29yZClcbiAgICAgIH0pXG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC52b3RpbmdSZWNvcmRzKS50b0hhdmVMZW5ndGgoMSlcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC52b3RpbmdSZWNvcmRzWzBdKS50b0VxdWFsKG1vY2tSZWNvcmQpXG4gICAgfSlcblxuICAgIGl0KCdzaG91bGQgY2xlYXIgdXNlciB2b3Rpbmcgc2Vzc2lvbicsICgpID0+IHtcbiAgICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZVZvdGluZ1N0b3JlKCkpXG4gICAgICBcbiAgICAgIGFjdCgoKSA9PiB7XG4gICAgICAgIHJlc3VsdC5jdXJyZW50LmFkZEJhbGxvdCh7XG4gICAgICAgICAgaWQ6ICdiYWxsb3QtMScsXG4gICAgICAgICAgcG9sbElkOiAncG9sbC0xJyxcbiAgICAgICAgICB1c2VySWQ6ICd1c2VyLTEnLFxuICAgICAgICAgIHNlbGVjdGlvbnM6IFsnb3B0aW9uLTEnXSxcbiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgICAgfSlcbiAgICAgIH0pXG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5iYWxsb3RzKS50b0hhdmVMZW5ndGgoMSlcbiAgICAgIFxuICAgICAgYWN0KCgpID0+IHtcbiAgICAgICAgcmVzdWx0LmN1cnJlbnQuY2xlYXJVc2VyVm90aW5nU2Vzc2lvbigpXG4gICAgICB9KVxuICAgICAgXG4gICAgICAvLyBTaG91bGQgY2xlYXIgVUkgc3RhdGUgYnV0IHByZXNlcnZlIGFjdHVhbCB2b3RpbmcgcmVjb3Jkc1xuICAgICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LmJhbGxvdHMpLnRvSGF2ZUxlbmd0aCgwKVxuICAgICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LnNlbGVjdGVkQmFsbG90KS50b0JlTnVsbCgpXG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQuY3VycmVudEJhbGxvdCkudG9CZU51bGwoKVxuICAgICAgLy8gTm90ZTogdm90aW5nUmVjb3JkcyBzaG91bGQgYmUgcHJlc2VydmVkIGZvciBhdWRpdCB0cmFpbFxuICAgIH0pXG4gIH0pXG5cbiAgLy8gVUlTdG9yZSByZW1vdmVkIC0gZGVsZXRlZCBhcyB1bnVzZWRcblxuICBkZXNjcmliZSgnTm90aWZpY2F0aW9uU3RvcmUnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIHdpdGggZW1wdHkgbm90aWZpY2F0aW9ucycsICgpID0+IHtcbiAgICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZU5vdGlmaWNhdGlvblN0b3JlKCkpXG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5ub3RpZmljYXRpb25zKS50b0VxdWFsKFtdKVxuICAgICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LnVucmVhZENvdW50KS50b0JlKDApXG4gICAgfSlcblxuICAgIGl0KCdzaG91bGQgYWRkIG5vdGlmaWNhdGlvbnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCB7IHJlc3VsdCB9ID0gcmVuZGVySG9vaygoKSA9PiB1c2VOb3RpZmljYXRpb25TdG9yZSgpKVxuICAgICAgXG4gICAgICBhY3QoKCkgPT4ge1xuICAgICAgICByZXN1bHQuY3VycmVudC5hZGROb3RpZmljYXRpb24oe1xuICAgICAgICAgIG1lc3NhZ2U6ICdUZXN0IG5vdGlmaWNhdGlvbicsXG4gICAgICAgICAgdHlwZTogJ2luZm8nXG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQubm90aWZpY2F0aW9ucykudG9IYXZlTGVuZ3RoKDEpXG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQudW5yZWFkQ291bnQpLnRvQmUoMSlcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5ub3RpZmljYXRpb25zWzBdLm1lc3NhZ2UpLnRvQmUoJ1Rlc3Qgbm90aWZpY2F0aW9uJylcbiAgICB9KVxuXG4gICAgaXQoJ3Nob3VsZCBtYXJrIG5vdGlmaWNhdGlvbnMgYXMgcmVhZCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZU5vdGlmaWNhdGlvblN0b3JlKCkpXG4gICAgICBcbiAgICAgIGFjdCgoKSA9PiB7XG4gICAgICAgIHJlc3VsdC5jdXJyZW50LmFkZE5vdGlmaWNhdGlvbih7XG4gICAgICAgICAgbWVzc2FnZTogJ1Rlc3Qgbm90aWZpY2F0aW9uJyxcbiAgICAgICAgICB0eXBlOiAnaW5mbydcbiAgICAgICAgfSlcbiAgICAgIH0pXG4gICAgICBcbiAgICAgIGNvbnN0IG5vdGlmaWNhdGlvbklkID0gcmVzdWx0LmN1cnJlbnQubm90aWZpY2F0aW9uc1swXS5pZFxuICAgICAgXG4gICAgICBhY3QoKCkgPT4ge1xuICAgICAgICByZXN1bHQuY3VycmVudC5tYXJrQXNSZWFkKG5vdGlmaWNhdGlvbklkKVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50Lm5vdGlmaWNhdGlvbnNbMF0ucmVhZCkudG9CZSh0cnVlKVxuICAgICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50LnVucmVhZENvdW50KS50b0JlKDApXG4gICAgfSlcblxuICAgIGl0KCdzaG91bGQgY2xlYXIgYWxsIG5vdGlmaWNhdGlvbnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCB7IHJlc3VsdCB9ID0gcmVuZGVySG9vaygoKSA9PiB1c2VOb3RpZmljYXRpb25TdG9yZSgpKVxuICAgICAgXG4gICAgICBhY3QoKCkgPT4ge1xuICAgICAgICByZXN1bHQuY3VycmVudC5hZGROb3RpZmljYXRpb24oe1xuICAgICAgICAgIG1lc3NhZ2U6ICdUZXN0IG5vdGlmaWNhdGlvbiAxJyxcbiAgICAgICAgICB0eXBlOiAnaW5mbydcbiAgICAgICAgfSlcbiAgICAgICAgcmVzdWx0LmN1cnJlbnQuYWRkTm90aWZpY2F0aW9uKHtcbiAgICAgICAgICBtZXNzYWdlOiAnVGVzdCBub3RpZmljYXRpb24gMicsXG4gICAgICAgICAgdHlwZTogJ3dhcm5pbmcnXG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQubm90aWZpY2F0aW9ucykudG9IYXZlTGVuZ3RoKDIpXG4gICAgICBcbiAgICAgIGFjdCgoKSA9PiB7XG4gICAgICAgIHJlc3VsdC5jdXJyZW50LmNsZWFyQWxsKClcbiAgICAgIH0pXG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC5ub3RpZmljYXRpb25zKS50b0hhdmVMZW5ndGgoMClcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC51bnJlYWRDb3VudCkudG9CZSgwKVxuICAgIH0pXG5cbiAgICBpdCgnc2hvdWxkIGNsZWFyIG5vdGlmaWNhdGlvbnMgYnkgdHlwZScsICgpID0+IHtcbiAgICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZU5vdGlmaWNhdGlvblN0b3JlKCkpXG4gICAgICBcbiAgICAgIGFjdCgoKSA9PiB7XG4gICAgICAgIHJlc3VsdC5jdXJyZW50LmFkZE5vdGlmaWNhdGlvbih7XG4gICAgICAgICAgbWVzc2FnZTogJ0luZm8gbm90aWZpY2F0aW9uJyxcbiAgICAgICAgICB0eXBlOiAnaW5mbydcbiAgICAgICAgfSlcbiAgICAgICAgcmVzdWx0LmN1cnJlbnQuYWRkTm90aWZpY2F0aW9uKHtcbiAgICAgICAgICBtZXNzYWdlOiAnV2FybmluZyBub3RpZmljYXRpb24nLFxuICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJ1xuICAgICAgICB9KVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5jdXJyZW50Lm5vdGlmaWNhdGlvbnMpLnRvSGF2ZUxlbmd0aCgyKVxuICAgICAgXG4gICAgICBhY3QoKCkgPT4ge1xuICAgICAgICByZXN1bHQuY3VycmVudC5jbGVhckJ5VHlwZSgnaW5mbycpXG4gICAgICB9KVxuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQubm90aWZpY2F0aW9ucykudG9IYXZlTGVuZ3RoKDEpXG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQubm90aWZpY2F0aW9uc1swXS50eXBlKS50b0JlKCd3YXJuaW5nJylcbiAgICB9KVxuICB9KVxuXG4gIC8vIEZlYXR1cmVGbGFnc1N0b3JlIHJlbW92ZWQgLSBjb25zb2xpZGF0ZWQgaW50byBhZG1pbiBzdG9yZVxuXG4gIGRlc2NyaWJlKCdTdG9yZSBJbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjcm9zcy1zdG9yZSBpbnRlcmFjdGlvbnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBhcHBSZXN1bHQgPSByZW5kZXJIb29rKCgpID0+IHVzZUFwcFN0b3JlKCkpXG4gICAgICBjb25zdCB1c2VyUmVzdWx0ID0gcmVuZGVySG9vaygoKSA9PiB1c2VVc2VyU3RvcmUoKSlcbiAgICAgIFxuICAgICAgLy8gU2V0IHVzZXJcbiAgICAgIGFjdCgoKSA9PiB7XG4gICAgICAgIHVzZXJSZXN1bHQucmVzdWx0LmN1cnJlbnQuc2V0VXNlckFuZEF1dGgoe1xuICAgICAgICAgIGlkOiAndXNlci0xJyxcbiAgICAgICAgICBuYW1lOiAnVGVzdCBVc2VyJyxcbiAgICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nXG4gICAgICAgIH0sIHRydWUpXG4gICAgICB9KVxuICAgICAgXG4gICAgICAvLyBVcGRhdGUgYXBwIHNldHRpbmdzXG4gICAgICBhY3QoKCkgPT4ge1xuICAgICAgICBhcHBSZXN1bHQucmVzdWx0LmN1cnJlbnQudXBkYXRlU2V0dGluZ3Moe1xuICAgICAgICAgIHRoZW1lOiAnZGFyaycsXG4gICAgICAgICAgbGFuZ3VhZ2U6ICdlbidcbiAgICAgICAgfSlcbiAgICAgIH0pXG4gICAgICBcbiAgICAgIGV4cGVjdCh1c2VyUmVzdWx0LnJlc3VsdC5jdXJyZW50LmlzQXV0aGVudGljYXRlZCkudG9CZSh0cnVlKVxuICAgICAgZXhwZWN0KGFwcFJlc3VsdC5yZXN1bHQuY3VycmVudC5zZXR0aW5ncy50aGVtZSkudG9CZSgnZGFyaycpXG4gICAgfSlcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHN0b3JlIHBlcnNpc3RlbmNlJywgKCkgPT4ge1xuICAgICAgY29uc3QgeyByZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT4gdXNlQXBwU3RvcmUoKSlcbiAgICAgIFxuICAgICAgYWN0KCgpID0+IHtcbiAgICAgICAgcmVzdWx0LmN1cnJlbnQuc2V0VGhlbWUoJ2RhcmsnKVxuICAgICAgICByZXN1bHQuY3VycmVudC5zZXRTaWRlYmFyQ29sbGFwc2VkKHRydWUpXG4gICAgICB9KVxuICAgICAgXG4gICAgICAvLyBTaW11bGF0ZSBwYWdlIHJlbG9hZCBieSByZS1pbml0aWFsaXppbmcgc3RvcmVcbiAgICAgIGNvbnN0IG5ld1Jlc3VsdCA9IHJlbmRlckhvb2soKCkgPT4gdXNlQXBwU3RvcmUoKSlcbiAgICAgIFxuICAgICAgLy8gSW4gYSByZWFsIGFwcCB3aXRoIHBlcnNpc3RlbmNlLCB0aGVzZSB2YWx1ZXMgd291bGQgYmUgcmVzdG9yZWRcbiAgICAgIC8vIEZvciB0ZXN0aW5nLCB3ZSB2ZXJpZnkgdGhlIGFjdGlvbnMgd29yayBjb3JyZWN0bHlcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC50aGVtZSkudG9CZSgnZGFyaycpXG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQuc2lkZWJhckNvbGxhcHNlZCkudG9CZSh0cnVlKVxuICAgIH0pXG4gIH0pXG5cbiAgZGVzY3JpYmUoJ0Vycm9yIEhhbmRsaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIHN0b3JlIGVycm9ycyBncmFjZWZ1bGx5JywgKCkgPT4ge1xuICAgICAgY29uc3QgeyByZXN1bHQgfSA9IHJlbmRlckhvb2soKCkgPT4gdXNlVXNlclN0b3JlKCkpXG4gICAgICBcbiAgICAgIC8vIFRlc3Qgd2l0aCBpbnZhbGlkIGRhdGFcbiAgICAgIGFjdCgoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcmVzdWx0LmN1cnJlbnQuc2V0VXNlcihudWxsIGFzIGFueSlcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAvLyBTdG9yZSBzaG91bGQgaGFuZGxlIG51bGwgdXNlciBncmFjZWZ1bGx5XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQuY3VycmVudC51c2VyKS50b0JlTnVsbCgpXG4gICAgfSlcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbmN1cnJlbnQgdXBkYXRlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IHsgcmVzdWx0IH0gPSByZW5kZXJIb29rKCgpID0+IHVzZVZvdGluZ1N0b3JlKCkpXG4gICAgICBcbiAgICAgIC8vIFNpbXVsYXRlIGNvbmN1cnJlbnQgYmFsbG90IGFkZGl0aW9uc1xuICAgICAgYWN0KCgpID0+IHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgICAgICAgcmVzdWx0LmN1cnJlbnQuYWRkQmFsbG90KHtcbiAgICAgICAgICAgIGlkOiBgYmFsbG90LSR7aX1gLFxuICAgICAgICAgICAgcG9sbElkOiAncG9sbC0xJyxcbiAgICAgICAgICAgIHVzZXJJZDogJ3VzZXItMScsXG4gICAgICAgICAgICBzZWxlY3Rpb25zOiBbJ29wdGlvbi0xJ10sXG4gICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LmN1cnJlbnQuYmFsbG90cykudG9IYXZlTGVuZ3RoKDEwKVxuICAgIH0pXG4gIH0pXG59KVxuXG5cblxuXG5cblxuIl0sIm5hbWVzIjpbImplc3QiLCJtb2NrIiwiZGV2TG9nIiwiZm4iLCJsb2dnZXIiLCJpbmZvIiwiZXJyb3IiLCJ3YXJuIiwid2l0aE9wdGlvbmFsIiwib2JqIiwiZGVzY3JpYmUiLCJiZWZvcmVFYWNoIiwidXNlQXBwU3RvcmUiLCJnZXRTdGF0ZSIsInJlc2V0IiwidXNlVXNlclN0b3JlIiwidXNlVm90aW5nU3RvcmUiLCJ1c2VOb3RpZmljYXRpb25TdG9yZSIsInNldFN0YXRlIiwibm90aWZpY2F0aW9ucyIsInVucmVhZENvdW50IiwiaXQiLCJyZXN1bHQiLCJyZW5kZXJIb29rIiwiZXhwZWN0IiwiY3VycmVudCIsInRoZW1lIiwidG9CZSIsInNpZGViYXJDb2xsYXBzZWQiLCJpc01vYmlsZSIsImFjdCIsInNldFRoZW1lIiwidG9nZ2xlU2lkZWJhciIsInVwZGF0ZVN5c3RlbVRoZW1lIiwic3lzdGVtVGhlbWUiLCJvcGVuTW9kYWwiLCJkYXRhIiwiYWN0aXZlTW9kYWwiLCJtb2RhbERhdGEiLCJ0b0VxdWFsIiwiY2xvc2VNb2RhbCIsInRvQmVOdWxsIiwidXBkYXRlU2V0dGluZ3MiLCJhbmltYXRpb25zIiwibGFuZ3VhZ2UiLCJzZXR0aW5ncyIsInVzZXIiLCJpc0F1dGhlbnRpY2F0ZWQiLCJtb2NrVXNlciIsImlkIiwiZW1haWwiLCJuYW1lIiwiYXZhdGFyIiwicm9sZSIsImNyZWF0ZWRBdCIsIkRhdGUiLCJ1cGRhdGVkQXQiLCJzZXRVc2VyQW5kQXV0aCIsImNsZWFyVXNlciIsInVzZXJuYW1lIiwicHJlZmVyZW5jZXMiLCJ0aW1lem9uZSIsInByaXZhY3kiLCJsb2NhdGlvbiIsImludGVyZXN0cyIsImJpbyIsIm1ldGFkYXRhIiwidG9JU09TdHJpbmciLCJzZXRQcm9maWxlIiwidXBkYXRlUHJvZmlsZSIsInByb2ZpbGUiLCJzZXRBdXRoZW50aWNhdGVkIiwiYmFsbG90cyIsImVsZWN0aW9ucyIsInZvdGluZ1JlY29yZHMiLCJtb2NrQmFsbG90IiwicG9sbElkIiwidXNlcklkIiwic2VsZWN0aW9ucyIsInRpbWVzdGFtcCIsImFkZEJhbGxvdCIsInRvSGF2ZUxlbmd0aCIsInJlbW92ZUJhbGxvdCIsIm1vY2tSZWNvcmQiLCJhY3Rpb24iLCJhZGRWb3RpbmdSZWNvcmQiLCJjbGVhclVzZXJWb3RpbmdTZXNzaW9uIiwic2VsZWN0ZWRCYWxsb3QiLCJjdXJyZW50QmFsbG90IiwiYWRkTm90aWZpY2F0aW9uIiwibWVzc2FnZSIsInR5cGUiLCJub3RpZmljYXRpb25JZCIsIm1hcmtBc1JlYWQiLCJyZWFkIiwiY2xlYXJBbGwiLCJjbGVhckJ5VHlwZSIsImFwcFJlc3VsdCIsInVzZXJSZXN1bHQiLCJzZXRTaWRlYmFyQ29sbGFwc2VkIiwibmV3UmVzdWx0Iiwic2V0VXNlciIsImkiXSwibWFwcGluZ3MiOiJBQUFBOzs7OztDQUtDOzs7O3lCQUVzRDt1QkFDdkI7MEJBR0o7MkJBQ0M7NkJBQ0U7bUNBRU07QUFDckMsNERBQTREO0FBRTVELDZCQUE2QjtBQUM3QkEsYUFBSSxDQUFDQyxJQUFJLENBQUMsc0JBQXNCLElBQU8sQ0FBQTtRQUNyQ0MsUUFBUUYsYUFBSSxDQUFDRyxFQUFFO1FBQ2ZDLFFBQVE7WUFDTkMsTUFBTUwsYUFBSSxDQUFDRyxFQUFFO1lBQ2JHLE9BQU9OLGFBQUksQ0FBQ0csRUFBRTtZQUNkSSxNQUFNUCxhQUFJLENBQUNHLEVBQUU7UUFDZjtJQUNGLENBQUE7QUFFQUgsYUFBSSxDQUFD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