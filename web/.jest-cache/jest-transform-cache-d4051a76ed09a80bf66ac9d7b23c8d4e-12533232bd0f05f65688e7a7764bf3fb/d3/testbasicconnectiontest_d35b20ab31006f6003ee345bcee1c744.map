{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/tests/jest/integration/test-basic-connection.test.ts"],"sourcesContent":["import { describe, it, expect } from '@jest/globals';\n\n/**\n * Test Basic Database Connection\n * \n * Tests basic database connectivity and simple queries\n * \n * Created: January 27, 2025\n * Status: ‚úÖ PRODUCTION READY\n */\n\ndescribe('Test Basic Database Connection', () => {\n  it('should test basic database connectivity', async () => {\n    const { createClient } = await import('@supabase/supabase-js');\n    const supabaseUrl = process.env.SUPABASE_URL || process.env.NEXT_PUBLIC_SUPABASE_URL;\n    const serviceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n    \n    if (!supabaseUrl || !serviceKey) {\n      throw new Error('Supabase credentials not found');\n    }\n    \n    console.log('üîç Testing basic database connectivity...');\n    console.log('Supabase URL:', supabaseUrl);\n    console.log('Service Key (first 10 chars):', serviceKey.substring(0, 10));\n    \n    const supabase = createClient(supabaseUrl, serviceKey);\n    \n    // Test 1: Simple SELECT 1\n    console.log('üîç Test 1: SELECT 1');\n    const { data: select1Data, error: select1Error } = await supabase\n      .rpc('version');\n    \n    console.log('SELECT 1 result:', { select1Data, select1Error });\n    \n    // Test 2: Get current timestamp\n    console.log('üîç Test 2: Current timestamp');\n    const { data: timestampData, error: timestampError } = await supabase\n      .rpc('now');\n    \n    console.log('Timestamp result:', { timestampData, timestampError });\n    \n    // Test 3: Get database name\n    console.log('üîç Test 3: Database name');\n    const { data: dbNameData, error: dbNameError } = await supabase\n      .rpc('current_database');\n    \n    console.log('Database name result:', { dbNameData, dbNameError });\n    \n    // Test 4: Get current user\n    console.log('üîç Test 4: Current user');\n    const { data: userData, error: userError } = await supabase\n      .rpc('current_user');\n    \n    console.log('Current user result:', { userData, userError });\n    \n    // Test 5: Get current role\n    console.log('üîç Test 5: Current role');\n    const { data: roleData, error: roleError } = await supabase\n      .rpc('current_role');\n    \n    console.log('Current role result:', { roleData, roleError });\n    \n    // Test 6: Get session user\n    console.log('üîç Test 6: Session user');\n    const { data: sessionData, error: sessionError } = await supabase\n      .rpc('session_user');\n    \n    console.log('Session user result:', { sessionData, sessionError });\n    \n    // Test 7: Get current setting\n    console.log('üîç Test 7: Current setting');\n    const { data: settingData, error: settingError } = await supabase\n      .rpc('current_setting', { setting_name: 'application_name' });\n    \n    console.log('Current setting result:', { settingData, settingError });\n    \n    // Test 8: Try to get table count\n    console.log('üîç Test 8: Table count');\n    const { data: tableCountData, error: tableCountError } = await supabase\n      .rpc('get_table_count');\n    \n    console.log('Table count result:', { tableCountData, tableCountError });\n    \n    // Test 9: Try to get polls count\n    console.log('üîç Test 9: Polls count');\n    const { data: pollsCountData, error: pollsCountError } = await supabase\n      .rpc('get_polls_count');\n    \n    console.log('Polls count result:', { pollsCountData, pollsCountError });\n    \n    // Test 10: Try to get polls count with SQL\n    console.log('üîç Test 10: Polls count with SQL');\n    const { data: sqlCountData, error: sqlCountError } = await supabase\n      .rpc('sql', { query: 'SELECT COUNT(*) FROM polls' });\n    \n    console.log('SQL count result:', { sqlCountData, sqlCountError });\n    \n    // The test should pass if we can at least connect\n    expect(select1Error).toBeNull();\n    expect(timestampError).toBeNull();\n    expect(dbNameError).toBeNull();\n    expect(userError).toBeNull();\n    expect(roleError).toBeNull();\n    expect(sessionError).toBeNull();\n    expect(settingError).toBeNull();\n    expect(tableCountError).toBeNull();\n    expect(pollsCountError).toBeNull();\n    expect(sqlCountError).toBeNull();\n  });\n});\n"],"names":["describe","it","createClient","supabaseUrl","process","env","SUPABASE_URL","NEXT_PUBLIC_SUPABASE_URL","serviceKey","SUPABASE_SERVICE_ROLE_KEY","Error","console","log","substring","supabase","data","select1Data","error","select1Error","rpc","timestampData","timestampError","dbNameData","dbNameError","userData","userError","roleData","roleError","sessionData","sessionError","settingData","settingError","setting_name","tableCountData","tableCountError","pollsCountData","pollsCountError","sqlCountData","sqlCountError","query","expect","toBeNull"],"mappings":"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"}