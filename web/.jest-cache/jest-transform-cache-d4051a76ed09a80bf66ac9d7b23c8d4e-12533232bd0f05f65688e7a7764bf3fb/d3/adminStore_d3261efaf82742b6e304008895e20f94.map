{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/lib/stores/adminStore.ts"],"sourcesContent":["/**\n * Admin Store - Zustand Implementation\n * \n * Admin-specific business logic and data management.\n * UI state (sidebar, notifications, navigation) moved to global stores.\n * \n * Created: October 10, 2025\n * Status: âœ… ACTIVE\n */\n\nimport { create } from 'zustand';\nimport { devtools } from 'zustand/middleware';\nimport { persist } from 'zustand/middleware';\n\nimport type {\n  AdminNotification,\n  TrendingTopic,\n  GeneratedPoll,\n  SystemMetrics,\n  ActivityItem,\n  AdminUser,\n} from '@/features/admin/types';\nimport type { Database } from '@/types/database-minimal'\nimport { logger } from '@/lib/utils/logger';\nimport { getSupabaseClient } from '@/utils/supabase/client';\n\n// Admin store state interface (business logic only)\ninterface AdminStore {\n  // Admin-specific data\n  trendingTopics: TrendingTopic[];\n  generatedPolls: GeneratedPoll[];\n  systemMetrics: SystemMetrics | null;\n  activityItems: ActivityItem[];\n  activityFeed: ActivityItem[];\n  \n  // User management data\n  users: AdminUser[];\n  userFilters: {\n    searchTerm: string;\n    roleFilter: 'all' | 'admin' | 'moderator' | 'user';\n    statusFilter: 'all' | 'active' | 'inactive' | 'suspended';\n    selectedUsers: Set<string>;\n    showBulkActions: boolean;\n  };\n  \n  // Dashboard state\n  activeTab: 'overview' | 'users' | 'analytics' | 'settings' | 'audit';\n  dashboardStats: {\n    totalUsers: number;\n    activePolls: number;\n    totalVotes: number;\n    systemHealth: 'healthy' | 'warning' | 'critical';\n  } | null;\n  \n  // System settings state\n  systemSettings: {\n    general: {\n      siteName: string;\n      siteDescription: string;\n      maintenanceMode: boolean;\n      allowRegistration: boolean;\n      requireEmailVerification: boolean;\n    };\n    performance: {\n      enableCaching: boolean;\n      cacheTTL: number;\n      enableCompression: boolean;\n      maxFileSize: number;\n    };\n    security: {\n      enableRateLimiting: boolean;\n      maxRequestsPerMinute: number;\n      enableCSP: boolean;\n      enableHSTS: boolean;\n    };\n    notifications: {\n      enableEmailNotifications: boolean;\n      enablePushNotifications: boolean;\n      notificationFrequency: 'immediate' | 'daily' | 'weekly';\n    };\n  } | null;\n  settingsTab: 'general' | 'performance' | 'security' | 'notifications';\n  isSavingSettings: boolean;\n  \n  // Reimport state\n  reimportProgress: {\n    totalStates: number;\n    processedStates: number;\n    successfulStates: number;\n    failedStates: number;\n    totalRepresentatives: number;\n    federalRepresentatives: number;\n    stateRepresentatives: number;\n    errors: string[];\n    stateResults: Array<{\n      state: string;\n      success: boolean;\n      representatives: number;\n      duration?: string;\n      error?: string;\n    }>;\n  };\n  reimportLogs: string[];\n  isReimportRunning: boolean;\n  \n  // Loading and error states\n  isLoading: boolean;\n  error: string | null;\n  \n  // Admin notifications\n  adminNotifications: AdminNotification[];\n  \n  // Actions\n  // Data loading actions\n  loadUsers: () => Promise<void>;\n  loadDashboardStats: () => Promise<void>;\n  loadSystemSettings: () => Promise<void>;\n  \n  // User management actions\n  setUserFilters: (filters: Partial<AdminStore['userFilters']>) => void;\n  selectUser: (userId: string) => void;\n  deselectUser: (userId: string) => void;\n  selectAllUsers: () => void;\n  deselectAllUsers: () => void;\n  updateUserRole: (userId: string, role: string) => Promise<void>;\n  updateUserStatus: (userId: string, status: string) => Promise<void>;\n  deleteUser: (userId: string) => Promise<void>;\n  \n  // Dashboard actions\n  setActiveTab: (tab: AdminStore['activeTab']) => void;\n  \n  // System settings actions\n  setSystemSettings: (settings: AdminStore['systemSettings']) => void;\n  updateSystemSetting: (section: keyof NonNullable<AdminStore['systemSettings']>, key: string, value: unknown) => void;\n  setSettingsTab: (tab: AdminStore['settingsTab']) => void;\n  saveSystemSettings: () => Promise<void>;\n  \n  // Reimport actions\n  setReimportProgress: (progress: Partial<AdminStore['reimportProgress']>) => void;\n  addReimportLog: (message: string) => void;\n  clearReimportLogs: () => void;\n  setIsReimportRunning: (running: boolean) => void;\n  startReimport: () => Promise<void>;\n  \n  // Activity and notifications\n  addActivityItem: (item: ActivityItem) => void;\n  clearActivityItems: () => void;\n  addAdminNotification: (notification: AdminNotification) => void;\n  clearAdminNotifications: () => void;\n  markNotificationAsRead: (id: string) => void;\n  \n  // Utility actions\n  setLoading: (loading: boolean) => void;\n  setUpdating: (updating: boolean) => void;\n  setError: (error: string | null) => void;\n  clearError: () => void;\n  setIsSavingSettings: (saving: boolean) => void;\n  refreshData: () => Promise<void>;\n  syncData: () => Promise<void>;\n}\n\n// Create the admin store\nexport const useAdminStore = create<AdminStore>()(\n  devtools(\n    persist(\n      (set, get) => ({\n        // Initial state\n        trendingTopics: [],\n        generatedPolls: [],\n        systemMetrics: null,\n        activityItems: [],\n        activityFeed: [],\n        users: [],\n        userFilters: {\n          searchTerm: '',\n          roleFilter: 'all',\n          statusFilter: 'all',\n          selectedUsers: new Set(),\n          showBulkActions: false,\n        },\n        activeTab: 'overview',\n        dashboardStats: null,\n        systemSettings: null,\n        settingsTab: 'general',\n        isSavingSettings: false,\n        reimportProgress: {\n          totalStates: 0,\n          processedStates: 0,\n          successfulStates: 0,\n          failedStates: 0,\n          totalRepresentatives: 0,\n          federalRepresentatives: 0,\n          stateRepresentatives: 0,\n          errors: [],\n          stateResults: [],\n        },\n        reimportLogs: [],\n        isReimportRunning: false,\n        isLoading: false,\n        error: null,\n        adminNotifications: [],\n\n        // Data loading actions\n        loadUsers: async () => {\n          const { setLoading, setError } = get();\n          \n          try {\n            setLoading(true);\n            setError(null);\n            \n            // Fetch users directly from database\n            const supabase = getSupabaseClient() as any;\n            if (!supabase) {\n              throw new Error('Database connection not available');\n            }\n\n            const { data: users, error } = await supabase\n              .from('user_profiles')\n              .select(`\n                user_id,\n                email,\n                display_name,\n                role,\n                status,\n                created_at,\n                last_login\n              `)\n              .order('created_at', { ascending: false });\n\n            if (error) {\n              throw new Error(`Failed to fetch users: ${error.message}`);\n            }\n\n            // Transform data to match AdminUser interface\n            const adminUsers: AdminUser[] = users?.map((user: any) => ({\n              id: user.user_id,\n              email: user.email,\n              name: user.display_name ?? 'Unknown User',\n              role: (user.role as 'admin' | 'moderator' | 'user') ?? 'user',\n              status: (user.status as 'active' | 'inactive' | 'suspended') ?? 'active',\n              created_at: user.created_at,\n              last_login: user.last_login\n            })) ?? [];\n\n            set({ users: adminUsers });\n            \n            logger.info('Users loaded successfully', {\n              userCount: adminUsers.length\n            });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to load users:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setLoading(false);\n          }\n        },\n        \n        loadDashboardStats: async () => {\n          const { setLoading, setError } = get();\n          \n          try {\n            setLoading(true);\n            setError(null);\n            \n            // Fetch dashboard stats directly from database\n            const supabase = getSupabaseClient() as any;\n            if (!supabase) {\n              throw new Error('Database connection not available');\n            }\n\n            // Get total users count\n            const { count: totalUsers, error: usersError } = await supabase\n              .from('user_profiles')\n              .select('*', { count: 'exact', head: true });\n\n            if (usersError) {\n              throw new Error(`Failed to fetch user count: ${usersError.message}`);\n            }\n\n            // Get active polls count\n            const { count: activePolls, error: pollsError } = await supabase\n              .from('polls')\n              .select('*', { count: 'exact', head: true })\n              .eq('status', 'active');\n\n            if (pollsError) {\n              throw new Error(`Failed to fetch polls count: ${pollsError.message}`);\n            }\n\n            // Get total votes count\n            const { count: totalVotes, error: votesError } = await supabase\n              .from('votes')\n              .select('*', { count: 'exact', head: true });\n\n            if (votesError) {\n              throw new Error(`Failed to fetch votes count: ${votesError.message}`);\n            }\n\n            // Determine system health based on recent activity\n            const { data: recentActivity } = await supabase\n              .from('analytics_events')\n              .select('created_at')\n              .gte('created_at', new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString())\n              .limit(1);\n\n            const systemHealth = recentActivity && recentActivity.length > 0 ? 'healthy' : 'warning';\n\n            const stats = {\n              totalUsers: totalUsers ?? 0,\n              activePolls: activePolls ?? 0,\n              totalVotes: totalVotes ?? 0,\n              systemHealth: systemHealth as 'healthy' | 'warning' | 'critical'\n            };\n\n            set({ dashboardStats: stats });\n            \n            logger.info('Dashboard stats loaded successfully', {\n              totalUsers: stats.totalUsers,\n              activePolls: stats.activePolls,\n              totalVotes: stats.totalVotes,\n              systemHealth: stats.systemHealth\n            });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to load dashboard stats:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setLoading(false);\n          }\n        },\n        \n        loadSystemSettings: async () => {\n          const { setLoading, setError } = get();\n          \n          try {\n            setLoading(true);\n            setError(null);\n            \n            // Fetch system settings from database\n            const supabase = getSupabaseClient() as any;\n            if (!supabase) {\n              throw new Error('Database connection not available');\n            }\n\n            const { data: settingsData, error } = await supabase\n              .from('system_settings')\n              .select('*')\n              .single();\n\n            if (error && error.code !== 'PGRST116') { // PGRST116 = no rows returned\n              throw new Error(`Failed to fetch system settings: ${error.message}`);\n            }\n\n            // Use default settings if none exist in database\n            const defaultSettings = {\n              general: {\n                siteName: 'Choices Platform',\n                siteDescription: 'A modern voting platform for democratic decision making',\n                maintenanceMode: false,\n                allowRegistration: true,\n                requireEmailVerification: true,\n              },\n              performance: {\n                enableCaching: true,\n                cacheTTL: 3600,\n                enableCompression: true,\n                maxFileSize: 10485760, // 10MB\n              },\n              security: {\n                enableRateLimiting: true,\n                maxRequestsPerMinute: 100,\n                enableCSP: true,\n                enableHSTS: true,\n              },\n              notifications: {\n                enableEmailNotifications: true,\n                enablePushNotifications: false,\n                notificationFrequency: 'immediate' as const,\n              },\n            };\n            \n            const settings = settingsData?.settings ?? defaultSettings;\n            set({ systemSettings: settings });\n            \n            logger.info('System settings loaded successfully');\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to load system settings:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setLoading(false);\n          }\n        },\n        \n        // User management actions\n        setUserFilters: (filters) => set((state) => ({\n          userFilters: { ...state.userFilters, ...filters }\n        })),\n\n        selectUser: (userId) => set((state) => ({\n          userFilters: {\n            ...state.userFilters,\n            selectedUsers: new Set([...state.userFilters.selectedUsers, userId])\n          }\n        })),\n\n        deselectUser: (userId) => set((state) => {\n          const newSelected = new Set(state.userFilters.selectedUsers);\n          newSelected.delete(userId);\n          return {\n            userFilters: {\n              ...state.userFilters,\n              selectedUsers: newSelected\n            }\n          };\n        }),\n\n        selectAllUsers: () => set((state) => ({\n          userFilters: {\n            ...state.userFilters,\n            selectedUsers: new Set(state.users.map(user => user.id))\n          }\n        })),\n\n        deselectAllUsers: () => set((state) => ({\n          userFilters: {\n            ...state.userFilters,\n            selectedUsers: new Set()\n          }\n        })),\n\n        updateUserRole: async (userId, role) => {\n          try {\n            const supabase = getSupabaseClient() as any;\n            if (!supabase) {\n              throw new Error('Database connection not available');\n            }\n\n            const { error } = await supabase\n              .from('user_profiles')\n              .update({ role })\n              .eq('user_id', userId);\n\n            if (error) {\n              throw new Error(`Failed to update user role: ${error.message}`);\n            }\n\n            // Update local state\n            set((state) => ({\n              users: state.users.map(user => \n                user.id === userId ? { ...user, role: role as 'admin' | 'moderator' | 'user' } : user\n              )\n            }));\n\n            logger.info('User role updated successfully', { userId, role });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            set({ error: errorMessage });\n            logger.error('Failed to update user role:', error instanceof Error ? error : new Error(errorMessage));\n          }\n        },\n\n        updateUserStatus: async (userId, status) => {\n          try {\n            const supabase = getSupabaseClient() as any;\n            if (!supabase) {\n              throw new Error('Database connection not available');\n            }\n\n            const { error } = await supabase\n              .from('user_profiles')\n              .update({ status })\n              .eq('user_id', userId);\n\n            if (error) {\n              throw new Error(`Failed to update user status: ${error.message}`);\n            }\n\n            // Update local state\n            set((state) => ({\n              users: state.users.map(user => \n                user.id === userId ? { ...user, status: status as 'active' | 'inactive' | 'suspended' } : user\n              )\n            }));\n\n            logger.info('User status updated successfully', { userId, status });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            set({ error: errorMessage });\n            logger.error('Failed to update user status:', error instanceof Error ? error : new Error(errorMessage));\n          }\n        },\n\n        deleteUser: async (userId) => {\n          try {\n            const supabase = getSupabaseClient() as any;\n            if (!supabase) {\n              throw new Error('Database connection not available');\n            }\n\n            const { error } = await supabase\n              .from('user_profiles')\n              .delete()\n              .eq('user_id', userId);\n\n            if (error) {\n              throw new Error(`Failed to delete user: ${error.message}`);\n            }\n\n            // Update local state\n            set((state) => ({\n              users: state.users.filter(user => user.id !== userId)\n            }));\n\n            logger.info('User deleted successfully', { userId });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            set({ error: errorMessage });\n            logger.error('Failed to delete user:', error instanceof Error ? error : new Error(errorMessage));\n          }\n        },\n\n        // Dashboard actions\n        setActiveTab: (tab) => set({ activeTab: tab }),\n\n        // System settings actions\n        setSystemSettings: (settings) => set({ systemSettings: settings }),\n        \n        updateSystemSetting: (section, key, value) => set((state) => {\n          if (!state.systemSettings) return state;\n          \n          return {\n            systemSettings: {\n              ...state.systemSettings,\n              [section]: {\n                ...state.systemSettings[section],\n                [key]: value\n              }\n            }\n          };\n        }),\n        \n        setSettingsTab: (tab) => set({ settingsTab: tab }),\n\n        saveSystemSettings: async () => {\n          const { setIsSavingSettings, setError } = get();\n          \n          try {\n            setIsSavingSettings(true);\n            setError(null);\n            \n            const { systemSettings } = get();\n            if (!systemSettings) {\n              throw new Error('No settings to save');\n            }\n\n            const supabase = getSupabaseClient() as any;\n            if (!supabase) {\n              throw new Error('Database connection not available');\n            }\n\n            const { error } = await supabase\n              .from('system_settings')\n              .upsert({ settings: systemSettings });\n\n            if (error) {\n              throw new Error(`Failed to save system settings: ${error.message}`);\n            }\n\n            logger.info('System settings saved successfully');\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to save system settings:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setIsSavingSettings(false);\n          }\n        },\n\n        // Reimport actions\n        setReimportProgress: (progress) => set((state) => ({\n          reimportProgress: { ...state.reimportProgress, ...progress }\n        })),\n\n        addReimportLog: (message) => set((state) => ({\n          reimportLogs: [...state.reimportLogs, message]\n        })),\n\n        clearReimportLogs: () => set({ reimportLogs: [] }),\n\n        setIsReimportRunning: (running) => set({ isReimportRunning: running }),\n\n        startReimport: async () => {\n          const { setIsReimportRunning, addReimportLog, setReimportProgress } = get();\n          \n          try {\n            setIsReimportRunning(true);\n            addReimportLog('Starting reimport process...');\n            \n            // Reset progress\n            setReimportProgress({\n              totalStates: 0,\n              processedStates: 0,\n              successfulStates: 0,\n              failedStates: 0,\n              totalRepresentatives: 0,\n              federalRepresentatives: 0,\n              stateRepresentatives: 0,\n              errors: [],\n              stateResults: [],\n            });\n\n            // Implementation would go here\n            addReimportLog('Reimport process completed');\n          } catch (error) {\n            addReimportLog(`Reimport failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n          } finally {\n            setIsReimportRunning(false);\n          }\n        },\n\n        // Activity and notifications\n        addActivityItem: (item) => set((state) => ({\n          activityItems: [item, ...state.activityItems.slice(0, 99)] // Keep last 100 items\n        })),\n\n        clearActivityItems: () => set({ activityItems: [] }),\n\n        addAdminNotification: (notification) => set((state) => ({\n          adminNotifications: [notification, ...state.adminNotifications]\n        })),\n\n        clearAdminNotifications: () => set({ adminNotifications: [] }),\n\n        markNotificationAsRead: (id) => set((state) => ({\n          adminNotifications: state.adminNotifications.map(notification =>\n            notification.id === id ? { ...notification, read: true } : notification\n          )\n        })),\n\n        // Utility actions\n        setLoading: (loading) => set({ isLoading: loading }),\n        setUpdating: (updating) => set({ isSavingSettings: updating }),\n        setError: (error) => set({ error }),\n        clearError: () => set({ error: null }),\n        setIsSavingSettings: (saving) => set({ isSavingSettings: saving }),\n\n        refreshData: async () => {\n          const { loadUsers, loadDashboardStats, loadSystemSettings } = get();\n          await Promise.all([\n            loadUsers(),\n            loadDashboardStats(),\n            loadSystemSettings()\n          ]);\n        },\n\n        syncData: async () => {\n          const { refreshData } = get();\n          await refreshData();\n        },\n      }),\n      {\n        name: 'admin-store',\n        partialize: (state) => ({\n          activeTab: state.activeTab,\n          settingsTab: state.settingsTab,\n          userFilters: state.userFilters,\n        }),\n      }\n    ),\n    {\n      name: 'admin-store',\n    }\n  )\n);\n\n// Export individual selectors for better performance\nexport const useTrendingTopics = () => useAdminStore((state) => state.trendingTopics);\nexport const useGeneratedPolls = () => useAdminStore((state) => state.generatedPolls);\nexport const useSystemMetrics = () => useAdminStore((state) => state.systemMetrics);\nexport const useActivityItems = () => useAdminStore((state) => state.activityItems);\nexport const useActivityFeed = () => useAdminStore((state) => state.activityFeed);\nexport const useAdminNotifications = () => useAdminStore((state) => state.adminNotifications);\nexport const useAdminLoading = () => useAdminStore((state) => state.isLoading);\nexport const useAdminError = () => useAdminStore((state) => state.error);\n\n// User management selectors\nexport const useAdminUsers = () => useAdminStore((state) => state.users);\nexport const useAdminUserFilters = () => useAdminStore((state) => state.userFilters);\nexport const useAdminUserActions = () => useAdminStore((state) => ({\n  setUserFilters: state.setUserFilters,\n  selectUser: state.selectUser,\n  deselectUser: state.deselectUser,\n  selectAllUsers: state.selectAllUsers,\n  deselectAllUsers: state.deselectAllUsers,\n  updateUserRole: state.updateUserRole,\n  updateUserStatus: state.updateUserStatus,\n  deleteUser: state.deleteUser,\n}));\n\n// Dashboard selectors\nexport const useAdminActiveTab = () => useAdminStore((state) => state.activeTab);\nexport const useAdminDashboardStats = () => useAdminStore((state) => state.dashboardStats);\nexport const useAdminDashboardActions = () => useAdminStore((state) => ({\n  setActiveTab: state.setActiveTab,\n  loadDashboardStats: state.loadDashboardStats,\n}));\n\n// System settings selectors\nexport const useAdminSystemSettings = () => useAdminStore((state) => state.systemSettings);\nexport const useAdminSettingsTab = () => useAdminStore((state) => state.settingsTab);\nexport const useAdminIsSavingSettings = () => useAdminStore((state) => state.isSavingSettings);\nexport const useAdminSystemSettingsActions = () => useAdminStore((state) => ({\n  setSystemSettings: state.setSystemSettings,\n  updateSystemSetting: state.updateSystemSetting,\n  setSettingsTab: state.setSettingsTab,\n  saveSystemSettings: state.saveSystemSettings,\n  loadSystemSettings: state.loadSystemSettings,\n}));\n\n// Reimport selectors\nexport const useAdminReimportProgress = () => useAdminStore((state) => state.reimportProgress);\nexport const useAdminReimportLogs = () => useAdminStore((state) => state.reimportLogs);\nexport const useAdminIsReimportRunning = () => useAdminStore((state) => state.isReimportRunning);\nexport const useAdminReimportActions = () => useAdminStore((state) => ({\n  setReimportProgress: state.setReimportProgress,\n  addReimportLog: state.addReimportLog,\n  clearReimportLogs: state.clearReimportLogs,\n  setIsReimportRunning: state.setIsReimportRunning,\n  startReimport: state.startReimport,\n}));\n\n// General admin actions\nexport const useAdminActions = () => useAdminStore((state) => ({\n  loadUsers: state.loadUsers,\n  loadDashboardStats: state.loadDashboardStats,\n  loadSystemSettings: state.loadSystemSettings,\n  addActivityItem: state.addActivityItem,\n  clearActivityItems: state.clearActivityItems,\n  addAdminNotification: state.addAdminNotification,\n  clearAdminNotifications: state.clearAdminNotifications,\n  markNotificationAsRead: state.markNotificationAsRead,\n  setLoading: state.setLoading,\n  setUpdating: state.setUpdating,\n  setError: state.setError,\n  clearError: state.clearError,\n  refreshData: state.refreshData,\n  syncData: state.syncData,\n}));\n\n// Admin store utilities\nexport const useAdminStats = () => useAdminStore((state) => ({\n  totalUsers: state.users.length,\n  totalNotifications: state.adminNotifications.length,\n  unreadNotifications: state.adminNotifications.filter(n => !n.read).length,\n  totalActivity: state.activityItems.length,\n}));\n\n// Recent activity selector\nexport const useRecentActivity = () => useAdminStore((state) => \n  state.activityItems.slice(0, 10)\n);\n\n// Admin store utilities\nexport const adminStoreUtils = {\n  getAdminStats: () => {\n    const state = useAdminStore.getState();\n    return {\n      totalUsers: state.users.length,\n      totalNotifications: state.adminNotifications.length,\n      unreadNotifications: state.adminNotifications.filter(n => !n.read).length,\n      totalActivity: state.activityItems.length,\n    };\n  },\n\n  getDataSummary: () => {\n    const state = useAdminStore.getState();\n    return {\n      users: state.users.length,\n      trendingTopics: state.trendingTopics.length,\n      generatedPolls: state.generatedPolls.length,\n      activityItems: state.activityItems.length,\n      notifications: state.adminNotifications.length,\n    };\n  },\n};\n\n// Admin store subscriptions\nexport const adminStoreSubscriptions = {\n  subscribeToUsers: (callback: (users: AdminUser[]) => void) => {\n    return useAdminStore.subscribe((state) => {\n      callback(state.users);\n    });\n  },\n\n  subscribeToDashboardStats: (callback: (stats: AdminStore['dashboardStats']) => void) => {\n    return useAdminStore.subscribe((state) => {\n      callback(state.dashboardStats);\n    });\n  },\n\n  subscribeToNotifications: (callback: (notifications: AdminNotification[]) => void) => {\n    return useAdminStore.subscribe((state) => {\n      callback(state.adminNotifications);\n    });\n  },\n};\n\n// Admin store debug utilities\nexport const adminStoreDebug = {\n  logState: () => {\n    const state = useAdminStore.getState();\n    logger.info('Admin store state:', state as any);\n  },\n  \n  logStats: () => {\n    const stats = adminStoreUtils.getAdminStats();\n    logger.info('Admin statistics:', stats);\n  },\n  \n  logDataSummary: () => {\n    const summary = adminStoreUtils.getDataSummary();\n    logger.info('Admin data summary:', summary);\n  },\n  \n  reset: () => {\n    useAdminStore.getState().clearActivityItems();\n    useAdminStore.getState().clearAdminNotifications();\n    // Admin store reset\n  }\n};"],"names":["adminStoreDebug","adminStoreSubscriptions","adminStoreUtils","useActivityFeed","useActivityItems","useAdminActions","useAdminActiveTab","useAdminDashboardActions","useAdminDashboardStats","useAdminError","useAdminIsReimportRunning","useAdminIsSavingSettings","useAdminLoading","useAdminNotifications","useAdminReimportActions","useAdminReimportLogs","useAdminReimportProgress","useAdminSettingsTab","useAdminStats","useAdminStore","useAdminSystemSettings","useAdminSystemSettingsActions","useAdminUserActions","useAdminUserFilters","useAdminUsers","useGeneratedPolls","useRecentActivity","useSystemMetrics","useTrendingTopics","create","devtools","persist","set","get","trendingTopics","generatedPolls","systemMetrics","activityItems","activityFeed","users","userFilters","searchTerm","roleFilter","statusFilter","selectedUsers","Set","showBulkActions","activeTab","dashboardStats","systemSettings","settingsTab","isSavingSettings","reimportProgress","totalStates","processedStates","successfulStates","failedStates","totalRepresentatives","federalRepresentatives","stateRepresentatives","errors","stateResults","reimportLogs","isReimportRunning","isLoading","error","adminNotifications","loadUsers","setLoading","setError","supabase","getSupabaseClient","Error","data","from","select","order","ascending","message","adminUsers","map","user","id","user_id","email","name","display_name","role","status","created_at","last_login","logger","info","userCount","length","errorMessage","loadDashboardStats","count","totalUsers","usersError","head","activePolls","pollsError","eq","totalVotes","votesError","recentActivity","gte","Date","now","toISOString","limit","systemHealth","stats","loadSystemSettings","settingsData","single","code","defaultSettings","general","siteName","siteDescription","maintenanceMode","allowRegistration","requireEmailVerification","performance","enableCaching","cacheTTL","enableCompression","maxFileSize","security","enableRateLimiting","maxRequestsPerMinute","enableCSP","enableHSTS","notifications","enableEmailNotifications","enablePushNotifications","notificationFrequency","settings","setUserFilters","filters","state","selectUser","userId","deselectUser","newSelected","delete","selectAllUsers","deselectAllUsers","updateUserRole","update","updateUserStatus","deleteUser","filter","setActiveTab","tab","setSystemSettings","updateSystemSetting","section","key","value","setSettingsTab","saveSystemSettings","setIsSavingSettings","upsert","setReimportProgress","progress","addReimportLog","clearReimportLogs","setIsReimportRunning","running","startReimport","addActivityItem","item","slice","clearActivityItems","addAdminNotification","notification","clearAdminNotifications","markNotificationAsRead","read","loading","setUpdating","updating","clearError","saving","refreshData","Promise","all","syncData","partialize","totalNotifications","unreadNotifications","n","totalActivity","getAdminStats","getState","getDataSummary","subscribeToUsers","callback","subscribe","subscribeToDashboardStats","subscribeToNotifications","logState","logStats","logDataSummary","summary","reset"],"mappings":"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"}