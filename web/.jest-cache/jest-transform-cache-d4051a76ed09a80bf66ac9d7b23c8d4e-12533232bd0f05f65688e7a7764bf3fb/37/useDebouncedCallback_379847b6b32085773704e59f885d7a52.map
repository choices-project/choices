{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/lib/utils/useDebouncedCallback.ts"],"sourcesContent":["// lib/react/useDebouncedCallback.ts\nimport { useEffect, useMemo, useRef } from 'react';\n\n/**\n * useDebouncedCallback\n * - Keeps a stable debounced function instance across renders.\n * - Safely updates the inner callback via a ref (so you avoid massive dep arrays).\n * - Cancels the debounced timer on unmount or delay change.\n *\n * Example:\n *   const onScroll = useDebouncedCallback((evt) => { ... }, 50, [rowHeight, buffer]);\n *   <div onScroll={onScroll} />\n */\nexport function useDebouncedCallback<T extends (...args: any[]) => void>(\n  fn: T,\n  delay: number,\n  deps: readonly unknown[] = []\n): T {\n  const fnRef = useRef(fn);\n\n  // keep the latest function without changing the debounced identity\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  useEffect(() => { fnRef.current = fn; }, [fn, ...deps]);\n\n  // create a single debounced wrapper that only changes when the delay changes\n  const debounced = useMemo(() => {\n    let timer: ReturnType<typeof setTimeout> | null = null;\n\n    const wrapped = ((...args: any[]) => {\n      if (timer) clearTimeout(timer);\n      timer = setTimeout(() => {\n        timer = null;\n        fnRef.current(...args);\n      }, delay);\n    }) as T & { cancel?: () => void };\n\n    wrapped.cancel = () => {\n      if (timer) {\n        clearTimeout(timer);\n        timer = null;\n      }\n    };\n\n    return wrapped;\n  }, [delay]);\n\n  // cancel any pending run on unmount\n  useEffect(() => {\n    return () => {\n      (debounced as any)?.cancel?.();\n    };\n  }, [debounced]);\n\n  return debounced as T;\n}\n"],"names":["useDebouncedCallback","fn","delay","deps","fnRef","useRef","useEffect","current","debounced","useMemo","timer","wrapped","args","clearTimeout","setTimeout","cancel"],"mappings":"AAAA,oCAAoC;;;;;+BAapBA;;;eAAAA;;;uBAZ2B;AAYpC,SAASA,qBACdC,EAAK,EACLC,KAAa,EACbC,OAA2B,EAAE;IAE7B,MAAMC,QAAQC,IAAAA,aAAM,EAACJ;IAErB,mEAAmE;IACnE,uDAAuD;IACvDK,IAAAA,gBAAS,EAAC;QAAQF,MAAMG,OAAO,GAAGN;IAAI,GAAG;QAACA;WAAOE;KAAK;IAEtD,6EAA6E;IAC7E,MAAMK,YAAYC,IAAAA,cAAO,EAAC;QACxB,IAAIC,QAA8C;QAElD,MAAMC,UAAW,CAAC,GAAGC;YACnB,IAAIF,OAAOG,aAAaH;YACxBA,QAAQI,WAAW;gBACjBJ,QAAQ;gBACRN,MAAMG,OAAO,IAAIK;YACnB,GAAGV;QACL;QAEAS,QAAQI,MAAM,GAAG;YACf,IAAIL,OAAO;gBACTG,aAAaH;gBACbA,QAAQ;YACV;QACF;QAEA,OAAOC;IACT,GAAG;QAACT;KAAM;IAEV,oCAAoC;IACpCI,IAAAA,gBAAS,EAAC;QACR,OAAO;YACJE,WAAmBO;QACtB;IACF,GAAG;QAACP;KAAU;IAEd,OAAOA;AACT"}