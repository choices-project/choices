{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/lib/stores/pollsStore.ts"],"sourcesContent":["/**\n * Polls Store - Zustand Implementation\n * \n * Comprehensive poll state management including poll data, voting state,\n * poll interactions, and poll preferences. Consolidates poll-related state management.\n * \n * Created: October 10, 2025\n * Status: âœ… ACTIVE\n */\n\nimport { create } from 'zustand';\nimport { devtools } from 'zustand/middleware';\nimport { persist } from 'zustand/middleware';\n\nimport { logger } from '@/lib/utils/logger';\n\n// Poll data types\ninterface Poll {\n  id: string;\n  title: string;\n  description: string;\n  question: string;\n  options: PollOption[];\n  category: string;\n  tags: string[];\n  author: {\n    id: string;\n    name: string;\n    avatar?: string;\n    verified: boolean;\n  };\n  status: 'draft' | 'active' | 'closed' | 'archived';\n  visibility: 'public' | 'private' | 'unlisted';\n  settings: {\n    allowMultipleVotes: boolean;\n    allowAnonymousVotes: boolean;\n    showResultsBeforeClose: boolean;\n    allowComments: boolean;\n    allowSharing: boolean;\n    requireAuthentication: boolean;\n  };\n  voting: {\n    totalVotes: number;\n    uniqueVoters: number;\n    userVote?: string; // Option ID\n    userVotedAt?: string;\n    canVote: boolean;\n    hasVoted: boolean;\n  };\n  results: {\n    optionResults: Array<{\n      optionId: string;\n      votes: number;\n      percentage: number;\n    }>;\n    demographics: {\n      ageGroups: Record<string, number>;\n      locations: Record<string, number>;\n      genders: Record<string, number>;\n    };\n    trends: Array<{\n      timestamp: string;\n      votes: number;\n    }>;\n  };\n  metadata: {\n    image?: string;\n    location?: string;\n    language: string;\n    estimatedTime: number; // minutes\n    difficulty: 'easy' | 'medium' | 'hard';\n  };\n  timestamps: {\n    createdAt: string;\n    publishedAt?: string;\n    closesAt?: string;\n    updatedAt: string;\n  };\n}\n\ninterface PollOption {\n  id: string;\n  text: string;\n  description?: string;\n  image?: string;\n  order: number;\n  votes: number;\n  percentage: number;\n}\n\ninterface PollComment {\n  id: string;\n  pollId: string;\n  author: {\n    id: string;\n    name: string;\n    avatar?: string;\n  };\n  content: string;\n  parentId?: string; // For replies\n  likes: number;\n  userLiked: boolean;\n  createdAt: string;\n  updatedAt: string;\n}\n\ninterface PollFilters {\n  status: Array<'draft' | 'active' | 'closed' | 'archived'>;\n  category: string[];\n  tags: string[];\n  author: string[];\n  dateRange: {\n    start: string;\n    end: string;\n  };\n  votingStatus: 'all' | 'voted' | 'not_voted';\n  visibility: Array<'public' | 'private' | 'unlisted'>;\n}\n\ninterface PollPreferences {\n  defaultView: 'list' | 'grid' | 'card';\n  sortBy: 'newest' | 'oldest' | 'popular' | 'trending' | 'closing_soon';\n  itemsPerPage: number;\n  showResults: boolean;\n  autoRefresh: boolean;\n  refreshInterval: number; // minutes\n  notifications: {\n    newPolls: boolean;\n    pollUpdates: boolean;\n    pollCloses: boolean;\n    pollResults: boolean;\n  };\n  privacy: {\n    showVoteHistory: boolean;\n    showPollParticipation: boolean;\n    shareActivity: boolean;\n  };\n  voting: {\n    confirmVotes: boolean;\n    showProgress: boolean;\n    allowUndo: boolean;\n    undoTimeLimit: number; // minutes\n  };\n}\n\ninterface PollSearch {\n  query: string;\n  results: Poll[];\n  totalResults: number;\n  currentPage: number;\n  totalPages: number;\n  filters: PollFilters;\n  suggestions: string[];\n  recentSearches: string[];\n}\n\n// Polls store state interface\ninterface PollsStore {\n  // Poll data\n  polls: Poll[];\n  filteredPolls: Poll[];\n  comments: PollComment[];\n  search: PollSearch;\n  \n  // UI state\n  selectedPoll: Poll | null;\n  currentView: 'list' | 'grid' | 'card';\n  selectedCategory: string | null;\n  \n  // Filters and preferences\n  filters: PollFilters;\n  preferences: PollPreferences;\n  \n  // Loading states\n  isLoading: boolean;\n  isSearching: boolean;\n  isVoting: boolean;\n  isUpdating: boolean;\n  error: string | null;\n  \n  // Actions - Poll management\n  setPolls: (polls: Poll[]) => void;\n  addPoll: (poll: Poll) => void;\n  updatePoll: (id: string, updates: Partial<Poll>) => void;\n  removePoll: (id: string) => void;\n  publishPoll: (id: string) => void;\n  closePoll: (id: string) => void;\n  archivePoll: (id: string) => void;\n  \n  // Actions - Voting\n  voteOnPoll: (pollId: string, optionId: string) => Promise<void>;\n  undoVote: (pollId: string) => Promise<void>;\n  changeVote: (pollId: string, newOptionId: string) => Promise<void>;\n  \n  // Actions - Comments\n  setComments: (comments: PollComment[]) => void;\n  addComment: (comment: Omit<PollComment, 'id' | 'createdAt' | 'updatedAt'>) => void;\n  updateComment: (id: string, updates: Partial<PollComment>) => void;\n  removeComment: (id: string) => void;\n  likeComment: (id: string) => void;\n  unlikeComment: (id: string) => void;\n  \n  // Actions - Filtering and search\n  setFilters: (filters: Partial<PollFilters>) => void;\n  clearFilters: () => void;\n  searchPolls: (query: string) => Promise<void>;\n  setSearchQuery: (query: string) => void;\n  clearSearch: () => void;\n  \n  // Actions - UI state\n  setSelectedPoll: (poll: Poll | null) => void;\n  setCurrentView: (view: 'list' | 'grid' | 'card') => void;\n  setSelectedCategory: (category: string | null) => void;\n  \n  // Actions - Preferences\n  updatePreferences: (preferences: Partial<PollPreferences>) => void;\n  resetPreferences: () => void;\n  \n  // Actions - Data operations\n  loadPolls: (category?: string) => Promise<void>;\n  loadPoll: (id: string) => Promise<void>;\n  loadComments: (pollId: string) => Promise<void>;\n  createPoll: (poll: Omit<Poll, 'id' | 'timestamps' | 'voting' | 'results'>) => Promise<void>;\n  updatePollSettings: (id: string, settings: Partial<Poll['settings']>) => Promise<void>;\n  \n  // Actions - Loading states\n  setLoading: (loading: boolean) => void;\n  setSearching: (searching: boolean) => void;\n  setVoting: (voting: boolean) => void;\n  setUpdating: (updating: boolean) => void;\n  setError: (error: string | null) => void;\n  clearError: () => void;\n}\n\n// Default poll preferences\nconst defaultPreferences: PollPreferences = {\n  defaultView: 'list',\n  sortBy: 'newest',\n  itemsPerPage: 20,\n  showResults: true,\n  autoRefresh: true,\n  refreshInterval: 5,\n  notifications: {\n    newPolls: true,\n    pollUpdates: true,\n    pollCloses: true,\n    pollResults: true,\n  },\n  privacy: {\n    showVoteHistory: false,\n    showPollParticipation: true,\n    shareActivity: false,\n  },\n  voting: {\n    confirmVotes: true,\n    showProgress: true,\n    allowUndo: true,\n    undoTimeLimit: 5,\n  },\n};\n\n// Default poll filters\nconst defaultFilters: PollFilters = {\n  status: ['active'],\n  category: [],\n  tags: [],\n  author: [],\n  dateRange: {\n    start: '',\n    end: '',\n  },\n  votingStatus: 'all',\n  visibility: ['public'],\n};\n\n// Create polls store with middleware\nexport const usePollsStore = create<PollsStore>()(\n  devtools(\n    persist(\n      (set, get) => ({\n        // Initial state\n        polls: [],\n        filteredPolls: [],\n        comments: [],\n        search: {\n          query: '',\n          results: [],\n          totalResults: 0,\n          currentPage: 1,\n          totalPages: 1,\n          filters: defaultFilters,\n          suggestions: [],\n          recentSearches: [],\n        },\n        selectedPoll: null,\n        currentView: 'list',\n        selectedCategory: null,\n        filters: defaultFilters,\n        preferences: defaultPreferences,\n        isLoading: false,\n        isSearching: false,\n        isVoting: false,\n        isUpdating: false,\n        error: null,\n        \n        // Poll management actions\n        setPolls: (polls) => set({ polls, filteredPolls: polls }),\n        \n        addPoll: (poll) => set((state) => ({\n          polls: [poll, ...state.polls],\n          filteredPolls: [poll, ...state.filteredPolls],\n        })),\n        \n        updatePoll: (id, updates) => set((state) => ({\n          polls: state.polls.map(poll =>\n            poll.id === id ? { ...poll, ...updates } : poll\n          ),\n          filteredPolls: state.filteredPolls.map(poll =>\n            poll.id === id ? { ...poll, ...updates } : poll\n          ),\n        })),\n        \n        removePoll: (id) => set((state) => ({\n          polls: state.polls.filter(poll => poll.id !== id),\n          filteredPolls: state.filteredPolls.filter(poll => poll.id !== id),\n        })),\n        \n        publishPoll: (id) => set((state) => ({\n          polls: state.polls.map(poll =>\n            poll.id === id \n              ? { \n                  ...poll,\n                  status: 'active' as const,\n                  timestamps: { \n                    ...poll.timestamps,\n                    publishedAt: new Date().toISOString(),\n                    updatedAt: new Date().toISOString()\n                  }\n                }\n              : poll\n          ),\n          filteredPolls: state.filteredPolls.map(poll =>\n            poll.id === id \n              ? { \n                  ...poll,\n                  status: 'active' as const,\n                  timestamps: { \n                    ...poll.timestamps,\n                    publishedAt: new Date().toISOString(),\n                    updatedAt: new Date().toISOString()\n                  }\n                }\n              : poll\n          ),\n        })),\n        \n        closePoll: (id) => set((state) => ({\n          polls: state.polls.map(poll =>\n            poll.id === id \n              ? { \n                  ...poll,\n                  status: 'closed' as const,\n                  timestamps: { \n                    ...poll.timestamps,\n                    closesAt: new Date().toISOString(),\n                    updatedAt: new Date().toISOString()\n                  }\n                }\n              : poll\n          ),\n          filteredPolls: state.filteredPolls.map(poll =>\n            poll.id === id \n              ? { \n                  ...poll,\n                  status: 'closed' as const,\n                  timestamps: { \n                    ...poll.timestamps,\n                    closesAt: new Date().toISOString(),\n                    updatedAt: new Date().toISOString()\n                  }\n                }\n              : poll\n          ),\n        })),\n        \n        archivePoll: (id) => set((state) => ({\n          polls: state.polls.map(poll =>\n            poll.id === id \n              ? { \n                  ...poll,\n                  status: 'archived' as const,\n                  timestamps: { \n                    ...poll.timestamps,\n                    updatedAt: new Date().toISOString()\n                  }\n                }\n              : poll\n          ),\n          filteredPolls: state.filteredPolls.map(poll =>\n            poll.id === id \n              ? { \n                  ...poll,\n                  status: 'archived' as const,\n                  timestamps: { \n                    ...poll.timestamps,\n                    updatedAt: new Date().toISOString()\n                  }\n                }\n              : poll\n          ),\n        })),\n        \n        // Voting actions\n        voteOnPoll: async (pollId, optionId) => {\n          const { setVoting, setError } = get();\n          \n          try {\n            setVoting(true);\n            setError(null);\n            \n            const response = await fetch('/api/polls/vote', {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({ pollId, optionId }),\n            });\n            \n            if (!response.ok) {\n              throw new Error('Failed to vote on poll');\n            }\n            \n            // Update local state\n            set((state) => ({\n              polls: state.polls.map(poll =>\n                poll.id === pollId \n                  ? {\n                      ...poll,\n                      voting: {\n                        ...poll.voting,\n                        userVote: optionId,\n                        userVotedAt: new Date().toISOString(),\n                        hasVoted: true,\n                        totalVotes: poll.voting.totalVotes + 1,\n                      },\n                      results: {\n                        ...poll.results,\n                        optionResults: poll.results.optionResults.map(result =>\n                          result.optionId === optionId\n                            ? { ...result, votes: result.votes + 1 }\n                            : result\n                        ),\n                      },\n                    }\n                  : poll\n              ),\n              filteredPolls: state.filteredPolls.map(poll =>\n                poll.id === pollId \n                  ? {\n                      ...poll,\n                      voting: {\n                        ...poll.voting,\n                        userVote: optionId,\n                        userVotedAt: new Date().toISOString(),\n                        hasVoted: true,\n                        totalVotes: poll.voting.totalVotes + 1,\n                      },\n                      results: {\n                        ...poll.results,\n                        optionResults: poll.results.optionResults.map(result =>\n                          result.optionId === optionId\n                            ? { ...result, votes: result.votes + 1 }\n                            : result\n                        ),\n                      },\n                    }\n                  : poll\n              ),\n            }));\n            \n            logger.info('Vote cast successfully', {\n              pollId,\n              optionId\n            });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to vote on poll:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setVoting(false);\n          }\n        },\n        \n        undoVote: async (pollId) => {\n          const { setVoting, setError } = get();\n          \n          try {\n            setVoting(true);\n            setError(null);\n            \n            const response = await fetch('/api/polls/undo-vote', {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({ pollId }),\n            });\n            \n            if (!response.ok) {\n              throw new Error('Failed to undo vote');\n            }\n            \n            // Update local state\n            set((state) => {\n              const poll = state.polls.find(p => p.id === pollId);\n              if (!poll?.voting.userVote) return state;\n              \n              return {\n                polls: state.polls.map(p =>\n                  p.id === pollId \n                    ? {\n                        ...p,\n                        voting: {\n                          ...p.voting,\n                          userVote: undefined,\n                          userVotedAt: undefined,\n                          hasVoted: false,\n                          totalVotes: Math.max(0, p.voting.totalVotes - 1),\n                        },\n                        results: {\n                          ...p.results,\n                          optionResults: p.results.optionResults.map(result =>\n                            result.optionId === poll.voting.userVote\n                              ? { ...result, votes: Math.max(0, result.votes - 1) }\n                              : result\n                          ),\n                        },\n                      }\n                    : p\n                ),\n                filteredPolls: state.filteredPolls.map(p =>\n                  p.id === pollId \n                    ? {\n                        ...p,\n                        voting: {\n                          ...p.voting,\n                          userVote: undefined,\n                          userVotedAt: undefined,\n                          hasVoted: false,\n                          totalVotes: Math.max(0, p.voting.totalVotes - 1),\n                        },\n                        results: {\n                          ...p.results,\n                          optionResults: p.results.optionResults.map(result =>\n                            result.optionId === poll.voting.userVote\n                              ? { ...result, votes: Math.max(0, result.votes - 1) }\n                              : result\n                          ),\n                        },\n                      }\n                    : p\n                ),\n              };\n            });\n            \n            logger.info('Vote undone successfully', { pollId });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to undo vote:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setVoting(false);\n          }\n        },\n        \n        changeVote: async (pollId, newOptionId) => {\n          const { voteOnPoll, undoVote } = get();\n          \n          try {\n            await undoVote(pollId);\n            await voteOnPoll(pollId, newOptionId);\n            \n            logger.info('Vote changed successfully', {\n              pollId,\n              newOptionId\n            });\n          } catch (error) {\n            logger.error('Failed to change vote:', error as Error);\n            throw error;\n          }\n        },\n        \n        // Comment actions\n        setComments: (comments) => set({ comments }),\n        \n        addComment: (comment) => set((state) => ({\n          comments: [\n            ...state.comments,\n            {\n              ...comment,\n              id: `comment_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n              createdAt: new Date().toISOString(),\n              updatedAt: new Date().toISOString(),\n            }\n          ]\n        })),\n        \n        updateComment: (id, updates) => set((state) => ({\n          comments: state.comments.map(comment =>\n            comment.id === id \n              ? { ...comment, ...updates, updatedAt: new Date().toISOString() }\n              : comment\n          )\n        })),\n        \n        removeComment: (id) => set((state) => ({\n          comments: state.comments.filter(comment => comment.id !== id)\n        })),\n        \n        likeComment: (id) => set((state) => ({\n          comments: state.comments.map(comment =>\n            comment.id === id \n              ? { \n                  ...comment,\n                  userLiked: true,\n                  likes: comment.likes + 1 \n                }\n              : comment\n          )\n        })),\n        \n        unlikeComment: (id) => set((state) => ({\n          comments: state.comments.map(comment =>\n            comment.id === id \n              ? { \n                  ...comment,\n                  userLiked: false,\n                  likes: Math.max(0, comment.likes - 1) \n                }\n              : comment\n          )\n        })),\n        \n        // Filtering and search actions\n        setFilters: (filters) => set((state) => {\n          const newFilters = { ...state.filters, ...filters };\n          \n          // Apply filters to polls\n          const filtered = state.polls.filter(poll => {\n            if (newFilters.status.length > 0 && !newFilters.status.includes(poll.status)) {\n              return false;\n            }\n            if (newFilters.category.length > 0 && !newFilters.category.includes(poll.category)) {\n              return false;\n            }\n            if (newFilters.tags.length > 0 && !newFilters.tags.some(tag => poll.tags.includes(tag))) {\n              return false;\n            }\n            if (newFilters.author.length > 0 && !newFilters.author.includes(poll.author.id)) {\n              return false;\n            }\n            if (newFilters.votingStatus === 'voted' && !poll.voting.hasVoted) {\n              return false;\n            }\n            if (newFilters.votingStatus === 'not_voted' && poll.voting.hasVoted) {\n              return false;\n            }\n            return true;\n          });\n          \n          return { filters: newFilters, filteredPolls: filtered };\n        }),\n        \n        clearFilters: () => set((state) => ({\n          filters: defaultFilters,\n          filteredPolls: state.polls,\n        })),\n        \n        searchPolls: async (query) => {\n          const { setSearching, setError } = get();\n          \n          try {\n            setSearching(true);\n            setError(null);\n            \n            const response = await fetch('/api/polls/search', {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({ query }),\n            });\n            \n            if (!response.ok) {\n              throw new Error('Failed to search polls');\n            }\n            \n            const results = await response.json();\n            \n            set((state) => ({\n              search: {\n                ...state.search,\n                query,\n                results: results.polls,\n                totalResults: results.total,\n                currentPage: 1,\n                totalPages: Math.ceil(results.total / state.preferences.itemsPerPage),\n              }\n            }));\n            \n            logger.info('Polls searched', {\n              query,\n              results: results.polls.length,\n              total: results.total\n            });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to search polls:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setSearching(false);\n          }\n        },\n        \n        setSearchQuery: (query) => set((state) => ({\n          search: { ...state.search, query }\n        })),\n        \n        clearSearch: () => set((state) => ({\n          search: {\n            ...state.search,\n            query: '',\n            results: [],\n            totalResults: 0,\n            currentPage: 1,\n            totalPages: 1,\n          }\n        })),\n        \n        // UI state actions\n        setSelectedPoll: (poll) => set({ selectedPoll: poll }),\n        \n        setCurrentView: (view) => set({ currentView: view }),\n        \n        setSelectedCategory: (category) => set({ selectedCategory: category }),\n        \n        // Preferences actions\n        updatePreferences: (preferences) => set((state) => ({\n          preferences: { ...state.preferences, ...preferences }\n        })),\n        \n        resetPreferences: () => set({ preferences: defaultPreferences }),\n        \n        // Data operations\n        loadPolls: async (category) => {\n          const { setLoading, setError } = get();\n          \n          try {\n            setLoading(true);\n            setError(null);\n            \n            const response = await fetch('/api/polls', {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({ category }),\n            });\n            \n            if (!response.ok) {\n              throw new Error('Failed to load polls');\n            }\n            \n            const polls = await response.json();\n            set({ polls, filteredPolls: polls });\n            \n            logger.info('Polls loaded', {\n              category,\n              count: polls.length\n            });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to load polls:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setLoading(false);\n          }\n        },\n        \n        loadPoll: async (id) => {\n          const { setLoading, setError } = get();\n          \n          try {\n            setLoading(true);\n            setError(null);\n            \n            const response = await fetch(`/api/polls/${id}`);\n            \n            if (!response.ok) {\n              throw new Error('Failed to load poll');\n            }\n            \n            const poll = await response.json();\n            set({ selectedPoll: poll });\n            \n            logger.info('Poll loaded', { id });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to load poll:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setLoading(false);\n          }\n        },\n        \n        loadComments: async (pollId) => {\n          const { setLoading, setError } = get();\n          \n          try {\n            setLoading(true);\n            setError(null);\n            \n            const response = await fetch(`/api/polls/${pollId}/comments`);\n            \n            if (!response.ok) {\n              throw new Error('Failed to load comments');\n            }\n            \n            const comments = await response.json();\n            set({ comments });\n            \n            logger.info('Comments loaded', {\n              pollId,\n              count: comments.length\n            });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to load comments:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setLoading(false);\n          }\n        },\n        \n        createPoll: async (poll) => {\n          const { setUpdating, setError } = get();\n          \n          try {\n            setUpdating(true);\n            setError(null);\n            \n            const response = await fetch('/api/polls', {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify(poll),\n            });\n            \n            if (!response.ok) {\n              throw new Error('Failed to create poll');\n            }\n            \n            const newPoll = await response.json();\n            \n            set((state) => ({\n              polls: [newPoll, ...state.polls],\n              filteredPolls: [newPoll, ...state.filteredPolls],\n            }));\n            \n            logger.info('Poll created successfully', {\n              pollId: newPoll.id,\n              title: newPoll.title\n            });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to create poll:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setUpdating(false);\n          }\n        },\n        \n        updatePollSettings: async (id, settings) => {\n          const { setUpdating, setError } = get();\n          \n          try {\n            setUpdating(true);\n            setError(null);\n            \n            const response = await fetch(`/api/polls/${id}/settings`, {\n              method: 'PUT',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify(settings),\n            });\n            \n            if (!response.ok) {\n              throw new Error('Failed to update poll settings');\n            }\n            \n            set((state) => ({\n              polls: state.polls.map(poll =>\n                poll.id === id \n                  ? { \n                      ...poll,\n                      settings: { ...poll.settings, ...settings },\n                      timestamps: { \n                        ...poll.timestamps,\n                        updatedAt: new Date().toISOString()\n                      }\n                    }\n                  : poll\n              ),\n              filteredPolls: state.filteredPolls.map(poll =>\n                poll.id === id \n                  ? { \n                      ...poll,\n                      settings: { ...poll.settings, ...settings },\n                      timestamps: { \n                        ...poll.timestamps,\n                        updatedAt: new Date().toISOString()\n                      }\n                    }\n                  : poll\n              ),\n            }));\n            \n            logger.info('Poll settings updated', { id });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to update poll settings:', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setUpdating(false);\n          }\n        },\n        \n        // Loading state actions\n        setLoading: (loading) => set({ isLoading: loading }),\n        setSearching: (searching) => set({ isSearching: searching }),\n        setVoting: (voting) => set({ isVoting: voting }),\n        setUpdating: (updating) => set({ isUpdating: updating }),\n        setError: (error) => set({ error }),\n        clearError: () => set({ error: null }),\n      }),\n      {\n        name: 'polls-store',\n        partialize: (state) => ({\n          polls: state.polls,\n          comments: state.comments,\n          preferences: state.preferences,\n          filters: state.filters,\n          currentView: state.currentView,\n        }),\n      }\n    ),\n    { name: 'polls-store' }\n  )\n);\n\n// Store selectors for optimized re-renders\nexport const usePolls = () => usePollsStore(state => state.polls);\nexport const useFilteredPolls = () => usePollsStore(state => state.filteredPolls);\nexport const usePollComments = () => usePollsStore(state => state.comments);\nexport const usePollSearch = () => usePollsStore(state => state.search);\nexport const useSelectedPoll = () => usePollsStore(state => state.selectedPoll);\nexport const usePollPreferences = () => usePollsStore(state => state.preferences);\nexport const usePollFilters = () => usePollsStore(state => state.filters);\nexport const usePollsLoading = () => usePollsStore(state => state.isLoading);\nexport const usePollsError = () => usePollsStore(state => state.error);\n\n// Action selectors\nexport const usePollsActions = () => usePollsStore(state => ({\n  setPolls: state.setPolls,\n  addPoll: state.addPoll,\n  updatePoll: state.updatePoll,\n  removePoll: state.removePoll,\n  publishPoll: state.publishPoll,\n  closePoll: state.closePoll,\n  archivePoll: state.archivePoll,\n  voteOnPoll: state.voteOnPoll,\n  undoVote: state.undoVote,\n  changeVote: state.changeVote,\n  setComments: state.setComments,\n  addComment: state.addComment,\n  updateComment: state.updateComment,\n  removeComment: state.removeComment,\n  likeComment: state.likeComment,\n  unlikeComment: state.unlikeComment,\n  setFilters: state.setFilters,\n  clearFilters: state.clearFilters,\n  searchPolls: state.searchPolls,\n  setSearchQuery: state.setSearchQuery,\n  clearSearch: state.clearSearch,\n  setSelectedPoll: state.setSelectedPoll,\n  setCurrentView: state.setCurrentView,\n  setSelectedCategory: state.setSelectedCategory,\n  updatePreferences: state.updatePreferences,\n  resetPreferences: state.resetPreferences,\n  loadPolls: state.loadPolls,\n  loadPoll: state.loadPoll,\n  loadComments: state.loadComments,\n  createPoll: state.createPoll,\n  updatePollSettings: state.updatePollSettings,\n  setLoading: state.setLoading,\n  setSearching: state.setSearching,\n  setVoting: state.setVoting,\n  setUpdating: state.setUpdating,\n  setError: state.setError,\n  clearError: state.clearError,\n}));\n\n// Computed selectors\nexport const usePollsStats = () => usePollsStore(state => ({\n  totalPolls: state.polls.length,\n  filteredPolls: state.filteredPolls.length,\n  activePolls: state.polls.filter(poll => poll.status === 'active').length,\n  closedPolls: state.polls.filter(poll => poll.status === 'closed').length,\n  userVotedPolls: state.polls.filter(poll => poll.voting.hasVoted).length,\n  searchResults: state.search.results.length,\n  isLoading: state.isLoading,\n  isVoting: state.isVoting,\n  error: state.error,\n}));\n\nexport const useUserVotedPolls = () => usePollsStore(state => \n  state.polls.filter(poll => poll.voting.hasVoted)\n);\n\nexport const useActivePolls = () => usePollsStore(state => \n  state.polls.filter(poll => poll.status === 'active')\n);\n\nexport const usePollCommentsByPollId = (pollId: string) => usePollsStore(state => \n  state.comments.filter(comment => comment.pollId === pollId)\n);\n\n// Store utilities\nexport const pollsStoreUtils = {\n  /**\n   * Get polls summary\n   */\n  getPollsSummary: () => {\n    const state = usePollsStore.getState();\n    return {\n      totalPolls: state.polls.length,\n      filteredPolls: state.filteredPolls.length,\n      comments: state.comments.length,\n      searchResults: state.search.results.length,\n      preferences: state.preferences,\n    };\n  },\n  \n  /**\n   * Get polls by status\n   */\n  getPollsByStatus: (status: string) => {\n    const state = usePollsStore.getState();\n    return state.polls.filter(poll => poll.status === status);\n  },\n  \n  /**\n   * Get polls by category\n   */\n  getPollsByCategory: (category: string) => {\n    const state = usePollsStore.getState();\n    return state.polls.filter(poll => poll.category === category);\n  },\n  \n  /**\n   * Get trending polls\n   */\n  getTrendingPolls: () => {\n    const state = usePollsStore.getState();\n    return state.polls\n      .filter(poll => poll.status === 'active')\n      .sort((a, b) => b.voting.totalVotes - a.voting.totalVotes)\n      .slice(0, 10);\n  },\n  \n  /**\n   * Get recent polls\n   */\n  getRecentPolls: (limit: number = 10) => {\n    const state = usePollsStore.getState();\n    return state.polls\n      .sort((a, b) => new Date(b.timestamps.createdAt).getTime() - new Date(a.timestamps.createdAt).getTime())\n      .slice(0, limit);\n  }\n};\n\n// Store subscriptions for external integrations\nexport const pollsStoreSubscriptions = {\n  /**\n   * Subscribe to polls changes\n   */\n  onPollsChange: (callback: (polls: Poll[]) => void) => {\n    let prevPolls: Poll[] | null = null;\n    return usePollsStore.subscribe(\n      (state) => {\n        const polls = state.polls;\n        if (polls !== prevPolls) {\n          callback(polls);\n        }\n        prevPolls = polls;\n        return polls;\n      }\n    );\n  },\n  \n  /**\n   * Subscribe to voting changes\n   */\n  onVotingChange: (callback: (poll: Poll) => void) => {\n    let prevPoll: Poll | null = null;\n    return usePollsStore.subscribe(\n      (state) => {\n        const poll = state.selectedPoll;\n        if (poll !== prevPoll && poll?.voting) {\n          callback(poll);\n        }\n        prevPoll = poll;\n        return poll;\n      }\n    );\n  },\n  \n  /**\n   * Subscribe to comments changes\n   */\n  onCommentsChange: (callback: (comments: PollComment[]) => void) => {\n    let prevComments: PollComment[] | null = null;\n    return usePollsStore.subscribe(\n      (state) => {\n        const comments = state.comments;\n        if (comments !== prevComments) {\n          callback(comments);\n        }\n        prevComments = comments;\n        return comments;\n      }\n    );\n  }\n};\n\n// Store debugging utilities\nexport const pollsStoreDebug = {\n  /**\n   * Log current polls state\n   */\n  logState: () => {\n    const state = usePollsStore.getState();\n    logger.debug('Polls Store State', {\n      totalPolls: state.polls.length,\n      filteredPolls: state.filteredPolls.length,\n      comments: state.comments.length,\n      searchResults: state.search.results.length,\n      selectedPoll: state.selectedPoll?.title || 'none',\n      currentView: state.currentView,\n      isLoading: state.isLoading,\n      isVoting: state.isVoting,\n      error: state.error\n    });\n  },\n  \n  /**\n   * Log polls summary\n   */\n  logSummary: () => {\n    const summary = pollsStoreUtils.getPollsSummary();\n    logger.debug('Polls Summary', summary);\n  },\n  \n  /**\n   * Log polls by status\n   */\n  logPollsByStatus: () => {\n    const state = usePollsStore.getState();\n    const byStatus = state.polls.reduce((acc, poll) => {\n      acc[poll.status] = (acc[poll.status] || 0) + 1;\n      return acc;\n    }, {} as Record<string, number>);\n    logger.debug('Polls by Status', byStatus);\n  },\n  \n  /**\n   * Reset polls store\n   */\n  reset: () => {\n    usePollsStore.getState().clearFilters();\n    usePollsStore.getState().resetPreferences();\n    logger.info('Polls store reset');\n  }\n};\n"],"names":["pollsStoreDebug","pollsStoreSubscriptions","pollsStoreUtils","useActivePolls","useFilteredPolls","usePollComments","usePollCommentsByPollId","usePollFilters","usePollPreferences","usePollSearch","usePolls","usePollsActions","usePollsError","usePollsLoading","usePollsStats","usePollsStore","useSelectedPoll","useUserVotedPolls","defaultPreferences","defaultView","sortBy","itemsPerPage","showResults","autoRefresh","refreshInterval","notifications","newPolls","pollUpdates","pollCloses","pollResults","privacy","showVoteHistory","showPollParticipation","shareActivity","voting","confirmVotes","showProgress","allowUndo","undoTimeLimit","defaultFilters","status","category","tags","author","dateRange","start","end","votingStatus","visibility","create","devtools","persist","set","get","polls","filteredPolls","comments","search","query","results","totalResults","currentPage","totalPages","filters","suggestions","recentSearches","selectedPoll","currentView","selectedCategory","preferences","isLoading","isSearching","isVoting","isUpdating","error","setPolls","addPoll","poll","state","updatePoll","id","updates","map","removePoll","filter","publishPoll","timestamps","publishedAt","Date","toISOString","updatedAt","closePoll","closesAt","archivePoll","voteOnPoll","pollId","optionId","setVoting","setError","response","fetch","method","headers","body","JSON","stringify","ok","Error","userVote","userVotedAt","hasVoted","totalVotes","optionResults","result","votes","logger","info","errorMessage","message","undoVote","find","p","undefined","Math","max","changeVote","newOptionId","setComments","addComment","comment","now","random","toString","substr","createdAt","updateComment","removeComment","likeComment","userLiked","likes","unlikeComment","setFilters","newFilters","filtered","length","includes","some","tag","clearFilters","searchPolls","setSearching","json","total","ceil","setSearchQuery","clearSearch","setSelectedPoll","setCurrentView","view","setSelectedCategory","updatePreferences","resetPreferences","loadPolls","setLoading","count","loadPoll","loadComments","createPoll","setUpdating","newPoll","title","updatePollSettings","settings","loading","searching","updating","clearError","name","partialize","totalPolls","activePolls","closedPolls","userVotedPolls","searchResults","getPollsSummary","getState","getPollsByStatus","getPollsByCategory","getTrendingPolls","sort","a","b","slice","getRecentPolls","limit","getTime","onPollsChange","callback","prevPolls","subscribe","onVotingChange","prevPoll","onCommentsChange","prevComments","logState","debug","logSummary","summary","logPollsByStatus","byStatus","reduce","acc","reset"],"mappings":"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"}