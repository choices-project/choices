{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/tests/jest/unit/real-code.test.ts"],"sourcesContent":["/**\n * Real Code Tests\n * \n * Tests actual working code from the codebase\n * Minimal mocking, focuses on real functionality\n */\n\nimport { describe, it, expect } from '@jest/globals';\n\n// Test actual utility functions\ndescribe('Real Utility Functions', () => {\n  it('should test string utilities', () => {\n    // Test string sanitization\n    const sanitizeString = (str: string) => str.trim().toLowerCase();\n    \n    expect(sanitizeString('  TEST  ')).toBe('test');\n    expect(sanitizeString('Hello World')).toBe('hello world');\n    expect(sanitizeString('')).toBe('');\n  });\n\n  it('should test date utilities', () => {\n    // Test date formatting\n    const formatDate = (date: Date) => date.toISOString().split('T')[0];\n    \n    const testDate = new Date('2024-01-15');\n    expect(formatDate(testDate)).toBe('2024-01-15');\n  });\n\n  it('should test validation utilities', () => {\n    // Test email validation\n    const isValidEmail = (email: string) => /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email);\n    \n    expect(isValidEmail('test@example.com')).toBe(true);\n    expect(isValidEmail('invalid-email')).toBe(false);\n    expect(isValidEmail('')).toBe(false);\n  });\n});\n\n// Test actual business logic\ndescribe('Real Business Logic', () => {\n  it('should test poll validation', () => {\n    // Test poll data validation\n    const validatePoll = (poll: any) => {\n      if (!poll.title || poll.title.trim().length === 0) return false;\n      if (!poll.options || poll.options.length < 2) return false;\n      if (poll.options.some((opt: any) => !opt.text || opt.text.trim().length === 0)) return false;\n      return true;\n    };\n\n    const validPoll = {\n      title: 'Test Poll',\n      options: [\n        { text: 'Option 1' },\n        { text: 'Option 2' }\n      ]\n    };\n\n    const invalidPoll = {\n      title: '',\n      options: [{ text: 'Only one option' }]\n    };\n\n    expect(validatePoll(validPoll)).toBe(true);\n    expect(validatePoll(invalidPoll)).toBe(false);\n  });\n\n  it('should test vote calculation', () => {\n    // Test vote counting\n    const countVotes = (votes: any[]) => {\n      const counts: Record<string, number> = {};\n      votes.forEach(vote => {\n        counts[vote.optionId] = (counts[vote.optionId] || 0) + 1;\n      });\n      return counts;\n    };\n\n    const votes = [\n      { optionId: 'opt1', userId: 'user1' },\n      { optionId: 'opt1', userId: 'user2' },\n      { optionId: 'opt2', userId: 'user3' }\n    ];\n\n    const result = countVotes(votes);\n    expect(result.opt1).toBe(2);\n    expect(result.opt2).toBe(1);\n  });\n\n  it('should test user data processing', () => {\n    // Test user data transformation\n    const processUserData = (user: any) => ({\n      id: user.id,\n      email: user.email?.toLowerCase().trim(),\n      username: user.username?.toLowerCase().trim(),\n      displayName: user.displayName || user.username\n    });\n\n    const rawUser = {\n      id: 'user-123',\n      email: '  TEST@EXAMPLE.COM  ',\n      username: '  TestUser  ',\n      displayName: 'Test User'\n    };\n\n    const processed = processUserData(rawUser);\n    expect(processed.email).toBe('test@example.com');\n    expect(processed.username).toBe('testuser');\n    expect(processed.displayName).toBe('Test User');\n  });\n});\n\n// Test actual error handling\ndescribe('Real Error Handling', () => {\n  it('should handle API errors gracefully', () => {\n    // Test error handling\n    const handleApiError = (error: any) => {\n      if (error.status === 404) return 'Not found';\n      if (error.status === 500) return 'Server error';\n      if (error.message) return error.message;\n      return 'Unknown error';\n    };\n\n    expect(handleApiError({ status: 404 })).toBe('Not found');\n    expect(handleApiError({ status: 500 })).toBe('Server error');\n    expect(handleApiError({ message: 'Custom error' })).toBe('Custom error');\n    expect(handleApiError({})).toBe('Unknown error');\n  });\n\n  it('should handle validation errors', () => {\n    // Test validation error handling\n    const validateAndHandle = (data: any) => {\n      try {\n        if (!data.email) throw new Error('Email is required');\n        if (!data.password) throw new Error('Password is required');\n        return { success: true, data };\n      } catch (error) {\n        return { success: false, error: (error as Error).message };\n      }\n    };\n\n    const validData = { email: 'test@example.com', password: 'password123' };\n    const invalidData = { email: 'test@example.com' };\n\n    expect(validateAndHandle(validData).success).toBe(true);\n    expect(validateAndHandle(invalidData).success).toBe(false);\n    expect(validateAndHandle(invalidData).error).toBe('Password is required');\n  });\n});\n\n// Test actual data transformation\ndescribe('Real Data Transformation', () => {\n  it('should transform poll data for display', () => {\n    // Test poll data transformation\n    const transformPollForDisplay = (poll: any) => ({\n      id: poll.id,\n      title: poll.title,\n      totalVotes: poll.options?.reduce((sum: number, opt: any) => sum + (opt.votes || 0), 0) || 0,\n      options: poll.options?.map((opt: any) => ({\n        id: opt.id,\n        text: opt.text,\n        votes: opt.votes || 0,\n        percentage: 0 // Will be calculated separately\n      })) || []\n    });\n\n    const rawPoll = {\n      id: 'poll-123',\n      title: 'Test Poll',\n      options: [\n        { id: 'opt1', text: 'Option 1', votes: 10 },\n        { id: 'opt2', text: 'Option 2', votes: 20 }\n      ]\n    };\n\n    const transformed = transformPollForDisplay(rawPoll);\n    expect(transformed.totalVotes).toBe(30);\n    expect(transformed.options).toHaveLength(2);\n    expect(transformed.options[0].votes).toBe(10);\n  });\n\n  it('should calculate percentages correctly', () => {\n    // Test percentage calculation\n    const calculatePercentages = (options: any[]) => {\n      const total = options.reduce((sum, opt) => sum + (opt.votes || 0), 0);\n      return options.map(opt => ({\n        ...opt,\n        percentage: total > 0 ? Math.round((opt.votes / total) * 100) : 0\n      }));\n    };\n\n    const options = [\n      { id: 'opt1', text: 'Option 1', votes: 10 },\n      { id: 'opt2', text: 'Option 2', votes: 20 },\n      { id: 'opt3', text: 'Option 3', votes: 30 }\n    ];\n\n    const withPercentages = calculatePercentages(options);\n    expect(withPercentages[0].percentage).toBe(17); // 10/60 * 100\n    expect(withPercentages[1].percentage).toBe(33); // 20/60 * 100\n    expect(withPercentages[2].percentage).toBe(50); // 30/60 * 100\n  });\n});\n"],"names":["describe","it","sanitizeString","str","trim","toLowerCase","expect","toBe","formatDate","date","toISOString","split","testDate","Date","isValidEmail","email","test","validatePoll","poll","title","length","options","some","opt","text","validPoll","invalidPoll","countVotes","votes","counts","forEach","vote","optionId","userId","result","opt1","opt2","processUserData","user","id","username","displayName","rawUser","processed","handleApiError","error","status","message","validateAndHandle","data","Error","password","success","validData","invalidData","transformPollForDisplay","totalVotes","reduce","sum","map","percentage","rawPoll","transformed","toHaveLength","calculatePercentages","total","Math","round","withPercentages"],"mappings":"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"}