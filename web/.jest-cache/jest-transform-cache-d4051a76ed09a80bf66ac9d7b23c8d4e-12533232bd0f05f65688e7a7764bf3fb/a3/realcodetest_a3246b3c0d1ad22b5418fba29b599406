7ca54e59e1acf40d2cb6e8a583ca209b
/**
 * Real Code Tests
 * 
 * Tests actual working code from the codebase
 * Minimal mocking, focuses on real functionality
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _globals = require("@jest/globals");
// Test actual utility functions
(0, _globals.describe)('Real Utility Functions', ()=>{
    (0, _globals.it)('should test string utilities', ()=>{
        // Test string sanitization
        const sanitizeString = (str)=>str.trim().toLowerCase();
        (0, _globals.expect)(sanitizeString('  TEST  ')).toBe('test');
        (0, _globals.expect)(sanitizeString('Hello World')).toBe('hello world');
        (0, _globals.expect)(sanitizeString('')).toBe('');
    });
    (0, _globals.it)('should test date utilities', ()=>{
        // Test date formatting
        const formatDate = (date)=>date.toISOString().split('T')[0];
        const testDate = new Date('2024-01-15');
        (0, _globals.expect)(formatDate(testDate)).toBe('2024-01-15');
    });
    (0, _globals.it)('should test validation utilities', ()=>{
        // Test email validation
        const isValidEmail = (email)=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        (0, _globals.expect)(isValidEmail('test@example.com')).toBe(true);
        (0, _globals.expect)(isValidEmail('invalid-email')).toBe(false);
        (0, _globals.expect)(isValidEmail('')).toBe(false);
    });
});
// Test actual business logic
(0, _globals.describe)('Real Business Logic', ()=>{
    (0, _globals.it)('should test poll validation', ()=>{
        // Test poll data validation
        const validatePoll = (poll)=>{
            if (!poll.title || poll.title.trim().length === 0) return false;
            if (!poll.options || poll.options.length < 2) return false;
            if (poll.options.some((opt)=>!opt.text || opt.text.trim().length === 0)) return false;
            return true;
        };
        const validPoll = {
            title: 'Test Poll',
            options: [
                {
                    text: 'Option 1'
                },
                {
                    text: 'Option 2'
                }
            ]
        };
        const invalidPoll = {
            title: '',
            options: [
                {
                    text: 'Only one option'
                }
            ]
        };
        (0, _globals.expect)(validatePoll(validPoll)).toBe(true);
        (0, _globals.expect)(validatePoll(invalidPoll)).toBe(false);
    });
    (0, _globals.it)('should test vote calculation', ()=>{
        // Test vote counting
        const countVotes = (votes)=>{
            const counts = {};
            votes.forEach((vote)=>{
                counts[vote.optionId] = (counts[vote.optionId] || 0) + 1;
            });
            return counts;
        };
        const votes = [
            {
                optionId: 'opt1',
                userId: 'user1'
            },
            {
                optionId: 'opt1',
                userId: 'user2'
            },
            {
                optionId: 'opt2',
                userId: 'user3'
            }
        ];
        const result = countVotes(votes);
        (0, _globals.expect)(result.opt1).toBe(2);
        (0, _globals.expect)(result.opt2).toBe(1);
    });
    (0, _globals.it)('should test user data processing', ()=>{
        // Test user data transformation
        const processUserData = (user)=>({
                id: user.id,
                email: user.email?.toLowerCase().trim(),
                username: user.username?.toLowerCase().trim(),
                displayName: user.displayName || user.username
            });
        const rawUser = {
            id: 'user-123',
            email: '  TEST@EXAMPLE.COM  ',
            username: '  TestUser  ',
            displayName: 'Test User'
        };
        const processed = processUserData(rawUser);
        (0, _globals.expect)(processed.email).toBe('test@example.com');
        (0, _globals.expect)(processed.username).toBe('testuser');
        (0, _globals.expect)(processed.displayName).toBe('Test User');
    });
});
// Test actual error handling
(0, _globals.describe)('Real Error Handling', ()=>{
    (0, _globals.it)('should handle API errors gracefully', ()=>{
        // Test error handling
        const handleApiError = (error)=>{
            if (error.status === 404) return 'Not found';
            if (error.status === 500) return 'Server error';
            if (error.message) return error.message;
            return 'Unknown error';
        };
        (0, _globals.expect)(handleApiError({
            status: 404
        })).toBe('Not found');
        (0, _globals.expect)(handleApiError({
            status: 500
        })).toBe('Server error');
        (0, _globals.expect)(handleApiError({
            message: 'Custom error'
        })).toBe('Custom error');
        (0, _globals.expect)(handleApiError({})).toBe('Unknown error');
    });
    (0, _globals.it)('should handle validation errors', ()=>{
        // Test validation error handling
        const validateAndHandle = (data)=>{
            try {
                if (!data.email) throw new Error('Email is required');
                if (!data.password) throw new Error('Password is required');
                return {
                    success: true,
                    data
                };
            } catch (error) {
                return {
                    success: false,
                    error: error.message
                };
            }
        };
        const validData = {
            email: 'test@example.com',
            password: 'password123'
        };
        const invalidData = {
            email: 'test@example.com'
        };
        (0, _globals.expect)(validateAndHandle(validData).success).toBe(true);
        (0, _globals.expect)(validateAndHandle(invalidData).success).toBe(false);
        (0, _globals.expect)(validateAndHandle(invalidData).error).toBe('Password is required');
    });
});
// Test actual data transformation
(0, _globals.describe)('Real Data Transformation', ()=>{
    (0, _globals.it)('should transform poll data for display', ()=>{
        // Test poll data transformation
        const transformPollForDisplay = (poll)=>({
                id: poll.id,
                title: poll.title,
                totalVotes: poll.options?.reduce((sum, opt)=>sum + (opt.votes || 0), 0) || 0,
                options: poll.options?.map((opt)=>({
                        id: opt.id,
                        text: opt.text,
                        votes: opt.votes || 0,
                        percentage: 0 // Will be calculated separately
                    })) || []
            });
        const rawPoll = {
            id: 'poll-123',
            title: 'Test Poll',
            options: [
                {
                    id: 'opt1',
                    text: 'Option 1',
                    votes: 10
                },
                {
                    id: 'opt2',
                    text: 'Option 2',
                    votes: 20
                }
            ]
        };
        const transformed = transformPollForDisplay(rawPoll);
        (0, _globals.expect)(transformed.totalVotes).toBe(30);
        (0, _globals.expect)(transformed.options).toHaveLength(2);
        (0, _globals.expect)(transformed.options[0].votes).toBe(10);
    });
    (0, _globals.it)('should calculate percentages correctly', ()=>{
        // Test percentage calculation
        const calculatePercentages = (options)=>{
            const total = options.reduce((sum, opt)=>sum + (opt.votes || 0), 0);
            return options.map((opt)=>({
                    ...opt,
                    percentage: total > 0 ? Math.round(opt.votes / total * 100) : 0
                }));
        };
        const options = [
            {
                id: 'opt1',
                text: 'Option 1',
                votes: 10
            },
            {
                id: 'opt2',
                text: 'Option 2',
                votes: 20
            },
            {
                id: 'opt3',
                text: 'Option 3',
                votes: 30
            }
        ];
        const withPercentages = calculatePercentages(options);
        (0, _globals.expect)(withPercentages[0].percentage).toBe(17); // 10/60 * 100
        (0, _globals.expect)(withPercentages[1].percentage).toBe(33); // 20/60 * 100
        (0, _globals.expect)(withPercentages[2].percentage).toBe(50); // 30/60 * 100
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hbGF1Z2hpbmdraXRzdW5lL3NyYy9DaG9pY2VzL3dlYi90ZXN0cy9qZXN0L3VuaXQvcmVhbC1jb2RlLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBSZWFsIENvZGUgVGVzdHNcbiAqIFxuICogVGVzdHMgYWN0dWFsIHdvcmtpbmcgY29kZSBmcm9tIHRoZSBjb2RlYmFzZVxuICogTWluaW1hbCBtb2NraW5nLCBmb2N1c2VzIG9uIHJlYWwgZnVuY3Rpb25hbGl0eVxuICovXG5cbmltcG9ydCB7IGRlc2NyaWJlLCBpdCwgZXhwZWN0IH0gZnJvbSAnQGplc3QvZ2xvYmFscyc7XG5cbi8vIFRlc3QgYWN0dWFsIHV0aWxpdHkgZnVuY3Rpb25zXG5kZXNjcmliZSgnUmVhbCBVdGlsaXR5IEZ1bmN0aW9ucycsICgpID0+IHtcbiAgaXQoJ3Nob3VsZCB0ZXN0IHN0cmluZyB1dGlsaXRpZXMnLCAoKSA9PiB7XG4gICAgLy8gVGVzdCBzdHJpbmcgc2FuaXRpemF0aW9uXG4gICAgY29uc3Qgc2FuaXRpemVTdHJpbmcgPSAoc3RyOiBzdHJpbmcpID0+IHN0ci50cmltKCkudG9Mb3dlckNhc2UoKTtcbiAgICBcbiAgICBleHBlY3Qoc2FuaXRpemVTdHJpbmcoJyAgVEVTVCAgJykpLnRvQmUoJ3Rlc3QnKTtcbiAgICBleHBlY3Qoc2FuaXRpemVTdHJpbmcoJ0hlbGxvIFdvcmxkJykpLnRvQmUoJ2hlbGxvIHdvcmxkJyk7XG4gICAgZXhwZWN0KHNhbml0aXplU3RyaW5nKCcnKSkudG9CZSgnJyk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgdGVzdCBkYXRlIHV0aWxpdGllcycsICgpID0+IHtcbiAgICAvLyBUZXN0IGRhdGUgZm9ybWF0dGluZ1xuICAgIGNvbnN0IGZvcm1hdERhdGUgPSAoZGF0ZTogRGF0ZSkgPT4gZGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XG4gICAgXG4gICAgY29uc3QgdGVzdERhdGUgPSBuZXcgRGF0ZSgnMjAyNC0wMS0xNScpO1xuICAgIGV4cGVjdChmb3JtYXREYXRlKHRlc3REYXRlKSkudG9CZSgnMjAyNC0wMS0xNScpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHRlc3QgdmFsaWRhdGlvbiB1dGlsaXRpZXMnLCAoKSA9PiB7XG4gICAgLy8gVGVzdCBlbWFpbCB2YWxpZGF0aW9uXG4gICAgY29uc3QgaXNWYWxpZEVtYWlsID0gKGVtYWlsOiBzdHJpbmcpID0+IC9eW15cXHNAXStAW15cXHNAXStcXC5bXlxcc0BdKyQvLnRlc3QoZW1haWwpO1xuICAgIFxuICAgIGV4cGVjdChpc1ZhbGlkRW1haWwoJ3Rlc3RAZXhhbXBsZS5jb20nKSkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QoaXNWYWxpZEVtYWlsKCdpbnZhbGlkLWVtYWlsJykpLnRvQmUoZmFsc2UpO1xuICAgIGV4cGVjdChpc1ZhbGlkRW1haWwoJycpKS50b0JlKGZhbHNlKTtcbiAgfSk7XG59KTtcblxuLy8gVGVzdCBhY3R1YWwgYnVzaW5lc3MgbG9naWNcbmRlc2NyaWJlKCdSZWFsIEJ1c2luZXNzIExvZ2ljJywgKCkgPT4ge1xuICBpdCgnc2hvdWxkIHRlc3QgcG9sbCB2YWxpZGF0aW9uJywgKCkgPT4ge1xuICAgIC8vIFRlc3QgcG9sbCBkYXRhIHZhbGlkYXRpb25cbiAgICBjb25zdCB2YWxpZGF0ZVBvbGwgPSAocG9sbDogYW55KSA9PiB7XG4gICAgICBpZiAoIXBvbGwudGl0bGUgfHwgcG9sbC50aXRsZS50cmltKCkubGVuZ3RoID09PSAwKSByZXR1cm4gZmFsc2U7XG4gICAgICBpZiAoIXBvbGwub3B0aW9ucyB8fCBwb2xsLm9wdGlvbnMubGVuZ3RoIDwgMikgcmV0dXJuIGZhbHNlO1xuICAgICAgaWYgKHBvbGwub3B0aW9ucy5zb21lKChvcHQ6IGFueSkgPT4gIW9wdC50ZXh0IHx8IG9wdC50ZXh0LnRyaW0oKS5sZW5ndGggPT09IDApKSByZXR1cm4gZmFsc2U7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuXG4gICAgY29uc3QgdmFsaWRQb2xsID0ge1xuICAgICAgdGl0bGU6ICdUZXN0IFBvbGwnLFxuICAgICAgb3B0aW9uczogW1xuICAgICAgICB7IHRleHQ6ICdPcHRpb24gMScgfSxcbiAgICAgICAgeyB0ZXh0OiAnT3B0aW9uIDInIH1cbiAgICAgIF1cbiAgICB9O1xuXG4gICAgY29uc3QgaW52YWxpZFBvbGwgPSB7XG4gICAgICB0aXRsZTogJycsXG4gICAgICBvcHRpb25zOiBbeyB0ZXh0OiAnT25seSBvbmUgb3B0aW9uJyB9XVxuICAgIH07XG5cbiAgICBleHBlY3QodmFsaWRhdGVQb2xsKHZhbGlkUG9sbCkpLnRvQmUodHJ1ZSk7XG4gICAgZXhwZWN0KHZhbGlkYXRlUG9sbChpbnZhbGlkUG9sbCkpLnRvQmUoZmFsc2UpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHRlc3Qgdm90ZSBjYWxjdWxhdGlvbicsICgpID0+IHtcbiAgICAvLyBUZXN0IHZvdGUgY291bnRpbmdcbiAgICBjb25zdCBjb3VudFZvdGVzID0gKHZvdGVzOiBhbnlbXSkgPT4ge1xuICAgICAgY29uc3QgY291bnRzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XG4gICAgICB2b3Rlcy5mb3JFYWNoKHZvdGUgPT4ge1xuICAgICAgICBjb3VudHNbdm90ZS5vcHRpb25JZF0gPSAoY291bnRzW3ZvdGUub3B0aW9uSWRdIHx8IDApICsgMTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGNvdW50cztcbiAgICB9O1xuXG4gICAgY29uc3Qgdm90ZXMgPSBbXG4gICAgICB7IG9wdGlvbklkOiAnb3B0MScsIHVzZXJJZDogJ3VzZXIxJyB9LFxuICAgICAgeyBvcHRpb25JZDogJ29wdDEnLCB1c2VySWQ6ICd1c2VyMicgfSxcbiAgICAgIHsgb3B0aW9uSWQ6ICdvcHQyJywgdXNlcklkOiAndXNlcjMnIH1cbiAgICBdO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gY291bnRWb3Rlcyh2b3Rlcyk7XG4gICAgZXhwZWN0KHJlc3VsdC5vcHQxKS50b0JlKDIpO1xuICAgIGV4cGVjdChyZXN1bHQub3B0MikudG9CZSgxKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCB0ZXN0IHVzZXIgZGF0YSBwcm9jZXNzaW5nJywgKCkgPT4ge1xuICAgIC8vIFRlc3QgdXNlciBkYXRhIHRyYW5zZm9ybWF0aW9uXG4gICAgY29uc3QgcHJvY2Vzc1VzZXJEYXRhID0gKHVzZXI6IGFueSkgPT4gKHtcbiAgICAgIGlkOiB1c2VyLmlkLFxuICAgICAgZW1haWw6IHVzZXIuZW1haWw/LnRvTG93ZXJDYXNlKCkudHJpbSgpLFxuICAgICAgdXNlcm5hbWU6IHVzZXIudXNlcm5hbWU/LnRvTG93ZXJDYXNlKCkudHJpbSgpLFxuICAgICAgZGlzcGxheU5hbWU6IHVzZXIuZGlzcGxheU5hbWUgfHwgdXNlci51c2VybmFtZVxuICAgIH0pO1xuXG4gICAgY29uc3QgcmF3VXNlciA9IHtcbiAgICAgIGlkOiAndXNlci0xMjMnLFxuICAgICAgZW1haWw6ICcgIFRFU1RARVhBTVBMRS5DT00gICcsXG4gICAgICB1c2VybmFtZTogJyAgVGVzdFVzZXIgICcsXG4gICAgICBkaXNwbGF5TmFtZTogJ1Rlc3QgVXNlcidcbiAgICB9O1xuXG4gICAgY29uc3QgcHJvY2Vzc2VkID0gcHJvY2Vzc1VzZXJEYXRhKHJhd1VzZXIpO1xuICAgIGV4cGVjdChwcm9jZXNzZWQuZW1haWwpLnRvQmUoJ3Rlc3RAZXhhbXBsZS5jb20nKTtcbiAgICBleHBlY3QocHJvY2Vzc2VkLnVzZXJuYW1lKS50b0JlKCd0ZXN0dXNlcicpO1xuICAgIGV4cGVjdChwcm9jZXNzZWQuZGlzcGxheU5hbWUpLnRvQmUoJ1Rlc3QgVXNlcicpO1xuICB9KTtcbn0pO1xuXG4vLyBUZXN0IGFjdHVhbCBlcnJvciBoYW5kbGluZ1xuZGVzY3JpYmUoJ1JlYWwgRXJyb3IgSGFuZGxpbmcnLCAoKSA9PiB7XG4gIGl0KCdzaG91bGQgaGFuZGxlIEFQSSBlcnJvcnMgZ3JhY2VmdWxseScsICgpID0+IHtcbiAgICAvLyBUZXN0IGVycm9yIGhhbmRsaW5nXG4gICAgY29uc3QgaGFuZGxlQXBpRXJyb3IgPSAoZXJyb3I6IGFueSkgPT4ge1xuICAgICAgaWYgKGVycm9yLnN0YXR1cyA9PT0gNDA0KSByZXR1cm4gJ05vdCBmb3VuZCc7XG4gICAgICBpZiAoZXJyb3Iuc3RhdHVzID09PSA1MDApIHJldHVybiAnU2VydmVyIGVycm9yJztcbiAgICAgIGlmIChlcnJvci5tZXNzYWdlKSByZXR1cm4gZXJyb3IubWVzc2FnZTtcbiAgICAgIHJldHVybiAnVW5rbm93biBlcnJvcic7XG4gICAgfTtcblxuICAgIGV4cGVjdChoYW5kbGVBcGlFcnJvcih7IHN0YXR1czogNDA0IH0pKS50b0JlKCdOb3QgZm91bmQnKTtcbiAgICBleHBlY3QoaGFuZGxlQXBpRXJyb3IoeyBzdGF0dXM6IDUwMCB9KSkudG9CZSgnU2VydmVyIGVycm9yJyk7XG4gICAgZXhwZWN0KGhhbmRsZUFwaUVycm9yKHsgbWVzc2FnZTogJ0N1c3RvbSBlcnJvcicgfSkpLnRvQmUoJ0N1c3RvbSBlcnJvcicpO1xuICAgIGV4cGVjdChoYW5kbGVBcGlFcnJvcih7fSkpLnRvQmUoJ1Vua25vd24gZXJyb3InKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBoYW5kbGUgdmFsaWRhdGlvbiBlcnJvcnMnLCAoKSA9PiB7XG4gICAgLy8gVGVzdCB2YWxpZGF0aW9uIGVycm9yIGhhbmRsaW5nXG4gICAgY29uc3QgdmFsaWRhdGVBbmRIYW5kbGUgPSAoZGF0YTogYW55KSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoIWRhdGEuZW1haWwpIHRocm93IG5ldyBFcnJvcignRW1haWwgaXMgcmVxdWlyZWQnKTtcbiAgICAgICAgaWYgKCFkYXRhLnBhc3N3b3JkKSB0aHJvdyBuZXcgRXJyb3IoJ1Bhc3N3b3JkIGlzIHJlcXVpcmVkJyk7XG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGEgfTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlIH07XG4gICAgICB9XG4gICAgfTtcblxuICAgIGNvbnN0IHZhbGlkRGF0YSA9IHsgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJywgcGFzc3dvcmQ6ICdwYXNzd29yZDEyMycgfTtcbiAgICBjb25zdCBpbnZhbGlkRGF0YSA9IHsgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyB9O1xuXG4gICAgZXhwZWN0KHZhbGlkYXRlQW5kSGFuZGxlKHZhbGlkRGF0YSkuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICBleHBlY3QodmFsaWRhdGVBbmRIYW5kbGUoaW52YWxpZERhdGEpLnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgIGV4cGVjdCh2YWxpZGF0ZUFuZEhhbmRsZShpbnZhbGlkRGF0YSkuZXJyb3IpLnRvQmUoJ1Bhc3N3b3JkIGlzIHJlcXVpcmVkJyk7XG4gIH0pO1xufSk7XG5cbi8vIFRlc3QgYWN0dWFsIGRhdGEgdHJhbnNmb3JtYXRpb25cbmRlc2NyaWJlKCdSZWFsIERhdGEgVHJhbnNmb3JtYXRpb24nLCAoKSA9PiB7XG4gIGl0KCdzaG91bGQgdHJhbnNmb3JtIHBvbGwgZGF0YSBmb3IgZGlzcGxheScsICgpID0+IHtcbiAgICAvLyBUZXN0IHBvbGwgZGF0YSB0cmFuc2Zvcm1hdGlvblxuICAgIGNvbnN0IHRyYW5zZm9ybVBvbGxGb3JEaXNwbGF5ID0gKHBvbGw6IGFueSkgPT4gKHtcbiAgICAgIGlkOiBwb2xsLmlkLFxuICAgICAgdGl0bGU6IHBvbGwudGl0bGUsXG4gICAgICB0b3RhbFZvdGVzOiBwb2xsLm9wdGlvbnM/LnJlZHVjZSgoc3VtOiBudW1iZXIsIG9wdDogYW55KSA9PiBzdW0gKyAob3B0LnZvdGVzIHx8IDApLCAwKSB8fCAwLFxuICAgICAgb3B0aW9uczogcG9sbC5vcHRpb25zPy5tYXAoKG9wdDogYW55KSA9PiAoe1xuICAgICAgICBpZDogb3B0LmlkLFxuICAgICAgICB0ZXh0OiBvcHQudGV4dCxcbiAgICAgICAgdm90ZXM6IG9wdC52b3RlcyB8fCAwLFxuICAgICAgICBwZXJjZW50YWdlOiAwIC8vIFdpbGwgYmUgY2FsY3VsYXRlZCBzZXBhcmF0ZWx5XG4gICAgICB9KSkgfHwgW11cbiAgICB9KTtcblxuICAgIGNvbnN0IHJhd1BvbGwgPSB7XG4gICAgICBpZDogJ3BvbGwtMTIzJyxcbiAgICAgIHRpdGxlOiAnVGVzdCBQb2xsJyxcbiAgICAgIG9wdGlvbnM6IFtcbiAgICAgICAgeyBpZDogJ29wdDEnLCB0ZXh0OiAnT3B0aW9uIDEnLCB2b3RlczogMTAgfSxcbiAgICAgICAgeyBpZDogJ29wdDInLCB0ZXh0OiAnT3B0aW9uIDInLCB2b3RlczogMjAgfVxuICAgICAgXVxuICAgIH07XG5cbiAgICBjb25zdCB0cmFuc2Zvcm1lZCA9IHRyYW5zZm9ybVBvbGxGb3JEaXNwbGF5KHJhd1BvbGwpO1xuICAgIGV4cGVjdCh0cmFuc2Zvcm1lZC50b3RhbFZvdGVzKS50b0JlKDMwKTtcbiAgICBleHBlY3QodHJhbnNmb3JtZWQub3B0aW9ucykudG9IYXZlTGVuZ3RoKDIpO1xuICAgIGV4cGVjdCh0cmFuc2Zvcm1lZC5vcHRpb25zWzBdLnZvdGVzKS50b0JlKDEwKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBjYWxjdWxhdGUgcGVyY2VudGFnZXMgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgIC8vIFRlc3QgcGVyY2VudGFnZSBjYWxjdWxhdGlvblxuICAgIGNvbnN0IGNhbGN1bGF0ZVBlcmNlbnRhZ2VzID0gKG9wdGlvbnM6IGFueVtdKSA9PiB7XG4gICAgICBjb25zdCB0b3RhbCA9IG9wdGlvbnMucmVkdWNlKChzdW0sIG9wdCkgPT4gc3VtICsgKG9wdC52b3RlcyB8fCAwKSwgMCk7XG4gICAgICByZXR1cm4gb3B0aW9ucy5tYXAob3B0ID0+ICh7XG4gICAgICAgIC4uLm9wdCxcbiAgICAgICAgcGVyY2VudGFnZTogdG90YWwgPiAwID8gTWF0aC5yb3VuZCgob3B0LnZvdGVzIC8gdG90YWwpICogMTAwKSA6IDBcbiAgICAgIH0pKTtcbiAgICB9O1xuXG4gICAgY29uc3Qgb3B0aW9ucyA9IFtcbiAgICAgIHsgaWQ6ICdvcHQxJywgdGV4dDogJ09wdGlvbiAxJywgdm90ZXM6IDEwIH0sXG4gICAgICB7IGlkOiAnb3B0MicsIHRleHQ6ICdPcHRpb24gMicsIHZvdGVzOiAyMCB9LFxuICAgICAgeyBpZDogJ29wdDMnLCB0ZXh0OiAnT3B0aW9uIDMnLCB2b3RlczogMzAgfVxuICAgIF07XG5cbiAgICBjb25zdCB3aXRoUGVyY2VudGFnZXMgPSBjYWxjdWxhdGVQZXJjZW50YWdlcyhvcHRpb25zKTtcbiAgICBleHBlY3Qod2l0aFBlcmNlbnRhZ2VzWzBdLnBlcmNlbnRhZ2UpLnRvQmUoMTcpOyAvLyAxMC82MCAqIDEwMFxuICAgIGV4cGVjdCh3aXRoUGVyY2VudGFnZXNbMV0ucGVyY2VudGFnZSkudG9CZSgzMyk7IC8vIDIwLzYwICogMTAwXG4gICAgZXhwZWN0KHdpdGhQZXJjZW50YWdlc1syXS5wZXJjZW50YWdlKS50b0JlKDUwKTsgLy8gMzAvNjAgKiAxMDBcbiAgfSk7XG59KTtcbiJdLCJuYW1lcyI6WyJkZXNjcmliZSIsIml0Iiwic2FuaXRpemVTdHJpbmciLCJzdHIiLCJ0cmltIiwidG9Mb3dlckNhc2UiLCJleHBlY3QiLCJ0b0JlIiwiZm9ybWF0RGF0ZSIsImRhdGUiLCJ0b0lTT1N0cmluZyIsInNwbGl0IiwidGVzdERhdGUiLCJEYXRlIiwiaXNWYWxpZEVtYWlsIiwiZW1haWwiLCJ0ZXN0IiwidmFsaWRhdGVQb2xsIiwicG9sbCIsInRpdGxlIiwibGVuZ3RoIiwib3B0aW9ucyIsInNvbWUiLCJvcHQiLCJ0ZXh0IiwidmFsaWRQb2xsIiwiaW52YWxpZFBvbGwiLCJjb3VudFZvdGVzIiwidm90ZXMiLCJjb3VudHMiLCJmb3JFYWNoIiwidm90ZSIsIm9wdGlvbklkIiwidXNlcklkIiwicmVzdWx0Iiwib3B0MSIsIm9wdDIiLCJwcm9jZXNzVXNlckRhdGEiLCJ1c2VyIiwiaWQiLCJ1c2VybmFtZSIsImRpc3BsYXlOYW1lIiwicmF3VXNlciIsInByb2Nlc3NlZCIsImhhbmRsZUFwaUVycm9yIiwiZXJyb3IiLCJzdGF0dXMiLCJtZXNzYWdlIiwidmFsaWRhdGVBbmRIYW5kbGUiLCJkYXRhIiwiRXJyb3IiLCJwYXNzd29yZCIsInN1Y2Nlc3MiLCJ2YWxpZERhdGEiLCJpbnZhbGlkRGF0YSIsInRyYW5zZm9ybVBvbGxGb3JEaXNwbGF5IiwidG90YWxWb3RlcyIsInJlZHVjZSIsInN1bSIsIm1hcCIsInBlcmNlbnRhZ2UiLCJyYXdQb2xsIiwidHJhbnNmb3JtZWQiLCJ0b0hhdmVMZW5ndGgiLCJjYWxjdWxhdGVQZXJjZW50YWdlcyIsInRvdGFsIiwiTWF0aCIsInJvdW5kIiwid2l0aFBlcmNlbnRhZ2VzIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Q0FLQzs7Ozt5QkFFb0M7QUFFckMsZ0NBQWdDO0FBQ2hDQSxJQUFBQSxpQkFBUSxFQUFDLDBCQUEwQjtJQUNqQ0MsSUFBQUEsV0FBRSxFQUFDLGdDQUFnQztRQUNqQywyQkFBMkI7UUFDM0IsTUFBTUMsaUJBQWlCLENBQUNDLE1BQWdCQSxJQUFJQyxJQUFJLEdBQUdDLFdBQVc7UUFFOURDLElBQUFBLGVBQU0sRUFBQ0osZUFBZSxhQUFhSyxJQUFJLENBQUM7UUFDeENELElBQUFBLGVBQU0sRUFBQ0osZUFBZSxnQkFBZ0JLLElBQUksQ0FBQztRQUMzQ0QsSUFBQUEsZUFBTSxFQUFDSixlQUFlLEtBQUtLLElBQUksQ0FBQztJQUNsQztJQUVBTixJQUFBQSxXQUFFLEVBQUMsOEJBQThCO1FBQy9CLHVCQUF1QjtRQUN2QixNQUFNTyxhQUFhLENBQUNDLE9BQWVBLEtBQUtDLFdBQVcsR0FBR0MsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFFO1FBRW5FLE1BQU1DLFdBQVcsSUFBSUMsS0FBSztRQUMxQlAsSUFBQUEsZUFBTSxFQUFDRSxXQUFXSSxXQUFXTCxJQUFJLENBQUM7SUFDcEM7SUFFQU4sSUFBQUEsV0FBRSxFQUFDLG9DQUFvQztRQUNyQyx3QkFBd0I7UUFDeEIsTUFBTWEsZUFBZSxDQUFDQyxRQUFr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