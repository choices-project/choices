{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/features/pwa/components/OfflineIndicator.tsx"],"sourcesContent":["'use client'\n\nimport { WifiOff, Wifi, AlertCircle, CheckCircle } from 'lucide-react'\nimport { useState, useEffect } from 'react'\n\nimport { usePWA } from '@/hooks/usePWA'\n\ninterface OfflineIndicatorProps {\n  showDetails?: boolean\n  className?: string\n}\n\nexport default function OfflineIndicator({ showDetails = false, className = '' }: OfflineIndicatorProps) {\n  const pwa = usePWA()\n  const [isOnline, setIsOnline] = useState(true)\n  const [_showIndicator, setShowIndicator] = useState(false)\n\n  useEffect(() => {\n    const handleOnline = () => {\n      setIsOnline(true)\n      setShowIndicator(false)\n    }\n    \n    const handleOffline = () => {\n      setIsOnline(false)\n      setShowIndicator(true)\n    }\n\n    // Set initial state (only on client side)\n    if (typeof window !== 'undefined') {\n      setIsOnline(navigator.onLine)\n      setShowIndicator(!navigator.onLine)\n\n      window.addEventListener('online', handleOnline)\n      window.addEventListener('offline', handleOffline)\n    }\n\n    return () => {\n      if (typeof window !== 'undefined') {\n        window.removeEventListener('online', handleOnline)\n        window.removeEventListener('offline', handleOffline)\n      }\n    }\n  }, [])\n\n  // Don't show if PWA is not enabled\n  if (!pwa.isEnabled || !pwa.isSupported) {\n    return null\n  }\n\n  // Don't show if online\n  if (isOnline && !showDetails) {\n    return null\n  }\n\n  const getStatusIcon = () => {\n    if (isOnline) {\n      return <Wifi className=\"w-5 h-5 text-green-500\" />\n    }\n    return <WifiOff className=\"w-5 h-5 text-red-500\" />\n  }\n\n  const getStatusText = () => {\n    if (isOnline) {\n      return 'You\\'re back online'\n    }\n    return 'You\\'re offline'\n  }\n\n  const getStatusColor = () => {\n    if (isOnline) {\n      return 'bg-green-50 border-green-200 text-green-800'\n    }\n    return 'bg-red-50 border-red-200 text-red-800'\n  }\n\n  if (!showDetails) {\n    return (\n      <div \n        className={`fixed top-4 left-4 right-4 z-50 ${getStatusColor()} border rounded-lg shadow-lg p-3 ${className}`}\n        data-testid=\"offline-indicator-main\"\n      >\n        <div className=\"flex items-center space-x-2\">\n          {getStatusIcon()}\n          <span className=\"text-sm font-medium\">\n            {getStatusText()}\n          </span>\n          {!isOnline && (\n            <span className=\"text-sm opacity-75\">\n              Votes will be stored and synced when you&apos;re back online.\n            </span>\n          )}\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className={`bg-white rounded-lg border border-gray-200 p-4 ${className}`} data-testid=\"offline-indicator\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <h3 className=\"text-lg font-semibold text-gray-900\">Connection Status</h3>\n        <div className=\"flex items-center space-x-2\">\n          {getStatusIcon()}\n          <span className={`text-sm font-medium ${isOnline ? 'text-green-600' : 'text-red-600'}`}>\n            {isOnline ? 'Online' : 'Offline'}\n          </span>\n        </div>\n      </div>\n\n      <div className=\"space-y-3\">\n        {/* Connection Status */}\n        <div className=\"flex items-center justify-between\" data-testid=\"connection-status\">\n          <div className=\"flex items-center space-x-2\">\n            {getStatusIcon()}\n            <span className=\"text-sm font-medium text-gray-700\">Connection</span>\n          </div>\n          <span className={`text-sm ${isOnline ? 'text-green-600' : 'text-red-600'}`}>\n            {isOnline ? 'Connected' : 'Disconnected'}\n          </span>\n        </div>\n\n        {/* Offline Data Status */}\n        {pwa.hasOfflineData && (\n          <div className=\"flex items-center justify-between\" data-testid=\"offline-data-status\">\n            <div className=\"flex items-center space-x-2\">\n              <AlertCircle className=\"w-4 h-4 text-orange-500\" />\n              <span className=\"text-sm font-medium text-gray-700\">Offline Data</span>\n            </div>\n            <span className=\"text-sm text-orange-600\">\n              {pwa.offlineVotes} vote{pwa.offlineVotes > 1 ? 's' : ''} pending\n            </span>\n          </div>\n        )}\n\n        {/* Sync Status */}\n        {!isOnline && pwa.hasOfflineData && (\n          <div className=\"p-3 bg-yellow-50 border border-yellow-200 rounded-lg\">\n            <div className=\"flex items-center space-x-2 text-yellow-800\">\n              <AlertCircle className=\"w-4 h-4\" />\n              <span className=\"text-sm font-medium\">Data will sync when online</span>\n            </div>\n            <p className=\"text-sm text-yellow-700 mt-1\">\n              Your offline votes and actions will be automatically synced when you reconnect.\n            </p>\n          </div>\n        )}\n\n        {/* Online Status */}\n        {isOnline && pwa.hasOfflineData && (\n          <div className=\"p-3 bg-green-50 border border-green-200 rounded-lg\">\n            <div className=\"flex items-center space-x-2 text-green-800\">\n              <CheckCircle className=\"w-4 h-4\" />\n              <span className=\"text-sm font-medium\">Ready to sync</span>\n            </div>\n            <p className=\"text-sm text-green-700 mt-1\">\n              Your offline data will be synced automatically.\n            </p>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n"],"names":["OfflineIndicator","showDetails","className","pwa","usePWA","isOnline","setIsOnline","useState","_showIndicator","setShowIndicator","useEffect","handleOnline","handleOffline","window","navigator","onLine","addEventListener","removeEventListener","isEnabled","isSupported","getStatusIcon","Wifi","WifiOff","getStatusText","getStatusColor","div","data-testid","span","h3","hasOfflineData","AlertCircle","offlineVotes","p","CheckCircle"],"mappings":"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"}