{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/lib/stores/onboardingStore.ts"],"sourcesContent":["/**\n * Onboarding Store - Zustand Implementation\n * \n * Comprehensive onboarding state management including step navigation,\n * form data persistence, and progress tracking. Integrates with UserStore\n * for profile data and AppStore for user preferences.\n * \n * Created: October 10, 2025\n * Status: âœ… ACTIVE\n */\n\nimport { create } from 'zustand';\nimport { devtools } from 'zustand/middleware';\nimport { persist } from 'zustand/middleware';\n\nimport { logger } from '@/lib/utils/logger';\n\n// Onboarding data types\ninterface AuthData {\n  method?: 'email' | 'google' | 'apple' | 'phone';\n  email?: string;\n  phone?: string;\n  password?: string;\n  confirmPassword?: string;\n  termsAccepted?: boolean;\n  privacyAccepted?: boolean;\n  marketingOptIn?: boolean;\n}\n\ninterface ProfileData {\n  firstName?: string;\n  lastName?: string;\n  username?: string;\n  avatar?: string;\n  bio?: string;\n  location?: string;\n  state?: string;\n  zipCode?: string;\n  dateOfBirth?: string;\n  gender?: string;\n  phone?: string;\n  website?: string;\n}\n\ninterface ValuesData {\n  politicalAffiliation?: string;\n  primaryInterests?: string[];\n  secondaryInterests?: string[];\n  values?: string[];\n  priorities?: string[];\n  engagementLevel?: 'low' | 'medium' | 'high';\n  notificationPreferences?: {\n    email: boolean;\n    push: boolean;\n    sms: boolean;\n  };\n}\n\ninterface PreferencesData {\n  theme?: 'light' | 'dark' | 'system';\n  language?: string;\n  timezone?: string;\n  notifications?: boolean;\n  privacy?: 'public' | 'private' | 'friends';\n  dataSharing?: boolean;\n  analytics?: boolean;\n  marketing?: boolean;\n}\n\ninterface OnboardingStep {\n  id: number;\n  title: string;\n  description: string;\n  component: string;\n  required: boolean;\n  completed: boolean;\n  skipped: boolean;\n  data?: any;\n}\n\n// Onboarding store state interface\ninterface OnboardingStore {\n  // Onboarding state\n  currentStep: number;\n  totalSteps: number;\n  isCompleted: boolean;\n  isSkipped: boolean;\n  isActive: boolean;\n  \n  // Form data\n  authData: AuthData;\n  profileData: ProfileData;\n  valuesData: ValuesData;\n  preferencesData: PreferencesData;\n  \n  // Progress tracking\n  progress: number;\n  completedSteps: number[];\n  skippedSteps: number[];\n  stepData: Record<number, any>;\n  \n  // Steps configuration\n  steps: OnboardingStep[];\n  \n  // Loading states\n  isLoading: boolean;\n  isSaving: boolean;\n  isSubmitting: boolean;\n  error: string | null;\n  \n  // Actions - Navigation\n  setCurrentStep: (step: number) => void;\n  nextStep: () => void;\n  previousStep: () => void;\n  goToStep: (step: number) => void;\n  completeOnboarding: () => void;\n  skipOnboarding: () => void;\n  restartOnboarding: () => void;\n  \n  // Actions - Data management\n  updateFormData: (step: number, data: any) => void;\n  updateAuthData: (data: Partial<AuthData>) => void;\n  updateProfileData: (data: Partial<ProfileData>) => void;\n  updateValuesData: (data: Partial<ValuesData>) => void;\n  updatePreferencesData: (data: Partial<PreferencesData>) => void;\n  clearStepData: (step: number) => void;\n  clearAllData: () => void;\n  \n  // Actions - Step management\n  markStepCompleted: (step: number) => void;\n  markStepSkipped: (step: number) => void;\n  markStepIncomplete: (step: number) => void;\n  canProceedToNextStep: (step: number) => boolean;\n  getStepValidationErrors: (step: number) => string[];\n  \n  // Actions - Loading states\n  setLoading: (loading: boolean) => void;\n  setSaving: (saving: boolean) => void;\n  setSubmitting: (submitting: boolean) => void;\n  setError: (error: string | null) => void;\n  clearError: () => void;\n  \n  // Actions - Data operations\n  saveProgress: () => Promise<void>;\n  loadProgress: () => Promise<void>;\n  submitOnboarding: () => Promise<void>;\n  validateStep: (step: number) => boolean;\n  validateAllSteps: () => boolean;\n}\n\n// Default onboarding steps\nconst defaultSteps: OnboardingStep[] = [\n  {\n    id: 0,\n    title: 'Welcome',\n    description: 'Get started with your civic engagement journey',\n    component: 'WelcomeStep',\n    required: true,\n    completed: false,\n    skipped: false,\n  },\n  {\n    id: 1,\n    title: 'Authentication',\n    description: 'Set up your account and security',\n    component: 'AuthSetupStep',\n    required: true,\n    completed: false,\n    skipped: false,\n  },\n  {\n    id: 2,\n    title: 'Profile Setup',\n    description: 'Tell us about yourself',\n    component: 'ProfileSetupStep',\n    required: true,\n    completed: false,\n    skipped: false,\n  },\n  {\n    id: 3,\n    title: 'Values & Interests',\n    description: 'Help us personalize your experience',\n    component: 'ValuesStep',\n    required: true,\n    completed: false,\n    skipped: false,\n  },\n  {\n    id: 4,\n    title: 'Privacy & Data',\n    description: 'Control your data and privacy settings',\n    component: 'DataUsageStepLite',\n    required: true,\n    completed: false,\n    skipped: false,\n  },\n  {\n    id: 5,\n    title: 'Complete',\n    description: 'You\\'re all set! Welcome to Choices',\n    component: 'CompleteStep',\n    required: true,\n    completed: false,\n    skipped: false,\n  },\n];\n\n// Create onboarding store with middleware\nexport const useOnboardingStore = create<OnboardingStore>()(\n  devtools(\n    persist(\n      (set, get) => ({\n        // Initial state\n        currentStep: 0,\n        totalSteps: 6,\n        isCompleted: false,\n        isSkipped: false,\n        isActive: false,\n        authData: {},\n        profileData: {},\n        valuesData: {},\n        preferencesData: {},\n        progress: 0,\n        completedSteps: [],\n        skippedSteps: [],\n        stepData: {},\n        steps: defaultSteps,\n        isLoading: false,\n        isSaving: false,\n        isSubmitting: false,\n        error: null,\n        \n        // Navigation actions\n        setCurrentStep: (step) => set((state) => {\n          const newStep = Math.max(0, Math.min(step, state.totalSteps - 1));\n          const progress = (newStep / state.totalSteps) * 100;\n          \n          logger.info('Onboarding step changed', {\n            from: state.currentStep,\n            to: newStep,\n            progress: Math.round(progress)\n          });\n          \n          return {\n            ...state,\n            currentStep: newStep,\n            progress\n          };\n        }),\n        \n        nextStep: () => set((state) => {\n          const nextStep = Math.min(state.currentStep + 1, state.totalSteps - 1);\n          const progress = (nextStep / state.totalSteps) * 100;\n          \n          logger.info('Onboarding next step', {\n            currentStep: nextStep,\n            progress: Math.round(progress)\n          });\n          \n          return {\n            ...state,\n            currentStep: nextStep,\n            progress\n          };\n        }),\n        \n        previousStep: () => set((state) => {\n          const prevStep = Math.max(state.currentStep - 1, 0);\n          const progress = (prevStep / state.totalSteps) * 100;\n          \n          logger.info('Onboarding previous step', {\n            currentStep: prevStep,\n            progress: Math.round(progress)\n          });\n          \n          return {\n            ...state,\n            currentStep: prevStep,\n            progress\n          };\n        }),\n        \n        goToStep: (step) => {\n          const { setCurrentStep } = get();\n          setCurrentStep(step);\n        },\n        \n        completeOnboarding: () => set((state) => {\n          logger.info('Onboarding completed', {\n            totalSteps: state.totalSteps,\n            completedSteps: state.completedSteps.length + 1\n          });\n          \n          return {\n            ...state,\n            isCompleted: true,\n            isActive: false,\n            progress: 100,\n            completedSteps: [...state.completedSteps, state.currentStep]\n          };\n        }),\n        \n        skipOnboarding: () => set({\n          isSkipped: true,\n          isActive: false,\n          progress: 100\n        }),\n        \n        restartOnboarding: () => set({\n          currentStep: 0,\n          isCompleted: false,\n          isSkipped: false,\n          isActive: true,\n          progress: 0,\n          completedSteps: [],\n          skippedSteps: [],\n          stepData: {},\n          authData: {},\n          profileData: {},\n          valuesData: {},\n          preferencesData: {},\n          error: null\n        }),\n        \n        // Data management actions\n        updateFormData: (step, data) => set((state) => ({\n          stepData: {\n            ...state.stepData,\n            [step]: { ...(state.stepData[step] || {}), ...data }\n          }\n        })),\n        \n        updateAuthData: (data) => set((state) => ({\n          authData: { ...state.authData, ...data }\n        })),\n        \n        updateProfileData: (data) => set((state) => ({\n          profileData: { ...state.profileData, ...data }\n        })),\n        \n        updateValuesData: (data) => set((state) => ({\n          valuesData: { ...state.valuesData, ...data }\n        })),\n        \n        updatePreferencesData: (data) => set((state) => ({\n          preferencesData: { ...state.preferencesData, ...data }\n        })),\n        \n        clearStepData: (step) => set((state) => ({\n          stepData: {\n            ...state.stepData,\n            [step]: {}\n          }\n        })),\n        \n        clearAllData: () => set({\n          stepData: {},\n          authData: {},\n          profileData: {},\n          valuesData: {},\n          preferencesData: {}\n        }),\n        \n        // Step management actions\n        markStepCompleted: (step) => set((state) => ({\n          completedSteps: [...state.completedSteps, step],\n          steps: state.steps.map(s => \n            s.id === step ? { ...s, completed: true } : s\n          )\n        })),\n        \n        markStepSkipped: (step) => set((state) => ({\n          skippedSteps: [...state.skippedSteps, step],\n          steps: state.steps.map(s => \n            s.id === step ? { ...s, skipped: true } : s\n          )\n        })),\n        \n        markStepIncomplete: (step) => set((state) => ({\n          completedSteps: state.completedSteps.filter(s => s !== step),\n          steps: state.steps.map(s => \n            s.id === step ? { ...s, completed: false } : s\n          )\n        })),\n        \n        canProceedToNextStep: (step) => {\n          const state = get();\n          const currentStepData = state.stepData[step];\n          const stepConfig = state.steps.find(s => s.id === step);\n          \n          if (!stepConfig?.required) return true;\n          \n          // Add validation logic here based on step requirements\n          switch (step) {\n            case 0: // Welcome step\n              return true;\n            case 1: // Auth step\n              return !!(currentStepData?.email && currentStepData?.password);\n            case 2: // Profile step\n              return !!(currentStepData?.firstName && currentStepData?.lastName);\n            case 3: // Values step\n              return !!(currentStepData?.primaryInterests?.length > 0);\n            case 4: // Privacy step\n              return !!(currentStepData?.privacyAccepted);\n            case 5: // Complete step\n              return true;\n            default:\n              return true;\n          }\n        },\n        \n        getStepValidationErrors: (step) => {\n          const state = get();\n          const currentStepData = state.stepData[step];\n          const errors: string[] = [];\n          \n          switch (step) {\n            case 1: // Auth step\n              if (!currentStepData?.email) errors.push('Email is required');\n              if (!currentStepData?.password) errors.push('Password is required');\n              if (currentStepData?.password !== currentStepData?.confirmPassword) {\n                errors.push('Passwords do not match');\n              }\n              break;\n            case 2: // Profile step\n              if (!currentStepData?.firstName) errors.push('First name is required');\n              if (!currentStepData?.lastName) errors.push('Last name is required');\n              break;\n            case 3: // Values step\n              if (!currentStepData?.primaryInterests?.length) {\n                errors.push('Please select at least one interest');\n              }\n              break;\n            case 4: // Privacy step\n              if (!currentStepData?.privacyAccepted) {\n                errors.push('You must accept the privacy policy');\n              }\n              break;\n          }\n          \n          return errors;\n        },\n        \n        // Loading state actions\n        setLoading: (loading) => set({ isLoading: loading }),\n        setSaving: (saving) => set({ isSaving: saving }),\n        setSubmitting: (submitting) => set({ isSubmitting: submitting }),\n        setError: (error) => set({ error }),\n        clearError: () => set({ error: null }),\n        \n        // Data operations\n        saveProgress: async () => {\n          const { setSaving, setError } = get();\n          \n          try {\n            setSaving(true);\n            setError(null);\n            \n            const state = get();\n            const response = await fetch('/api/profile?action=onboarding-progress', {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({\n                currentStep: state.currentStep,\n                progress: state.progress,\n                stepData: state.stepData,\n                authData: state.authData,\n                profileData: state.profileData,\n                valuesData: state.valuesData,\n                preferencesData: state.preferencesData,\n              }),\n            });\n            \n            if (!response.ok) {\n              throw new Error('Failed to save onboarding progress');\n            }\n            \n            logger.info('Onboarding progress saved', {\n              currentStep: state.currentStep,\n              progress: state.progress\n            });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to save onboarding progress', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setSaving(false);\n          }\n        },\n        \n        loadProgress: async () => {\n          const { setLoading, setError } = get();\n          \n          try {\n            setLoading(true);\n            setError(null);\n            \n            const response = await fetch('/api/profile?action=onboarding-progress');\n            \n            if (!response.ok) {\n              throw new Error('Failed to load onboarding progress');\n            }\n            \n            const data = await response.json();\n            \n            set({\n              currentStep: data.currentStep || 0,\n              progress: data.progress || 0,\n              stepData: data.stepData || {},\n              authData: data.authData || {},\n              profileData: data.profileData || {},\n              valuesData: data.valuesData || {},\n              preferencesData: data.preferencesData || {},\n            });\n            \n            logger.info('Onboarding progress loaded', {\n              currentStep: data.currentStep,\n              progress: data.progress\n            });\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to load onboarding progress', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setLoading(false);\n          }\n        },\n        \n        submitOnboarding: async () => {\n          const { setSubmitting, setError, completeOnboarding } = get();\n          \n          try {\n            setSubmitting(true);\n            setError(null);\n            \n            const state = get();\n            const response = await fetch('/api/profile?action=complete-onboarding', {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({\n                authData: state.authData,\n                profileData: state.profileData,\n                valuesData: state.valuesData,\n                preferencesData: state.preferencesData,\n              }),\n            });\n            \n            if (!response.ok) {\n              throw new Error('Failed to complete onboarding');\n            }\n            \n            completeOnboarding();\n            \n            logger.info('Onboarding submitted successfully');\n          } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n            setError(errorMessage);\n            logger.error('Failed to submit onboarding', error instanceof Error ? error : new Error(errorMessage));\n          } finally {\n            setSubmitting(false);\n          }\n        },\n        \n        validateStep: (step) => {\n          const { getStepValidationErrors } = get();\n          const errors = getStepValidationErrors(step);\n          return errors.length === 0;\n        },\n        \n        validateAllSteps: () => {\n          const { validateStep, totalSteps } = get();\n          return Array.from({ length: totalSteps }, (_, i) => i)\n            .every(step => validateStep(step));\n        },\n      }),\n      {\n        name: 'onboarding-store',\n        partialize: (state) => ({\n          currentStep: state.currentStep,\n          progress: state.progress,\n          stepData: state.stepData,\n          authData: state.authData,\n          profileData: state.profileData,\n          valuesData: state.valuesData,\n          preferencesData: state.preferencesData,\n          completedSteps: state.completedSteps,\n          skippedSteps: state.skippedSteps,\n        }),\n      }\n    ),\n    { name: 'onboarding-store' }\n  )\n);\n\n// Store selectors for optimized re-renders\nexport const useOnboardingStep = () => useOnboardingStore(state => state.currentStep);\nexport const useOnboardingProgress = () => useOnboardingStore(state => state.progress);\nexport const useOnboardingCompleted = () => useOnboardingStore(state => state.isCompleted);\nexport const useOnboardingSkipped = () => useOnboardingStore(state => state.isSkipped);\nexport const useOnboardingActive = () => useOnboardingStore(state => state.isActive);\n// FIXED: Use individual selectors to prevent infinite re-renders\nexport const useOnboardingData = () => {\n  const currentStep = useOnboardingStore(state => state.currentStep);\n  const progress = useOnboardingStore(state => state.progress);\n  const isCompleted = useOnboardingStore(state => state.isCompleted);\n  const authData = useOnboardingStore(state => state.authData);\n  const profileData = useOnboardingStore(state => state.profileData);\n  const valuesData = useOnboardingStore(state => state.valuesData);\n  const preferencesData = useOnboardingStore(state => state.preferencesData);\n  \n  return {\n    currentStep,\n    progress,\n    isCompleted,\n    authData,\n    profileData,\n    valuesData,\n    preferencesData,\n  };\n};\nexport const useOnboardingLoading = () => useOnboardingStore(state => state.isLoading);\nexport const useOnboardingError = () => useOnboardingStore(state => state.error);\n\n// Action selectors - FIXED: Use individual selectors to prevent infinite re-renders\nexport const useOnboardingActions = () => {\n  const setCurrentStep = useOnboardingStore(state => state.setCurrentStep);\n  const nextStep = useOnboardingStore(state => state.nextStep);\n  const previousStep = useOnboardingStore(state => state.previousStep);\n  const goToStep = useOnboardingStore(state => state.goToStep);\n  const completeOnboarding = useOnboardingStore(state => state.completeOnboarding);\n  const skipOnboarding = useOnboardingStore(state => state.skipOnboarding);\n  const restartOnboarding = useOnboardingStore(state => state.restartOnboarding);\n  const updateFormData = useOnboardingStore(state => state.updateFormData);\n  const updateAuthData = useOnboardingStore(state => state.updateAuthData);\n  const updateProfileData = useOnboardingStore(state => state.updateProfileData);\n  const updateValuesData = useOnboardingStore(state => state.updateValuesData);\n  const updatePreferencesData = useOnboardingStore(state => state.updatePreferencesData);\n  const clearStepData = useOnboardingStore(state => state.clearStepData);\n  const clearAllData = useOnboardingStore(state => state.clearAllData);\n  const markStepCompleted = useOnboardingStore(state => state.markStepCompleted);\n  const markStepSkipped = useOnboardingStore(state => state.markStepSkipped);\n  const markStepIncomplete = useOnboardingStore(state => state.markStepIncomplete);\n  const canProceedToNextStep = useOnboardingStore(state => state.canProceedToNextStep);\n  const getStepValidationErrors = useOnboardingStore(state => state.getStepValidationErrors);\n  const setLoading = useOnboardingStore(state => state.setLoading);\n  const setSaving = useOnboardingStore(state => state.setSaving);\n  const setSubmitting = useOnboardingStore(state => state.setSubmitting);\n  const setError = useOnboardingStore(state => state.setError);\n  const clearError = useOnboardingStore(state => state.clearError);\n  const saveProgress = useOnboardingStore(state => state.saveProgress);\n  const loadProgress = useOnboardingStore(state => state.loadProgress);\n  const submitOnboarding = useOnboardingStore(state => state.submitOnboarding);\n  const validateStep = useOnboardingStore(state => state.validateStep);\n  const validateAllSteps = useOnboardingStore(state => state.validateAllSteps);\n  \n  return {\n    setCurrentStep,\n    nextStep,\n    previousStep,\n    goToStep,\n    completeOnboarding,\n    skipOnboarding,\n    restartOnboarding,\n    updateFormData,\n    updateAuthData,\n    updateProfileData,\n    updateValuesData,\n    updatePreferencesData,\n    clearStepData,\n    clearAllData,\n    markStepCompleted,\n    markStepSkipped,\n    markStepIncomplete,\n    canProceedToNextStep,\n    getStepValidationErrors,\n    setLoading,\n    setSaving,\n    setSubmitting,\n    setError,\n    clearError,\n    saveProgress,\n    loadProgress,\n    submitOnboarding,\n    validateStep,\n    validateAllSteps,\n  };\n};\n\n// Computed selectors - FIXED: Use individual selectors to prevent infinite re-renders\nexport const useOnboardingStats = () => {\n  const totalSteps = useOnboardingStore(state => state.totalSteps);\n  const currentStep = useOnboardingStore(state => state.currentStep);\n  const completedSteps = useOnboardingStore(state => state.completedSteps.length);\n  const skippedSteps = useOnboardingStore(state => state.skippedSteps.length);\n  const progress = useOnboardingStore(state => state.progress);\n  const isCompleted = useOnboardingStore(state => state.isCompleted);\n  const isSkipped = useOnboardingStore(state => state.isSkipped);\n  \n  return {\n    totalSteps,\n    currentStep,\n    completedSteps,\n    skippedSteps,\n    progress,\n    isCompleted,\n    isSkipped,\n  };\n};\n\nexport const useCurrentStepData = () => useOnboardingStore(state => \n  state.stepData[state.currentStep] || {}\n);\n\nexport const useStepValidation = (step: number) => useOnboardingStore(state => ({\n  canProceed: state.canProceedToNextStep(step),\n  errors: state.getStepValidationErrors(step),\n  isValid: state.validateStep(step),\n}));\n\n// Store utilities\nexport const onboardingStoreUtils = {\n  /**\n   * Get onboarding summary\n   */\n  getOnboardingSummary: () => {\n    const state = useOnboardingStore.getState();\n    return {\n      currentStep: state.currentStep,\n      totalSteps: state.totalSteps,\n      progress: state.progress,\n      isCompleted: state.isCompleted,\n      isSkipped: state.isSkipped,\n      completedSteps: state.completedSteps,\n      skippedSteps: state.skippedSteps,\n    };\n  },\n  \n  /**\n   * Get step data for specific step\n   */\n  getStepData: (step: number) => {\n    const state = useOnboardingStore.getState();\n    return state.stepData[step] || {};\n  },\n  \n  /**\n   * Check if onboarding can be completed\n   */\n  canCompleteOnboarding: () => {\n    const state = useOnboardingStore.getState();\n    return state.validateAllSteps() && state.currentStep === state.totalSteps - 1;\n  },\n  \n  /**\n   * Get onboarding progress percentage\n   */\n  getProgressPercentage: () => {\n    const state = useOnboardingStore.getState();\n    return Math.round(state.progress);\n  },\n  \n  /**\n   * Get next incomplete step\n   */\n  getNextIncompleteStep: () => {\n    const state = useOnboardingStore.getState();\n    const incompleteSteps = state.steps.filter(step => !step.completed && !step.skipped);\n    return incompleteSteps[0] || null;\n  }\n};\n\n// Store subscriptions for external integrations\nexport const onboardingStoreSubscriptions = {\n  /**\n   * Subscribe to onboarding progress changes\n   */\n  onProgressChange: (callback: (progress: number) => void) => {\n    return useOnboardingStore.subscribe(\n      (state) => {\n        callback(state.progress);\n      }\n    );\n  },\n  \n  /**\n   * Subscribe to step changes\n   */\n  onStepChange: (callback: (step: number) => void) => {\n    return useOnboardingStore.subscribe(\n      (state) => {\n        callback(state.currentStep);\n      }\n    );\n  },\n  \n  /**\n   * Subscribe to completion status\n   */\n  onCompletionChange: (callback: (isCompleted: boolean) => void) => {\n    return useOnboardingStore.subscribe(\n      (state) => {\n        callback(state.isCompleted);\n      }\n    );\n  }\n};\n\n// Store debugging utilities\nexport const onboardingStoreDebug = {\n  /**\n   * Log current onboarding state\n   */\n  logState: () => {\n    const state = useOnboardingStore.getState();\n    logger.debug('Onboarding Store State', {\n      currentStep: state.currentStep,\n      totalSteps: state.totalSteps,\n      progress: state.progress,\n      isCompleted: state.isCompleted,\n      isSkipped: state.isSkipped,\n      completedSteps: state.completedSteps,\n      skippedSteps: state.skippedSteps,\n      isLoading: state.isLoading,\n      error: state.error\n    });\n  },\n  \n  /**\n   * Log onboarding summary\n   */\n  logSummary: () => {\n    const summary = onboardingStoreUtils.getOnboardingSummary();\n    logger.debug('Onboarding Summary', summary);\n  },\n  \n  /**\n   * Log step data\n   */\n  logStepData: (step: number) => {\n    const stepData = onboardingStoreUtils.getStepData(step);\n    logger.debug('Step Data', { step, stepData });\n  },\n  \n  /**\n   * Reset onboarding store\n   */\n  reset: () => {\n    useOnboardingStore.getState().restartOnboarding();\n    logger.info('Onboarding store reset');\n  }\n};\n"],"names":["onboardingStoreDebug","onboardingStoreSubscriptions","onboardingStoreUtils","useCurrentStepData","useOnboardingActions","useOnboardingActive","useOnboardingCompleted","useOnboardingData","useOnboardingError","useOnboardingLoading","useOnboardingProgress","useOnboardingSkipped","useOnboardingStats","useOnboardingStep","useOnboardingStore","useStepValidation","defaultSteps","id","title","description","component","required","completed","skipped","create","devtools","persist","set","get","currentStep","totalSteps","isCompleted","isSkipped","isActive","authData","profileData","valuesData","preferencesData","progress","completedSteps","skippedSteps","stepData","steps","isLoading","isSaving","isSubmitting","error","setCurrentStep","step","state","newStep","Math","max","min","logger","info","from","to","round","nextStep","previousStep","prevStep","goToStep","completeOnboarding","length","skipOnboarding","restartOnboarding","updateFormData","data","updateAuthData","updateProfileData","updateValuesData","updatePreferencesData","clearStepData","clearAllData","markStepCompleted","map","s","markStepSkipped","markStepIncomplete","filter","canProceedToNextStep","currentStepData","stepConfig","find","email","password","firstName","lastName","primaryInterests","privacyAccepted","getStepValidationErrors","errors","push","confirmPassword","setLoading","loading","setSaving","saving","setSubmitting","submitting","setError","clearError","saveProgress","response","fetch","method","headers","body","JSON","stringify","ok","Error","errorMessage","message","loadProgress","json","submitOnboarding","validateStep","validateAllSteps","Array","_","i","every","name","partialize","canProceed","isValid","getOnboardingSummary","getState","getStepData","canCompleteOnboarding","getProgressPercentage","getNextIncompleteStep","incompleteSteps","onProgressChange","callback","subscribe","onStepChange","onCompletionChange","logState","debug","logSummary","summary","logStepData","reset"],"mappings":"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"}