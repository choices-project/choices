{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/app/api/feature-flags/route.ts"],"sourcesContent":["/**\n * Feature Flags API Endpoint\n * \n * Returns the current state of all feature flags\n * Used for E2E testing and debugging\n * \n * Created: January 23, 2025\n * Status: âœ… ACTIVE\n */\n\nimport { type NextRequest, NextResponse } from 'next/server';\nimport { featureFlagManager } from '@/lib/core/feature-flags';\n\nexport async function GET(request: NextRequest) {\n  try {\n    // Get all feature flags\n    const allFlags = featureFlagManager.getAllFlags();\n    const enabledFlags = featureFlagManager.getEnabledFlags();\n    const disabledFlags = featureFlagManager.getDisabledFlags();\n    \n    // Get system info\n    const systemInfo = featureFlagManager.getSystemInfo();\n    \n    return NextResponse.json({\n      success: true,\n      flags: allFlags,\n      enabledFlags,\n      disabledFlags,\n      systemInfo,\n      timestamp: new Date().toISOString()\n    });\n  } catch (error) {\n    console.error('Error fetching feature flags:', error);\n    return NextResponse.json(\n      { \n        success: false, \n        error: 'Failed to fetch feature flags',\n        timestamp: new Date().toISOString()\n      },\n      { status: 500 }\n    );\n  }\n}\n\nexport async function PATCH(request: NextRequest) {\n  try {\n    const body = await request.json();\n    const { flagId, enabled } = body;\n    \n    if (!flagId || typeof enabled !== 'boolean') {\n      return NextResponse.json(\n        { \n          success: false, \n          error: 'Invalid request body. Expected { flagId: string, enabled: boolean }',\n          timestamp: new Date().toISOString()\n        },\n        { status: 400 }\n      );\n    }\n    \n    // Update the feature flag using the feature flag manager\n    const success = enabled \n      ? featureFlagManager.enable(flagId)\n      : featureFlagManager.disable(flagId);\n    \n    if (!success) {\n      return NextResponse.json(\n        { \n          success: false, \n          error: `Failed to update feature flag: ${flagId}`,\n          timestamp: new Date().toISOString()\n        },\n        { status: 400 }\n      );\n    }\n    \n    return NextResponse.json({\n      success: true,\n      message: `Feature flag ${flagId} updated to ${enabled}`,\n      flagId,\n      enabled,\n      timestamp: new Date().toISOString()\n    });\n  } catch (error) {\n    console.error('Error updating feature flag:', error);\n    return NextResponse.json(\n      { \n        success: false, \n        error: 'Failed to update feature flag',\n        timestamp: new Date().toISOString()\n      },\n      { status: 500 }\n    );\n  }\n}\n"],"names":["GET","PATCH","request","allFlags","featureFlagManager","getAllFlags","enabledFlags","getEnabledFlags","disabledFlags","getDisabledFlags","systemInfo","getSystemInfo","NextResponse","json","success","flags","timestamp","Date","toISOString","error","console","status","body","flagId","enabled","enable","disable","message"],"mappings":"AAAA;;;;;;;;CAQC;;;;;;;;;;;QAKqBA;eAAAA;;QA+BAC;eAAAA;;;wBAlCyB;8BACZ;AAE5B,eAAeD,IAAIE,OAAoB;IAC5C,IAAI;QACF,wBAAwB;QACxB,MAAMC,WAAWC,gCAAkB,CAACC,WAAW;QAC/C,MAAMC,eAAeF,gCAAkB,CAACG,eAAe;QACvD,MAAMC,gBAAgBJ,gCAAkB,CAACK,gBAAgB;QAEzD,kBAAkB;QAClB,MAAMC,aAAaN,gCAAkB,CAACO,aAAa;QAEnD,OAAOC,oBAAY,CAACC,IAAI,CAAC;YACvBC,SAAS;YACTC,OAAOZ;YACPG;YACAE;YACAE;YACAM,WAAW,IAAIC,OAAOC,WAAW;QACnC;IACF,EAAE,OAAOC,OAAO;QACdC,QAAQD,KAAK,CAAC,iCAAiCA;QAC/C,OAAOP,oBAAY,CAACC,IAAI,CACtB;YACEC,SAAS;YACTK,OAAO;YACPH,WAAW,IAAIC,OAAOC,WAAW;QACnC,GACA;YAAEG,QAAQ;QAAI;IAElB;AACF;AAEO,eAAepB,MAAMC,OAAoB;IAC9C,IAAI;QACF,MAAMoB,OAAO,MAAMpB,QAAQW,IAAI;QAC/B,MAAM,EAAEU,MAAM,EAAEC,OAAO,EAAE,GAAGF;QAE5B,IAAI,CAACC,UAAU,OAAOC,YAAY,WAAW;YAC3C,OAAOZ,oBAAY,CAACC,IAAI,CACtB;gBACEC,SAAS;gBACTK,OAAO;gBACPH,WAAW,IAAIC,OAAOC,WAAW;YACnC,GACA;gBAAEG,QAAQ;YAAI;QAElB;QAEA,yDAAyD;QACzD,MAAMP,UAAUU,UACZpB,gCAAkB,CAACqB,MAAM,CAACF,UAC1BnB,gCAAkB,CAACsB,OAAO,CAACH;QAE/B,IAAI,CAACT,SAAS;YACZ,OAAOF,oBAAY,CAACC,IAAI,CACtB;gBACEC,SAAS;gBACTK,OAAO,CAAC,+BAA+B,EAAEI,QAAQ;gBACjDP,WAAW,IAAIC,OAAOC,WAAW;YACnC,GACA;gBAAEG,QAAQ;YAAI;QAElB;QAEA,OAAOT,oBAAY,CAACC,IAAI,CAAC;YACvBC,SAAS;YACTa,SAAS,CAAC,aAAa,EAAEJ,OAAO,YAAY,EAAEC,SAAS;YACvDD;YACAC;YACAR,WAAW,IAAIC,OAAOC,WAAW;QACnC;IACF,EAAE,OAAOC,OAAO;QACdC,QAAQD,KAAK,CAAC,gCAAgCA;QAC9C,OAAOP,oBAAY,CAACC,IAAI,CACtB;YACEC,SAAS;YACTK,OAAO;YACPH,WAAW,IAAIC,OAAOC,WAAW;QACnC,GACA;YAAEG,QAAQ;QAAI;IAElB;AACF"}