293970287f1cf459fc81c0f5f22b5f85
/**
 * Rate Limiting Utilities
 * 
 * Production rate limiting utilities for the Choices platform
 * 
 * Created: January 16, 2025
 * Status: âœ… ACTIVE
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get RateLimiter () {
        return RateLimiter;
    },
    get checkRateLimit () {
        return checkRateLimit;
    },
    get createRateLimiter () {
        return createRateLimiter;
    }
});
const _logger = require("./logger");
async function checkRateLimit(key, options) {
    try {
        // This would integrate with your actual rate limiting system (Redis, etc.)
        _logger.logger.info('Checking rate limit', {
            key,
            options
        });
        // Placeholder implementation
        return {
            allowed: true,
            remaining: options.maxRequests,
            resetTime: Date.now() + options.windowMs
        };
    } catch (error) {
        _logger.logger.error('Rate limit check failed', error instanceof Error ? error : new Error(String(error)));
        return {
            allowed: false,
            remaining: 0,
            resetTime: Date.now() + options.windowMs
        };
    }
}
function createRateLimiter(options) {
    return {
        check: (key)=>checkRateLimit(key, options),
        reset: async (key)=>{
            _logger.logger.info('Resetting rate limit', {
                key
            });
        // This would reset the rate limit for the key
        },
        getStats: async (key)=>{
            _logger.logger.info('Getting rate limit stats', {
                key
            });
            return {
                total: options.maxRequests,
                remaining: options.maxRequests,
                resetTime: Date.now() + options.windowMs
            };
        }
    };
}
class RateLimiter {
    constructor(options){
        this.options = options;
    }
    async check(key) {
        return checkRateLimit(key, this.options);
    }
    async reset(key) {
        _logger.logger.info('Resetting rate limit', {
            key
        });
    // This would reset the rate limit for the key
    }
    async getStats(key) {
        _logger.logger.info('Getting rate limit stats', {
            key
        });
        return {
            total: this.options.maxRequests,
            remaining: this.options.maxRequests,
            resetTime: Date.now() + this.options.windowMs
        };
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hbGF1Z2hpbmdraXRzdW5lL3NyYy9DaG9pY2VzL3dlYi9saWIvdXRpbHMvcmF0ZS1saW1pdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFJhdGUgTGltaXRpbmcgVXRpbGl0aWVzXG4gKiBcbiAqIFByb2R1Y3Rpb24gcmF0ZSBsaW1pdGluZyB1dGlsaXRpZXMgZm9yIHRoZSBDaG9pY2VzIHBsYXRmb3JtXG4gKiBcbiAqIENyZWF0ZWQ6IEphbnVhcnkgMTYsIDIwMjVcbiAqIFN0YXR1czog4pyFIEFDVElWRVxuICovXG5cbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gJy4vbG9nZ2VyJztcblxuZXhwb3J0IGludGVyZmFjZSBSYXRlTGltaXRSZXN1bHQge1xuICBhbGxvd2VkOiBib29sZWFuO1xuICByZW1haW5pbmc6IG51bWJlcjtcbiAgcmVzZXRUaW1lOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmF0ZUxpbWl0U3RhdHMge1xuICB0b3RhbDogbnVtYmVyO1xuICByZW1haW5pbmc6IG51bWJlcjtcbiAgcmVzZXRUaW1lOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmF0ZUxpbWl0T3B0aW9ucyB7XG4gIHdpbmRvd01zOiBudW1iZXI7XG4gIG1heFJlcXVlc3RzOiBudW1iZXI7XG4gIGtleUdlbmVyYXRvcj86IChyZXE6IGFueSkgPT4gc3RyaW5nO1xufVxuXG4vKipcbiAqIENoZWNrIHJhdGUgbGltaXQgZm9yIGEgZ2l2ZW4ga2V5XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjaGVja1JhdGVMaW1pdChrZXk6IHN0cmluZywgb3B0aW9uczogUmF0ZUxpbWl0T3B0aW9ucyk6IFByb21pc2U8UmF0ZUxpbWl0UmVzdWx0PiB7XG4gIHRyeSB7XG4gICAgLy8gVGhpcyB3b3VsZCBpbnRlZ3JhdGUgd2l0aCB5b3VyIGFjdHVhbCByYXRlIGxpbWl0aW5nIHN5c3RlbSAoUmVkaXMsIGV0Yy4pXG4gICAgbG9nZ2VyLmluZm8oJ0NoZWNraW5nIHJhdGUgbGltaXQnLCB7IGtleSwgb3B0aW9ucyB9KTtcbiAgICBcbiAgICAvLyBQbGFjZWhvbGRlciBpbXBsZW1lbnRhdGlvblxuICAgIHJldHVybiB7XG4gICAgICBhbGxvd2VkOiB0cnVlLFxuICAgICAgcmVtYWluaW5nOiBvcHRpb25zLm1heFJlcXVlc3RzLFxuICAgICAgcmVzZXRUaW1lOiBEYXRlLm5vdygpICsgb3B0aW9ucy53aW5kb3dNc1xuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCdSYXRlIGxpbWl0IGNoZWNrIGZhaWxlZCcsIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvciA6IG5ldyBFcnJvcihTdHJpbmcoZXJyb3IpKSk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGFsbG93ZWQ6IGZhbHNlLFxuICAgICAgcmVtYWluaW5nOiAwLFxuICAgICAgcmVzZXRUaW1lOiBEYXRlLm5vdygpICsgb3B0aW9ucy53aW5kb3dNc1xuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGUgYSByYXRlIGxpbWl0ZXIgaW5zdGFuY2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVJhdGVMaW1pdGVyKG9wdGlvbnM6IFJhdGVMaW1pdE9wdGlvbnMpIHtcbiAgcmV0dXJuIHtcbiAgICBjaGVjazogKGtleTogc3RyaW5nKSA9PiBjaGVja1JhdGVMaW1pdChrZXksIG9wdGlvbnMpLFxuICAgIHJlc2V0OiBhc3luYyAoa2V5OiBzdHJpbmcpID0+IHtcbiAgICAgIGxvZ2dlci5pbmZvKCdSZXNldHRpbmcgcmF0ZSBsaW1pdCcsIHsga2V5IH0pO1xuICAgICAgLy8gVGhpcyB3b3VsZCByZXNldCB0aGUgcmF0ZSBsaW1pdCBmb3IgdGhlIGtleVxuICAgIH0sXG4gICAgZ2V0U3RhdHM6IGFzeW5jIChrZXk6IHN0cmluZyk6IFByb21pc2U8UmF0ZUxpbWl0U3RhdHM+ID0+IHtcbiAgICAgIGxvZ2dlci5pbmZvKCdHZXR0aW5nIHJhdGUgbGltaXQgc3RhdHMnLCB7IGtleSB9KTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRvdGFsOiBvcHRpb25zLm1heFJlcXVlc3RzLFxuICAgICAgICByZW1haW5pbmc6IG9wdGlvbnMubWF4UmVxdWVzdHMsXG4gICAgICAgIHJlc2V0VGltZTogRGF0ZS5ub3coKSArIG9wdGlvbnMud2luZG93TXNcbiAgICAgIH07XG4gICAgfVxuICB9O1xufVxuXG4vKipcbiAqIFJhdGUgTGltaXRlciBjbGFzc1xuICovXG5leHBvcnQgY2xhc3MgUmF0ZUxpbWl0ZXIge1xuICBwcml2YXRlIG9wdGlvbnM6IFJhdGVMaW1pdE9wdGlvbnM7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogUmF0ZUxpbWl0T3B0aW9ucykge1xuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gIH1cbiAgXG4gIGFzeW5jIGNoZWNrKGtleTogc3RyaW5nKTogUHJvbWlzZTxSYXRlTGltaXRSZXN1bHQ+IHtcbiAgICByZXR1cm4gY2hlY2tSYXRlTGltaXQoa2V5LCB0aGlzLm9wdGlvbnMpO1xuICB9XG4gIFxuICBhc3luYyByZXNldChrZXk6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGxvZ2dlci5pbmZvKCdSZXNldHRpbmcgcmF0ZSBsaW1pdCcsIHsga2V5IH0pO1xuICAgIC8vIFRoaXMgd291bGQgcmVzZXQgdGhlIHJhdGUgbGltaXQgZm9yIHRoZSBrZXlcbiAgfVxuICBcbiAgYXN5bmMgZ2V0U3RhdHMoa2V5OiBzdHJpbmcpOiBQcm9taXNlPFJhdGVMaW1pdFN0YXRzPiB7XG4gICAgbG9nZ2VyLmluZm8oJ0dldHRpbmcgcmF0ZSBsaW1pdCBzdGF0cycsIHsga2V5IH0pO1xuICAgIHJldHVybiB7XG4gICAgICB0b3RhbDogdGhpcy5vcHRpb25zLm1heFJlcXVlc3RzLFxuICAgICAgcmVtYWluaW5nOiB0aGlzLm9wdGlvbnMubWF4UmVxdWVzdHMsXG4gICAgICByZXNldFRpbWU6IERhdGUubm93KCkgKyB0aGlzLm9wdGlvbnMud2luZG93TXNcbiAgICB9O1xuICB9XG59Il0sIm5hbWVzIjpbIlJhdGVMaW1pdGVyIiwiY2hlY2tSYXRlTGltaXQiLCJjcmVhdGVSYXRlTGltaXRlciIsImtleSIsIm9wdGlvbnMiLCJsb2dnZXIiLCJpbmZvIiwiYWxsb3dlZCIsInJlbWFpbmluZyIsIm1heFJlcXVlc3RzIiwicmVzZXRUaW1lIiwiRGF0ZSIsIm5vdyIsIndpbmRvd01zIiwiZXJyb3IiLCJFcnJvciIsIlN0cmluZyIsImNoZWNrIiwicmVzZXQiLCJnZXRTdGF0cyIsInRvdGFsIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7OztDQU9DOzs7Ozs7Ozs7OztRQXNFWUE7ZUFBQUE7O1FBN0NTQztlQUFBQTs7UUF3Qk5DO2VBQUFBOzs7d0JBL0NPO0FBdUJoQixlQUFlRCxlQUFlRSxHQUFXLEVBQUVDLE9BQXlCO0lBQ3pFLElBQUk7UUFDRiwyRUFBMkU7UUFDM0VDLGNBQU0sQ0FBQ0MsSUFBSSxDQUFDLHVCQUF1QjtZQUFFSDtZQUFLQztRQUFRO1FBRWxELDZCQUE2QjtRQUM3QixPQUFPO1lBQ0xHLFNBQVM7WUFDVEMsV0FBV0osUUFBUUssV0FBVztZQUM5QkMsV0FBV0MsS0FBS0MsR0FBRyxLQUFLUixRQUFRUyxRQUFRO1FBQzFDO0lBQ0YsRUFBRSxPQUFPQyxPQUFPO1FBQ2RULGNBQU0sQ0FBQ1MsS0FBSyxDQUFDLDJCQUEyQkEsaUJBQWlCQyxRQUFRRCxRQUFRLElBQUlDLE1BQU1DLE9BQU9GO1FBQzFGLE9BQU87WUFDTFAsU0FBUztZQUNUQyxXQUFXO1lBQ1hFLFdBQVdDLEtBQUtDLEdBQUcsS0FBS1IsUUFBUVMsUUFBUTtRQUMxQztJQUNGO0FBQ0Y7QUFLTyxTQUFTWCxrQkFBa0JFLE9BQXlCO0lBQ3pELE9BQU87UUFDTGEsT0FBTyxDQUFDZCxNQUFnQkYsZUFBZUUsS0FBS0M7UUFDNUNjLE9BQU8sT0FBT2Y7WUFDWkUsY0FBTSxDQUFDQyxJQUFJLENBQUMsd0JBQXdCO2dCQUFFSDtZQUFJO1FBQzFDLDhDQUE4QztRQUNoRDtRQUNBZ0IsVUFBVSxPQUFPaEI7WUFDZkUsY0FBTSxDQUFDQyxJQUFJLENBQUMsNEJBQTRCO2dCQUFFSDtZQUFJO1lBQzlDLE9BQU87Z0JBQ0xpQixPQUFPaEIsUUFBUUssV0FBVztnQkFDMUJELFdBQVdKLFFBQVFLLFdBQVc7Z0JBQzlCQyxXQUFXQyxLQUFLQyxHQUFHLEtBQUtSLFFBQVFTLFFBQVE7WUFDMUM7UUFDRjtJQUNGO0FBQ0Y7QUFLTyxNQUFNYjtJQUdYLFlBQVlJLE9BQXlCLENBQUU7UUFDckMsSUFBSSxDQUFDQSxPQUFPLEdBQUdBO0lBQ2pCO0lBRUEsTUFBTWEsTUFBTWQsR0FBVyxFQUE0QjtRQUNqRCxPQUFPRixlQUFlRSxLQUFLLElBQUksQ0FBQ0MsT0FBTztJQUN6QztJQUVBLE1BQU1jLE1BQU1mLEdBQVcsRUFBaUI7UUFDdENFLGNBQU0sQ0FBQ0MsSUFBSSxDQUFDLHdCQUF3QjtZQUFFSDtRQUFJO0lBQzFDLDhDQUE4QztJQUNoRDtJQUVBLE1BQU1nQixTQUFTaEIsR0FBVyxFQUEyQjtRQUNuREUsY0FBTSxDQUFDQyxJQUFJLENBQUMsNEJBQTRCO1lBQUVIO1FBQUk7UUFDOUMsT0FBTztZQUNMaUIsT0FBTyxJQUFJLENBQUNoQixPQUFPLENBQUNLLFdBQVc7WUFDL0JELFdBQVcsSUFBSSxDQUFDSixPQUFPLENBQUNLLFdBQVc7WUFDbkNDLFdBQVdDLEtBQUtDLEdBQUcsS0FBSyxJQUFJLENBQUNSLE9BQU8sQ0FBQ1MsUUFBUTtRQUMvQztJQUNGO0FBQ0YifQ==