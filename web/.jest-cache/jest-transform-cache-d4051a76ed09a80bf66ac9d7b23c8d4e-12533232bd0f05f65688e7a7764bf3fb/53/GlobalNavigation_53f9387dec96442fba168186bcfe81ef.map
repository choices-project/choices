{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/components/shared/GlobalNavigation.tsx"],"sourcesContent":["/**\n * @fileoverview Global Navigation Component\n * \n * Global navigation component providing site navigation, user authentication,\n * and responsive mobile menu functionality.\n * \n * @author Choices Platform Team\n * @created 2025-10-24\n * @version 2.0.0\n * @since 1.0.0\n */\n\n'use client'\n\nimport { \n  Menu, \n  X, \n  Shield, \n  User, \n  LogOut, \n  Vote,\n  BarChart3,\n  Home,\n  Settings\n} from 'lucide-react'\nimport Link from 'next/link'\nimport { usePathname } from 'next/navigation'\nimport { useState } from 'react'\n\nimport { Button } from '@/components/ui/button'\nimport { useUser, useUserActions, useUserLoading, useIsAuthenticated } from '@/lib/stores'\nimport { useI18n } from '@/hooks/useI18n'\nimport LanguageSelector from '@/components/shared/LanguageSelector'\n\n/**\n * Global Navigation Component\n * \n * @returns {JSX.Element} Global navigation component\n * \n * @example\n * <GlobalNavigation />\n */\nexport default function GlobalNavigation() {\n  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false)\n  const [hasError, setHasError] = useState(false)\n  const pathname = usePathname()\n\n  // Error boundary for component\n  if (hasError) {\n    return (\n      <nav className=\"bg-white shadow-sm border-b border-gray-200\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between h-16\">\n            <div className=\"flex items-center\">\n              <div className=\"h-8 w-8 bg-gray-200 rounded\"></div>\n            </div>\n            <div className=\"flex items-center space-x-4\">\n              <div className=\"h-8 w-20 bg-gray-200 rounded\"></div>\n            </div>\n          </div>\n        </div>\n      </nav>\n    );\n  }\n  \n  // Safe user hook with error handling and loading state\n  let user: any = null;\n  let signOut: (() => Promise<void>) | null = null;\n  let isLoading = false;\n  let isAuthenticated = false;\n  \n  // Try each hook individually to isolate issues\n  try {\n    user = useUser();\n  } catch (error) {\n    console.warn('useUser hook failed:', error);\n    user = null;\n    setHasError(true);\n  }\n  \n  try {\n    const userActions = useUserActions();\n    signOut = userActions?.signOut ? async () => {\n      try {\n        userActions.signOut();\n      } catch (error) {\n        console.error('SignOut error:', error);\n      }\n    } : null;\n  } catch (error) {\n    console.warn('useUserActions hook failed:', error);\n    signOut = null;\n    setHasError(true);\n  }\n  \n  try {\n    isLoading = useUserLoading() || false;\n  } catch (error) {\n    console.warn('useUserLoading hook failed:', error);\n    isLoading = false;\n    setHasError(true);\n  }\n  \n  try {\n    isAuthenticated = useIsAuthenticated() || false;\n  } catch (error) {\n    console.warn('useIsAuthenticated hook failed:', error);\n    isAuthenticated = false;\n    setHasError(true);\n  }\n  \n  // Safe i18n hook with error handling\n  let t: (key: string) => string;\n  try {\n    const i18n = useI18n();\n    t = i18n.t;\n  } catch (error) {\n    console.warn('i18n hook failed, using fallback:', error);\n    t = (key: string) => key; // Fallback to key as translation\n  }\n\n  // Show loading state if user data is still loading or if we're not authenticated yet\n  if (isLoading || (!isAuthenticated && !user)) {\n    return (\n      <nav className=\"bg-white shadow-sm border-b border-gray-200\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between h-16\">\n            <div className=\"flex items-center\">\n              <div className=\"h-8 w-8 bg-gray-200 animate-pulse rounded\"></div>\n            </div>\n            <div className=\"flex items-center space-x-4\">\n              <div className=\"h-8 w-20 bg-gray-200 animate-pulse rounded\"></div>\n            </div>\n          </div>\n        </div>\n      </nav>\n    );\n  }\n\n  const toggleMobileMenu = () => {\n    setIsMobileMenuOpen(!isMobileMenuOpen)\n  }\n\n  const closeMobileMenu = () => {\n    setIsMobileMenuOpen(false)\n  }\n\n  const handleLogout = async () => {\n    try {\n      if (signOut) {\n        const result = signOut()\n        if (result instanceof Promise) {\n          await result\n        }\n      }\n      closeMobileMenu()\n    } catch (error) {\n      console.error('Logout failed:', error)\n    }\n  }\n\n  const isActive = (path: string) => {\n    return pathname === path\n  }\n\n  const navigationItems = [\n    { href: '/feed', label: t('navigation.home'), icon: Home },\n    { href: '/polls', label: t('navigation.polls'), icon: Vote },\n    { href: '/dashboard', label: t('navigation.dashboard'), icon: BarChart3 },\n  ]\n\n  return (\n    <nav className=\"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-50\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        <div className=\"flex justify-between items-center h-16\">\n          {/* Logo and Brand */}\n          <div className=\"flex items-center\">\n            <Link href=\"/\" className=\"flex items-center space-x-2\" onClick={closeMobileMenu}>\n              <Shield className=\"h-8 w-8 text-blue-600\" />\n              <span className=\"text-xl font-bold text-gray-900\">Choices</span>\n            </Link>\n          </div>\n\n          {/* Desktop Navigation */}\n          <div className=\"hidden md:flex md:items-center md:space-x-8\">\n            {navigationItems.map((item) => {\n              const Icon = item.icon\n              return (\n                <Link\n                  key={item.href}\n                  href={item.href}\n                  data-testid={item.href === '/polls' ? 'polls-nav' : item.href === '/dashboard' ? 'dashboard-nav' : item.href === '/' ? 'home-nav' : undefined}\n                  className={`flex items-center space-x-1 px-3 py-2 rounded-md text-sm font-medium transition-colors ${\n                    isActive(item.href)\n                      ? 'text-blue-600 bg-blue-50'\n                      : 'text-gray-700 hover:text-blue-600 hover:bg-gray-50'\n                  }`}\n                >\n                  <Icon className=\"h-4 w-4\" />\n                  <span>{item.label}</span>\n                </Link>\n              )\n            })}\n          </div>\n\n          {/* Desktop Auth Section */}\n          <div className=\"hidden md:flex md:items-center md:space-x-4\">\n            {/* Language Selector */}\n            <div data-testid=\"language-selector\">\n              <LanguageSelector />\n            </div>\n            \n            {user ? (\n              <div className=\"flex items-center space-x-4\">\n                <Link\n                  href=\"/profile\"\n                  className={`flex items-center space-x-1 px-3 py-2 rounded-md text-sm font-medium transition-colors ${\n                    isActive('/profile')\n                      ? 'text-blue-600 bg-blue-50'\n                      : 'text-gray-700 hover:text-blue-600 hover:bg-gray-50'\n                  }`}\n                >\n                  <User className=\"h-4 w-4\" />\n                  <span>{t('navigation.profile')}</span>\n                </Link>\n                <Link\n                  href=\"/account/privacy\"\n                  className={`flex items-center space-x-1 px-3 py-2 rounded-md text-sm font-medium transition-colors ${\n                    isActive('/account/privacy')\n                      ? 'text-blue-600 bg-blue-50'\n                      : 'text-gray-700 hover:text-blue-600 hover:bg-gray-50'\n                  }`}\n                >\n                  <Settings className=\"h-4 w-4\" />\n                  <span>{t('navigation.settings')}</span>\n                </Link>\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={handleLogout}\n                  className=\"flex items-center space-x-1\"\n                >\n                  <LogOut className=\"h-4 w-4\" />\n                  <span>{t('navigation.logout')}</span>\n                </Button>\n              </div>\n            ) : (\n              <div className=\"flex items-center space-x-4\">\n                <Button asChild variant=\"outline\" size=\"sm\">\n                  <Link href=\"/login\">{t('navigation.login')}</Link>\n                </Button>\n                <Button asChild size=\"sm\">\n                  <Link href=\"/register\">{t('navigation.register')}</Link>\n                </Button>\n              </div>\n            )}\n          </div>\n\n          {/* Mobile menu button */}\n          <div className=\"md:hidden\">\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={toggleMobileMenu}\n              className=\"p-2\"\n              aria-label=\"Toggle mobile menu\"\n              data-testid=\"mobile-menu\"\n              aria-expanded={isMobileMenuOpen}\n            >\n              {isMobileMenuOpen ? (\n                <X className=\"h-6 w-6\" />\n              ) : (\n                <Menu className=\"h-6 w-6\" />\n              )}\n            </Button>\n          </div>\n        </div>\n\n        {/* Mobile Navigation Menu */}\n        {isMobileMenuOpen && (\n          <div className=\"md:hidden\">\n            <div className=\"px-2 pt-2 pb-3 space-y-1 bg-white border-t border-gray-200\">\n              {/* Mobile Navigation Items */}\n              {navigationItems.map((item) => {\n                const Icon = item.icon\n                return (\n                  <Link\n                    key={item.href}\n                    href={item.href}\n                    onClick={closeMobileMenu}\n                    data-testid={item.href === '/polls' ? 'polls-nav' : item.href === '/dashboard' ? 'dashboard-nav' : item.href === '/' ? 'home-nav' : undefined}\n                    className={`flex items-center space-x-2 px-3 py-2 rounded-md text-base font-medium transition-colors ${\n                      isActive(item.href)\n                        ? 'text-blue-600 bg-blue-50'\n                        : 'text-gray-700 hover:text-blue-600 hover:bg-gray-50'\n                    }`}\n                  >\n                    <Icon className=\"h-5 w-5\" />\n                    <span>{item.label}</span>\n                  </Link>\n                )\n              })}\n\n              {/* Mobile Auth Section */}\n              <div className=\"pt-4 border-t border-gray-200\">\n                {user ? (\n                  <div className=\"space-y-2\">\n                    <Link\n                      href=\"/profile\"\n                      onClick={closeMobileMenu}\n                      className={`flex items-center space-x-2 px-3 py-2 rounded-md text-base font-medium transition-colors ${\n                        isActive('/profile')\n                          ? 'text-blue-600 bg-blue-50'\n                          : 'text-gray-700 hover:text-blue-600 hover:bg-gray-50'\n                      }`}\n                    >\n                      <User className=\"h-5 w-5\" />\n                      <span>Profile</span>\n                    </Link>\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={handleLogout}\n                      className=\"w-full justify-start flex items-center space-x-2\"\n                      data-testid=\"logout-button\"\n                    >\n                      <LogOut className=\"h-5 w-5\" />\n                      <span>Logout</span>\n                    </Button>\n                  </div>\n                ) : (\n                  <div className=\"space-y-2\">\n                    <Button asChild variant=\"outline\" size=\"sm\" className=\"w-full\">\n                      <Link href=\"/login\" onClick={closeMobileMenu}>Sign In</Link>\n                    </Button>\n                    <Button asChild size=\"sm\" className=\"w-full\">\n                      <Link href=\"/register\" onClick={closeMobileMenu}>Get Started</Link>\n                    </Button>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </nav>\n  )\n}"],"names":["GlobalNavigation","isMobileMenuOpen","setIsMobileMenuOpen","useState","hasError","setHasError","pathname","usePathname","nav","className","div","user","signOut","isLoading","isAuthenticated","useUser","error","console","warn","userActions","useUserActions","useUserLoading","useIsAuthenticated","t","i18n","useI18n","key","toggleMobileMenu","closeMobileMenu","handleLogout","result","Promise","isActive","path","navigationItems","href","label","icon","Home","Vote","BarChart3","Link","onClick","Shield","span","map","item","Icon","data-testid","undefined","LanguageSelector","User","Settings","Button","variant","size","LogOut","asChild","aria-label","aria-expanded","X","Menu"],"mappings":"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"}