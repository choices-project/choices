{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/lib/utils/performance-monitor.ts"],"sourcesContent":["/**\n * Performance Monitoring Utilities\n * \n * Provides utilities for monitoring and optimizing performance metrics\n * including Core Web Vitals, memory usage, and bundle analysis.\n * \n * Created: January 27, 2025\n * Status: ✅ ACTIVE\n */\n\nexport interface PerformanceMetrics {\n  // Core Web Vitals\n  lcp: number; // Largest Contentful Paint\n  fid: number; // First Input Delay\n  cls: number; // Cumulative Layout Shift\n  \n  // Loading Performance\n  fcp: number; // First Contentful Paint\n  tti: number; // Time to Interactive\n  tbt: number; // Total Blocking Time\n  \n  // Resource Performance\n  jsBundleSize: number;\n  cssBundleSize: number;\n  imageCount: number;\n  totalRequests: number;\n  \n  // Memory Performance\n  memoryUsage: {\n    usedJSHeapSize: number;\n    totalJSHeapSize: number;\n    jsHeapSizeLimit: number;\n  };\n}\n\nexport interface PerformanceThresholds {\n  lcp: number; // 2.5s\n  fid: number; // 100ms\n  cls: number; // 0.1\n  fcp: number; // 1.8s\n  tti: number; // 3.8s\n  tbt: number; // 200ms\n  jsBundleSize: number; // 500KB\n  cssBundleSize: number; // 100KB\n  memoryGrowth: number; // 50MB\n}\n\nexport const DEFAULT_THRESHOLDS: PerformanceThresholds = {\n  lcp: 2500, // 2.5 seconds\n  fid: 100,  // 100 milliseconds\n  cls: 0.1,  // 0.1\n  fcp: 1800, // 1.8 seconds\n  tti: 3800, // 3.8 seconds\n  tbt: 200,  // 200 milliseconds\n  jsBundleSize: 500000, // 500KB\n  cssBundleSize: 100000, // 100KB\n  memoryGrowth: 52428800, // 50MB\n};\n\n/**\n * Performance Monitor Class\n */\nexport class PerformanceMonitor {\n  private metrics: Partial<PerformanceMetrics> = {};\n  private observers: PerformanceObserver[] = [];\n  private isMonitoring = false;\n\n  constructor() {\n    this.initializeObservers();\n  }\n\n  /**\n   * Initialize performance observers\n   */\n  private initializeObservers(): void {\n    if (typeof window === 'undefined') return;\n\n    // LCP Observer\n    if ('PerformanceObserver' in window) {\n      const lcpObserver = new PerformanceObserver((list) => {\n        const entries = list.getEntries();\n        const lastEntry = entries[entries.length - 1];\n        this.metrics.lcp = lastEntry?.startTime || 0;\n      });\n      lcpObserver.observe({ entryTypes: ['largest-contentful-paint'] });\n      this.observers.push(lcpObserver);\n\n      // FID Observer\n      const fidObserver = new PerformanceObserver((list) => {\n        const entries = list.getEntries();\n        entries.forEach((entry: any) => {\n          if (entry.processingStart && entry.startTime) {\n            this.metrics.fid = entry.processingStart - entry.startTime;\n          }\n        });\n      });\n      fidObserver.observe({ entryTypes: ['first-input'] });\n      this.observers.push(fidObserver);\n\n      // CLS Observer\n      let clsValue = 0;\n      const clsObserver = new PerformanceObserver((list) => {\n        const entries = list.getEntries();\n        entries.forEach((entry: any) => {\n          if (!entry.hadRecentInput) {\n            clsValue += entry.value;\n          }\n        });\n        this.metrics.cls = clsValue;\n      });\n      clsObserver.observe({ entryTypes: ['layout-shift'] });\n      this.observers.push(clsObserver);\n\n      // FCP Observer\n      const fcpObserver = new PerformanceObserver((list) => {\n        const entries = list.getEntries();\n        entries.forEach((entry: any) => {\n          if (entry.name === 'first-contentful-paint') {\n            this.metrics.fcp = entry.startTime;\n          }\n        });\n      });\n      fcpObserver.observe({ entryTypes: ['paint'] });\n      this.observers.push(fcpObserver);\n    }\n  }\n\n  /**\n   * Start monitoring performance\n   */\n  startMonitoring(): void {\n    this.isMonitoring = true;\n    this.initializeObservers();\n  }\n\n  /**\n   * Stop monitoring performance\n   */\n  stopMonitoring(): void {\n    this.isMonitoring = false;\n    this.observers.forEach(observer => observer.disconnect());\n    this.observers = [];\n  }\n\n  /**\n   * Get current performance metrics\n   */\n  getMetrics(): Partial<PerformanceMetrics> {\n    if (typeof window === 'undefined') return {};\n\n    // Get memory usage\n    if ('memory' in performance) {\n      this.metrics.memoryUsage = {\n        usedJSHeapSize: (performance.memory as any).usedJSHeapSize,\n        totalJSHeapSize: (performance.memory as any).totalJSHeapSize,\n        jsHeapSizeLimit: (performance.memory as any).jsHeapSizeLimit,\n      };\n    }\n\n    // Get resource metrics\n    const resources = performance.getEntriesByType('resource');\n    let jsSize = 0;\n    let cssSize = 0;\n    let imageCount = 0;\n\n    resources.forEach((resource: any) => {\n      if (resource.name.includes('.js')) {\n        jsSize += resource.transferSize || 0;\n      } else if (resource.name.includes('.css')) {\n        cssSize += resource.transferSize || 0;\n      } else if (resource.name.match(/\\.(jpg|jpeg|png|gif|webp|svg)$/)) {\n        imageCount++;\n      }\n    });\n\n    this.metrics.jsBundleSize = jsSize;\n    this.metrics.cssBundleSize = cssSize;\n    this.metrics.imageCount = imageCount;\n    this.metrics.totalRequests = resources.length;\n\n    return { ...this.metrics };\n  }\n\n  /**\n   * Validate performance metrics against thresholds\n   */\n  validateMetrics(thresholds: PerformanceThresholds = DEFAULT_THRESHOLDS): {\n    passed: boolean;\n    failures: string[];\n    score: number;\n  } {\n    const metrics = this.getMetrics();\n    const failures: string[] = [];\n    let score = 100;\n\n    // Check each metric\n    if (metrics.lcp && metrics.lcp > thresholds.lcp) {\n      failures.push(`LCP ${metrics.lcp}ms exceeds threshold ${thresholds.lcp}ms`);\n      score -= 20;\n    }\n\n    if (metrics.fid && metrics.fid > thresholds.fid) {\n      failures.push(`FID ${metrics.fid}ms exceeds threshold ${thresholds.fid}ms`);\n      score -= 20;\n    }\n\n    if (metrics.cls && metrics.cls > thresholds.cls) {\n      failures.push(`CLS ${metrics.cls} exceeds threshold ${thresholds.cls}`);\n      score -= 20;\n    }\n\n    if (metrics.fcp && metrics.fcp > thresholds.fcp) {\n      failures.push(`FCP ${metrics.fcp}ms exceeds threshold ${thresholds.fcp}ms`);\n      score -= 10;\n    }\n\n    if (metrics.tti && metrics.tti > thresholds.tti) {\n      failures.push(`TTI ${metrics.tti}ms exceeds threshold ${thresholds.tti}ms`);\n      score -= 10;\n    }\n\n    if (metrics.tbt && metrics.tbt > thresholds.tbt) {\n      failures.push(`TBT ${metrics.tbt}ms exceeds threshold ${thresholds.tbt}ms`);\n      score -= 10;\n    }\n\n    if (metrics.jsBundleSize && metrics.jsBundleSize > thresholds.jsBundleSize) {\n      failures.push(`JS Bundle ${metrics.jsBundleSize} bytes exceeds threshold ${thresholds.jsBundleSize} bytes`);\n      score -= 5;\n    }\n\n    if (metrics.cssBundleSize && metrics.cssBundleSize > thresholds.cssBundleSize) {\n      failures.push(`CSS Bundle ${metrics.cssBundleSize} bytes exceeds threshold ${thresholds.cssBundleSize} bytes`);\n      score -= 5;\n    }\n\n    return {\n      passed: failures.length === 0,\n      failures,\n      score: Math.max(0, score)\n    };\n  }\n\n  /**\n   * Generate performance report\n   */\n  generateReport(): string {\n    const metrics = this.getMetrics();\n    const validation = this.validateMetrics();\n\n    return `\n# Performance Report\n\n## Core Web Vitals\n- **LCP (Largest Contentful Paint):** ${metrics.lcp ? `${metrics.lcp}ms` : 'N/A'}\n- **FID (First Input Delay):** ${metrics.fid ? `${metrics.fid}ms` : 'N/A'}\n- **CLS (Cumulative Layout Shift):** ${metrics.cls ? metrics.cls.toFixed(3) : 'N/A'}\n\n## Loading Performance\n- **FCP (First Contentful Paint):** ${metrics.fcp ? `${metrics.fcp}ms` : 'N/A'}\n- **TTI (Time to Interactive):** ${metrics.tti ? `${metrics.tti}ms` : 'N/A'}\n- **TBT (Total Blocking Time):** ${metrics.tbt ? `${metrics.tbt}ms` : 'N/A'}\n\n## Resource Performance\n- **JavaScript Bundle Size:** ${metrics.jsBundleSize ? `${(metrics.jsBundleSize / 1024).toFixed(2)}KB` : 'N/A'}\n- **CSS Bundle Size:** ${metrics.cssBundleSize ? `${(metrics.cssBundleSize / 1024).toFixed(2)}KB` : 'N/A'}\n- **Image Count:** ${metrics.imageCount || 'N/A'}\n- **Total Requests:** ${metrics.totalRequests || 'N/A'}\n\n## Memory Performance\n- **Used JS Heap:** ${metrics.memoryUsage ? `${(metrics.memoryUsage.usedJSHeapSize / 1024 / 1024).toFixed(2)}MB` : 'N/A'}\n- **Total JS Heap:** ${metrics.memoryUsage ? `${(metrics.memoryUsage.totalJSHeapSize / 1024 / 1024).toFixed(2)}MB` : 'N/A'}\n\n## Performance Score\n- **Score:** ${validation.score}/100\n- **Status:** ${validation.passed ? '✅ PASSED' : '❌ FAILED'}\n\n## Issues\n${validation.failures.length > 0 ? validation.failures.map(f => `- ${f}`).join('\\n') : '- ✅ All metrics within acceptable ranges'}\n\n## Recommendations\n${this.generateRecommendations(metrics)}\n`;\n  }\n\n  /**\n   * Generate performance recommendations\n   */\n  private generateRecommendations(metrics: Partial<PerformanceMetrics>): string {\n    const recommendations: string[] = [];\n\n    if (metrics.lcp && metrics.lcp > 2500) {\n      recommendations.push('- Optimize Largest Contentful Paint (LCP) by reducing image sizes and improving server response times');\n    }\n\n    if (metrics.fid && metrics.fid > 100) {\n      recommendations.push('- Reduce First Input Delay (FID) by optimizing JavaScript execution and reducing main thread blocking');\n    }\n\n    if (metrics.cls && metrics.cls > 0.1) {\n      recommendations.push('- Minimize Cumulative Layout Shift (CLS) by setting explicit dimensions for images and avoiding dynamic content insertion');\n    }\n\n    if (metrics.jsBundleSize && metrics.jsBundleSize > 500000) {\n      recommendations.push('- Optimize JavaScript bundle size by code splitting, tree shaking, and removing unused dependencies');\n    }\n\n    if (metrics.cssBundleSize && metrics.cssBundleSize > 100000) {\n      recommendations.push('- Optimize CSS bundle size by removing unused styles and using CSS-in-JS solutions');\n    }\n\n    if (metrics.totalRequests && metrics.totalRequests > 50) {\n      recommendations.push('- Reduce number of network requests by combining resources and using HTTP/2 server push');\n    }\n\n    if (recommendations.length === 0) {\n      return '- ✅ All performance metrics are within acceptable ranges';\n    }\n\n    return recommendations.join('\\n');\n  }\n}\n\n/**\n * Global performance monitor instance\n */\nexport const performanceMonitor = new PerformanceMonitor();\n\n/**\n * Hook for using performance monitoring in React components\n */\nexport function usePerformanceMonitor() {\n  const [metrics, setMetrics] = React.useState<Partial<PerformanceMetrics>>({});\n  const [isMonitoring, setIsMonitoring] = React.useState(false);\n\n  const startMonitoring = React.useCallback(() => {\n    performanceMonitor.startMonitoring();\n    setIsMonitoring(true);\n  }, []);\n\n  const stopMonitoring = React.useCallback(() => {\n    performanceMonitor.stopMonitoring();\n    setIsMonitoring(false);\n  }, []);\n\n  const updateMetrics = React.useCallback(() => {\n    const currentMetrics = performanceMonitor.getMetrics();\n    setMetrics(currentMetrics);\n  }, []);\n\n  React.useEffect(() => {\n    if (isMonitoring) {\n      const interval = setInterval(updateMetrics, 1000);\n      return () => clearInterval(interval);\n    }\n  }, [isMonitoring, updateMetrics]);\n\n  return {\n    metrics,\n    isMonitoring,\n    startMonitoring,\n    stopMonitoring,\n    updateMetrics,\n    validateMetrics: performanceMonitor.validateMetrics.bind(performanceMonitor),\n    generateReport: performanceMonitor.generateReport.bind(performanceMonitor),\n  };\n}\n\n// Import React for the hook\nimport React from 'react';\n\n"],"names":["DEFAULT_THRESHOLDS","PerformanceMonitor","performanceMonitor","usePerformanceMonitor","lcp","fid","cls","fcp","tti","tbt","jsBundleSize","cssBundleSize","memoryGrowth","metrics","observers","isMonitoring","initializeObservers","window","lcpObserver","PerformanceObserver","list","entries","getEntries","lastEntry","length","startTime","observe","entryTypes","push","fidObserver","forEach","entry","processingStart","clsValue","clsObserver","hadRecentInput","value","fcpObserver","name","startMonitoring","stopMonitoring","observer","disconnect","getMetrics","performance","memoryUsage","usedJSHeapSize","memory","totalJSHeapSize","jsHeapSizeLimit","resources","getEntriesByType","jsSize","cssSize","imageCount","resource","includes","transferSize","match","totalRequests","validateMetrics","thresholds","failures","score","passed","Math","max","generateReport","validation","toFixed","map","f","join","generateRecommendations","recommendations","setMetrics","React","useState","setIsMonitoring","useCallback","updateMetrics","currentMetrics","useEffect","interval","setInterval","clearInterval","bind"],"mappings":"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"}