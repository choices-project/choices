{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/tests/jest/unit/features/feeds/UnifiedFeed.performance.test.tsx"],"sourcesContent":["/**\n * UnifiedFeed Performance Tests (Jest)\n *\n * Note: This suite is intentionally skipped.\n * Reason: With jsdom and heavy mocking, Jest does not yield meaningful\n * performance metrics. We'll move performance to Playwright + Lighthouse/Tracing.\n *\n * Created: January 19, 2025\n * Updated: 2025-10-20 (skipped in favor of E2E performance checks)\n * Status: ⏭️ Skipped (see testing_audit.md for the plan)\n */\n\n/** @jest-environment jsdom */\nimport React from 'react';\nimport type { Database } from '@/types/database';\nimport { render, screen, fireEvent, act } from '@testing-library/react';\nimport { jest } from '@jest/globals';\nimport UnifiedFeed from '@/features/feeds/components/UnifiedFeed';\nimport * as Stores from '@/lib/stores';\n\n// Shared mock state for aggregated stores used by UnifiedFeed\nconst mockStores = {\n  feeds: [] as any[],\n  hashtagStore: { hashtags: [] as any[], trendingHashtags: [] as any[], isLoading: false, error: null as any },\n  feedsActions: { loadFeeds: jest.fn(), likeFeed: jest.fn(), bookmarkFeed: jest.fn(), refreshFeeds: jest.fn() },\n  feedsLoading: false,\n  pwaStore: {} as any,\n  userStore: { user: { id: 'test-user' } } as any,\n  notificationStore: { addNotification: jest.fn() } as any,\n};\nconst hashtagActions = { getTrendingHashtags: jest.fn() };\nimport { T } from '@/tests/registry/testIds';\n\n// Mock the aggregated stores module used by UnifiedFeed\njest.mock('@/lib/stores', () => {\n  const actual = jest.requireActual('@/lib/stores');\n  const React = require('react');\n  const useSyncExternalStore = (React).useSyncExternalStore;\n  const subscribe = () => () => {};\n  const getFeedsSnapshot = () => mockStores.feeds;\n  const getHashtagSnapshot = () => mockStores.hashtagStore;\n  const getActionsSnapshot = () => mockStores.feedsActions;\n  const getLoadingSnapshot = () => mockStores.feedsLoading;\n  const getUserSnapshot = () => mockStores.userStore;\n  const getPwaSnapshot = () => mockStores.pwaStore;\n  const getNotifSnapshot = () => mockStores.notificationStore;\n  return {\n    ...actual,\n    useFeeds: () => useSyncExternalStore(subscribe, getFeedsSnapshot, getFeedsSnapshot),\n    useFeedsActions: (selector?: any) => {\n      const state = useSyncExternalStore(subscribe, getActionsSnapshot, getActionsSnapshot);\n      return typeof selector === 'function' ? selector(state) : state;\n    },\n    useFeedsLoading: () => useSyncExternalStore(subscribe, getLoadingSnapshot, getLoadingSnapshot),\n    usePWAStore: (selector?: any) => {\n      const state = useSyncExternalStore(subscribe, getPwaSnapshot, getPwaSnapshot);\n      return typeof selector === 'function' ? selector(state) : state;\n    },\n    useUserStore: (selector?: any) => {\n      const state = useSyncExternalStore(subscribe, getUserSnapshot, getUserSnapshot);\n      return typeof selector === 'function' ? selector(state) : state;\n    },\n    useNotificationStore: (selector?: any) => {\n      const state = useSyncExternalStore(subscribe, getNotifSnapshot, getNotifSnapshot);\n      return typeof selector === 'function' ? selector(state) : state;\n    },\n    useHashtagStore: (selector?: any) => {\n      const state = useSyncExternalStore(subscribe, getHashtagSnapshot, getHashtagSnapshot);\n      return typeof selector === 'function' ? selector(state) : state;\n    },\n    useHashtagActions: () => hashtagActions,\n    useHashtagStats: () => ({ trendingCount: 0 }),\n  };\n});\n\n// Types only helpers; runtime values are from module mock above\n\n// Ensure mocks are properly initialized\nbeforeEach(() => {\n  mockStores.feeds.length = 0;\n  Object.assign(mockStores.hashtagStore, { hashtags: [], trendingHashtags: [], isLoading: false, error: null });\n  mockStores.feedsActions.loadFeeds = jest.fn();\n  mockStores.feedsActions.likeFeed = jest.fn();\n  mockStores.feedsActions.bookmarkFeed = jest.fn();\n  mockStores.feedsActions.refreshFeeds = jest.fn();\n  mockStores.feedsLoading = false;\n});\n\n\n// Performance test data\nconst generateLargeFeedData = (count: number) => \n  Array.from({ length: count }, (_, i) => ({\n    id: `${i}`,\n    title: `Test ${i % 2 === 0 ? 'Poll' : 'Post'} ${i}`,\n    content: `This is test ${i % 2 === 0 ? 'poll' : 'post'} ${i} with some content`,\n    summary: `This is test ${i % 2 === 0 ? 'poll' : 'post'} ${i}`,\n    author: {\n      id: `author-${i}`,\n      name: `User ${i}`,\n      avatar: `/test-avatar-${i}.jpg`,\n      verified: Math.random() > 0.8\n    },\n    category: `category${i % 5}`,\n    tags: [`hashtag${i % 10}`, `category${i % 5}`],\n    type: (i % 2 === 0 ? 'poll' : 'article'),\n    source: {\n      name: `Source ${i}`,\n      url: `https://example.com/${i}`,\n      logo: `/test-logo-${i}.jpg`,\n      verified: true\n    },\n    publishedAt: new Date(Date.now() - i * 1000).toISOString(),\n    updatedAt: new Date(Date.now() - i * 1000).toISOString(),\n    readTime: Math.floor(Math.random() * 10) + 1,\n    engagement: {\n      likes: Math.floor(Math.random() * 1000),\n      shares: Math.floor(Math.random() * 500),\n      comments: Math.floor(Math.random() * 200),\n      views: Math.floor(Math.random() * 5000)\n    },\n    userInteraction: {\n      liked: false,\n      shared: false,\n      bookmarked: false,\n      read: false\n    },\n    metadata: {\n      hashtags: [`hashtag${i % 10}`, `category${i % 5}`],\n      primary_hashtag: `hashtag${i % 10}`,\n      language: 'en'\n    }\n  }));\n\nconst generateLargeHashtagData = (count: number) =>\n  Array.from({ length: count }, (_, i) => ({\n    id: `${i}`,\n    name: `hashtag${i}`,\n    display_name: `Hashtag ${i}`,\n    usage_count: Math.floor(Math.random() * 1000),\n    follower_count: Math.floor(Math.random() * 500),\n    is_trending: Math.random() > 0.7,\n    trend_score: Math.random(),\n    created_at: new Date(Date.now() - i * 1000).toISOString(),\n    updated_at: new Date(Date.now() - i * 1000).toISOString(),\n    is_verified: Math.random() > 0.9,\n    is_featured: Math.random() > 0.8\n  }));\n\n// Disable this suite in Jest; performance will be validated in E2E/browser\nconst D = describe.skip;\n\nD('UnifiedFeed Performance Tests', () => {\n  beforeEach(() => {\n    // reset snapshots\n    mockStores.feeds = [];\n    mockStores.hashtagStore = { hashtags: [], trendingHashtags: [], isLoading: false, error: null } as any;\n    mockStores.feedsLoading = false;\n    mockStores.feedsActions = { loadFeeds: jest.fn(), likeFeed: jest.fn(), bookmarkFeed: jest.fn(), refreshFeeds: jest.fn() } as any;\n    hashtagActions.getTrendingHashtags = jest.fn();\n  });\n\n  afterEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('Rendering Performance', () => {\n    test('should render small dataset (< 50 items) within 500ms', async () => {\n      const smallDataset = generateLargeFeedData(50);\n      mockStores.feeds.length = 0;\n      mockStores.feeds.push(...(smallDataset as any[]));\n\n      const startTime = performance.now();\n      \n      await act(async () => {\n        render(<UnifiedFeed enableRealTimeUpdates={false} enableAnalytics={false} enableHaptics={false} />);\n      });\n      \n      const endTime = performance.now();\n      const renderTime = endTime - startTime;\n      \n      expect(renderTime).toBeLessThan(500);\n    });\n\n    test('should render medium dataset (50-200 items) within 1000ms', async () => {\n      const mediumDataset = generateLargeFeedData(200);\n      mockStores.feeds.length = 0;\n      mockStores.feeds.push(...(mediumDataset as any[]));\n\n      const startTime = performance.now();\n      \n      await act(async () => {\n        render(<UnifiedFeed enableRealTimeUpdates={false} enableAnalytics={false} enableHaptics={false} />);\n      });\n      \n      const endTime = performance.now();\n      const renderTime = endTime - startTime;\n      \n      expect(renderTime).toBeLessThan(1000);\n    });\n\n    test('should render large dataset (200+ items) within 2000ms', async () => {\n      const largeDataset = generateLargeFeedData(500);\n      mockStores.feeds.length = 0;\n      mockStores.feeds.push(...(largeDataset as any[]));\n\n      const startTime = performance.now();\n      \n      await act(async () => {\n        render(<UnifiedFeed enableRealTimeUpdates={false} enableAnalytics={false} enableHaptics={false} />);\n      });\n      \n      const endTime = performance.now();\n      const renderTime = endTime - startTime;\n      \n      expect(renderTime).toBeLessThan(2000);\n    });\n\n    test('should handle hashtag data efficiently', async () => {\n      const largeHashtagDataset = generateLargeHashtagData(1000);\n      Object.assign(mockStores.hashtagStore, { hashtags: largeHashtagDataset as any[], trendingHashtags: [], isLoading: false, error: null });\n\n      const startTime = performance.now();\n      \n      await act(async () => {\n        render(<UnifiedFeed />);\n      });\n      \n      const endTime = performance.now();\n      const renderTime = endTime - startTime;\n      \n      expect(renderTime).toBeLessThan(1500);\n    });\n  });\n\n  describe('Interaction Performance', () => {\n    test('should handle rapid clicks within acceptable time', async () => {\n      const component = <UnifiedFeed enableRealTimeUpdates={false} enableAnalytics={false} enableHaptics={false} />;\n      render(component);\n      \n      const startTime = performance.now();\n      \n      // Simulate rapid interactions\n      for (let i = 0; i < 20; i++) {\n        const likeButton = screen.getByLabelText(/like/i);\n        fireEvent.click(likeButton);\n        \n        // Small delay to simulate real user behavior\n        await act(async () => {\n          await new Promise(resolve => setTimeout(resolve, 10));\n        });\n      }\n      \n      const endTime = performance.now();\n      const totalTime = endTime - startTime;\n      \n      // Should handle 20 interactions within 1 second\n      expect(totalTime).toBeLessThan(1000);\n    });\n\n    test('should handle scroll events efficiently', async () => {\n      const largeDataset = generateLargeFeedData(300);\n      mockStores.feeds.length = 0;\n      mockStores.feeds.push(...(largeDataset as any[]));\n\n      const component = <UnifiedFeed enableRealTimeUpdates={false} enableAnalytics={false} enableHaptics={false} />;\n      render(component);\n      \n      const startTime = performance.now();\n      \n      // Simulate scroll events\n      for (let i = 0; i < 10; i++) {\n        fireEvent.scroll(window, { target: { scrollY: i * 100 } });\n        await act(async () => {\n          await new Promise(resolve => setTimeout(resolve, 50));\n        });\n      }\n      \n      const endTime = performance.now();\n      const totalTime = endTime - startTime;\n      \n      // Should handle scroll events efficiently\n      expect(totalTime).toBeLessThan(2000);\n    });\n\n    test('should handle filter changes efficiently', async () => {\n      const component = <UnifiedFeed enableRealTimeUpdates={false} enableAnalytics={false} enableHaptics={false} />;\n      render(component);\n      \n      const startTime = performance.now();\n      \n      // Simulate filter changes\n      for (let i = 0; i < 10; i++) {\n      const hashtag = screen.getByText(`hashtag${i % 10}`);\n        fireEvent.click(hashtag);\n        \n        await act(async () => {\n          await new Promise(resolve => setTimeout(resolve, 50));\n        });\n      }\n      \n      const endTime = performance.now();\n      const totalTime = endTime - startTime;\n      \n      // Should handle filter changes within 1 second\n      expect(totalTime).toBeLessThan(1000);\n    });\n  });\n\n  describe('Memory Performance', () => {\n    test('should not leak memory during repeated renders', async () => {\n      const initialMemory = performance.memory?.usedJSHeapSize || 0;\n      \n      // Render and unmount component multiple times\n      for (let i = 0; i < 10; i++) {\n        const { unmount } = render(<UnifiedFeed />);\n        unmount();\n        \n        // Force garbage collection if available\n        if (global.gc) {\n          global.gc();\n        }\n      }\n      \n      const finalMemory = performance.memory?.usedJSHeapSize || 0;\n      const memoryIncrease = finalMemory - initialMemory;\n      \n      // Memory increase should be minimal (< 10MB)\n      expect(memoryIncrease).toBeLessThan(10 * 1024 * 1024);\n    });\n\n    test('should handle large datasets without memory issues', async () => {\n      const veryLargeDataset = generateLargeFeedData(1000);\n      mockStores.feeds.length = 0;\n      mockStores.feeds.push(...(veryLargeDataset as any[]));\n\n      const initialMemory = performance.memory?.usedJSHeapSize || 0;\n      \n      await act(async () => {\n        render(<UnifiedFeed enableRealTimeUpdates={false} enableAnalytics={false} enableHaptics={false} />);\n      });\n      \n      const finalMemory = performance.memory?.usedJSHeapSize || 0;\n      const memoryIncrease = finalMemory - initialMemory;\n      \n      // Memory increase should be reasonable (< 50MB for 1000 items)\n      expect(memoryIncrease).toBeLessThan(50 * 1024 * 1024);\n    });\n  });\n\n  describe('Network Performance', () => {\n    test('should handle slow network responses gracefully', async () => {\n      // Mock slow network response\n      Object.assign(mockStores.hashtagStore, { hashtags: [], trendingHashtags: [], isLoading: true, error: null });\n\n      const startTime = performance.now();\n      \n      await act(async () => {\n        render(<UnifiedFeed enableRealTimeUpdates={false} enableAnalytics={false} enableHaptics={false} />);\n      });\n      \n      // Simulate slow loading\n      await act(async () => {\n        await new Promise(resolve => setTimeout(resolve, 2000));\n      });\n      \n      const endTime = performance.now();\n      const totalTime = endTime - startTime;\n      \n      // Should handle slow loading within 3 seconds\n      expect(totalTime).toBeLessThan(3000);\n    });\n\n    test('should handle network errors without performance degradation', async () => {\n      Object.assign(mockStores.hashtagStore, { hashtags: [], trendingHashtags: [], isLoading: false, error: 'Network error' } as any);\n\n      const startTime = performance.now();\n      \n      await act(async () => {\n        render(<UnifiedFeed />);\n      });\n      \n      const endTime = performance.now();\n      const renderTime = endTime - startTime;\n      \n      // Should render error state quickly\n      expect(renderTime).toBeLessThan(500);\n    });\n  });\n\n  describe('Animation Performance', () => {\n    test('should handle animations smoothly', async () => {\n      const component = <UnifiedFeed enableRealTimeUpdates={false} enableAnalytics={false} enableHaptics={false} />;\n      render(component);\n      \n      const startTime = performance.now();\n      \n      // Trigger animations\n      const darkModeButton = screen.getByLabelText(/switch to dark mode/i);\n      fireEvent.click(darkModeButton);\n      \n      // Wait for animation to complete\n      await act(async () => {\n        await new Promise(resolve => setTimeout(resolve, 300));\n      });\n      \n      const endTime = performance.now();\n      const animationTime = endTime - startTime;\n      \n      // Animation should complete within 500ms\n      expect(animationTime).toBeLessThan(500);\n    });\n\n    test('should handle multiple simultaneous animations', async () => {\n      const component = <UnifiedFeed enableRealTimeUpdates={false} enableAnalytics={false} enableHaptics={false} />;\n      render(component);\n      \n      const startTime = performance.now();\n      \n      // Trigger multiple animations simultaneously\n      const darkModeButton = screen.getByLabelText(/switch to dark mode/i);\n      const filtersButton = screen.getByLabelText(/toggle advanced filters/i);\n      \n      fireEvent.click(darkModeButton);\n      fireEvent.click(filtersButton);\n      \n      // Wait for animations to complete\n      await act(async () => {\n        await new Promise(resolve => setTimeout(resolve, 500));\n      });\n      \n      const endTime = performance.now();\n      const animationTime = endTime - startTime;\n      \n      // Multiple animations should complete within 1 second\n      expect(animationTime).toBeLessThan(1000);\n    });\n  });\n\n  describe('Real-time Updates Performance', () => {\n    test('should handle real-time updates efficiently', async () => {\n      const component = <UnifiedFeed />;\n      render(component);\n      \n      const startTime = performance.now();\n      \n      // Simulate real-time updates\n      for (let i = 0; i < 10; i++) {\n        const newFeedData = generateLargeFeedData(10);\n        mockStores.feeds.length = 0;\n        mockStores.feeds.push(...(newFeedData as any[]));\n        \n        await act(async () => {\n          await new Promise(resolve => setTimeout(resolve, 100));\n        });\n      }\n      \n      const endTime = performance.now();\n      const updateTime = endTime - startTime;\n      \n      // Should handle 10 updates within 2 seconds\n      expect(updateTime).toBeLessThan(2000);\n    });\n\n    test('should handle WebSocket updates without performance issues', async () => {\n      const component = <UnifiedFeed />;\n      render(component);\n      \n      const startTime = performance.now();\n      \n      // Simulate WebSocket updates\n      for (let i = 0; i < 5; i++) {\n        // Simulate WebSocket message\n        fireEvent(window, new Event('message'));\n        \n        await act(async () => {\n          await new Promise(resolve => setTimeout(resolve, 200));\n        });\n      }\n      \n      const endTime = performance.now();\n      const updateTime = endTime - startTime;\n      \n      // Should handle WebSocket updates within 1.5 seconds\n      expect(updateTime).toBeLessThan(1500);\n    });\n  });\n\n  describe('Accessibility Performance', () => {\n    test('should handle screen reader updates efficiently', async () => {\n      const component = <UnifiedFeed />;\n      render(component);\n      \n      const startTime = performance.now();\n      \n      // Simulate screen reader updates\n      for (let i = 0; i < 5; i++) {\n        const likeButton = screen.getByLabelText(/like/i);\n        fireEvent.click(likeButton);\n        \n        await act(async () => {\n          await new Promise(resolve => setTimeout(resolve, 100));\n        });\n      }\n      \n      const endTime = performance.now();\n      const updateTime = endTime - startTime;\n      \n      // Should handle screen reader updates within 1 second\n      expect(updateTime).toBeLessThan(1000);\n    });\n\n    test('should handle keyboard navigation efficiently', async () => {\n      const component = <UnifiedFeed />;\n      render(component);\n      \n      const startTime = performance.now();\n      \n      // Simulate keyboard navigation\n      for (let i = 0; i < 10; i++) {\n        fireEvent.keyDown(document, { key: 'Tab' });\n        \n        await act(async () => {\n          await new Promise(resolve => setTimeout(resolve, 50));\n        });\n      }\n      \n      const endTime = performance.now();\n      const navigationTime = endTime - startTime;\n      \n      // Should handle keyboard navigation within 1 second\n      expect(navigationTime).toBeLessThan(1000);\n    });\n  });\n});\n"],"names":["mockStores","feeds","hashtagStore","hashtags","trendingHashtags","isLoading","error","feedsActions","loadFeeds","jest","fn","likeFeed","bookmarkFeed","refreshFeeds","feedsLoading","pwaStore","userStore","user","id","notificationStore","addNotification","hashtagActions","getTrendingHashtags","mock","actual","requireActual","React","require","useSyncExternalStore","subscribe","getFeedsSnapshot","getHashtagSnapshot","getActionsSnapshot","getLoadingSnapshot","getUserSnapshot","getPwaSnapshot","getNotifSnapshot","useFeeds","useFeedsActions","selector","state","useFeedsLoading","usePWAStore","useUserStore","useNotificationStore","useHashtagStore","useHashtagActions","useHashtagStats","trendingCount","beforeEach","length","Object","assign","generateLargeFeedData","count","Array","from","_","i","title","content","summary","author","name","avatar","verified","Math","random","category","tags","type","source","url","logo","publishedAt","Date","now","toISOString","updatedAt","readTime","floor","engagement","likes","shares","comments","views","userInteraction","liked","shared","bookmarked","read","metadata","primary_hashtag","language","generateLargeHashtagData","display_name","usage_count","follower_count","is_trending","trend_score","created_at","updated_at","is_verified","is_featured","D","describe","skip","afterEach","clearAllMocks","test","smallDataset","push","startTime","performance","act","render","UnifiedFeed","enableRealTimeUpdates","enableAnalytics","enableHaptics","endTime","renderTime","expect","toBeLessThan","mediumDataset","largeDataset","largeHashtagDataset","component","likeButton","screen","getByLabelText","fireEvent","click","Promise","resolve","setTimeout","totalTime","scroll","window","target","scrollY","hashtag","getByText","initialMemory","memory","usedJSHeapSize","unmount","global","gc","finalMemory","memoryIncrease","veryLargeDataset","darkModeButton","animationTime","filtersButton","newFeedData","updateTime","Event","keyDown","document","key","navigationTime"],"mappings":"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"}