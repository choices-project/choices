{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/tests/jest/unit/performance/advanced-optimization.test.tsx"],"sourcesContent":["/**\n * @jest-environment jsdom\n */\n\nimport React from 'react';\nimport { render, screen, waitFor, act } from '@testing-library/react';\nimport { BrowserRouter } from 'react-router-dom';\nimport UnifiedFeed from '@/features/feeds/components/UnifiedFeed';\nimport { performanceProfiler, ProfilerMetrics, ComponentProfile } from './performance-profiler';\nimport { logger } from '@/lib/utils/logger';\n\n// Setup minimal mocks for test environment\nbeforeAll(() => {\n  // Mock localStorage for component functionality\n  Object.defineProperty(window, 'localStorage', {\n    value: {\n      getItem: jest.fn(),\n      setItem: jest.fn(),\n      removeItem: jest.fn(),\n      clear: jest.fn(),\n    },\n    writable: true,\n  });\n  \n  // Mock navigator for online status\n  Object.defineProperty(navigator, 'onLine', {\n    value: true,\n    writable: true,\n  });\n\n  // Mock fetch to handle API calls\n  global.fetch = jest.fn((url: string) => {\n    if (url.includes('/api/feeds')) {\n      return Promise.resolve({\n        ok: true,\n        json: () => Promise.resolve([\n          {\n            id: '1',\n            title: 'Sample Civic Activity',\n            description: 'A sample civic activity for testing',\n            category: 'civic',\n            timestamp: new Date().toISOString(),\n            source: 'test'\n          }\n        ])\n      } as Response);\n    }\n    if (url.includes('/api/civics/analytics')) {\n      return Promise.resolve({\n        ok: true,\n        json: () => Promise.resolve({\n          success: true,\n          analytics: {\n            totalViews: 100,\n            engagement: 0.75,\n            userSatisfaction: 0.85\n          }\n        })\n      } as Response);\n    }\n    if (url.includes('/api/pwa/offline/sync')) {\n      return Promise.resolve({\n        ok: true,\n        json: () => Promise.resolve({ success: true })\n      } as Response);\n    }\n    return Promise.resolve({\n      ok: true,\n      json: () => Promise.resolve({})\n    } as Response);\n  });\n});\n\ndescribe('Advanced Performance Optimization Tests', () => {\n  beforeEach(() => {\n    // Clear profiler before each test\n    performanceProfiler.clear();\n  });\n\n  describe('Performance Profiling', () => {\n    it('should profile component performance with deep analysis', async () => {\n      const componentName = 'UnifiedFeed';\n      \n      // Start profiling\n      performanceProfiler.startProfiling(componentName);\n      \n      const startTime = performance.now();\n      const startMemory = performance.memory?.usedJSHeapSize || 0;\n      \n      await act(async () => {\n        render(\n          <BrowserRouter>\n            <UnifiedFeed />\n          </BrowserRouter>\n        );\n      });\n      \n      const endTime = performance.now();\n      const endMemory = performance.memory?.usedJSHeapSize || 0;\n      \n      // Stop profiling and get metrics\n      const metrics = performanceProfiler.stopProfiling(componentName, 1);\n      \n      logger.info(`ðŸ” Deep Performance Analysis:`);\n      logger.info(`- Component: ${metrics.componentName}`);\n      logger.info(`- Render Time: ${metrics.totalRenderTime.toFixed(2)}ms`);\n      logger.info(`- Memory Used: ${metrics.memoryPeak.toFixed(2)}MB`);\n      logger.info(`- Optimization Score: ${metrics.optimizationScore}/100`);\n      logger.info(`- Re-render Triggers: ${metrics.reRenderTriggers.length}`);\n      logger.info(`- Bottlenecks: ${metrics.performanceBottlenecks.length}`);\n      logger.info(`- Recommendations: ${metrics.recommendations.length}`);\n      \n      // Verify metrics\n      expect(metrics.componentName).toBe(componentName);\n      expect(metrics.renderCount).toBe(1);\n      expect(metrics.totalRenderTime).toBeGreaterThan(0);\n      expect(metrics.memoryPeak).toBeGreaterThanOrEqual(0);\n      expect(metrics.optimizationScore).toBeGreaterThanOrEqual(0);\n      expect(metrics.optimizationScore).toBeLessThanOrEqual(100);\n      expect(metrics.recommendations.length).toBeGreaterThan(0);\n    });\n\n    it('should create component profile with optimization analysis', async () => {\n      const componentName = 'UnifiedFeed';\n      \n      // Profile the component\n      performanceProfiler.startProfiling(componentName);\n      \n      await act(async () => {\n        render(\n          <BrowserRouter>\n            <UnifiedFeed />\n          </BrowserRouter>\n        );\n      });\n      \n      const metrics = performanceProfiler.stopProfiling(componentName, 1);\n      \n      // Create component profile\n      const profile = performanceProfiler.createComponentProfile(componentName, metrics);\n      \n      logger.info(`ðŸ“Š Component Profile Created:`);\n      logger.info(`- Name: ${profile.name}`);\n      logger.info(`- Depth: ${profile.depth}`);\n      logger.info(`- Is Optimized: ${profile.isOptimized}`);\n      logger.info(`- Optimization Potential: ${profile.optimizationPotential}`);\n      logger.info(`- Optimization Score: ${profile.metrics.optimizationScore}/100`);\n      \n      // Verify profile\n      expect(profile.name).toBe(componentName);\n      expect(profile.metrics).toBe(metrics);\n      expect(profile.depth).toBe(0);\n      expect(typeof profile.isOptimized).toBe('boolean');\n      expect(['HIGH', 'MEDIUM', 'LOW']).toContain(profile.optimizationPotential);\n    });\n\n    it('should generate comprehensive performance analysis', async () => {\n      // Profile multiple components\n      const components = ['UnifiedFeed', 'TestComponent1', 'TestComponent2'];\n      \n      for (const componentName of components) {\n        performanceProfiler.startProfiling(componentName);\n        \n        await act(async () => {\n          render(\n            <BrowserRouter>\n              <UnifiedFeed />\n            </BrowserRouter>\n          );\n        });\n        \n        const metrics = performanceProfiler.stopProfiling(componentName, Math.floor(Math.random() * 5) + 1);\n        performanceProfiler.createComponentProfile(componentName, metrics);\n      }\n      \n      // Generate comprehensive analysis\n      const analysis = performanceProfiler.generatePerformanceAnalysis();\n      \n      logger.info(`ðŸ“ˆ Comprehensive Performance Analysis:`);\n      logger.info(`- Overall Score: ${analysis.overallScore.toFixed(2)}/100`);\n      logger.info(`- Critical Issues: ${analysis.criticalIssues.length}`);\n      logger.info(`- Optimization Opportunities: ${analysis.optimizationOpportunities.length}`);\n      logger.info(`- Memory Leaks: ${analysis.memoryLeaks.length}`);\n      logger.info(`- Render Optimizations: ${analysis.renderOptimizations.length}`);\n      logger.info(`- Network Optimizations: ${analysis.networkOptimizations.length}`);\n      logger.info(`- Accessibility Optimizations: ${analysis.accessibilityOptimizations.length}`);\n      logger.info(`- Recommendations: ${analysis.recommendations.length}`);\n      logger.info(`- Estimated Improvement: ${analysis.estimatedImprovement.toFixed(2)}%`);\n      \n      // Verify analysis\n      expect(analysis.overallScore).toBeGreaterThanOrEqual(0);\n      expect(analysis.overallScore).toBeLessThanOrEqual(100);\n      expect(Array.isArray(analysis.criticalIssues)).toBe(true);\n      expect(Array.isArray(analysis.optimizationOpportunities)).toBe(true);\n      expect(Array.isArray(analysis.memoryLeaks)).toBe(true);\n      expect(Array.isArray(analysis.renderOptimizations)).toBe(true);\n      expect(Array.isArray(analysis.networkOptimizations)).toBe(true);\n      expect(Array.isArray(analysis.accessibilityOptimizations)).toBe(true);\n      expect(Array.isArray(analysis.recommendations)).toBe(true);\n      expect(analysis.estimatedImprovement).toBeGreaterThanOrEqual(0);\n    });\n  });\n\n  describe('Memory Optimization', () => {\n    it('should identify memory optimization opportunities', async () => {\n      const componentName = 'MemoryOptimizationTest';\n      \n      // Simulate memory-intensive operations\n      performanceProfiler.startProfiling(componentName);\n      \n      await act(async () => {\n        render(\n          <BrowserRouter>\n            <UnifiedFeed />\n          </BrowserRouter>\n        );\n      });\n      \n      const metrics = performanceProfiler.stopProfiling(componentName, 1);\n      \n      logger.info(`ðŸ§  Memory Optimization Analysis:`);\n      logger.info(`- Memory Peak: ${metrics.memoryPeak.toFixed(2)}MB`);\n      logger.info(`- Memory Average: ${metrics.memoryAverage.toFixed(2)}MB`);\n      logger.info(`- Memory Bottlenecks: ${metrics.performanceBottlenecks.filter(b => b.includes('memory')).length}`);\n      \n      // Check for memory optimization recommendations\n      const memoryRecommendations = metrics.recommendations.filter(r => \n        r.includes('memory') || r.includes('cleanup') || r.includes('leak')\n      );\n      \n      logger.info(`- Memory Recommendations: ${memoryRecommendations.length}`);\n      memoryRecommendations.forEach(rec => logger.info(`  - ${rec}`));\n      \n      expect(metrics.memoryPeak).toBeGreaterThanOrEqual(0);\n      expect(metrics.memoryAverage).toBeGreaterThanOrEqual(0);\n      expect(Array.isArray(memoryRecommendations)).toBe(true);\n    });\n\n    it('should detect potential memory leaks', async () => {\n      const componentName = 'MemoryLeakTest';\n      \n      // Simulate multiple renders to detect memory leaks\n      performanceProfiler.startProfiling(componentName);\n      \n      for (let i = 0; i < 5; i++) {\n        await act(async () => {\n          render(\n            <BrowserRouter>\n              <UnifiedFeed />\n            </BrowserRouter>\n          );\n        });\n      }\n      \n      const metrics = performanceProfiler.stopProfiling(componentName, 5);\n      \n      logger.info(`ðŸ” Memory Leak Detection:`);\n      logger.info(`- Render Count: ${metrics.renderCount}`);\n      logger.info(`- Memory Peak: ${metrics.memoryPeak.toFixed(2)}MB`);\n      logger.info(`- Memory Average: ${metrics.memoryAverage.toFixed(2)}MB`);\n      \n      // Check for memory leak indicators\n      const memoryLeakIndicators = metrics.performanceBottlenecks.filter(b => \n        b.includes('memory') || b.includes('leak')\n      );\n      \n      logger.info(`- Memory Leak Indicators: ${memoryLeakIndicators.length}`);\n      memoryLeakIndicators.forEach(indicator => logger.info(`  - ${indicator}`));\n      \n      expect(metrics.renderCount).toBe(5);\n      expect(metrics.memoryPeak).toBeGreaterThanOrEqual(0);\n    });\n  });\n\n  describe('Network Optimization', () => {\n    it('should analyze network performance and optimization', async () => {\n      const componentName = 'NetworkOptimizationTest';\n      \n      performanceProfiler.startProfiling(componentName);\n      \n      await act(async () => {\n        render(\n          <BrowserRouter>\n            <UnifiedFeed />\n          </BrowserRouter>\n        );\n      });\n      \n      const metrics = performanceProfiler.stopProfiling(componentName, 1);\n      \n      logger.info(`ðŸŒ Network Optimization Analysis:`);\n      logger.info(`- Component: ${metrics.componentName}`);\n      logger.info(`- Render Time: ${metrics.totalRenderTime.toFixed(2)}ms`);\n      logger.info(`- Network Bottlenecks: ${metrics.performanceBottlenecks.filter(b => b.includes('network')).length}`);\n      \n      // Check for network optimization recommendations\n      const networkRecommendations = metrics.recommendations.filter(r => \n        r.includes('network') || r.includes('API') || r.includes('request') || r.includes('cache')\n      );\n      \n      logger.info(`- Network Recommendations: ${networkRecommendations.length}`);\n      networkRecommendations.forEach(rec => logger.info(`  - ${rec}`));\n      \n      expect(metrics.totalRenderTime).toBeGreaterThan(0);\n      expect(Array.isArray(networkRecommendations)).toBe(true);\n    });\n\n    it('should identify API performance bottlenecks', async () => {\n      const componentName = 'APIPerformanceTest';\n      \n      performanceProfiler.startProfiling(componentName);\n      \n      // Simulate API calls\n      await act(async () => {\n        render(\n          <BrowserRouter>\n            <UnifiedFeed />\n          </BrowserRouter>\n        );\n      });\n      \n      const metrics = performanceProfiler.stopProfiling(componentName, 1);\n      \n      logger.info(`ðŸ”Œ API Performance Analysis:`);\n      logger.info(`- API Bottlenecks: ${metrics.performanceBottlenecks.filter(b => b.includes('API')).length}`);\n      logger.info(`- Network Recommendations: ${metrics.recommendations.filter(r => r.includes('API')).length}`);\n      \n      // Verify API performance analysis\n      expect(metrics.performanceBottlenecks).toBeDefined();\n      expect(metrics.recommendations).toBeDefined();\n    });\n  });\n\n  describe('Accessibility Optimization', () => {\n    it('should analyze accessibility performance', async () => {\n      const componentName = 'AccessibilityOptimizationTest';\n      \n      performanceProfiler.startProfiling(componentName);\n      \n      await act(async () => {\n        render(\n          <BrowserRouter>\n            <UnifiedFeed />\n          </BrowserRouter>\n        );\n      });\n      \n      const metrics = performanceProfiler.stopProfiling(componentName, 1);\n      \n      logger.info(`â™¿ Accessibility Performance Analysis:`);\n      logger.info(`- Component: ${metrics.componentName}`);\n      logger.info(`- Accessibility Bottlenecks: ${metrics.performanceBottlenecks.filter(b => b.includes('accessibility')).length}`);\n      \n      // Check for accessibility optimization recommendations\n      const accessibilityRecommendations = metrics.recommendations.filter(r => \n        r.includes('accessibility') || r.includes('screen reader') || r.includes('ARIA')\n      );\n      \n      logger.info(`- Accessibility Recommendations: ${accessibilityRecommendations.length}`);\n      accessibilityRecommendations.forEach(rec => logger.info(`  - ${rec}`));\n      \n      expect(metrics.componentName).toBe(componentName);\n      expect(Array.isArray(accessibilityRecommendations)).toBe(true);\n    });\n\n    it('should optimize screen reader performance', async () => {\n      const componentName = 'ScreenReaderOptimizationTest';\n      \n      performanceProfiler.startProfiling(componentName);\n      \n      await act(async () => {\n        render(\n          <BrowserRouter>\n            <UnifiedFeed />\n          </BrowserRouter>\n        );\n      });\n      \n      const metrics = performanceProfiler.stopProfiling(componentName, 1);\n      \n      logger.info(`ðŸ“± Screen Reader Performance:`);\n      logger.info(`- Render Time: ${metrics.totalRenderTime.toFixed(2)}ms`);\n      logger.info(`- Optimization Score: ${metrics.optimizationScore}/100`);\n      \n      // Check for screen reader optimization recommendations\n      const screenReaderRecommendations = metrics.recommendations.filter(r => \n        r.includes('screen reader') || r.includes('announcement') || r.includes('ARIA')\n      );\n      \n      logger.info(`- Screen Reader Recommendations: ${screenReaderRecommendations.length}`);\n      screenReaderRecommendations.forEach(rec => logger.info(`  - ${rec}`));\n      \n      expect(metrics.optimizationScore).toBeGreaterThanOrEqual(0);\n      expect(metrics.optimizationScore).toBeLessThanOrEqual(100);\n    });\n  });\n\n  describe('Production Monitoring', () => {\n    it('should simulate production performance monitoring', async () => {\n      const componentName = 'ProductionMonitoringTest';\n      \n      // Simulate production-like conditions\n      performanceProfiler.startProfiling(componentName);\n      \n      // Simulate multiple renders under production conditions\n      for (let i = 0; i < 3; i++) {\n        await act(async () => {\n          render(\n            <BrowserRouter>\n              <UnifiedFeed />\n            </BrowserRouter>\n          );\n        });\n      }\n      \n      const metrics = performanceProfiler.stopProfiling(componentName, 3);\n      \n      logger.info(`ðŸ­ Production Performance Monitoring:`);\n      logger.info(`- Component: ${metrics.componentName}`);\n      logger.info(`- Render Count: ${metrics.renderCount}`);\n      logger.info(`- Total Render Time: ${metrics.totalRenderTime.toFixed(2)}ms`);\n      logger.info(`- Average Render Time: ${metrics.averageRenderTime.toFixed(2)}ms`);\n      logger.info(`- Memory Peak: ${metrics.memoryPeak.toFixed(2)}MB`);\n      logger.info(`- Optimization Score: ${metrics.optimizationScore}/100`);\n      \n      // Verify production monitoring metrics\n      expect(metrics.renderCount).toBe(3);\n      expect(metrics.totalRenderTime).toBeGreaterThan(0);\n      expect(metrics.averageRenderTime).toBeGreaterThan(0);\n      expect(metrics.memoryPeak).toBeGreaterThanOrEqual(0);\n      expect(metrics.optimizationScore).toBeGreaterThanOrEqual(0);\n      expect(metrics.optimizationScore).toBeLessThanOrEqual(100);\n    });\n\n    it('should export comprehensive profiling data', async () => {\n      // Profile multiple components\n      const components = ['Component1', 'Component2', 'Component3'];\n      \n      for (const componentName of components) {\n        performanceProfiler.startProfiling(componentName);\n        \n        await act(async () => {\n          render(\n            <BrowserRouter>\n              <UnifiedFeed />\n            </BrowserRouter>\n          );\n        });\n        \n        const metrics = performanceProfiler.stopProfiling(componentName, 1);\n        performanceProfiler.createComponentProfile(componentName, metrics);\n      }\n      \n      // Export profiling data\n      const exportedData = performanceProfiler.exportProfilingData();\n      const parsedData = JSON.parse(exportedData);\n      \n      logger.info(`ðŸ“¤ Exported Profiling Data:`);\n      logger.info(`- Profiles: ${parsedData.profiles.length}`);\n      logger.info(`- Metrics: ${parsedData.metrics.length}`);\n      logger.info(`- Analysis Generated: ${!!parsedData.analysis}`);\n      \n      expect(parsedData.profiles).toBeDefined();\n      expect(parsedData.metrics).toBeDefined();\n      expect(parsedData.analysis).toBeDefined();\n      expect(parsedData.profiles.length).toBe(3);\n      expect(parsedData.metrics.length).toBe(3);\n    });\n  });\n});\n\n"],"names":["beforeAll","Object","defineProperty","window","value","getItem","jest","fn","setItem","removeItem","clear","writable","navigator","global","fetch","url","includes","Promise","resolve","ok","json","id","title","description","category","timestamp","Date","toISOString","source","success","analytics","totalViews","engagement","userSatisfaction","describe","beforeEach","performanceProfiler","it","componentName","startProfiling","startTime","performance","now","startMemory","memory","usedJSHeapSize","act","render","BrowserRouter","UnifiedFeed","endTime","endMemory","metrics","stopProfiling","logger","info","totalRenderTime","toFixed","memoryPeak","optimizationScore","reRenderTriggers","length","performanceBottlenecks","recommendations","expect","toBe","renderCount","toBeGreaterThan","toBeGreaterThanOrEqual","toBeLessThanOrEqual","profile","createComponentProfile","name","depth","isOptimized","optimizationPotential","toContain","components","Math","floor","random","analysis","generatePerformanceAnalysis","overallScore","criticalIssues","optimizationOpportunities","memoryLeaks","renderOptimizations","networkOptimizations","accessibilityOptimizations","estimatedImprovement","Array","isArray","memoryAverage","filter","b","memoryRecommendations","r","forEach","rec","i","memoryLeakIndicators","indicator","networkRecommendations","toBeDefined","accessibilityRecommendations","screenReaderRecommendations","averageRenderTime","exportedData","exportProfilingData","parsedData","JSON","parse","profiles"],"mappings":"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"}