{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/features/feeds/components/FeedItem.tsx"],"sourcesContent":["/**\n * Enhanced Feed Item Component\n * \n * Individual feed item with Instagram-like interactions\n * Features:\n * - Touch gesture support\n * - Progressive disclosure\n * - Engagement metrics\n * - Accessibility compliance\n * - Performance optimizations\n */\n\n'use client';\n\nimport { \n  HeartIcon, \n  ChatBubbleLeftIcon, \n  ShareIcon, \n  BookmarkIcon,\n  EllipsisHorizontalIcon,\n  CalendarIcon,\n  MapPinIcon\n} from '@heroicons/react/24/outline';\nimport { \n  HeartIcon as HeartSolidIcon,\n  BookmarkIcon as BookmarkSolidIcon\n} from '@heroicons/react/24/solid';\nimport Image from 'next/image';\nimport React, { useState, useRef, useCallback, memo } from 'react';\n\nimport type { FeedItemData } from '@/features/civics/lib/types/civics-types';\n\ninterface FeedItemProps {\n  item: FeedItemData;\n  onLike?: (itemId: string) => void;\n  onShare?: (itemId: string) => void;\n  onBookmark?: (itemId: string) => void;\n  onComment?: (itemId: string) => void;\n  onViewDetails?: (itemId: string) => void;\n  isLiked?: boolean;\n  isBookmarked?: boolean;\n  showEngagement?: boolean;\n  enableHaptics?: boolean;\n  className?: string;\n}\n\nconst FeedItem = memo(({\n  item,\n  onLike,\n  onShare,\n  onBookmark,\n  onComment,\n  onViewDetails,\n  isLiked = false,\n  isBookmarked = false,\n  showEngagement = true,\n  enableHaptics = false,\n  className = ''\n}: FeedItemProps) => {\n  const [isExpanded, setIsExpanded] = useState(false);\n  const [showActions, setShowActions] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  \n  const itemRef = useRef<HTMLDivElement>(null);\n  const touchStartRef = useRef<{ x: number; y: number; time: number } | null>(null);\n  const longPressTimerRef = useRef<NodeJS.Timeout | null>(null);\n\n  // Touch gesture handling\n  const handleTouchStart = useCallback((e: React.TouchEvent) => {\n    const touch = e.touches[0];\n    if (touch) {\n      touchStartRef.current = {\n        x: touch.clientX,\n        y: touch.clientY,\n        time: Date.now()\n      };\n    }\n\n    // Long press detection\n    longPressTimerRef.current = setTimeout(() => {\n      if (enableHaptics && 'vibrate' in navigator) {\n        navigator.vibrate(50); // Short haptic feedback\n      }\n      setShowActions(true);\n    }, 500);\n  }, [enableHaptics]);\n\n  const handleTouchMove = useCallback((_e: React.TouchEvent) => {\n    if (longPressTimerRef.current) {\n      clearTimeout(longPressTimerRef.current);\n      longPressTimerRef.current = null;\n    }\n  }, []);\n\n  // Engagement handlers\n  const handleLike = useCallback(() => {\n    if (isLoading) return;\n    \n    setIsLoading(true);\n    if (enableHaptics && 'vibrate' in navigator) {\n      navigator.vibrate(25); // Light haptic feedback\n    }\n    onLike?.(item.id);\n    setTimeout(() => setIsLoading(false), 200);\n  }, [item.id, onLike, enableHaptics, isLoading]);\n\n  const handleShare = useCallback(() => {\n    if (isLoading) return;\n    \n    setIsLoading(true);\n    if (enableHaptics && 'vibrate' in navigator) {\n      navigator.vibrate(25);\n    }\n    onShare?.(item.id);\n    setTimeout(() => setIsLoading(false), 200);\n  }, [item.id, onShare, enableHaptics, isLoading]);\n\n  const handleBookmark = useCallback(() => {\n    if (isLoading) return;\n    \n    setIsLoading(true);\n    if (enableHaptics && 'vibrate' in navigator) {\n      navigator.vibrate(25);\n    }\n    onBookmark?.(item.id);\n    setTimeout(() => setIsLoading(false), 200);\n  }, [item.id, onBookmark, enableHaptics, isLoading]);\n\n  const handleComment = useCallback(() => {\n    if (isLoading) return;\n    \n    setIsLoading(true);\n    if (enableHaptics && 'vibrate' in navigator) {\n      navigator.vibrate(25);\n    }\n    onComment?.(item.id);\n    setTimeout(() => setIsLoading(false), 200);\n  }, [item.id, onComment, enableHaptics, isLoading]);\n\n  const handleHashtagClick = useCallback((tag: string) => {\n    if (isLoading) return;\n    \n    setIsLoading(true);\n    if (enableHaptics && 'vibrate' in navigator) {\n      navigator.vibrate(25);\n    }\n    \n    // Simulate hashtag follow/unfollow\n    setTimeout(() => {\n      setIsLoading(false);\n      // Announce to screen reader\n      if (typeof window !== 'undefined' && window.document) {\n        const liveRegion = document.getElementById('live-region-content');\n        if (liveRegion) {\n          liveRegion.textContent = `Followed hashtag ${tag}`;\n        }\n      }\n    }, 500);\n  }, [enableHaptics, isLoading]);\n\n  const handleTouchEnd = useCallback((e: React.TouchEvent) => {\n    if (longPressTimerRef.current) {\n      clearTimeout(longPressTimerRef.current);\n      longPressTimerRef.current = null;\n    }\n\n    if (!touchStartRef.current) return;\n\n    const touch = e.changedTouches[0];\n    if (touch) {\n      const deltaX = touch.clientX - touchStartRef.current.x;\n      const deltaY = touch.clientY - touchStartRef.current.y;\n      const deltaTime = Date.now() - touchStartRef.current.time;\n\n      // Swipe detection\n      if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 50 && deltaTime < 300) {\n        if (deltaX > 0) {\n          // Swipe right - like\n          handleLike();\n        } else {\n          // Swipe left - share\n          handleShare();\n        }\n      } else if (deltaTime < 200) {\n        // Quick tap - toggle expansion\n        setIsExpanded(!isExpanded);\n      }\n    }\n\n    touchStartRef.current = null;\n  }, [isExpanded, handleLike, handleShare]);\n\n  // Format date - handle both Date objects and date strings with null safety\n  const formatDate = (date: Date | string | null | undefined) => {\n    if (!date) return 'Unknown date';\n    \n    const now = new Date();\n    const dateObj = typeof date === 'string' ? new Date(date) : date;\n    \n    // Check if dateObj is valid\n    if (!dateObj || isNaN(dateObj.getTime())) {\n      return 'Invalid date';\n    }\n    \n    const diffInHours = Math.floor((now.getTime() - dateObj.getTime()) / (1000 * 60 * 60));\n    \n    if (diffInHours < 1) return 'Just now';\n    if (diffInHours < 24) return `${diffInHours}h ago`;\n    if (diffInHours < 48) return 'Yesterday';\n    return new Date(date).toLocaleDateString();\n  };\n\n  // Get content type icon\n  const getContentTypeIcon = (type: string) => {\n    const iconClass = \"w-5 h-5\";\n    \n    switch (type) {\n      case 'vote':\n        return <div className={`${iconClass} bg-green-100 rounded-full flex items-center justify-center`}>\n          <span className=\"text-green-600 text-xs font-bold\">V</span>\n        </div>;\n      case 'bill':\n        return <div className={`${iconClass} bg-blue-100 rounded-full flex items-center justify-center`}>\n          <span className=\"text-blue-600 text-xs font-bold\">B</span>\n        </div>;\n      case 'statement':\n        return <div className={`${iconClass} bg-purple-100 rounded-full flex items-center justify-center`}>\n          <span className=\"text-purple-600 text-xs font-bold\">S</span>\n        </div>;\n      case 'social_media':\n        return <div className={`${iconClass} bg-pink-100 rounded-full flex items-center justify-center`}>\n          <span className=\"text-pink-600 text-xs font-bold\">@</span>\n        </div>;\n      case 'photo':\n        return <div className={`${iconClass} bg-gray-100 rounded-full flex items-center justify-center`}>\n          <span className=\"text-gray-600 text-xs font-bold\">ðŸ“·</span>\n        </div>;\n      default:\n        return <div className={`${iconClass} bg-gray-100 rounded-full flex items-center justify-center`}>\n          <span className=\"text-gray-600 text-xs font-bold\">?</span>\n        </div>;\n    }\n  };\n\n  // Get party color\n  const getPartyColor = (party: string) => {\n    const partyColors: Record<string, string> = {\n      'Republican': 'text-red-600 bg-red-50 border-red-200',\n      'Democrat': 'text-blue-600 bg-blue-50 border-blue-200',\n      'Independent': 'text-gray-600 bg-gray-50 border-gray-200',\n      'Green': 'text-green-600 bg-green-50 border-green-200',\n      'Libertarian': 'text-yellow-600 bg-yellow-50 border-yellow-200'\n    };\n    \n    return partyColors[party] ?? 'text-gray-600 bg-gray-50 border-gray-200';\n  };\n\n  return (\n    <div \n      ref={itemRef}\n      data-testid=\"feed-item\"\n      className={`bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden transition-all duration-200 hover:shadow-md ${className}`}\n      onTouchStart={handleTouchStart}\n      onTouchMove={handleTouchMove}\n      onTouchEnd={handleTouchEnd}\n    >\n      {/* Header */}\n      <div className=\"p-4 border-b border-gray-100\">\n        <div className=\"flex items-center space-x-3\">\n          <div className=\"relative\">\n            {item.representativePhoto ? (\n              <Image\n                src={item.representativePhoto}\n                alt={item.representativeName}\n                width={40}\n                height={40}\n                className=\"rounded-full object-cover\"\n              />\n            ) : (\n              <div className=\"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center\">\n                <span className=\"text-gray-500 text-sm font-medium\">\n                  {item.representativeName?.charAt(0) || '?'}\n                </span>\n              </div>\n            )}\n            <div className=\"absolute -bottom-1 -right-1\">\n              {getContentTypeIcon(item.contentType)}\n            </div>\n          </div>\n          \n          <div className=\"flex-1\">\n            <div className=\"flex items-center space-x-2\">\n              <h3 className=\"font-semibold text-gray-900\">{item.representativeName}</h3>\n              <span className={`px-2 py-1 rounded-full text-xs font-medium border ${getPartyColor(item.representativeParty)}`}>\n                {item.representativeParty}\n              </span>\n            </div>\n            <div className=\"flex items-center space-x-2 text-sm text-gray-500\">\n              <MapPinIcon className=\"w-4 h-4\" />\n              <span>{item.representativeOffice}</span>\n            </div>\n          </div>\n          \n          <div className=\"text-right\">\n            <div className=\"flex items-center space-x-2 text-sm text-gray-500\">\n              <CalendarIcon className=\"w-4 h-4\" />\n              <span>{formatDate(item.date)}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Content */}\n      <div className=\"p-4\">\n        <h4 className=\"font-semibold text-gray-900 mb-2\">{item.title}</h4>\n        {item.description && (\n          <div className=\"text-gray-600 mb-4\">\n            {isExpanded ? (\n              <p>{item.description}</p>\n            ) : (\n              <p className=\"line-clamp-3\">{item.description}</p>\n            )}\n            {item.description.length > 100 && (\n              <button\n                onClick={() => setIsExpanded(!isExpanded)}\n                className=\"text-blue-500 text-sm font-medium mt-2 hover:text-blue-600\"\n              >\n                {isExpanded ? 'Show less' : 'Show more'}\n              </button>\n            )}\n          </div>\n        )}\n        \n        {item.imageUrl && item.imageUrl.trim() !== '' && (\n          <div className=\"relative mb-4\">\n            <Image\n              src={item.imageUrl}\n              alt={item.title}\n              width={400}\n              height={300}\n              className=\"w-full h-64 object-cover rounded-lg\"\n            />\n          </div>\n        )}\n        \n        {/* Hashtags */}\n        {(item as any).tags && (item as any).tags.length > 0 && (\n          <div className=\"px-4 py-2\">\n            <div className=\"flex flex-wrap gap-2\">\n              {(item as any).tags.map((tag: string, index: number) => (\n                <button\n                  key={index}\n                  onClick={() => handleHashtagClick(tag)}\n                  className=\"text-blue-500 hover:text-blue-700 text-sm font-medium hover:underline\"\n                  aria-label={`Click hashtag ${tag}`}\n                >\n                  #{tag}\n                </button>\n              ))}\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Engagement */}\n      {showEngagement && (\n        <div className=\"px-4 py-3 border-t border-gray-100\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-6\">\n              <button\n                onClick={handleLike}\n                disabled={isLoading}\n                className={`flex items-center space-x-2 transition-colors ${\n                  isLiked \n                    ? 'text-red-500' \n                    : 'text-gray-500 hover:text-red-500'\n                } ${isLoading ? 'opacity-50 cursor-not-allowed' : ''}`}\n                aria-label={`${isLiked ? 'Unlike' : 'Like'} ${item.title}`}\n              >\n                {isLiked ? (\n                  <HeartSolidIcon className=\"w-5 h-5\" />\n                ) : (\n                  <HeartIcon className=\"w-5 h-5\" />\n                )}\n                <span className=\"text-sm font-medium\">\n                  {item.engagementMetrics?.likes ?? 0}\n                </span>\n              </button>\n              \n              <button\n                onClick={handleComment}\n                disabled={isLoading}\n                className={`flex items-center space-x-2 text-gray-500 hover:text-blue-500 transition-colors ${\n                  isLoading ? 'opacity-50 cursor-not-allowed' : ''\n                }`}\n                aria-label={`Comment on ${item.title}`}\n              >\n                <ChatBubbleLeftIcon className=\"w-5 h-5\" />\n                <span className=\"text-sm font-medium\">\n                  {item.engagementMetrics?.comments ?? 0}\n                </span>\n              </button>\n              \n              <button\n                onClick={handleShare}\n                disabled={isLoading}\n                data-testid=\"share-button\"\n                className={`flex items-center space-x-2 text-gray-500 hover:text-green-500 transition-colors ${\n                  isLoading ? 'opacity-50 cursor-not-allowed' : ''\n                }`}\n                aria-label={`Share ${item.title}`}\n              >\n                <ShareIcon className=\"w-5 h-5\" />\n                <span className=\"text-sm font-medium\" data-testid=\"share-count\">\n                  {item.engagementMetrics?.shares ?? 0}\n                </span>\n              </button>\n            </div>\n            \n            <div className=\"flex items-center space-x-2\">\n              <button\n                onClick={handleBookmark}\n                disabled={isLoading}\n                className={`transition-colors ${\n                  isBookmarked \n                    ? 'text-blue-500' \n                    : 'text-gray-500 hover:text-blue-500'\n                } ${isLoading ? 'opacity-50 cursor-not-allowed' : ''}`}\n                aria-label={`${isBookmarked ? 'Remove from' : 'Add to'} bookmarks`}\n              >\n                {isBookmarked ? (\n                  <BookmarkSolidIcon className=\"w-5 h-5\" />\n                ) : (\n                  <BookmarkIcon className=\"w-5 h-5\" />\n                )}\n              </button>\n              \n              <button\n                onClick={() => setShowActions(!showActions)}\n                className=\"text-gray-500 hover:text-gray-700 transition-colors\"\n                aria-label=\"More options\"\n              >\n                <EllipsisHorizontalIcon className=\"w-5 h-5\" />\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Action Menu */}\n      {showActions && (\n        <div className=\"px-4 py-2 border-t border-gray-100 bg-gray-50\">\n          <div className=\"flex items-center space-x-4\">\n            <button\n              onClick={() => {\n                onViewDetails?.(item.id);\n                setShowActions(false);\n              }}\n              className=\"text-sm text-blue-600 hover:text-blue-700 font-medium\"\n            >\n              View Details\n            </button>\n            <button\n              onClick={() => {\n                handleShare();\n                setShowActions(false);\n              }}\n              className=\"text-sm text-green-600 hover:text-green-700 font-medium\"\n            >\n              Share\n            </button>\n            <button\n              onClick={() => setShowActions(false)}\n              className=\"text-sm text-gray-600 hover:text-gray-700 font-medium\"\n            >\n              Close\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n});\n\nexport default FeedItem;\n"],"names":["FeedItem","memo","item","onLike","onShare","onBookmark","onComment","onViewDetails","isLiked","isBookmarked","showEngagement","enableHaptics","className","isExpanded","setIsExpanded","useState","showActions","setShowActions","isLoading","setIsLoading","itemRef","useRef","touchStartRef","longPressTimerRef","handleTouchStart","useCallback","e","touch","touches","current","x","clientX","y","clientY","time","Date","now","setTimeout","navigator","vibrate","handleTouchMove","_e","clearTimeout","handleLike","id","handleShare","handleBookmark","handleComment","handleHashtagClick","tag","window","document","liveRegion","getElementById","textContent","handleTouchEnd","changedTouches","deltaX","deltaY","deltaTime","Math","abs","formatDate","date","dateObj","isNaN","getTime","diffInHours","floor","toLocaleDateString","getContentTypeIcon","type","iconClass","div","span","getPartyColor","party","partyColors","ref","data-testid","onTouchStart","onTouchMove","onTouchEnd","representativePhoto","Image","src","alt","representativeName","width","height","charAt","contentType","h3","representativeParty","MapPinIcon","representativeOffice","CalendarIcon","h4","title","description","p","length","button","onClick","imageUrl","trim","tags","map","index","aria-label","disabled","HeartSolidIcon","HeartIcon","engagementMetrics","likes","ChatBubbleLeftIcon","comments","ShareIcon","shares","BookmarkSolidIcon","BookmarkIcon","EllipsisHorizontalIcon"],"mappings":"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"}