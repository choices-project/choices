{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/features/pwa/components/OfflineQueue.tsx"],"sourcesContent":["'use client'\n\nimport { Clock, WifiOff } from 'lucide-react'\nimport { useState, useEffect } from 'react'\n\nimport { usePWA } from '@/hooks/usePWA'\nimport { logger } from '@/lib/utils/logger'\n\ninterface OfflineQueueProps {\n  className?: string\n}\n\nexport default function OfflineQueue({ className = '' }: OfflineQueueProps) {\n  const pwa = usePWA()\n  const [queueItems, setQueueItems] = useState<any[]>([])\n  const [isSyncing, setIsSyncing] = useState(false)\n\n  useEffect(() => {\n    // Simulate offline queue items\n    const mockQueueItems = [\n      { id: '1', type: 'vote', pollId: 'poll-1', timestamp: Date.now() - 300000 },\n      { id: '2', type: 'comment', pollId: 'poll-1', timestamp: Date.now() - 180000 },\n      { id: '3', type: 'vote', pollId: 'poll-2', timestamp: Date.now() - 60000 }\n    ]\n    setQueueItems(mockQueueItems)\n  }, [])\n\n  const handleSync = async () => {\n    setIsSyncing(true)\n    try {\n      await pwa.syncOfflineData()\n      setQueueItems([])\n    } catch (error) {\n      logger.error('Sync failed:', error instanceof Error ? error : new Error(String(error)))\n    } finally {\n      setIsSyncing(false)\n    }\n  }\n\n  if (!pwa.hasOfflineData && queueItems.length === 0) {\n    return null\n  }\n\n  return (\n    <div className={`bg-yellow-50 border border-yellow-200 rounded-lg p-4 ${className}`} data-testid=\"offline-queue-component\">\n      <div className=\"flex items-center justify-between mb-3\">\n        <div className=\"flex items-center space-x-2\">\n          <WifiOff className=\"w-5 h-5 text-yellow-600\" />\n          <h3 className=\"text-sm font-medium text-yellow-800\">Offline Actions</h3>\n        </div>\n        <span className=\"text-sm text-yellow-700\">{queueItems.length} pending</span>\n      </div>\n\n      <div className=\"space-y-2\">\n        {queueItems.map((item) => (\n          <div key={item.id} className=\"flex items-center justify-between p-2 bg-white rounded border\">\n            <div className=\"flex items-center space-x-2\">\n              <Clock className=\"w-4 h-4 text-gray-400\" />\n              <span className=\"text-sm text-gray-700\">\n                {item.label === 'vote' ? 'Vote' : 'Comment'} on Poll {item.pollId}\n              </span>\n            </div>\n            <span className=\"text-xs text-gray-500\">\n              {new Date(item.timestamp).toLocaleTimeString()}\n            </span>\n          </div>\n        ))}\n      </div>\n\n      {pwa.isOnline && (\n        <button\n          onClick={handleSync}\n          disabled={isSyncing}\n          className=\"w-full mt-3 px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 disabled:opacity-50 transition-colors\"\n        >\n          {isSyncing ? 'Syncing...' : 'Sync Now'}\n        </button>\n      )}\n    </div>\n  )\n}\n"],"names":["OfflineQueue","className","pwa","usePWA","queueItems","setQueueItems","useState","isSyncing","setIsSyncing","useEffect","mockQueueItems","id","type","pollId","timestamp","Date","now","handleSync","syncOfflineData","error","logger","Error","String","hasOfflineData","length","div","data-testid","WifiOff","h3","span","map","item","Clock","label","toLocaleTimeString","isOnline","button","onClick","disabled"],"mappings":"AAAA;;;;;+BAYA;;;eAAwBA;;;;;;uBATY;wBAEb;wBACA;AAMR,SAASA,aAAa,EAAEC,YAAY,EAAE,EAAqB;IACxE,MAAMC,MAAMC,IAAAA,cAAM;IAClB,MAAM,CAACC,YAAYC,cAAc,GAAGC,IAAAA,eAAQ,EAAQ,EAAE;IACtD,MAAM,CAACC,WAAWC,aAAa,GAAGF,IAAAA,eAAQ,EAAC;IAE3CG,IAAAA,gBAAS,EAAC;QACR,+BAA+B;QAC/B,MAAMC,iBAAiB;YACrB;gBAAEC,IAAI;gBAAKC,MAAM;gBAAQC,QAAQ;gBAAUC,WAAWC,KAAKC,GAAG,KAAK;YAAO;YAC1E;gBAAEL,IAAI;gBAAKC,MAAM;gBAAWC,QAAQ;gBAAUC,WAAWC,KAAKC,GAAG,KAAK;YAAO;YAC7E;gBAAEL,IAAI;gBAAKC,MAAM;gBAAQC,QAAQ;gBAAUC,WAAWC,KAAKC,GAAG,KAAK;YAAM;SAC1E;QACDX,cAAcK;IAChB,GAAG,EAAE;IAEL,MAAMO,aAAa;QACjBT,aAAa;QACb,IAAI;YACF,MAAMN,IAAIgB,eAAe;YACzBb,cAAc,EAAE;QAClB,EAAE,OAAOc,OAAO;YACdC,cAAM,CAACD,KAAK,CAAC,gBAAgBA,iBAAiBE,QAAQF,QAAQ,IAAIE,MAAMC,OAAOH;QACjF,SAAU;YACRX,aAAa;QACf;IACF;IAEA,IAAI,CAACN,IAAIqB,cAAc,IAAInB,WAAWoB,MAAM,KAAK,GAAG;QAClD,OAAO;IACT;IAEA,qBACE,sBAACC;QAAIxB,WAAW,CAAC,qDAAqD,EAAEA,WAAW;QAAEyB,eAAY;;0BAC/F,sBAACD;gBAAIxB,WAAU;;kCACb,sBAACwB;wBAAIxB,WAAU;;0CACb,qBAAC0B,gBAAO;gCAAC1B,WAAU;;0CACnB,qBAAC2B;gCAAG3B,WAAU;0CAAsC;;;;kCAEtD,sBAAC4B;wBAAK5B,WAAU;;4BAA2BG,WAAWoB,MAAM;4BAAC;;;;;0BAG/D,qBAACC;gBAAIxB,WAAU;0BACZG,WAAW0B,GAAG,CAAC,CAACC,qBACf,sBAACN;wBAAkBxB,WAAU;;0CAC3B,sBAACwB;gCAAIxB,WAAU;;kDACb,qBAAC+B,YAAK;wCAAC/B,WAAU;;kDACjB,sBAAC4B;wCAAK5B,WAAU;;4CACb8B,KAAKE,KAAK,KAAK,SAAS,SAAS;4CAAU;4CAAUF,KAAKlB,MAAM;;;;;0CAGrE,qBAACgB;gCAAK5B,WAAU;0CACb,IAAIc,KAAKgB,KAAKjB,SAAS,EAAEoB,kBAAkB;;;uBARtCH,KAAKpB,EAAE;;YAcpBT,IAAIiC,QAAQ,kBACX,qBAACC;gBACCC,SAASpB;gBACTqB,UAAU/B;gBACVN,WAAU;0BAETM,YAAY,eAAe;;;;AAKtC"}