{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/features/pwa/components/NotificationPermission.tsx"],"sourcesContent":["'use client'\n\nimport { Bell, BellOff, CheckCircle, AlertCircle } from 'lucide-react'\nimport { useState, useEffect } from 'react'\n\nimport { usePWA } from '@/hooks/usePWA'\n\ntype NotificationPermissionState = 'default' | 'granted' | 'denied'\n\ninterface NotificationPermissionProps {\n  className?: string\n}\n\nexport default function NotificationPermission({ className = '' }: NotificationPermissionProps) {\n  const pwa = usePWA()\n  const [permission, setPermission] = useState<NotificationPermissionState>('default')\n  const [isRequesting, setIsRequesting] = useState(false)\n  const [error, setError] = useState<string | null>(null)\n\n  useEffect(() => {\n    if (pwa.notificationsSupported) {\n      setPermission(pwa.notificationsPermission)\n    }\n  }, [pwa.notificationsSupported, pwa.notificationsPermission])\n\n  const handleRequestPermission = async () => {\n    setIsRequesting(true)\n    setError(null)\n    \n    try {\n      const granted = await pwa.requestNotificationPermission()\n      if (granted) {\n        setPermission('granted')\n      } else {\n        setPermission('denied')\n        setError('Notification permission denied')\n      }\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to request permission')\n    } finally {\n      setIsRequesting(false)\n    }\n  }\n\n  if (!pwa.notificationsSupported) {\n    return (\n      <div className={`bg-yellow-50 border border-yellow-200 rounded-lg p-4 ${className}`}>\n        <div className=\"flex items-center space-x-2 text-yellow-800\">\n          <AlertCircle className=\"w-5 h-5\" />\n          <span className=\"text-sm\">Notifications are not supported in your browser</span>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className={`bg-white border border-gray-200 rounded-lg p-4 ${className}`}>\n      <div className=\"flex items-center justify-between mb-3\">\n        <div className=\"flex items-center space-x-2\">\n          <Bell className=\"w-5 h-5 text-blue-600\" />\n          <h3 className=\"text-sm font-medium text-gray-800\">Notification Permission</h3>\n        </div>\n        <span className={`text-xs px-2 py-1 rounded ${\n          permission === 'granted' ? 'bg-green-100 text-green-800' :\n          permission === 'denied' ? 'bg-red-100 text-red-800' :\n          'bg-gray-100 text-gray-800'\n        }`}>\n          {permission.charAt(0).toUpperCase() + permission.slice(1)}\n        </span>\n      </div>\n\n      {permission === 'default' && (\n        <button\n          onClick={handleRequestPermission}\n          disabled={isRequesting}\n          className=\"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors\"\n          data-testid=\"request-notification-permission\"\n        >\n          {isRequesting ? 'Requesting...' : 'Request Permission'}\n        </button>\n      )}\n\n      {permission === 'granted' && (\n        <div className=\"flex items-center space-x-2 text-green-800\">\n          <CheckCircle className=\"w-5 h-5\" />\n          <span className=\"text-sm\">Notifications are enabled</span>\n        </div>\n      )}\n\n      {permission === 'denied' && (\n        <div className=\"space-y-2\">\n          <div className=\"flex items-center space-x-2 text-red-800\">\n            <BellOff className=\"w-5 h-5\" />\n            <span className=\"text-sm\">Notifications are blocked</span>\n          </div>\n          <p className=\"text-xs text-gray-600\">\n            Please enable notifications in your browser settings\n          </p>\n        </div>\n      )}\n\n      {error && (\n        <div className=\"mt-2 p-2 bg-red-100 rounded border\">\n          <div className=\"flex items-center space-x-2 text-red-800\">\n            <AlertCircle className=\"w-4 h-4\" />\n            <span className=\"text-sm\">{error}</span>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n"],"names":["NotificationPermission","className","pwa","usePWA","permission","setPermission","useState","isRequesting","setIsRequesting","error","setError","useEffect","notificationsSupported","notificationsPermission","handleRequestPermission","granted","requestNotificationPermission","err","Error","message","div","AlertCircle","span","Bell","h3","charAt","toUpperCase","slice","button","onClick","disabled","data-testid","CheckCircle","BellOff","p"],"mappings":"AAAA;;;;;+BAaA;;;eAAwBA;;;;;;;;uBAVY;wBAEb;AAQR,SAASA,uBAAuB,EAAEC,YAAY,EAAE,EAA+B;IAC5F,MAAMC,MAAMC,IAAAA,cAAM;IAClB,MAAM,CAACC,YAAYC,cAAc,GAAGC,IAAAA,eAAQ,EAA8B;IAC1E,MAAM,CAACC,cAAcC,gBAAgB,GAAGF,IAAAA,eAAQ,EAAC;IACjD,MAAM,CAACG,OAAOC,SAAS,GAAGJ,IAAAA,eAAQ,EAAgB;IAElDK,IAAAA,gBAAS,EAAC;QACR,IAAIT,IAAIU,sBAAsB,EAAE;YAC9BP,cAAcH,IAAIW,uBAAuB;QAC3C;IACF,GAAG;QAACX,IAAIU,sBAAsB;QAAEV,IAAIW,uBAAuB;KAAC;IAE5D,MAAMC,0BAA0B;QAC9BN,gBAAgB;QAChBE,SAAS;QAET,IAAI;YACF,MAAMK,UAAU,MAAMb,IAAIc,6BAA6B;YACvD,IAAID,SAAS;gBACXV,cAAc;YAChB,OAAO;gBACLA,cAAc;gBACdK,SAAS;YACX;QACF,EAAE,OAAOO,KAAK;YACZP,SAASO,eAAeC,QAAQD,IAAIE,OAAO,GAAG;QAChD,SAAU;YACRX,gBAAgB;QAClB;IACF;IAEA,IAAI,CAACN,IAAIU,sBAAsB,EAAE;QAC/B,qBACE,qBAACQ;YAAInB,WAAW,CAAC,qDAAqD,EAAEA,WAAW;sBACjF,cAAA,sBAACmB;gBAAInB,WAAU;;kCACb,qBAACoB,wBAAW;wBAACpB,WAAU;;kCACvB,qBAACqB;wBAAKrB,WAAU;kCAAU;;;;;IAIlC;IAEA,qBACE,sBAACmB;QAAInB,WAAW,CAAC,+CAA+C,EAAEA,WAAW;;0BAC3E,sBAACmB;gBAAInB,WAAU;;kCACb,sBAACmB;wBAAInB,WAAU;;0CACb,qBAACsB,UAAI;gCAACtB,WAAU;;0CAChB,qBAACuB;gCAAGvB,WAAU;0CAAoC;;;;kCAEpD,qBAACqB;wBAAKrB,WAAW,CAAC,0BAA0B,EAC1CG,eAAe,YAAY,gCAC3BA,eAAe,WAAW,4BAC1B,6BACA;kCACCA,WAAWqB,MAAM,CAAC,GAAGC,WAAW,KAAKtB,WAAWuB,KAAK,CAAC;;;;YAI1DvB,eAAe,2BACd,qBAACwB;gBACCC,SAASf;gBACTgB,UAAUvB;gBACVN,WAAU;gBACV8B,eAAY;0BAEXxB,eAAe,kBAAkB;;YAIrCH,eAAe,2BACd,sBAACgB;gBAAInB,WAAU;;kCACb,qBAAC+B,wBAAW;wBAAC/B,WAAU;;kCACvB,qBAACqB;wBAAKrB,WAAU;kCAAU;;;;YAI7BG,eAAe,0BACd,sBAACgB;gBAAInB,WAAU;;kCACb,sBAACmB;wBAAInB,WAAU;;0CACb,qBAACgC,gBAAO;gCAAChC,WAAU;;0CACnB,qBAACqB;gCAAKrB,WAAU;0CAAU;;;;kCAE5B,qBAACiC;wBAAEjC,WAAU;kCAAwB;;;;YAMxCQ,uBACC,qBAACW;gBAAInB,WAAU;0BACb,cAAA,sBAACmB;oBAAInB,WAAU;;sCACb,qBAACoB,wBAAW;4BAACpB,WAAU;;sCACvB,qBAACqB;4BAAKrB,WAAU;sCAAWQ;;;;;;;AAMvC"}