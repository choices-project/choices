b89dd13ea70d445bfbc5696c0095b5f5
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _globals = require("@jest/globals");
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {
        __proto__: null
    };
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
/**
 * Debug Poll Insert Test
 * 
 * Tests to debug why polls aren't being inserted/retrieved
 * 
 * Created: January 27, 2025
 * Status: ‚úÖ PRODUCTION READY
 */ (0, _globals.describe)('Debug Poll Insert', ()=>{
    (0, _globals.it)('should debug poll insertion step by step', async ()=>{
        const { createClient } = await Promise.resolve().then(()=>/*#__PURE__*/ _interop_require_wildcard(require("@supabase/supabase-js")));
        const supabaseUrl = process.env.SUPABASE_URL || process.env.NEXT_PUBLIC_SUPABASE_URL;
        const supabaseKey = process.env.SUPABASE_SERVICE_ROLE_KEY;
        if (!supabaseUrl || !supabaseKey) {
            throw new Error('Supabase credentials not found');
        }
        const supabase = createClient(supabaseUrl, supabaseKey);
        console.log('üîç Step 1: Check if polls table exists...');
        // Try to query the polls table directly
        const { data: pollsData, error: pollsError } = await supabase.from('polls').select('*').limit(1);
        console.log('Polls table query result:', {
            pollsData,
            pollsError
        });
        if (pollsError) {
            console.log('‚ùå Polls table error:', pollsError.message);
            if (pollsError.message.includes('relation "polls" does not exist')) {
                console.log('‚ùå Polls table does not exist!');
                return;
            }
        } else {
            console.log('‚úÖ Polls table exists and is accessible');
        }
        console.log('üîç Step 2: Check polls table structure...');
        // Get table structure
        const { data: columns, error: columnsError } = await supabase.from('information_schema.columns').select('column_name, data_type, is_nullable').eq('table_name', 'polls').eq('table_schema', 'public');
        console.log('Polls table columns:', {
            columns,
            columnsError
        });
        console.log('üîç Step 3: Try to insert a minimal poll...');
        const minimalPoll = {
            title: 'Debug Test Poll',
            description: 'Debug Test Description',
            options: [
                'Option 1',
                'Option 2'
            ],
            voting_method: 'single_choice',
            status: 'active',
            created_by: 'debug-user',
            privacy_level: 'public'
        };
        console.log('Minimal poll data:', minimalPoll);
        const { data: insertResult, error: insertError } = await supabase.from('polls').insert(minimalPoll).select();
        console.log('Insert result:', {
            insertResult,
            insertError
        });
        if (insertError) {
            console.log('‚ùå Insert error details:', {
                message: insertError.message,
                details: insertError.details,
                hint: insertError.hint,
                code: insertError.code
            });
        }
        console.log('üîç Step 4: Query all polls to see what exists...');
        const { data: allPolls, error: queryError } = await supabase.from('polls').select('*');
        console.log('All polls query result:', {
            allPolls,
            queryError
        });
        console.log('üîç Step 5: Query specific poll by title...');
        const { data: specificPoll, error: specificError } = await supabase.from('polls').select('*').eq('title', 'Debug Test Poll');
        console.log('Specific poll query result:', {
            specificPoll,
            specificError
        });
        // The test should pass if we can at least connect and query
        (0, _globals.expect)(insertError).toBeNull();
        (0, _globals.expect)(queryError).toBeNull();
        (0, _globals.expect)(specificError).toBeNull();
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hbGF1Z2hpbmdraXRzdW5lL3NyYy9DaG9pY2VzL3dlYi90ZXN0cy9qZXN0L2ludGVncmF0aW9uL2RlYnVnLXBvbGwtaW5zZXJ0LnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGVzY3JpYmUsIGl0LCBleHBlY3QgfSBmcm9tICdAamVzdC9nbG9iYWxzJztcblxuLyoqXG4gKiBEZWJ1ZyBQb2xsIEluc2VydCBUZXN0XG4gKiBcbiAqIFRlc3RzIHRvIGRlYnVnIHdoeSBwb2xscyBhcmVuJ3QgYmVpbmcgaW5zZXJ0ZWQvcmV0cmlldmVkXG4gKiBcbiAqIENyZWF0ZWQ6IEphbnVhcnkgMjcsIDIwMjVcbiAqIFN0YXR1czog4pyFIFBST0RVQ1RJT04gUkVBRFlcbiAqL1xuXG5kZXNjcmliZSgnRGVidWcgUG9sbCBJbnNlcnQnLCAoKSA9PiB7XG4gIGl0KCdzaG91bGQgZGVidWcgcG9sbCBpbnNlcnRpb24gc3RlcCBieSBzdGVwJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHsgY3JlYXRlQ2xpZW50IH0gPSBhd2FpdCBpbXBvcnQoJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcycpO1xuICAgIGNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuU1VQQUJBU0VfVVJMIHx8IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTDtcbiAgICBjb25zdCBzdXBhYmFzZUtleSA9IHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVk7XG4gICAgXG4gICAgaWYgKCFzdXBhYmFzZVVybCB8fCAhc3VwYWJhc2VLZXkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignU3VwYWJhc2UgY3JlZGVudGlhbHMgbm90IGZvdW5kJyk7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZUtleSk7XG4gICAgXG4gICAgY29uc29sZS5sb2coJ/CflI0gU3RlcCAxOiBDaGVjayBpZiBwb2xscyB0YWJsZSBleGlzdHMuLi4nKTtcbiAgICBcbiAgICAvLyBUcnkgdG8gcXVlcnkgdGhlIHBvbGxzIHRhYmxlIGRpcmVjdGx5XG4gICAgY29uc3QgeyBkYXRhOiBwb2xsc0RhdGEsIGVycm9yOiBwb2xsc0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3BvbGxzJylcbiAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgLmxpbWl0KDEpO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCdQb2xscyB0YWJsZSBxdWVyeSByZXN1bHQ6JywgeyBwb2xsc0RhdGEsIHBvbGxzRXJyb3IgfSk7XG4gICAgXG4gICAgaWYgKHBvbGxzRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfinYwgUG9sbHMgdGFibGUgZXJyb3I6JywgcG9sbHNFcnJvci5tZXNzYWdlKTtcbiAgICAgIGlmIChwb2xsc0Vycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ3JlbGF0aW9uIFwicG9sbHNcIiBkb2VzIG5vdCBleGlzdCcpKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfinYwgUG9sbHMgdGFibGUgZG9lcyBub3QgZXhpc3QhJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coJ+KchSBQb2xscyB0YWJsZSBleGlzdHMgYW5kIGlzIGFjY2Vzc2libGUnKTtcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coJ/CflI0gU3RlcCAyOiBDaGVjayBwb2xscyB0YWJsZSBzdHJ1Y3R1cmUuLi4nKTtcbiAgICBcbiAgICAvLyBHZXQgdGFibGUgc3RydWN0dXJlXG4gICAgY29uc3QgeyBkYXRhOiBjb2x1bW5zLCBlcnJvcjogY29sdW1uc0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2luZm9ybWF0aW9uX3NjaGVtYS5jb2x1bW5zJylcbiAgICAgIC5zZWxlY3QoJ2NvbHVtbl9uYW1lLCBkYXRhX3R5cGUsIGlzX251bGxhYmxlJylcbiAgICAgIC5lcSgndGFibGVfbmFtZScsICdwb2xscycpXG4gICAgICAuZXEoJ3RhYmxlX3NjaGVtYScsICdwdWJsaWMnKTtcbiAgICBcbiAgICBjb25zb2xlLmxvZygnUG9sbHMgdGFibGUgY29sdW1uczonLCB7IGNvbHVtbnMsIGNvbHVtbnNFcnJvciB9KTtcbiAgICBcbiAgICBjb25zb2xlLmxvZygn8J+UjSBTdGVwIDM6IFRyeSB0byBpbnNlcnQgYSBtaW5pbWFsIHBvbGwuLi4nKTtcbiAgICBcbiAgICBjb25zdCBtaW5pbWFsUG9sbCA9IHtcbiAgICAgIHRpdGxlOiAnRGVidWcgVGVzdCBQb2xsJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnRGVidWcgVGVzdCBEZXNjcmlwdGlvbicsXG4gICAgICBvcHRpb25zOiBbJ09wdGlvbiAxJywgJ09wdGlvbiAyJ10sXG4gICAgICB2b3RpbmdfbWV0aG9kOiAnc2luZ2xlX2Nob2ljZScsXG4gICAgICBzdGF0dXM6ICdhY3RpdmUnLFxuICAgICAgY3JlYXRlZF9ieTogJ2RlYnVnLXVzZXInLFxuICAgICAgcHJpdmFjeV9sZXZlbDogJ3B1YmxpYydcbiAgICB9O1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCdNaW5pbWFsIHBvbGwgZGF0YTonLCBtaW5pbWFsUG9sbCk7XG4gICAgXG4gICAgY29uc3QgeyBkYXRhOiBpbnNlcnRSZXN1bHQsIGVycm9yOiBpbnNlcnRFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdwb2xscycpXG4gICAgICAuaW5zZXJ0KG1pbmltYWxQb2xsKVxuICAgICAgLnNlbGVjdCgpO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCdJbnNlcnQgcmVzdWx0OicsIHsgaW5zZXJ0UmVzdWx0LCBpbnNlcnRFcnJvciB9KTtcbiAgICBcbiAgICBpZiAoaW5zZXJ0RXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfinYwgSW5zZXJ0IGVycm9yIGRldGFpbHM6Jywge1xuICAgICAgICBtZXNzYWdlOiBpbnNlcnRFcnJvci5tZXNzYWdlLFxuICAgICAgICBkZXRhaWxzOiBpbnNlcnRFcnJvci5kZXRhaWxzLFxuICAgICAgICBoaW50OiBpbnNlcnRFcnJvci5oaW50LFxuICAgICAgICBjb2RlOiBpbnNlcnRFcnJvci5jb2RlXG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coJ/CflI0gU3RlcCA0OiBRdWVyeSBhbGwgcG9sbHMgdG8gc2VlIHdoYXQgZXhpc3RzLi4uJyk7XG4gICAgXG4gICAgY29uc3QgeyBkYXRhOiBhbGxQb2xscywgZXJyb3I6IHF1ZXJ5RXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgncG9sbHMnKVxuICAgICAgLnNlbGVjdCgnKicpO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCdBbGwgcG9sbHMgcXVlcnkgcmVzdWx0OicsIHsgYWxsUG9sbHMsIHF1ZXJ5RXJyb3IgfSk7XG4gICAgXG4gICAgY29uc29sZS5sb2coJ/CflI0gU3RlcCA1OiBRdWVyeSBzcGVjaWZpYyBwb2xsIGJ5IHRpdGxlLi4uJyk7XG4gICAgXG4gICAgY29uc3QgeyBkYXRhOiBzcGVjaWZpY1BvbGwsIGVycm9yOiBzcGVjaWZpY0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3BvbGxzJylcbiAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgLmVxKCd0aXRsZScsICdEZWJ1ZyBUZXN0IFBvbGwnKTtcbiAgICBcbiAgICBjb25zb2xlLmxvZygnU3BlY2lmaWMgcG9sbCBxdWVyeSByZXN1bHQ6JywgeyBzcGVjaWZpY1BvbGwsIHNwZWNpZmljRXJyb3IgfSk7XG4gICAgXG4gICAgLy8gVGhlIHRlc3Qgc2hvdWxkIHBhc3MgaWYgd2UgY2FuIGF0IGxlYXN0IGNvbm5lY3QgYW5kIHF1ZXJ5XG4gICAgZXhwZWN0KGluc2VydEVycm9yKS50b0JlTnVsbCgpO1xuICAgIGV4cGVjdChxdWVyeUVycm9yKS50b0JlTnVsbCgpO1xuICAgIGV4cGVjdChzcGVjaWZpY0Vycm9yKS50b0JlTnVsbCgpO1xuICB9KTtcbn0pO1xuIl0sIm5hbWVzIjpbImRlc2NyaWJlIiwiaXQiLCJjcmVhdGVDbGllbnQiLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJTVVBBQkFTRV9VUkwiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzdXBhYmFzZUtleSIsIlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkiLCJFcnJvciIsInN1cGFiYXNlIiwiY29uc29sZSIsImxvZyIsImRhdGEiLCJwb2xsc0RhdGEiLCJlcnJvciIsInBvbGxzRXJyb3IiLCJmcm9tIiwic2VsZWN0IiwibGltaXQiLCJtZXNzYWdlIiwiaW5jbHVkZXMiLCJjb2x1bW5zIiwiY29sdW1uc0Vycm9yIiwiZXEiLCJtaW5pbWFsUG9sbCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJvcHRpb25zIiwidm90aW5nX21ldGhvZCIsInN0YXR1cyIsImNyZWF0ZWRfYnkiLCJwcml2YWN5X2xldmVsIiwiaW5zZXJ0UmVzdWx0IiwiaW5zZXJ0RXJyb3IiLCJpbnNlcnQiLCJkZXRhaWxzIiwiaGludCIsImNvZGUiLCJhbGxQb2xscyIsInF1ZXJ5RXJyb3IiLCJzcGVjaWZpY1BvbGwiLCJzcGVjaWZpY0Vycm9yIiwiZXhwZWN0IiwidG9CZU51bGwiXSwibWFwcGluZ3MiOiI7Ozs7eUJBQXFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFckM7Ozs7Ozs7Q0FPQyxHQUVEQSxJQUFBQSxpQkFBUSxFQUFDLHFCQUFxQjtJQUM1QkMsSUFBQUEsV0FBRSxFQUFDLDRDQUE0QztRQUM3QyxNQUFNLEVBQUVDLFlBQVksRUFBRSxHQUFHLE1BQU0sbUVBQUEsUUFBTztRQUN0QyxNQUFNQyxjQUFjQyxRQUFRQyxHQUFHLENBQUNDLFlBQVksSUFBSUYsUUFBUUMsR0FBRyxDQUFDRSx3QkFBd0I7UUFDcEYsTUFBTUMsY0FBY0osUUFBUUMsR0FBRyxDQUFDSSx5QkFBeUI7UUFFekQsSUFBSSxDQUFDTixlQUFlLENBQUNL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