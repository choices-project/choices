{"version":3,"sources":["/Users/alaughingkitsune/src/Choices/web/tests/jest/unit/integration/feature-integration.test.ts"],"sourcesContent":["/**\n * Cross-Feature Integration Tests\n * \n * Ensures features work together properly and maintain\n * system coherence across feature interactions.\n * \n * Created: January 27, 2025\n * Status: âœ… ACTIVE\n */\n\nimport { describe, it, expect } from '@jest/globals';\nimport { logger } from '@/lib/utils/logger';\nimport * as fs from 'fs';\nimport * as glob from 'glob';\n\ndescribe('Feature Integration Error Prevention', () => {\n  it('hashtag integration should work across features', () => {\n    const hashtagFiles = glob.sync('web/features/**/*.{ts,tsx}', { \n      ignore: ['**/*.test.*', '**/*.spec.*', '**/node_modules/**'] \n    });\n    \n    const problematicFiles: string[] = [];\n    \n    hashtagFiles.forEach(file => {\n      const content = fs.readFileSync(file, 'utf8');\n      \n      // Check for hashtag integration\n      if (content.includes('hashtag') || content.includes('Hashtag')) {\n        // Should have proper integration\n        if (!content.includes('useHashtagStore') && !content.includes('hashtagStore')) {\n          problematicFiles.push(`${file}: hashtag integration should use store`);\n        }\n      }\n      \n      // Check for hashtag state management\n      if (content.includes('hashtag') && content.includes('useState')) {\n        // Should use store instead of local state\n        if (!content.includes('useHashtagStore')) {\n          problematicFiles.push(`${file}: hashtag state should use store`);\n        }\n      }\n    });\n    \n    if (problematicFiles.length > 0) {\n      logger.info('Files with hashtag integration issues:', problematicFiles);\n    }\n    \n    expect(problematicFiles).toHaveLength(0);\n  });\n\n  it('analytics should track across all features', () => {\n    const featureFiles = glob.sync('web/features/**/*.{ts,tsx}', { \n      ignore: ['**/*.test.*', '**/*.spec.*', '**/node_modules/**'] \n    });\n    \n    const problematicFiles: string[] = [];\n    \n    featureFiles.forEach(file => {\n      const content = fs.readFileSync(file, 'utf8');\n      \n      // Check for analytics integration\n      if (content.includes('onClick') || content.includes('onSubmit') || content.includes('onChange')) {\n        // Should have analytics tracking\n        if (!content.includes('track') && !content.includes('analytics') && !content.includes('event')) {\n          problematicFiles.push(`${file}: user interactions should be tracked`);\n        }\n      }\n      \n      // Check for analytics state management\n      if (content.includes('analytics') && content.includes('useState')) {\n        // Should use analytics store\n        if (!content.includes('useAnalyticsStore')) {\n          problematicFiles.push(`${file}: analytics should use store`);\n        }\n      }\n    });\n    \n    if (problematicFiles.length > 0) {\n      logger.info('Files with missing analytics tracking:', problematicFiles);\n    }\n    \n    expect(problematicFiles).toHaveLength(0);\n  });\n\n  it('state management should be consistent across features', () => {\n    const featureFiles = glob.sync('web/features/**/*.{ts,tsx}', { \n      ignore: ['**/*.test.*', '**/*.spec.*', '**/node_modules/**'] \n    });\n    \n    const problematicFiles: string[] = [];\n    \n    featureFiles.forEach(file => {\n      const content = fs.readFileSync(file, 'utf8');\n      \n      // Check for store usage consistency\n      if (content.includes('useState') && content.includes('user')) {\n        // Should use user store\n        if (!content.includes('useUserStore')) {\n          problematicFiles.push(`${file}: user state should use store`);\n        }\n      }\n      \n      if (content.includes('useState') && content.includes('app')) {\n        // Should use app store\n        if (!content.includes('useAppStore')) {\n          problematicFiles.push(`${file}: app state should use store`);\n        }\n      }\n      \n      if (content.includes('useState') && content.includes('notification')) {\n        // Should use notification store\n        if (!content.includes('useNotificationStore')) {\n          problematicFiles.push(`${file}: notification state should use store`);\n        }\n      }\n    });\n    \n    if (problematicFiles.length > 0) {\n      logger.info('Files with inconsistent state management:', problematicFiles);\n    }\n    \n    expect(problematicFiles).toHaveLength(0);\n  });\n\n  it('error handling should be consistent across features', () => {\n    const featureFiles = glob.sync('web/features/**/*.{ts,tsx}', { \n      ignore: ['**/*.test.*', '**/*.spec.*', '**/node_modules/**'] \n    });\n    \n    const problematicFiles: string[] = [];\n    \n    featureFiles.forEach(file => {\n      const content = fs.readFileSync(file, 'utf8');\n      \n      // Check for error handling consistency\n      if (content.includes('catch') && content.includes('error')) {\n        // Should have consistent error handling\n        if (!content.includes('logger.error') && !content.includes('console.error')) {\n          problematicFiles.push(`${file}: error handling should be consistent`);\n        }\n      }\n      \n      // Check for error state management\n      if (content.includes('error') && content.includes('useState')) {\n        // Should have proper error state management\n        if (!content.includes('setError') && !content.includes('setLoading')) {\n          problematicFiles.push(`${file}: error state should be properly managed`);\n        }\n      }\n    });\n    \n    if (problematicFiles.length > 0) {\n      logger.info('Files with inconsistent error handling:', problematicFiles);\n    }\n    \n    expect(problematicFiles).toHaveLength(0);\n  });\n});\n"],"names":["describe","it","hashtagFiles","glob","sync","ignore","problematicFiles","forEach","file","content","fs","readFileSync","includes","push","length","logger","info","expect","toHaveLength","featureFiles"],"mappings":"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"}